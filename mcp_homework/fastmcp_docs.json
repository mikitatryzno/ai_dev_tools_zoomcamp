[{"filename": ".github/copilot-instructions.md", "content": "../AGENTS.md"}, {"filename": ".github/pull_request_template.md", "content": "## Description\n<!-- \nPlease provide a clear and concise description of the changes made in this pull request.\n\nUsing AI to generate code? Please include a note in the description with which AI tool you used.\n-->\n\n**Contributors Checklist**\n<!--\nNOTE:\n1. You must create an issue in the repository before making a Pull Request.\n2. You must not create a Pull Request for an issue that is already assigned to someone else.\n\nIf you do not follow these steps, your Pull Request will be closed without review.\n-->\n\n- [ ] My change closes #(issue number)\n- [ ] I have followed the repository's development workflow\n- [ ] I have tested my changes manually and by adding relevant tests\n- [ ] I have performed all required documentation updates\n\n**Review Checklist**\n<!-- Your Pull Request will not be reviewed if tests are failing, you have not self-reviewed your changes, or you have not checked all of the following: -->\n\n- [ ] I have self-reviewed my changes\n- [ ] My Pull Request is ready for review\n\n---\n"}, {"filename": "AGENTS.md", "content": "# FastMCP Development Guidelines\n\n> **Audience**: LLM-driven engineering agents and human developers\n\nFastMCP is a comprehensive Python framework (Python \u22653.10) for building Model Context Protocol (MCP) servers and clients. This is the actively maintained v2.0 providing a complete toolkit for the MCP ecosystem.\n\n## Required Development Workflow\n\n**CRITICAL**: Always run these commands in sequence before committing:\n\n```bash\nuv sync                              # Install dependencies\nuv run prek run --all-files          # Ruff + Prettier + ty\nuv run pytest -n auto                # Run full test suite\n```\n\n**All three must pass** - this is enforced by CI. Alternative: `just build && just typecheck && just test`\n\n**Tests must pass and lint/typing must be clean before committing.**\n\n## Repository Structure\n\n| Path               | Purpose                                                                             |\n| ------------------ | ----------------------------------------------------------------------------------- |\n| `src/fastmcp/`     | Library source code (Python \u2265 3.10)                                                 |\n| `\u251c\u2500server/`        | Server implementation, `FastMCP`, auth, networking                                  |\n| `\u2502  \u251c\u2500auth/`       | Authentication providers (Google, GitHub, Azure, AWS, WorkOS, Auth0, JWT, and more) |\n| `\u2502  \u2514\u2500middleware/` | Error handling, logging, rate limiting                                              |\n| `\u251c\u2500client/`        | High-level client SDK + transports                                                  |\n| `\u2502  \u2514\u2500auth/`       | Client authentication (Bearer, OAuth)                                               |\n| `\u251c\u2500tools/`         | Tool implementations + `ToolManager`                                                |\n| `\u251c\u2500resources/`     | Resources, templates + `ResourceManager`                                            |\n| `\u251c\u2500prompts/`       | Prompt templates + `PromptManager`                                                  |\n| `\u251c\u2500cli/`           | FastMCP CLI commands (`run`, `dev`, `install`)                                      |\n| `\u251c\u2500contrib/`       | Community contributions (bulk caller, mixins)                                       |\n| `\u251c\u2500experimental/`  | Experimental features (sampling handlers)                                           |\n| `\u2514\u2500utilities/`     | Shared utilities (logging, JSON schema, HTTP)                                       |\n| `tests/`           | Comprehensive pytest suite with markers                                             |\n| `docs/`            | Mintlify documentation (published to gofastmcp.com)                                 |\n| `examples/`        | Runnable demo servers (echo, smart_home, atproto)                                   |\n\n## Core MCP Objects\n\nWhen modifying MCP functionality, changes typically need to be applied across all object types:\n\n- **Tools** (`src/tools/` + `ToolManager`)\n- **Resources** (`src/resources/` + `ResourceManager`)\n- **Resource Templates** (`src/resources/` + `ResourceManager`)\n- **Prompts** (`src/prompts/` + `PromptManager`)\n\n## Writing Style\n\n- Be brief and to the point. Do not regurgitate information that can easily be gleaned from the code, except to guide the reader to where the code is located.\n- **NEVER** use \"This isn't...\" or \"not just...\" constructions. State what something IS directly. Avoid defensive writing patterns like:\n  - \"This isn't X, it's Y\" or \"Not just X, but Y\" \u2192 Just say \"This is Y\"\n  - \"Not just about X\" \u2192 State the actual purpose\n  - \"We're not doing X, we're doing Y\" \u2192 Just explain what you're doing\n  - Any variation of explaining what something isn't before what it is\n\n## Testing Best Practices\n\n### Testing Standards\n\n- Every test: atomic, self-contained, single functionality\n- Use parameterization for multiple examples of same functionality\n- Use separate tests for different functionality pieces\n- **ALWAYS** Put imports at the top of the file, not in the test body\n- **NEVER** add `@pytest.mark.asyncio` to tests - `asyncio_mode = \"auto\"` is set globally\n- **ALWAYS** run pytest after significant changes\n\n### Inline Snapshots\n\nFastMCP uses `inline-snapshot` for testing complex data structures. On first run with empty `snapshot()`, pytest will auto-populate the expected value when running `pytest --inline-snapshot=create`. To update snapshots after intentional changes, run `pytest --inline-snapshot=fix`. This is particularly useful for testing JSON schemas and API responses.\n\n### Always Use In-Memory Transport\n\nPass FastMCP servers directly to clients for testing:\n\n```python\nmcp = FastMCP(\"TestServer\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    return f\"Hello, {name}!\"\n\n# Direct connection - no network complexity\nasync with Client(mcp) as client:\n    result = await client.call_tool(\"greet\", {\"name\": \"World\"})\n```\n\nOnly use HTTP transport when explicitly testing network features:\n\n```python\n# Network testing only\nasync with Client(transport=StreamableHttpTransport(server_url)) as client:\n    result = await client.ping()\n```\n\n## Development Rules\n\n### Git & CI\n\n- Prek hooks are required (run automatically on commits)\n- Never amend commits to fix prek failures\n- Apply PR labels: bugs/breaking/enhancements/features\n- Improvements = enhancements (not features) unless specified\n- **NEVER** force-push on collaborative repos\n- **ALWAYS** run prek before PRs\n- **NEVER** create a release, comment on an issue, or open a PR unless specifically instructed to do so.\n\n### Commit Messages and Agent Attribution\n\n- **Agents NOT acting on behalf of @jlowin MUST identify themselves** (e.g., \"\ud83e\udd16 Generated with Claude Code\" in commits/PRs)\n- Keep commit messages brief - ideally just headlines, not detailed messages\n- Focus on what changed, not how or why\n- Always read issue comments for follow-up information (treat maintainers as authoritative)\n\n### PR Messages - Required Structure\n\n- 1-2 paragraphs: problem/tension + solution (PRs are documentation!)\n- Focused code example showing key capability\n- **Avoid:** bullet summaries, exhaustive change lists, verbose closes/fixes, marketing language\n- **Do:** Be opinionated about why change matters, show before/after scenarios\n- Minor fixes: keep body short and concise\n- No \"test plan\" sections or testing summaries\n\n### Code Standards\n\n- Python \u2265 3.10 with full type annotations\n- Follow existing patterns and maintain consistency\n- **Prioritize readable, understandable code** - clarity over cleverness\n- Avoid obfuscated or confusing patterns even if they're shorter\n- Each feature needs corresponding tests\n\n### Module Exports\n\n- **Be intentional about re-exports** - don't blindly re-export everything to parent namespaces\n- Core types that define a module's purpose should be exported (e.g., `Middleware` from `fastmcp.server.middleware`)\n- Specialized features can live in submodules (e.g., `fastmcp.server.middleware.dynamic`)\n- Only re-export to `fastmcp.*` for the most fundamental types (e.g., `FastMCP`, `Client`)\n- When in doubt, prefer users importing from the specific submodule over re-exporting\n\n### Documentation\n\n- Uses Mintlify framework\n- Files must be in docs.json to be included\n- Never modify `docs/python-sdk/**` (auto-generated)\n- **Core Principle:** A feature doesn't exist unless it is documented!\n\n### Documentation Guidelines\n\n- **Code Examples:** Explain before showing code, make blocks fully runnable (include imports)\n- **Structure:** Headers form navigation guide, logical H2/H3 hierarchy\n- **Content:** User-focused sections, motivate features (why) before mechanics (how)\n- **Style:** Prose over code comments for important information\n\n## Code Review Guidelines\n\n### Philosophy\n\nCode review is about maintaining a healthy codebase while helping contributors succeed. The burden of proof is on the PR to demonstrate it adds value in the intended way. Your job is to help it get there through actionable feedback.\n\n**Critical**: A perfectly written PR that adds unwanted functionality must still be rejected. The code must advance the codebase in the intended direction, not just be well-written. When rejecting, provide clear guidance on how to align with project goals.\n\nBe friendly and welcoming while maintaining high standards. Call out what works well - this reinforces good patterns. When code needs improvement, be specific about why and how to fix it. Remember that PRs serve as documentation for future developers.\n\n### Focus On\n\n- **Does this advance the codebase in the intended direction?** (Even perfect code for unwanted features should be rejected)\n- **API design and naming clarity** - Identify confusing patterns (e.g., parameter values that contradict defaults) or non-idiomatic code (mutable defaults, etc.). Contributed code will need to be maintained indefinitely, and by someone other than the author (unless the author is a maintainer).\n- **Suggest specific improvements**, not generic \"add more tests\" comments\n- **Think about API ergonomics and learning curve** from a user perspective\n\n### For Agent Reviewers\n\n- **Read the full context**: Always examine related files, tests, and documentation before reviewing\n- **Check against established patterns**: Look for consistency with existing codebase conventions\n- **Verify functionality claims**: Don't just read code - understand what it actually does\n- **Consider edge cases**: Think through error conditions and boundary scenarios\n\n### Avoid\n\n- Generic feedback without specifics\n- Hypothetical problems unlikely to occur\n- Nitpicking organizational choices without strong reason\n- Summarizing what the PR already describes\n- Star ratings or excessive emojis\n- Bikeshedding style preferences when functionality is correct\n- Requesting changes without suggesting solutions\n- Focusing on personal coding style over project conventions\n\n### Tone\n\n- Acknowledge good decisions (\"This API design is clean\")\n- Be direct but respectful\n- Explain impact (\"This will confuse users because...\")\n- Remember: Someone else maintains this code forever\n\n### Decision Framework\n\nBefore approving, ask yourself:\n\n1. Does this PR achieve its stated purpose?\n2. Is that purpose aligned with where the codebase should go?\n3. Would I be comfortable maintaining this code?\n4. Have I actually understood what it does, not just what it claims?\n5. Does this change introduce technical debt?\n\nIf something needs work, your review should help it get there through specific, actionable feedback. If it's solving the wrong problem, say so clearly.\n\n### Review Comment Examples\n\n**Good Review Comments:**\n\n\u274c \"Add more tests\"  \n\u2705 \"The `handle_timeout` method needs tests for the edge case where timeout=0\"\n\n\u274c \"This API is confusing\"  \n\u2705 \"The parameter name `data` is ambiguous - consider `message_content` to match the MCP specification\"\n\n\u274c \"This could be better\"  \n\u2705 \"This approach works but creates a circular dependency. Consider moving the validation to `utils/validators.py`\"\n\n### Review Checklist\n\nBefore approving, verify:\n\n- [ ] All required development workflow steps completed (uv sync, prek, pytest)\n- [ ] Changes align with repository patterns and conventions\n- [ ] API changes are documented and backwards-compatible where possible\n- [ ] Error handling follows project patterns (specific exception types)\n- [ ] Tests cover new functionality and edge cases\n\n## Key Tools & Commands\n\n### Environment Setup\n\n```bash\ngit clone <repo>\ncd fastmcp\nuv sync                    # Installs all deps including dev tools\n```\n\n### Validation Commands (Run Frequently)\n\n- **Linting**: `uv run ruff check` (or with `--fix`)\n- **Type Checking**: `uv run ty check`\n- **All Checks**: `uv run prek run --all-files`\n\n### Testing\n\n- **Standard**: `uv run pytest -n auto`\n- **Integration**: `uv run pytest -n auto -m \"integration\"`\n- **Excluding markers**: `uv run pytest -n auto -m \"not integration and not client_process\"`\n\n### CLI Usage\n\n- **Run server**: `uv run fastmcp run server.py`\n- **Inspect server**: `uv run fastmcp inspect server.py`\n\n## Critical Patterns\n\n### Error Handling\n\n- Never use bare `except` - be specific with exception types\n\n### Build Issues (Common Solutions)\n\n1. **Dependencies**: Always `uv sync` first\n2. **Prek fails**: Run `uv run prek run --all-files` to see failures\n3. **Type errors**: Use `uv run ty check` directly, check `pyproject.toml` config\n4. **Test timeouts**: Default 5s - optimize or mark as integration tests\n"}, {"filename": "CLAUDE.md", "content": "AGENTS.md"}, {"filename": "CODE_OF_CONDUCT.md", "content": "# Contributor Covenant Code of Conduct\n\n## Our Pledge\n\nWe as members, contributors, and leaders pledge to make participation in our\ncommunity a harassment-free experience for everyone, regardless of age, body\nsize, visible or invisible disability, ethnicity, sex characteristics, gender\nidentity and expression, level of experience, education, socio-economic status,\nnationality, personal appearance, race, religion, or sexual identity\nand orientation.\n\nWe pledge to act and interact in ways that contribute to an open, welcoming,\ndiverse, inclusive, and healthy community.\n\n## Our Standards\n\nExamples of behavior that contributes to a positive environment for our\ncommunity include:\n\n* Demonstrating empathy and kindness toward other people\n* Being respectful of differing opinions, viewpoints, and experiences\n* Giving and gracefully accepting constructive feedback\n* Accepting responsibility and apologizing to those affected by our mistakes,\n  and learning from the experience\n* Focusing on what is best not just for us as individuals, but for the\n  overall community\n\nExamples of unacceptable behavior include:\n\n* The use of sexualized language or imagery, and sexual attention or\n  advances of any kind\n* Trolling, insulting or derogatory comments, and personal or political attacks\n* Public or private harassment\n* Publishing others' private information, such as a physical or email\n  address, without their explicit permission\n* Other conduct which could reasonably be considered inappropriate in a\n  professional setting\n\n## Enforcement Responsibilities\n\nCommunity leaders are responsible for clarifying and enforcing our standards of\nacceptable behavior and will take appropriate and fair corrective action in\nresponse to any behavior that they deem inappropriate, threatening, offensive,\nor harmful.\n\nCommunity leaders have the right and responsibility to remove, edit, or reject\ncomments, commits, code, wiki edits, issues, and other contributions that are\nnot aligned to this Code of Conduct, and will communicate reasons for moderation\ndecisions when appropriate.\n\n## Scope\n\nThis Code of Conduct applies within all community spaces, and also applies when\nan individual is officially representing the community in public spaces.\nExamples of representing our community include using an official e-mail address,\nposting via an official social media account, or acting as an appointed\nrepresentative at an online or offline event.\n\n## Enforcement\n\nInstances of abusive, harassing, or otherwise unacceptable behavior may be\nreported to the community leaders responsible for enforcement at\nchris@prefect.io.\nAll complaints will be reviewed and investigated promptly and fairly.\n\nAll community leaders are obligated to respect the privacy and security of the\nreporter of any incident.\n\n## Enforcement Guidelines\n\nCommunity leaders will follow these Community Impact Guidelines in determining\nthe consequences for any action they deem in violation of this Code of Conduct:\n\n### 1. Correction\n\n**Community Impact**: Use of inappropriate language or other behavior deemed\nunprofessional or unwelcome in the community.\n\n**Consequence**: A private, written warning from community leaders, providing\nclarity around the nature of the violation and an explanation of why the\nbehavior was inappropriate. A public apology may be requested.\n\n### 2. Warning\n\n**Community Impact**: A violation through a single incident or series\nof actions.\n\n**Consequence**: A warning with consequences for continued behavior. No\ninteraction with the people involved, including unsolicited interaction with\nthose enforcing the Code of Conduct, for a specified period of time. This\nincludes avoiding interactions in community spaces as well as external channels\nlike social media. Violating these terms may lead to a temporary or\npermanent ban.\n\n### 3. Temporary Ban\n\n**Community Impact**: A serious violation of community standards, including\nsustained inappropriate behavior.\n\n**Consequence**: A temporary ban from any sort of interaction or public\ncommunication with the community for a specified period of time. No public or\nprivate interaction with the people involved, including unsolicited interaction\nwith those enforcing the Code of Conduct, is allowed during this period.\nViolating these terms may lead to a permanent ban.\n\n### 4. Permanent Ban\n\n**Community Impact**: Demonstrating a pattern of violation of community\nstandards, including sustained inappropriate behavior,  harassment of an\nindividual, or aggression toward or disparagement of classes of individuals.\n\n**Consequence**: A permanent ban from any sort of public interaction within\nthe community.\n\n## Attribution\n\nThis Code of Conduct is adapted from the [Contributor Covenant][homepage],\nversion 2.0, available at\nhttps://www.contributor-covenant.org/version/2/0/code_of_conduct.html.\n\nCommunity Impact Guidelines were inspired by [Mozilla's code of conduct\nenforcement ladder](https://github.com/mozilla/diversity).\n\n[homepage]: https://www.contributor-covenant.org\n\nFor answers to common questions about this code of conduct, see the FAQ at\nhttps://www.contributor-covenant.org/faq. Translations are available at\nhttps://www.contributor-covenant.org/translations.\n"}, {"filename": "README.md", "content": "<div align=\"center\">\n\n<!-- omit in toc -->\n\n<picture>\n  <source width=\"550\" media=\"(prefers-color-scheme: dark)\" srcset=\"docs/assets/brand/wordmark-watercolor-waves-dark.png\">\n  <source width=\"550\" media=\"(prefers-color-scheme: light)\" srcset=\"docs/assets/brand/wordmark-watercolor-waves.png\">\n  <img width=\"550\" alt=\"FastMCP Logo\" src=\"docs/assets/brand/wordmark-watercolor-waves.png\">\n</picture>\n\n# FastMCP v2 \ud83d\ude80\n\n<strong>The fast, Pythonic way to build MCP servers and clients.</strong>\n\n*Made with \u2615\ufe0f by [Prefect](https://www.prefect.io/)*\n\n[![Docs](https://img.shields.io/badge/docs-gofastmcp.com-blue)](https://gofastmcp.com)\n[![Discord](https://img.shields.io/badge/community-discord-5865F2?logo=discord&logoColor=white)](https://discord.gg/uu8dJCgttd)\n[![PyPI - Version](https://img.shields.io/pypi/v/fastmcp.svg)](https://pypi.org/project/fastmcp)\n[![Tests](https://github.com/jlowin/fastmcp/actions/workflows/run-tests.yml/badge.svg)](https://github.com/jlowin/fastmcp/actions/workflows/run-tests.yml)\n[![License](https://img.shields.io/github/license/jlowin/fastmcp.svg)](https://github.com/jlowin/fastmcp/blob/main/LICENSE)\n\n<a href=\"https://trendshift.io/repositories/13266\" target=\"_blank\"><img src=\"https://trendshift.io/api/badge/repositories/13266\" alt=\"jlowin%2Ffastmcp | Trendshift\" style=\"width: 250px; height: 55px;\" width=\"250\" height=\"55\"/></a>\n</div>\n\n> [!Note]\n>\n> #### FastMCP 2.0: The Standard Framework\n>\n> FastMCP pioneered Python MCP development, and FastMCP 1.0 was incorporated into the [official MCP SDK](https://github.com/modelcontextprotocol/python-sdk) in 2024.\n>\n> **This is FastMCP 2.0** \u2014 the actively maintained, production-ready framework that extends far beyond basic protocol implementation. While the SDK provides core functionality, FastMCP 2.0 delivers everything needed for production: advanced MCP patterns (server composition, proxying, OpenAPI/FastAPI generation, tool transformation), enterprise auth (Google, GitHub, WorkOS, Azure, Auth0, and more), deployment tools, testing utilities, and comprehensive client libraries.\n>\n> **For production MCP applications, install FastMCP:** `pip install fastmcp`\n\n> [!Important]\n> FastMCP 3.0 is in development and may include some breaking changes. To avoid unexpected issues, pin your dependency to v2: `fastmcp<3`\n\n---\n\n**FastMCP is the standard framework for building MCP applications**, providing the fastest path from idea to production.\n\nThe [Model Context Protocol (MCP)](https://modelcontextprotocol.io) is a standardized way to provide context and tools to LLMs. FastMCP makes building production-ready MCP servers simple, with enterprise auth, deployment tools, and a complete ecosystem built in.\n\n```python\n# server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"Demo \ud83d\ude80\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Add two numbers\"\"\"\n    return a + b\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\nRun the server locally:\n\n```bash\nfastmcp run server.py\n```\n\n### \ud83d\udcda Documentation\n\nFastMCP's complete documentation is available at **[gofastmcp.com](https://gofastmcp.com)**, including detailed guides, API references, and advanced patterns. This readme provides only a high-level overview.\n\nDocumentation is also available in [llms.txt format](https://llmstxt.org/), which is a simple markdown standard that LLMs can consume easily.\n\nThere are two ways to access the LLM-friendly documentation:\n\n- [`llms.txt`](https://gofastmcp.com/llms.txt) is essentially a sitemap, listing all the pages in the documentation.\n- [`llms-full.txt`](https://gofastmcp.com/llms-full.txt) contains the entire documentation. Note this may exceed the context window of your LLM.\n\n**Community:** Join our [Discord server](https://discord.gg/uu8dJCgttd) to connect with other FastMCP developers and share what you're building.\n\n---\n\n<!-- omit in toc -->\n## Table of Contents\n\n- [FastMCP v2 \ud83d\ude80](#fastmcp-v2-)\n    - [\ud83d\udcda Documentation](#-documentation)\n  - [What is MCP?](#what-is-mcp)\n  - [Why FastMCP?](#why-fastmcp)\n  - [Installation](#installation)\n  - [Core Concepts](#core-concepts)\n    - [The `FastMCP` Server](#the-fastmcp-server)\n    - [Tools](#tools)\n    - [Resources \\& Templates](#resources--templates)\n    - [Prompts](#prompts)\n    - [Context](#context)\n    - [MCP Clients](#mcp-clients)\n  - [Authentication](#authentication)\n    - [Enterprise Authentication, Zero Configuration](#enterprise-authentication-zero-configuration)\n  - [Deployment](#deployment)\n    - [From Development to Production](#from-development-to-production)\n  - [Advanced Features](#advanced-features)\n    - [Proxy Servers](#proxy-servers)\n    - [Composing MCP Servers](#composing-mcp-servers)\n    - [OpenAPI \\& FastAPI Generation](#openapi--fastapi-generation)\n  - [Running Your Server](#running-your-server)\n  - [Contributing](#contributing)\n    - [Prerequisites](#prerequisites)\n    - [Setup](#setup)\n    - [Unit Tests](#unit-tests)\n    - [Static Checks](#static-checks)\n    - [Pull Requests](#pull-requests)\n\n---\n\n## What is MCP?\n\nThe [Model Context Protocol (MCP)](https://modelcontextprotocol.io) lets you build servers that expose data and functionality to LLM applications in a secure, standardized way. It is often described as \"the USB-C port for AI\", providing a uniform way to connect LLMs to resources they can use. It may be easier to think of it as an API, but specifically designed for LLM interactions. MCP servers can:\n\n- Expose data through **Resources** (think of these sort of like GET endpoints; they are used to load information into the LLM's context)\n- Provide functionality through **Tools** (sort of like POST endpoints; they are used to execute code or otherwise produce a side effect)\n- Define interaction patterns through **Prompts** (reusable templates for LLM interactions)\n- And more!\n\nFastMCP provides a high-level, Pythonic interface for building, managing, and interacting with these servers.\n\n## Why FastMCP?\n\nFastMCP handles all the complex protocol details so you can focus on building. In most cases, decorating a Python function is all you need \u2014 FastMCP handles the rest.\n\n\ud83d\ude80 **Fast:** High-level interface means less code and faster development\n\n\ud83c\udf40 **Simple:** Build MCP servers with minimal boilerplate\n\n\ud83d\udc0d **Pythonic:** Feels natural to Python developers\n\n\ud83d\udd0d **Complete:** Everything for production \u2014 enterprise auth (Google, GitHub, Azure, Auth0, WorkOS), deployment tools, testing frameworks, client libraries, and more\n\nFastMCP provides the shortest path from idea to production. Deploy locally, to the cloud with [FastMCP Cloud](https://fastmcp.cloud), or to your own infrastructure.\n\n## Installation\n\nWe recommend installing FastMCP with [uv](https://docs.astral.sh/uv/):\n\n```bash\nuv pip install fastmcp\n```\n\nFor full installation instructions, including verification, upgrading from the official MCPSDK, and developer setup, see the [**Installation Guide**](https://gofastmcp.com/getting-started/installation).\n\n**Dependency Licensing:** FastMCP depends on Cyclopts for CLI functionality. Cyclopts v4 includes docutils as a transitive dependency, which has complex licensing that may trigger compliance reviews in some organizations. If this is a concern, you can install Cyclopts v5 alpha (`pip install \"cyclopts>=5.0.0a1\"`) which removes this dependency, or wait for the stable v5 release. See [this issue](https://github.com/BrianPugh/cyclopts/issues/672) for details.\n\n## Core Concepts\n\nThese are the building blocks for creating MCP servers and clients with FastMCP.\n\n### The `FastMCP` Server\n\nThe central object representing your MCP application. It holds your tools, resources, and prompts, manages connections, and can be configured with settings like authentication.\n\n```python\nfrom fastmcp import FastMCP\n\n# Create a server instance\nmcp = FastMCP(name=\"MyAssistantServer\")\n```\n\nLearn more in the [**FastMCP Server Documentation**](https://gofastmcp.com/servers/server).\n\n### Tools\n\nTools allow LLMs to perform actions by executing your Python functions (sync or async). Ideal for computations, API calls, or side effects (like `POST`/`PUT`). FastMCP handles schema generation from type hints and docstrings. Tools can return various types, including text, JSON-serializable objects, and even images or audio aided by the FastMCP media helper classes.\n\n```python\n@mcp.tool\ndef multiply(a: float, b: float) -> float:\n    \"\"\"Multiplies two numbers.\"\"\"\n    return a * b\n```\n\nLearn more in the [**Tools Documentation**](https://gofastmcp.com/servers/tools).\n\n### Resources & Templates\n\nResources expose read-only data sources (like `GET` requests). Use `@mcp.resource(\"your://uri\")`. Use `{placeholders}` in the URI to create dynamic templates that accept parameters, allowing clients to request specific data subsets.\n\n```python\n# Static resource\n@mcp.resource(\"config://version\")\ndef get_version(): \n    return \"2.0.1\"\n\n# Dynamic resource template\n@mcp.resource(\"users://{user_id}/profile\")\ndef get_profile(user_id: int):\n    # Fetch profile for user_id...\n    return {\"name\": f\"User {user_id}\", \"status\": \"active\"}\n```\n\nLearn more in the [**Resources & Templates Documentation**](https://gofastmcp.com/servers/resources).\n\n### Prompts\n\nPrompts define reusable message templates to guide LLM interactions. Decorate functions with `@mcp.prompt`. Return strings or `Message` objects.\n\n```python\n@mcp.prompt\ndef summarize_request(text: str) -> str:\n    \"\"\"Generate a prompt asking for a summary.\"\"\"\n    return f\"Please summarize the following text:\\n\\n{text}\"\n```\n\nLearn more in the [**Prompts Documentation**](https://gofastmcp.com/servers/prompts).\n\n### Context\n\nAccess MCP session capabilities within your tools, resources, or prompts by adding a `ctx: Context` parameter. Context provides methods for:\n\n- **Logging:** Log messages to MCP clients with `ctx.info()`, `ctx.error()`, etc.\n- **LLM Sampling:** Use `ctx.sample()` to request completions from the client's LLM.\n- **Resource Access:** Use `ctx.read_resource()` to access resources on the server\n- **Progress Reporting:** Use `ctx.report_progress()` to report progress to the client.\n- and more...\n\nTo access the context, add a parameter annotated as `Context` to any mcp-decorated function. FastMCP will automatically inject the correct context object when the function is called.\n\n```python\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(\"My MCP Server\")\n\n@mcp.tool\nasync def process_data(uri: str, ctx: Context):\n    # Log a message to the client\n    await ctx.info(f\"Processing {uri}...\")\n\n    # Read a resource from the server\n    data = await ctx.read_resource(uri)\n\n    # Ask client LLM to summarize the data\n    summary = await ctx.sample(f\"Summarize: {data.content[:500]}\")\n\n    # Return the summary\n    return summary.text\n```\n\nLearn more in the [**Context Documentation**](https://gofastmcp.com/servers/context).\n\n### MCP Clients\n\nInteract with *any* MCP server programmatically using the `fastmcp.Client`. It supports various transports (Stdio, SSE, In-Memory) and often auto-detects the correct one. The client can also handle advanced patterns like server-initiated **LLM sampling requests** if you provide an appropriate handler.\n\nCritically, the client allows for efficient **in-memory testing** of your servers by connecting directly to a `FastMCP` server instance via the `FastMCPTransport`, eliminating the need for process management or network calls during tests.\n\n```python\nfrom fastmcp import Client\n\nasync def main():\n    # Connect via stdio to a local script\n    async with Client(\"my_server.py\") as client:\n        tools = await client.list_tools()\n        print(f\"Available tools: {tools}\")\n        result = await client.call_tool(\"add\", {\"a\": 5, \"b\": 3})\n        print(f\"Result: {result.content[0].text}\")\n\n    # Connect via SSE\n    async with Client(\"http://localhost:8000/sse\") as client:\n        # ... use the client\n        pass\n```\n\nTo use clients to test servers, use the following pattern:\n\n```python\nfrom fastmcp import FastMCP, Client\n\nmcp = FastMCP(\"My MCP Server\")\n\nasync def main():\n    # Connect via in-memory transport\n    async with Client(mcp) as client:\n        # ... use the client\n```\n\nFastMCP also supports connecting to multiple servers through a single unified client using the standard MCP configuration format:\n\n```python\nfrom fastmcp import Client\n\n# Standard MCP configuration with multiple servers\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\"url\": \"https://weather-api.example.com/mcp\"},\n        \"assistant\": {\"command\": \"python\", \"args\": [\"./assistant_server.py\"]}\n    }\n}\n\n# Create a client that connects to all servers\nclient = Client(config)\n\nasync def main():\n    async with client:\n        # Access tools and resources with server prefixes\n        forecast = await client.call_tool(\"weather_get_forecast\", {\"city\": \"London\"})\n        answer = await client.call_tool(\"assistant_answer_question\", {\"query\": \"What is MCP?\"})\n```\n\nLearn more in the [**Client Documentation**](https://gofastmcp.com/clients/client) and [**Transports Documentation**](https://gofastmcp.com/clients/transports).\n\n## Authentication\n\n### Enterprise Authentication, Zero Configuration\n\nFastMCP provides comprehensive authentication support that sets it apart from basic MCP implementations. Secure your servers and authenticate your clients with the same enterprise-grade providers used by major corporations.\n\n**Built-in OAuth Providers:**\n\n- **Google**\n- **GitHub**\n- **Microsoft Azure**\n- **Auth0**\n- **WorkOS**\n- **Descope**\n- **Discord**\n- **JWT/Custom**\n- **API Keys**\n\nProtecting a server takes just two lines:\n\n```python\nfrom fastmcp.server.auth.providers.google import GoogleProvider\n\nauth = GoogleProvider(client_id=\"...\", client_secret=\"...\", base_url=\"https://myserver.com\")\nmcp = FastMCP(\"Protected Server\", auth=auth)\n```\n\nConnecting to protected servers is even simpler:\n\n```python\nasync with Client(\"https://protected-server.com/mcp\", auth=\"oauth\") as client:\n    # Automatic browser-based OAuth flow\n    result = await client.call_tool(\"protected_tool\")\n```\n\n**Why FastMCP Auth Matters:**\n\n- **Production-Ready:** Persistent storage, token refresh, comprehensive error handling\n- **Zero-Config OAuth:** Just pass `auth=\"oauth\"` for automatic setup\n- **Enterprise Integration:** WorkOS SSO, Azure Active Directory, Auth0 tenants\n- **Developer Experience:** Automatic browser launch, local callback server, environment variable support\n- **Advanced Architecture:** Full OIDC support, Dynamic Client Registration (DCR), and unique OAuth proxy pattern that enables DCR with any provider\n\n*Authentication this comprehensive is unique to FastMCP 2.0.*\n\nLearn more in the **Authentication Documentation** for [servers](https://gofastmcp.com/servers/auth) and [clients](https://gofastmcp.com/clients/auth).\n\n## Deployment\n\n### From Development to Production\n\nFastMCP supports every deployment scenario from local development to global scale:\n\n**Development:** Run locally with a single command\n\n```bash\nfastmcp run server.py\n```\n\n**Production:** Deploy to [**FastMCP Cloud**](https://fastmcp.cloud) \u2014 Remote MCP that just works\n\n- Instant HTTPS endpoints\n- Built-in authentication\n- Zero configuration\n- Free for personal servers\n\n**Self-Hosted:** Use HTTP or SSE transports for your own infrastructure\n\n```python\nmcp.run(transport=\"http\", host=\"0.0.0.0\", port=8000)\n```\n\nLearn more in the [**Deployment Documentation**](https://gofastmcp.com/deployment).\n\n## Advanced Features\n\nFastMCP introduces powerful ways to structure and compose your MCP applications.\n\n### Proxy Servers\n\nCreate a FastMCP server that acts as an intermediary for another local or remote MCP server using `FastMCP.as_proxy()`. This is especially useful for bridging transports (e.g., remote SSE to local Stdio) or adding a layer of logic to a server you don't control.\n\nLearn more in the [**Proxying Documentation**](https://gofastmcp.com/patterns/proxy).\n\n### Composing MCP Servers\n\nBuild modular applications by mounting multiple `FastMCP` instances onto a parent server using `mcp.mount()` (live link) or `mcp.import_server()` (static copy).\n\nLearn more in the [**Composition Documentation**](https://gofastmcp.com/patterns/composition).\n\n### OpenAPI & FastAPI Generation\n\nAutomatically generate FastMCP servers from existing OpenAPI specifications (`FastMCP.from_openapi()`) or FastAPI applications (`FastMCP.from_fastapi()`), instantly bringing your web APIs to the MCP ecosystem.\n\nLearn more: [**OpenAPI Integration**](https://gofastmcp.com/integrations/openapi) | [**FastAPI Integration**](https://gofastmcp.com/integrations/fastapi).\n\n## Running Your Server\n\nThe main way to run a FastMCP server is by calling the `run()` method on your server instance:\n\n```python\n# server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"Demo \ud83d\ude80\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    mcp.run()  # Default: uses STDIO transport\n```\n\nFastMCP supports three transport protocols:\n\n**STDIO (Default)**: Best for local tools and command-line scripts.\n\n```python\nmcp.run(transport=\"stdio\")  # Default, so transport argument is optional\n```\n\n**Streamable HTTP**: Recommended for web deployments.\n\n```python\nmcp.run(transport=\"http\", host=\"127.0.0.1\", port=8000, path=\"/mcp\")\n```\n\n**SSE**: For compatibility with existing SSE clients.\n\n```python\nmcp.run(transport=\"sse\", host=\"127.0.0.1\", port=8000)\n```\n\nSee the [**Running Server Documentation**](https://gofastmcp.com/deployment/running-server) for more details.\n\n## Contributing\n\nContributions are the core of open source! We welcome improvements and features.\n\n### Prerequisites\n\n- Python 3.10+\n- [uv](https://docs.astral.sh/uv/) (Recommended for environment management)\n\n### Setup\n\n1. Clone the repository:\n\n   ```bash\n   git clone https://github.com/jlowin/fastmcp.git \n   cd fastmcp\n   ```\n\n2. Create and sync the environment:\n\n   ```bash\n   uv sync\n   ```\n\n   This installs all dependencies, including dev tools.\n\n3. Activate the virtual environment (e.g., `source .venv/bin/activate` or via your IDE).\n\n### Unit Tests\n\nFastMCP has a comprehensive unit test suite. All PRs must introduce or update tests as appropriate and pass the full suite.\n\nRun tests using pytest:\n\n```bash\npytest\n```\n\nor if you want an overview of the code coverage\n\n```bash\nuv run pytest --cov=src --cov=examples --cov-report=html\n```\n\n### Static Checks\n\nFastMCP uses `prek` for code formatting, linting, and type-checking. All PRs must pass these checks (they run automatically in CI).\n\nInstall the hooks locally:\n\n```bash\nuv run prek install\n```\n\nThe hooks will now run automatically on `git commit`. You can also run them manually at any time:\n\n```bash\nprek run --all-files\n# or via uv\nuv run prek run --all-files\n```\n\n### Pull Requests\n\n1. Fork the repository on GitHub.\n2. Create a feature branch from `main`.\n3. Make your changes, including tests and documentation updates.\n4. Ensure tests and prek hooks pass.\n5. Commit your changes and push to your fork.\n6. Open a pull request against the `main` branch of `jlowin/fastmcp`.\n\nPlease open an issue or discussion for questions or suggestions before starting significant work!\n"}, {"filename": "SECURITY.md", "content": "# Security Policy\n\n## Supported Versions\n\nFastMCP v2.x receives security updates. Earlier versions are no longer supported.\n\n| Version | Supported          |\n| ------- | ------------------ |\n| 2.x     | :white_check_mark: |\n| < 2.0   | :x:                |\n\n## Reporting a Vulnerability\n\nPlease report security vulnerabilities privately using [GitHub's security advisory feature](https://github.com/jlowin/fastmcp/security/advisories/new).\n\nDo not open public issues for security concerns.\n"}, {"filename": "docs/changelog.mdx", "content": "---\ntitle: \"Changelog\"\nicon: \"list-check\"\nrss: true\n---\n\n<Update label=\"v2.13.0\" description=\"2025-10-25\">\n\n**[v2.13.0: Cache Me If You Can](https://github.com/jlowin/fastmcp/releases/tag/v2.13.0)**\n\nFastMCP 2.13 \"Cache Me If You Can\" represents a fundamental maturation of the framework. After months of community feedback on authentication and state management, this release delivers the infrastructure FastMCP needs to handle production workloads: persistent storage, response caching, and pragmatic OAuth improvements that reflect real-world deployment challenges.\n\n\ud83d\udcbe **Pluggable storage backends** bring persistent state to FastMCP servers. Built on [py-key-value-aio](https://github.com/strawgate/py-key-value), a new library from FastMCP maintainer Bill Easton ([@strawgate](https://github.com/strawgate)), the storage layer provides encrypted disk storage by default, platform-aware token management, and a simple key-value interface for application state. We're excited to bring this elegantly designed library into the FastMCP ecosystem - it's both powerful and remarkably easy to use, including wrappers to add encryption, TTLs, caching, and more to backends ranging from Elasticsearch, Redis, DynamoDB, filesystem, in-memory, and more! OAuth providers now automatically persist tokens across restarts, and developers can store arbitrary state without reaching for external databases. This foundation enables long-running sessions, cached credentials, and stateful applications built on MCP.\n\n\ud83d\udd10 **OAuth maturity** brings months of production learnings into the framework. The new consent screen prevents confused deputy and authorization bypass attacks discovered in earlier versions while providing a clean UX with customizable branding. The OAuth proxy now issues its own tokens with automatic key derivation from client secrets, and RFC 7662 token introspection support enables enterprise auth flows. Path prefix mounting enables OAuth-protected servers to integrate into existing web applications under custom paths like `/api`, and MCP 1.17+ compliance with RFC 9728 ensures protocol compatibility. Combined with improved error handling and platform-aware token storage, OAuth is now production-ready and security-hardened for serious applications.\n\nFastMCP now supports out-of-the-box authentication with:\n- **[WorkOS](https://gofastmcp.com/integrations/workos)** and **[AuthKit](https://gofastmcp.com/integrations/authkit)**\n- **[GitHub](https://gofastmcp.com/integrations/github)**\n- **[Google](https://gofastmcp.com/integrations/google)**\n- **[Azure](https://gofastmcp.com/integrations/azure)** (Entra ID)\n- **[AWS Cognito](https://gofastmcp.com/integrations/aws-cognito)**\n- **[Auth0](https://gofastmcp.com/integrations/auth0)**\n- **[Descope](https://gofastmcp.com/integrations/descope)**\n- **[Scalekit](https://gofastmcp.com/integrations/scalekit)**\n- **[JWTs](https://gofastmcp.com/servers/auth/token-verification#jwt-token-verification)**\n- **[RFC 7662 token introspection](https://gofastmcp.com/servers/auth/token-verification#token-introspection-protocol)**\n\n\u26a1 **Response Caching Middleware** dramatically improves performance for expensive operations. Cache tool and resource responses with configurable TTLs, reducing redundant API calls and speeding up repeated queries.\n\n\ud83d\udd04 **Server lifespans** provide proper initialization and cleanup hooks that run once per server instance instead of per client session. This fixes a long-standing source of confusion in the MCP SDK and enables proper resource management for database connections, background tasks, and other server-level state. Note: this is a breaking behavioral change if you were using the `lifespan` parameter.\n\n\u2728 **Developer experience improvements** include Pydantic input validation for better type safety, icon support for richer UX, RFC 6570 query parameters for resource templates, improved Context API methods (list_resources, list_prompts, get_prompt), and async file/directory resources.\n\nThis release includes contributions from **20** new contributors and represents the largest feature set in a while. Thank you to everyone who tested preview builds and filed issues - your feedback shaped these improvements!\n\n**Full Changelog**: [v2.12.5...v2.13.0](https://github.com/jlowin/fastmcp/compare/v2.12.5...v2.13.0)\n\n</Update>\n\n<Update label=\"v2.12.5\" description=\"2025-10-17\">\n\n**[v2.12.5: Safety Pin](https://github.com/jlowin/fastmcp/releases/tag/v2.12.5)**\n\nFastMCP 2.12.5 is a point release that pins the MCP SDK version below 1.17, which introduced a change affecting FastMCP users with auth providers mounted as part of a larger application. This ensures the `.well-known` payload appears in the expected location when using FastMCP authentication providers with composite applications.\n\n## What's Changed\n\n### Fixes \ud83d\udc1e\n* Pin MCP SDK version below 1.17 by [@jlowin](https://github.com/jlowin) in [a1b2c3d](https://github.com/jlowin/fastmcp/commit/dab2b316ddc3883b7896a86da21cacb68da01e5c)\n\n**Full Changelog**: [v2.12.4...v2.12.5](https://github.com/jlowin/fastmcp/compare/v2.12.4...v2.12.5)\n\n</Update>\n\n<Update label=\"v2.12.4\" description=\"2025-09-26\">\n\n**[v2.12.4: OIDC What You Did There](https://github.com/jlowin/fastmcp/releases/tag/v2.12.4)**\n\nFastMCP 2.12.4 adds comprehensive OIDC support and expands authentication options with AWS Cognito and Descope providers. The release also includes improvements to logging middleware, URL handling for nested resources, persistent OAuth client registration storage, and various fixes to the experimental OpenAPI parser.\n\n## What's Changed\n### New Features \ud83c\udf89\n* feat: Add support for OIDC configuration by [@ruhulio](https://github.com/ruhulio) in [#1817](https://github.com/jlowin/fastmcp/pull/1817)\n### Enhancements \ud83d\udd27\n* feat: Move the Starlette context middleware to the front by [@akkuman](https://github.com/akkuman) in [#1812](https://github.com/jlowin/fastmcp/pull/1812)\n* Refactor Logging and Structured Logging Middleware by [@strawgate](https://github.com/strawgate) in [#1805](https://github.com/jlowin/fastmcp/pull/1805)\n* Update pull_request_template.md by [@jlowin](https://github.com/jlowin) in [#1824](https://github.com/jlowin/fastmcp/pull/1824)\n* chore: Set redirect_path default in function by [@ruhulio](https://github.com/ruhulio) in [#1833](https://github.com/jlowin/fastmcp/pull/1833)\n* feat: Set instructions in code by [@attiks](https://github.com/attiks) in [#1838](https://github.com/jlowin/fastmcp/pull/1838)\n* Automatically Create inline Snapshots by [@strawgate](https://github.com/strawgate) in [#1779](https://github.com/jlowin/fastmcp/pull/1779)\n* chore: Cleanup Auth0 redirect_path initialization by [@ruhulio](https://github.com/ruhulio) in [#1842](https://github.com/jlowin/fastmcp/pull/1842)\n* feat: Add support for Descope Authentication by [@anvibanga](https://github.com/anvibanga) in [#1853](https://github.com/jlowin/fastmcp/pull/1853)\n* Update descope version badges by [@jlowin](https://github.com/jlowin) in [#1870](https://github.com/jlowin/fastmcp/pull/1870)\n* Update welcome images by [@jlowin](https://github.com/jlowin) in [#1884](https://github.com/jlowin/fastmcp/pull/1884)\n* Fix rounded edges of image by [@jlowin](https://github.com/jlowin) in [#1886](https://github.com/jlowin/fastmcp/pull/1886)\n* optimize test suite by [@zzstoatzz](https://github.com/zzstoatzz) in [#1893](https://github.com/jlowin/fastmcp/pull/1893)\n* Enhancement: client completions support context_arguments by [@isijoe](https://github.com/isijoe) in [#1906](https://github.com/jlowin/fastmcp/pull/1906)\n* Update Descope icon by [@anvibanga](https://github.com/anvibanga) in [#1912](https://github.com/jlowin/fastmcp/pull/1912)\n* Add AWS Cognito OAuth Provider for Enterprise Authentication by [@stephaneberle9](https://github.com/stephaneberle9) in [#1873](https://github.com/jlowin/fastmcp/pull/1873)\n* Fix typos discovered by codespell by [@cclauss](https://github.com/cclauss) in [#1922](https://github.com/jlowin/fastmcp/pull/1922)\n* Use lowercase namespace for fastmcp logger by [@jlowin](https://github.com/jlowin) in [#1791](https://github.com/jlowin/fastmcp/pull/1791)\n### Fixes \ud83d\udc1e\n* Update quickstart.mdx by [@radi-dev](https://github.com/radi-dev) in [#1821](https://github.com/jlowin/fastmcp/pull/1821)\n* Remove extraneous union import by [@jlowin](https://github.com/jlowin) in [#1823](https://github.com/jlowin/fastmcp/pull/1823)\n* Delay import of Provider classes until FastMCP Server Creation by [@strawgate](https://github.com/strawgate) in [#1820](https://github.com/jlowin/fastmcp/pull/1820)\n* fix: correct documentation link in deprecation warning by [@strawgate](https://github.com/strawgate) in [#1828](https://github.com/jlowin/fastmcp/pull/1828)\n* fix: Increase default 3s timeout on Pytest by [@dacamposol](https://github.com/dacamposol) in [#1866](https://github.com/jlowin/fastmcp/pull/1866)\n* fix: Improve URL handling in OIDCConfiguration by [@ruhulio](https://github.com/ruhulio) in [#1850](https://github.com/jlowin/fastmcp/pull/1850)\n* fix: correct typing for on_read_resource middleware method by [@strawgate](https://github.com/strawgate) in [#1858](https://github.com/jlowin/fastmcp/pull/1858)\n* feat(experimental/openapi): replace $ref in additionalProperties; add tests by [@jlowin](https://github.com/jlowin) in [#1735](https://github.com/jlowin/fastmcp/pull/1735)\n* Honor client supplied scopes during registration by [@dmikusa](https://github.com/dmikusa) in [#1860](https://github.com/jlowin/fastmcp/pull/1860)\n* Fix: FastAPI list parameter parsing in experimental OpenAPI parser by [@jlowin](https://github.com/jlowin) in [#1834](https://github.com/jlowin/fastmcp/pull/1834)\n* Add log level support for stdio and HTTP transports by [@jlowin](https://github.com/jlowin) in [#1840](https://github.com/jlowin/fastmcp/pull/1840)\n* Fix OAuth pre-flight check to accept HTTP 200 responses by [@jlowin](https://github.com/jlowin) in [#1874](https://github.com/jlowin/fastmcp/pull/1874)\n* Fix: Preserve OpenAPI parameter descriptions in experimental parser by [@shlomo666](https://github.com/shlomo666) in [#1877](https://github.com/jlowin/fastmcp/pull/1877)\n* Add persistent storage for OAuth client registrations by [@jlowin](https://github.com/jlowin) in [#1879](https://github.com/jlowin/fastmcp/pull/1879)\n* docs: update release dates based on github releases by [@lodu](https://github.com/lodu) in [#1890](https://github.com/jlowin/fastmcp/pull/1890)\n* Small updates to Sampling types by [@strawgate](https://github.com/strawgate) in [#1882](https://github.com/jlowin/fastmcp/pull/1882)\n* remove lockfile smart_home example by [@zzstoatzz](https://github.com/zzstoatzz) in [#1892](https://github.com/jlowin/fastmcp/pull/1892)\n* Fix: Remove JSON schema title metadata while preserving parameters named 'title' by [@jlowin](https://github.com/jlowin) in [#1872](https://github.com/jlowin/fastmcp/pull/1872)\n* Fix: get_resource_url nested URL handling by [@raphael-linx](https://github.com/raphael-linx) in [#1914](https://github.com/jlowin/fastmcp/pull/1914)\n* Clean up code for creating the resource url by [@jlowin](https://github.com/jlowin) in [#1916](https://github.com/jlowin/fastmcp/pull/1916)\n* Fix route count logging in OpenAPI server by [@zzstoatzz](https://github.com/zzstoatzz) in [#1928](https://github.com/jlowin/fastmcp/pull/1928)\n### Docs \ud83d\udcda\n* docs: make Gemini CLI integration discoverable by [@jackwotherspoon](https://github.com/jackwotherspoon) in [#1827](https://github.com/jlowin/fastmcp/pull/1827)\n* docs: update NEW tags for AI assistant integrations by [@jackwotherspoon](https://github.com/jackwotherspoon) in [#1829](https://github.com/jlowin/fastmcp/pull/1829)\n* Update wordmark by [@jlowin](https://github.com/jlowin) in [#1832](https://github.com/jlowin/fastmcp/pull/1832)\n* docs: improve OAuth and OIDC Proxy documentation by [@jlowin](https://github.com/jlowin) in [#1880](https://github.com/jlowin/fastmcp/pull/1880)\n* Update readme + welcome docs by [@jlowin](https://github.com/jlowin) in [#1883](https://github.com/jlowin/fastmcp/pull/1883)\n* Update dark mode image in README by [@jlowin](https://github.com/jlowin) in [#1885](https://github.com/jlowin/fastmcp/pull/1885)\n\n## New Contributors\n* [@radi-dev](https://github.com/radi-dev) made their first contribution in [#1821](https://github.com/jlowin/fastmcp/pull/1821)\n* [@akkuman](https://github.com/akkuman) made their first contribution in [#1812](https://github.com/jlowin/fastmcp/pull/1812)\n* [@ruhulio](https://github.com/ruhulio) made their first contribution in [#1817](https://github.com/jlowin/fastmcp/pull/1817)\n* [@attiks](https://github.com/attiks) made their first contribution in [#1838](https://github.com/jlowin/fastmcp/pull/1838)\n* [@anvibanga](https://github.com/anvibanga) made their first contribution in [#1853](https://github.com/jlowin/fastmcp/pull/1853)\n* [@shlomo666](https://github.com/shlomo666) made their first contribution in [#1877](https://github.com/jlowin/fastmcp/pull/1877)\n* [@lodu](https://github.com/lodu) made their first contribution in [#1890](https://github.com/jlowin/fastmcp/pull/1890)\n* [@isijoe](https://github.com/isijoe) made their first contribution in [#1906](https://github.com/jlowin/fastmcp/pull/1906)\n* [@raphael-linx](https://github.com/raphael-linx) made their first contribution in [#1914](https://github.com/jlowin/fastmcp/pull/1914)\n* [@stephaneberle9](https://github.com/stephaneberle9) made their first contribution in [#1873](https://github.com/jlowin/fastmcp/pull/1873)\n* [@cclauss](https://github.com/cclauss) made their first contribution in [#1922](https://github.com/jlowin/fastmcp/pull/1922)\n\n**Full Changelog**: [v2.12.3...v2.12.4](https://github.com/jlowin/fastmcp/compare/v2.12.3...v2.12.4)\n\n</Update>\n\n<Update label=\"v2.12.3\" description=\"2025-09-17\">\n\n**[v2.12.3: Double Time](https://github.com/jlowin/fastmcp/releases/tag/v2.12.3)**\n\nFastMCP 2.12.3 focuses on performance and developer experience improvements based on community feedback. This release includes optimized auth provider imports that reduce server startup time, enhanced OIDC authentication flows with proper token management, and several reliability fixes for OAuth proxy configurations. The addition of automatic inline snapshot creation significantly improves the testing experience for contributors.\n\n## What's Changed\n### New Features \ud83c\udf89\n* feat: Support setting MCP log level via transport configuration by [@jlowin](https://github.com/jlowin) in [#1756](https://github.com/jlowin/fastmcp/pull/1756)\n### Enhancements \ud83d\udd27\n* Add client-side auth support for mcp install cursor command by [@jlowin](https://github.com/jlowin) in [#1747](https://github.com/jlowin/fastmcp/pull/1747)\n* Automatically Create inline Snapshots by [@strawgate](https://github.com/strawgate) in [#1779](https://github.com/jlowin/fastmcp/pull/1779)\n* Use lowercase namespace for fastmcp logger by [@jlowin](https://github.com/jlowin) in [#1791](https://github.com/jlowin/fastmcp/pull/1791)\n### Fixes \ud83d\udc1e\n* fix: correct merge mistake during auth0 refactor by [@strawgate](https://github.com/strawgate) in [#1742](https://github.com/jlowin/fastmcp/pull/1742)\n* Remove extraneous union import by [@jlowin](https://github.com/jlowin) in [#1823](https://github.com/jlowin/fastmcp/pull/1823)\n* Delay import of Provider classes until FastMCP Server Creation by [@strawgate](https://github.com/strawgate) in [#1820](https://github.com/jlowin/fastmcp/pull/1820)\n* fix: refactor OIDC configuration provider for proper token management by [@strawgate](https://github.com/strawgate) in [#1751](https://github.com/jlowin/fastmcp/pull/1751)\n* Fix smart_home example imports by [@strawgate](https://github.com/strawgate) in [#1753](https://github.com/jlowin/fastmcp/pull/1753)\n* fix: correct oauth proxy initialization of client by [@strawgate](https://github.com/strawgate) in [#1759](https://github.com/jlowin/fastmcp/pull/1759)\n* Fix: return empty string when prompts have no arguments by [@jlowin](https://github.com/jlowin) in [#1766](https://github.com/jlowin/fastmcp/pull/1766)\n* Fix async server callbacks by [@strawgate](https://github.com/strawgate) in [#1774](https://github.com/jlowin/fastmcp/pull/1774)\n* Fix error when retrieving Completion API errors by [@strawgate](https://github.com/strawgate) in [#1785](https://github.com/jlowin/fastmcp/pull/1785)\n* fix: correct documentation link in deprecation warning by [@strawgate](https://github.com/strawgate) in [#1828](https://github.com/jlowin/fastmcp/pull/1828)\n### Docs \ud83d\udcda\n* Add migration docs for 2.12 by [@jlowin](https://github.com/jlowin) in [#1745](https://github.com/jlowin/fastmcp/pull/1745)\n* Update docs for default sampling implementation to mention OpenAI API Key by [@strawgate](https://github.com/strawgate) in [#1763](https://github.com/jlowin/fastmcp/pull/1763)\n* Add tip about sampling prompts and user_context to sampling documentation by [@jlowin](https://github.com/jlowin) in [#1764](https://github.com/jlowin/fastmcp/pull/1764)\n* Update quickstart.mdx by [@radi-dev](https://github.com/radi-dev) in [#1821](https://github.com/jlowin/fastmcp/pull/1821)\n### Other Changes \ud83e\uddbe\n* Replace Marvin with Claude Code in CI by [@jlowin](https://github.com/jlowin) in [#1800](https://github.com/jlowin/fastmcp/pull/1800)\n* Refactor logging and structured logging middleware by [@strawgate](https://github.com/strawgate) in [#1805](https://github.com/jlowin/fastmcp/pull/1805)\n* feat: Move the Starlette context middleware to the front by [@akkuman](https://github.com/akkuman) in [#1812](https://github.com/jlowin/fastmcp/pull/1812)\n* feat: Add support for OIDC configuration by [@ruhulio](https://github.com/ruhulio) in [#1817](https://github.com/jlowin/fastmcp/pull/1817)\n\n## New Contributors\n* [@radi-dev](https://github.com/radi-dev) made their first contribution in [#1821](https://github.com/jlowin/fastmcp/pull/1821)\n* [@akkuman](https://github.com/akkuman) made their first contribution in [#1812](https://github.com/jlowin/fastmcp/pull/1812)\n* [@ruhulio](https://github.com/ruhulio) made their first contribution in [#1817](https://github.com/jlowin/fastmcp/pull/1817)\n\n**Full Changelog**: [v2.12.2...v2.12.3](https://github.com/jlowin/fastmcp/compare/v2.12.2...v2.12.3)\n\n</Update>\n\n<Update label=\"v2.12.2\" description=\"2025-09-03\">\n\n**[v2.12.2: Perchance to Stream](https://github.com/jlowin/fastmcp/releases/tag/v2.12.2)**\n\nThis is a hotfix for a bug where the `streamable-http` transport was not recognized as a valid option in `fastmcp.json` configuration files, despite being supported by the CLI. This resulted in a parsing error when the CLI arguments were merged against the configuration spec. \n\n## What's Changed\n### Fixes \ud83d\udc1e\n* Fix streamable-http transport validation in fastmcp.json config by [@jlowin](https://github.com/jlowin) in [#1739](https://github.com/jlowin/fastmcp/pull/1739)\n\n**Full Changelog**: [v2.12.1...v2.12.2](https://github.com/jlowin/fastmcp/compare/v2.12.1...v2.12.2)\n\n</Update>\n\n<Update label=\"v2.12.1\" description=\"2025-09-03\">\n\n**[v2.12.1: OAuth to Joy](https://github.com/jlowin/fastmcp/releases/tag/v2.12.1)**\n\nFastMCP 2.12.1 strengthens the OAuth proxy implementation based on extensive community testing and feedback. This release improves client storage reliability, adds PKCE forwarding for enhanced security, introduces configurable token endpoint authentication methods, and expands scope handling\u2014all addressing real-world integration challenges discovered since 2.12.0. The enhanced test suite with mock providers ensures these improvements are robust and maintainable.\n\n## Breaking Changes\n- **OAuth Proxy**: Users of built-in IDP integrations should note that `resource_server_url` has been renamed to `base_url` for clarity and consistency\n\n## What's Changed\n### Enhancements \ud83d\udd27\n* Make openai dependency optional by [@jlowin](https://github.com/jlowin) in [#1701](https://github.com/jlowin/fastmcp/pull/1701)\n* Remove orphaned OAuth proxy code by [@jlowin](https://github.com/jlowin) in [#1722](https://github.com/jlowin/fastmcp/pull/1722)\n* Expose valid scopes from OAuthProxy metadata by [@dmikusa](https://github.com/dmikusa) in [#1717](https://github.com/jlowin/fastmcp/pull/1717)\n* OAuth proxy PKCE forwarding by [@jlowin](https://github.com/jlowin) in [#1733](https://github.com/jlowin/fastmcp/pull/1733)\n* Add token_endpoint_auth_method parameter to OAuthProxy by [@jlowin](https://github.com/jlowin) in [#1736](https://github.com/jlowin/fastmcp/pull/1736)\n* Clean up and enhance OAuth proxy tests with mock provider by [@jlowin](https://github.com/jlowin) in [#1738](https://github.com/jlowin/fastmcp/pull/1738)\n### Fixes \ud83d\udc1e\n* refactor: replace auth provider registry with ImportString by [@jlowin](https://github.com/jlowin) in [#1710](https://github.com/jlowin/fastmcp/pull/1710)\n* Fix OAuth resource URL handling and WWW-Authenticate header by [@jlowin](https://github.com/jlowin) in [#1706](https://github.com/jlowin/fastmcp/pull/1706)\n* Fix OAuth proxy client storage and add retry logic by [@jlowin](https://github.com/jlowin) in [#1732](https://github.com/jlowin/fastmcp/pull/1732)\n### Docs \ud83d\udcda\n* Fix documentation: use StreamableHttpTransport for headers in testing by [@jlowin](https://github.com/jlowin) in [#1702](https://github.com/jlowin/fastmcp/pull/1702)\n* docs: add performance warnings for mounted servers and proxies by [@strawgate](https://github.com/strawgate) in [#1669](https://github.com/jlowin/fastmcp/pull/1669)\n* Update documentation around scopes for google by [@jlowin](https://github.com/jlowin) in [#1703](https://github.com/jlowin/fastmcp/pull/1703)\n* Add deployment information to quickstart by [@seanpwlms](https://github.com/seanpwlms) in [#1433](https://github.com/jlowin/fastmcp/pull/1433)\n* Update quickstart by [@jlowin](https://github.com/jlowin) in [#1728](https://github.com/jlowin/fastmcp/pull/1728)\n* Add development docs for FastMCP by [@jlowin](https://github.com/jlowin) in [#1719](https://github.com/jlowin/fastmcp/pull/1719)\n### Other Changes \ud83e\uddbe\n* Set generics without bounds to default=Any by [@strawgate](https://github.com/strawgate) in [#1648](https://github.com/jlowin/fastmcp/pull/1648)\n\n## New Contributors\n* [@dmikusa](https://github.com/dmikusa) made their first contribution in [#1717](https://github.com/jlowin/fastmcp/pull/1717)\n* [@seanpwlms](https://github.com/seanpwlms) made their first contribution in [#1433](https://github.com/jlowin/fastmcp/pull/1433)\n\n**Full Changelog**: [v2.12.0...v2.12.1](https://github.com/jlowin/fastmcp/compare/v2.12.0...v2.12.1)\n\n</Update>\n\n<Update label=\"v2.12.0\" description=\"2025-08-31\">\n\n**[v2.12.0: Auth to the Races](https://github.com/jlowin/fastmcp/releases/tag/v2.12.0)**\n\nFastMCP 2.12 represents one of our most significant releases to date, both in scope and community involvement. After extensive testing and iteration with the community, we're shipping major improvements to authentication, configuration, and MCP feature adoption.\n\n\ud83d\udd10 **OAuth Proxy for Broader Provider Support** addresses a fundamental challenge: while MCP requires Dynamic Client Registration (DCR), many popular OAuth providers don't support it. The new OAuth proxy bridges this gap, enabling FastMCP servers to authenticate with providers like GitHub, Google, WorkOS, and Azure through minimal configuration. These native integrations ship today, with more providers planned based on community needs.\n\n\ud83d\udccb **Declarative JSON Configuration** introduces a standardized, portable way to describe and deploy MCP servers. The `fastmcp.json` configuration file becomes the single source of truth for dependencies, transport settings, entrypoints, and server metadata. This foundation sets the stage for future capabilities like transformations and remote sources, moving toward a world where MCP servers are as portable and shareable as container images.\n\n\ud83e\udde0 **Sampling API Fallback** tackles the chicken-and-egg problem limiting adoption of advanced MCP features. Sampling\u2014where servers request LLM completions from clients\u2014is powerful but underutilized due to limited client support. FastMCP now lets server authors define fallback handlers that generate sampling completions server-side when clients don't support the feature, encouraging adoption while maintaining compatibility.\n\nThis release took longer than usual to ship, and for good reason: the community's aggressive testing and feedback on the authentication system helped us reach a level of stability we're confident in. There's certainly more work ahead, but these foundations position FastMCP to handle increasingly complex use cases while remaining approachable for developers.\n\nThank you to our new contributors and everyone who tested preview builds. Your feedback directly shaped these features.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Add OAuth proxy that allows authentication with social IDPs without DCR support by [@jlowin](https://github.com/jlowin) in [#1434](https://github.com/jlowin/fastmcp/pull/1434)\n* feat: introduce declarative JSON configuration system by [@jlowin](https://github.com/jlowin) in [#1517](https://github.com/jlowin/fastmcp/pull/1517)\n* \u2728 Fallback to a Completions API when Sampling is not available by [@strawgate](https://github.com/strawgate) in [#1145](https://github.com/jlowin/fastmcp/pull/1145)\n* Implement typed source system for FastMCP declarative configuration by [@jlowin](https://github.com/jlowin) in [#1607](https://github.com/jlowin/fastmcp/pull/1607)\n### Enhancements \ud83d\udd27\n* Support importing custom_route endpoints when mounting servers by [@jlowin](https://github.com/jlowin) in [#1470](https://github.com/jlowin/fastmcp/pull/1470)\n* Remove unnecessary asserts by [@jlowin](https://github.com/jlowin) in [#1484](https://github.com/jlowin/fastmcp/pull/1484)\n* Add Claude issue triage by [@jlowin](https://github.com/jlowin) in [#1510](https://github.com/jlowin/fastmcp/pull/1510)\n* Inline dedupe prompt by [@jlowin](https://github.com/jlowin) in [#1512](https://github.com/jlowin/fastmcp/pull/1512)\n* Improve stdio and mcp_config clean-up by [@strawgate](https://github.com/strawgate) in [#1444](https://github.com/jlowin/fastmcp/pull/1444)\n* involve kwargs to pass parameters on creating RichHandler for logging customization. by [@itaru2622](https://github.com/itaru2622) in [#1504](https://github.com/jlowin/fastmcp/pull/1504)\n* Move SDK docs generation to post-merge workflow by [@jlowin](https://github.com/jlowin) in [#1513](https://github.com/jlowin/fastmcp/pull/1513)\n* Improve label triage guidance by [@jlowin](https://github.com/jlowin) in [#1516](https://github.com/jlowin/fastmcp/pull/1516)\n* Add code review guidelines for agents by [@jlowin](https://github.com/jlowin) in [#1520](https://github.com/jlowin/fastmcp/pull/1520)\n* Remove trailing slash in unit tests by [@jlowin](https://github.com/jlowin) in [#1535](https://github.com/jlowin/fastmcp/pull/1535)\n* Update OAuth callback UI branding by [@jlowin](https://github.com/jlowin) in [#1536](https://github.com/jlowin/fastmcp/pull/1536)\n* Fix Marvin workflow to support development tools by [@jlowin](https://github.com/jlowin) in [#1537](https://github.com/jlowin/fastmcp/pull/1537)\n* Add mounted_components_raise_on_load_error setting for debugging by [@jlowin](https://github.com/jlowin) in [#1534](https://github.com/jlowin/fastmcp/pull/1534)\n* feat: Add --workspace flag to fastmcp install cursor by [@jlowin](https://github.com/jlowin) in [#1522](https://github.com/jlowin/fastmcp/pull/1522)\n* switch from `pyright` to `ty` by [@zzstoatzz](https://github.com/zzstoatzz) in [#1545](https://github.com/jlowin/fastmcp/pull/1545)\n* feat: trigger Marvin workflow on PR body content by [@jlowin](https://github.com/jlowin) in [#1549](https://github.com/jlowin/fastmcp/pull/1549)\n* Add WorkOS and Azure OAuth providers by [@jlowin](https://github.com/jlowin) in [#1550](https://github.com/jlowin/fastmcp/pull/1550)\n* Adjust timeout for slow MCP Server shutdown test by [@strawgate](https://github.com/strawgate) in [#1561](https://github.com/jlowin/fastmcp/pull/1561)\n* Update banner by [@jlowin](https://github.com/jlowin) in [#1567](https://github.com/jlowin/fastmcp/pull/1567)\n* Added import of AuthProxy to auth __init__ by [@KaliszS](https://github.com/KaliszS) in [#1568](https://github.com/jlowin/fastmcp/pull/1568)\n* Add configurable redirect URI validation for OAuth providers by [@jlowin](https://github.com/jlowin) in [#1582](https://github.com/jlowin/fastmcp/pull/1582)\n* Remove invalid-argument-type ignore and fix type errors by [@jlowin](https://github.com/jlowin) in [#1588](https://github.com/jlowin/fastmcp/pull/1588)\n* Remove generate-schema from public CLI by [@jlowin](https://github.com/jlowin) in [#1591](https://github.com/jlowin/fastmcp/pull/1591)\n* Skip flaky windows test / mulit-client garbage collection by [@jlowin](https://github.com/jlowin) in [#1592](https://github.com/jlowin/fastmcp/pull/1592)\n* Add setting to disable logging configuration by [@isra17](https://github.com/isra17) in [#1575](https://github.com/jlowin/fastmcp/pull/1575)\n* Improve debug logging for nested Servers / Clients by [@strawgate](https://github.com/strawgate) in [#1604](https://github.com/jlowin/fastmcp/pull/1604)\n* Add GitHub pull request template by [@strawgate](https://github.com/strawgate) in [#1581](https://github.com/jlowin/fastmcp/pull/1581)\n* chore: Automate docs and schema updates via PRs by [@jlowin](https://github.com/jlowin) in [#1611](https://github.com/jlowin/fastmcp/pull/1611)\n* Experiment with haiku for limited workflows by [@jlowin](https://github.com/jlowin) in [#1613](https://github.com/jlowin/fastmcp/pull/1613)\n* feat: Improve GitHub workflow automation for schema and SDK docs by [@jlowin](https://github.com/jlowin) in [#1615](https://github.com/jlowin/fastmcp/pull/1615)\n* Consolidate server loading logic into FileSystemSource by [@jlowin](https://github.com/jlowin) in [#1614](https://github.com/jlowin/fastmcp/pull/1614)\n* Prevent Haiku Marvin from commenting when there are no duplicates by [@jlowin](https://github.com/jlowin) in [#1622](https://github.com/jlowin/fastmcp/pull/1622)\n* chore: Add clarifying note to automated PR bodies by [@jlowin](https://github.com/jlowin) in [#1623](https://github.com/jlowin/fastmcp/pull/1623)\n* feat: introduce inline snapshots by [@strawgate](https://github.com/strawgate) in [#1605](https://github.com/jlowin/fastmcp/pull/1605)\n* Improve fastmcp.json environment configuration and project-based deployments by [@jlowin](https://github.com/jlowin) in [#1631](https://github.com/jlowin/fastmcp/pull/1631)\n* fix: allow passing query params in OAuthProxy upstream authorization url by [@danb27](https://github.com/danb27) in [#1630](https://github.com/jlowin/fastmcp/pull/1630)\n* Support multiple --with-editable flags in CLI commands by [@jlowin](https://github.com/jlowin) in [#1634](https://github.com/jlowin/fastmcp/pull/1634)\n* feat: support comma separated oauth scopes by [@jlowin](https://github.com/jlowin) in [#1642](https://github.com/jlowin/fastmcp/pull/1642)\n* Add allowed_client_redirect_uris to OAuth provider subclasses by [@jlowin](https://github.com/jlowin) in [#1662](https://github.com/jlowin/fastmcp/pull/1662)\n* Consolidate CLI config parsing and prevent infinite loops by [@jlowin](https://github.com/jlowin) in [#1660](https://github.com/jlowin/fastmcp/pull/1660)\n* Internal refactor: mcp server config by [@jlowin](https://github.com/jlowin) in [#1672](https://github.com/jlowin/fastmcp/pull/1672)\n* Refactor Environment to support multiple runtime types by [@jlowin](https://github.com/jlowin) in [#1673](https://github.com/jlowin/fastmcp/pull/1673)\n* Add type field to Environment base class by [@jlowin](https://github.com/jlowin) in [#1676](https://github.com/jlowin/fastmcp/pull/1676)\n### Fixes \ud83d\udc1e\n* Fix breaking change: restore output_schema=False compatibility by [@jlowin](https://github.com/jlowin) in [#1482](https://github.com/jlowin/fastmcp/pull/1482)\n* Fix #1506: Update tool filtering documentation from _meta to meta by [@maybenotconnor](https://github.com/maybenotconnor) in [#1511](https://github.com/jlowin/fastmcp/pull/1511)\n* Fix pytest warnings by [@jlowin](https://github.com/jlowin) in [#1559](https://github.com/jlowin/fastmcp/pull/1559)\n* nest schemas under assets by [@jlowin](https://github.com/jlowin) in [#1593](https://github.com/jlowin/fastmcp/pull/1593)\n* Skip flaky windows test by [@jlowin](https://github.com/jlowin) in [#1596](https://github.com/jlowin/fastmcp/pull/1596)\n* ACTUALLY move schemas to fastmcp.json by [@jlowin](https://github.com/jlowin) in [#1597](https://github.com/jlowin/fastmcp/pull/1597)\n* Fix and centralize CLI path resolution by [@jlowin](https://github.com/jlowin) in [#1590](https://github.com/jlowin/fastmcp/pull/1590)\n* Remove client info modifications by [@jlowin](https://github.com/jlowin) in [#1620](https://github.com/jlowin/fastmcp/pull/1620)\n* Fix $defs being discarded in input schema of transformed tool by [@pldesch-chift](https://github.com/pldesch-chift) in [#1578](https://github.com/jlowin/fastmcp/pull/1578)\n* Fix enum elicitation to use inline schemas for MCP compatibility by [@jlowin](https://github.com/jlowin) in [#1632](https://github.com/jlowin/fastmcp/pull/1632)\n* Reuse session for `StdioTransport` in `Client.new` by [@strawgate](https://github.com/strawgate) in [#1635](https://github.com/jlowin/fastmcp/pull/1635)\n* Feat: Configurable LoggingMiddleware payload serialization by [@vl-kp](https://github.com/vl-kp) in [#1636](https://github.com/jlowin/fastmcp/pull/1636)\n* Fix OAuth redirect URI validation for DCR compatibility by [@jlowin](https://github.com/jlowin) in [#1661](https://github.com/jlowin/fastmcp/pull/1661)\n* Add default scope handling in OAuth proxy by [@romanusyk](https://github.com/romanusyk) in [#1667](https://github.com/jlowin/fastmcp/pull/1667)\n* Fix OAuth token expiry handling by [@jlowin](https://github.com/jlowin) in [#1671](https://github.com/jlowin/fastmcp/pull/1671)\n* Add resource_server_url parameter to OAuth proxy providers by [@jlowin](https://github.com/jlowin) in [#1682](https://github.com/jlowin/fastmcp/pull/1682)\n### Breaking Changes \ud83d\udeeb\n* Enhance inspect command with structured output and format options by [@jlowin](https://github.com/jlowin) in [#1481](https://github.com/jlowin/fastmcp/pull/1481)\n### Docs \ud83d\udcda\n* Update changelog by [@jlowin](https://github.com/jlowin) in [#1453](https://github.com/jlowin/fastmcp/pull/1453)\n* Update banner by [@jlowin](https://github.com/jlowin) in [#1472](https://github.com/jlowin/fastmcp/pull/1472)\n* Update logo files by [@jlowin](https://github.com/jlowin) in [#1473](https://github.com/jlowin/fastmcp/pull/1473)\n* Update deployment docs by [@jlowin](https://github.com/jlowin) in [#1486](https://github.com/jlowin/fastmcp/pull/1486)\n* Update FastMCP Cloud screenshot by [@jlowin](https://github.com/jlowin) in [#1487](https://github.com/jlowin/fastmcp/pull/1487)\n* Update authentication note in docs by [@jlowin](https://github.com/jlowin) in [#1488](https://github.com/jlowin/fastmcp/pull/1488)\n* chore: Update installation.mdx version snippet by [@thomas-te](https://github.com/thomas-te) in [#1496](https://github.com/jlowin/fastmcp/pull/1496)\n* Update fastmcp cloud server requirements by [@jlowin](https://github.com/jlowin) in [#1497](https://github.com/jlowin/fastmcp/pull/1497)\n* Fix oauth pyright type checking by [@strawgate](https://github.com/strawgate) in [#1498](https://github.com/jlowin/fastmcp/pull/1498)\n* docs: Fix type annotation in return value documentation by [@MaikelVeen](https://github.com/MaikelVeen) in [#1499](https://github.com/jlowin/fastmcp/pull/1499)\n* Fix PromptMessage usage in docs example by [@jlowin](https://github.com/jlowin) in [#1515](https://github.com/jlowin/fastmcp/pull/1515)\n* Create CODE_OF_CONDUCT.md by [@jlowin](https://github.com/jlowin) in [#1523](https://github.com/jlowin/fastmcp/pull/1523)\n* Fixed wrong import path in new docs page by [@KaliszS](https://github.com/KaliszS) in [#1538](https://github.com/jlowin/fastmcp/pull/1538)\n* Document symmetric key JWT verification support by [@jlowin](https://github.com/jlowin) in [#1586](https://github.com/jlowin/fastmcp/pull/1586)\n* Update fastmcp.json schema path by [@jlowin](https://github.com/jlowin) in [#1595](https://github.com/jlowin/fastmcp/pull/1595)\n### Dependencies \ud83d\udce6\n* Bump actions/create-github-app-token from 1 to 2 by [@dependabot](https://github.com/dependabot)[bot] in [#1436](https://github.com/jlowin/fastmcp/pull/1436)\n* Bump astral-sh/setup-uv from 4 to 6 by [@dependabot](https://github.com/dependabot)[bot] in [#1532](https://github.com/jlowin/fastmcp/pull/1532)\n* Bump actions/checkout from 4 to 5 by [@dependabot](https://github.com/dependabot)[bot] in [#1533](https://github.com/jlowin/fastmcp/pull/1533)\n### Other Changes \ud83e\uddbe\n* Add dedupe workflow by [@jlowin](https://github.com/jlowin) in [#1454](https://github.com/jlowin/fastmcp/pull/1454)\n* Update AGENTS.md by [@jlowin](https://github.com/jlowin) in [#1471](https://github.com/jlowin/fastmcp/pull/1471)\n* Give Marvin the power of the Internet by [@strawgate](https://github.com/strawgate) in [#1475](https://github.com/jlowin/fastmcp/pull/1475)\n* Update `just` error message for static checks by [@jlowin](https://github.com/jlowin) in [#1483](https://github.com/jlowin/fastmcp/pull/1483)\n* Remove labeler by [@jlowin](https://github.com/jlowin) in [#1509](https://github.com/jlowin/fastmcp/pull/1509)\n* update aproto server to handle rich links by [@zzstoatzz](https://github.com/zzstoatzz) in [#1556](https://github.com/jlowin/fastmcp/pull/1556)\n* fix: enable triage bot for fork PRs using pull_request_target by [@jlowin](https://github.com/jlowin) in [#1557](https://github.com/jlowin/fastmcp/pull/1557)\n\n## New Contributors\n* [@thomas-te](https://github.com/thomas-te) made their first contribution in [#1496](https://github.com/jlowin/fastmcp/pull/1496)\n* [@maybenotconnor](https://github.com/maybenotconnor) made their first contribution in [#1511](https://github.com/jlowin/fastmcp/pull/1511)\n* [@MaikelVeen](https://github.com/MaikelVeen) made their first contribution in [#1499](https://github.com/jlowin/fastmcp/pull/1499)\n* [@KaliszS](https://github.com/KaliszS) made their first contribution in [#1538](https://github.com/jlowin/fastmcp/pull/1538)\n* [@isra17](https://github.com/isra17) made their first contribution in [#1575](https://github.com/jlowin/fastmcp/pull/1575)\n* [@marvin-context-protocol](https://github.com/marvin-context-protocol)[bot] made their first contribution in [#1616](https://github.com/jlowin/fastmcp/pull/1616)\n* [@pldesch-chift](https://github.com/pldesch-chift) made their first contribution in [#1578](https://github.com/jlowin/fastmcp/pull/1578)\n* [@vl-kp](https://github.com/vl-kp) made their first contribution in [#1636](https://github.com/jlowin/fastmcp/pull/1636)\n* [@romanusyk](https://github.com/romanusyk) made their first contribution in [#1667](https://github.com/jlowin/fastmcp/pull/1667)\n\n**Full Changelog**: [v2.11.3...v2.12.0](https://github.com/jlowin/fastmcp/compare/v2.11.3...v2.12.0)\n\n</Update>\n\n<Update label=\"v2.11.3\" description=\"2025-08-11\">\n\n**[v2.11.3: API-tite for Change](https://github.com/jlowin/fastmcp/releases/tag/v2.11.3)**\n\nThis release includes significant enhancements to the experimental OpenAPI parser and fixes a significant bug that led schemas not to be included in input/output schemas if they were transitive dependencies (e.g. A \u2192 B \u2192 C implies A depends on C). For users naively transforming large OpenAPI specs into MCP servers, this may result in ballooning payload sizes and necessitate curation.\n\n## What's Changed\n### Enhancements \ud83d\udd27\n* Improve redirect handling to address 307's by [@jlowin](https://github.com/jlowin) in [#1387](https://github.com/jlowin/fastmcp/pull/1387)\n* Ensure resource + template names are properly prefixed when importing/mounting by [@jlowin](https://github.com/jlowin) in [#1423](https://github.com/jlowin/fastmcp/pull/1423)\n* fixes #1398: Add JWT claims to AccessToken by [@panargirakis](https://github.com/panargirakis) in [#1399](https://github.com/jlowin/fastmcp/pull/1399)\n* Enable Protected Resource Metadata to provide resource_name and resou\u2026 by [@yannj-fr](https://github.com/yannj-fr) in [#1371](https://github.com/jlowin/fastmcp/pull/1371)\n* Pin mcp SDK under 2.0 to avoid breaking changes by [@jlowin](https://github.com/jlowin) in [#1428](https://github.com/jlowin/fastmcp/pull/1428)\n* Clean up complexity from PR #1426 by [@jlowin](https://github.com/jlowin) in [#1435](https://github.com/jlowin/fastmcp/pull/1435)\n* Optimize OpenAPI payload size by 46% by [@jlowin](https://github.com/jlowin) in [#1452](https://github.com/jlowin/fastmcp/pull/1452)\n* Update static checks by [@jlowin](https://github.com/jlowin) in [#1448](https://github.com/jlowin/fastmcp/pull/1448)\n### Fixes \ud83d\udc1e\n* Fix client-side logging bug #1394 by [@chi2liu](https://github.com/chi2liu) in [#1397](https://github.com/jlowin/fastmcp/pull/1397)\n* fix: Fix httpx_client_factory type annotation to match MCP SDK (#1402) by [@chi2liu](https://github.com/chi2liu) in [#1405](https://github.com/jlowin/fastmcp/pull/1405)\n* Fix OpenAPI allOf handling at requestBody top level (#1378) by [@chi2liu](https://github.com/chi2liu) in [#1425](https://github.com/jlowin/fastmcp/pull/1425)\n* Fix OpenAPI transitive references and performance (#1372) by [@jlowin](https://github.com/jlowin) in [#1426](https://github.com/jlowin/fastmcp/pull/1426)\n* fix(type): lifespan is partially unknown by [@ykun9](https://github.com/ykun9) in [#1389](https://github.com/jlowin/fastmcp/pull/1389)\n* Ensure transformed tools generate structured content by [@jlowin](https://github.com/jlowin) in [#1443](https://github.com/jlowin/fastmcp/pull/1443)\n### Docs \ud83d\udcda\n* docs(client/logging): reflect corrected default log level mapping by [@jlowin](https://github.com/jlowin) in [#1403](https://github.com/jlowin/fastmcp/pull/1403)\n* Add documentation for get_access_token() dependency function by [@jlowin](https://github.com/jlowin) in [#1446](https://github.com/jlowin/fastmcp/pull/1446)\n### Other Changes \ud83e\uddbe\n* Add comprehensive tests for utilities.components module by [@chi2liu](https://github.com/chi2liu) in [#1395](https://github.com/jlowin/fastmcp/pull/1395)\n* Consolidate agent instructions into AGENTS.md by [@jlowin](https://github.com/jlowin) in [#1404](https://github.com/jlowin/fastmcp/pull/1404)\n* Fix performance test threshold to prevent flaky failures by [@jlowin](https://github.com/jlowin) in [#1406](https://github.com/jlowin/fastmcp/pull/1406)\n* Update agents.md; add github instructions by [@jlowin](https://github.com/jlowin) in [#1410](https://github.com/jlowin/fastmcp/pull/1410)\n* Add Marvin assistant by [@jlowin](https://github.com/jlowin) in [#1412](https://github.com/jlowin/fastmcp/pull/1412)\n* Marvin: fix deprecated variable names by [@jlowin](https://github.com/jlowin) in [#1417](https://github.com/jlowin/fastmcp/pull/1417)\n* Simplify action setup and add github tools for Marvin by [@jlowin](https://github.com/jlowin) in [#1419](https://github.com/jlowin/fastmcp/pull/1419)\n* Update marvin workflow name by [@jlowin](https://github.com/jlowin) in [#1421](https://github.com/jlowin/fastmcp/pull/1421)\n* Improve GitHub templates by [@jlowin](https://github.com/jlowin) in [#1422](https://github.com/jlowin/fastmcp/pull/1422)\n\n## New Contributors\n* [@panargirakis](https://github.com/panargirakis) made their first contribution in [#1399](https://github.com/jlowin/fastmcp/pull/1399)\n* [@ykun9](https://github.com/ykun9) made their first contribution in [#1389](https://github.com/jlowin/fastmcp/pull/1389)\n* [@yannj-fr](https://github.com/yannj-fr) made their first contribution in [#1371](https://github.com/jlowin/fastmcp/pull/1371)\n\n**Full Changelog**: [v2.11.2...v2.11.3](https://github.com/jlowin/fastmcp/compare/v2.11.2...v2.11.3)\n\n</Update>\n\n<Update label=\"v2.11.2\" description=\"2025-08-06\">\n\n## [v2.11.2: Satis-factory](https://github.com/jlowin/fastmcp/releases/tag/v2.11.2)\n\n## What's Changed\n### Enhancements \ud83d\udd27\n* Support factory functions in fastmcp run by [@jlowin](https://github.com/jlowin) in [#1384](https://github.com/jlowin/fastmcp/pull/1384)\n* Add async support to client_factory in FastMCPProxy  (#1286) by [@bianning](https://github.com/bianning) in [#1375](https://github.com/jlowin/fastmcp/pull/1375)\n### Fixes \ud83d\udc1e\n* Fix server_version field in inspect manifest by [@jlowin](https://github.com/jlowin) in [#1383](https://github.com/jlowin/fastmcp/pull/1383)\n* Fix Settings field with both default and default_factory by [@jlowin](https://github.com/jlowin) in [#1380](https://github.com/jlowin/fastmcp/pull/1380)\n### Other Changes \ud83e\uddbe\n* Remove unused arg by [@jlowin](https://github.com/jlowin) in [#1382](https://github.com/jlowin/fastmcp/pull/1382)\n* Add remote auth provider tests by [@jlowin](https://github.com/jlowin) in [#1351](https://github.com/jlowin/fastmcp/pull/1351)\n\n## New Contributors\n* [@bianning](https://github.com/bianning) made their first contribution in [#1375](https://github.com/jlowin/fastmcp/pull/1375)\n\n**Full Changelog**: [v2.11.1...v2.11.2](https://github.com/jlowin/fastmcp/compare/v2.11.1...v2.11.2)\n\n</Update>\n\n<Update label=\"v2.11.1\" description=\"2025-08-04\">\n\n## [v2.11.1: You're Better Auth Now](https://github.com/jlowin/fastmcp/releases/tag/v2.11.1)\n\n## What's Changed\n### New Features \ud83c\udf89\n* Introduce `RemoteAuthProvider` for cleaner external identity provider integration, update docs by [@jlowin](https://github.com/jlowin) in [#1346](https://github.com/jlowin/fastmcp/pull/1346)\n### Enhancements \ud83d\udd27\n* perf: optimize string operations in OpenAPI parameter processing by [@chi2liu](https://github.com/chi2liu) in [#1342](https://github.com/jlowin/fastmcp/pull/1342)\n### Fixes \ud83d\udc1e\n* Fix method-bound FunctionTool schemas by [@strawgate](https://github.com/strawgate) in [#1360](https://github.com/jlowin/fastmcp/pull/1360)\n* Manually set `_key` after `model_copy()` to enable prefixing Transformed Tools by [@strawgate](https://github.com/strawgate) in [#1357](https://github.com/jlowin/fastmcp/pull/1357)\n### Docs \ud83d\udcda\n* Docs updates by [@jlowin](https://github.com/jlowin) in [#1336](https://github.com/jlowin/fastmcp/pull/1336)\n* Add 2.11 to changelog by [@jlowin](https://github.com/jlowin) in [#1337](https://github.com/jlowin/fastmcp/pull/1337)\n* Update AuthKit vocab by [@jlowin](https://github.com/jlowin) in [#1338](https://github.com/jlowin/fastmcp/pull/1338)\n* Fix typo in decorating-methods.mdx by [@Ozzuke](https://github.com/Ozzuke) in [#1344](https://github.com/jlowin/fastmcp/pull/1344)\n\n## New Contributors\n* [@Ozzuke](https://github.com/Ozzuke) made their first contribution in [#1344](https://github.com/jlowin/fastmcp/pull/1344)\n\n**Full Changelog**: [v2.11.0...v2.11.1](https://github.com/jlowin/fastmcp/compare/v2.11.0...v2.11.1)\n\n</Update>\n\n<Update label=\"v2.11.0\" description=\"2025-08-01\">\n\n## [v2.11.0: Auth to a Good Start](https://github.com/jlowin/fastmcp/releases/tag/v2.11.0)\n\nFastMCP 2.11 doubles down on what developers need most: speed and simplicity. This massive release delivers significant performance improvements and a dramatically better developer experience.\n\n\ud83d\udd10 **Enterprise-Ready Authentication** brings comprehensive OAuth 2.1 support with WorkOS's AuthKit integration. The new AuthProvider interface leverages MCP's support for separate resource and authorization servers, handling API keys and remote authentication with Dynamic Client Registration. AuthKit integration means you can plug into existing enterprise identity systems without rebuilding your auth stack, setting the stage for plug-and-play auth that doesn't require users to become security experts overnight.\n\n\u26a1 The **Experimental OpenAPI Parser** delivers dramatic performance improvements through single-pass schema processing and optimized memory usage. OpenAPI integrations are now significantly faster, with cleaner, more maintainable code. _(Note: the experimental parser is disabled by default, set `FASTMCPEXPERIMENTALENABLENEWOPENAPIPARSER=1` to enable it. A message will be shown to all users on the legacy parser encouraging them to try the new one before it becomes the default.)_\n\n\ud83e\udde0 **Context State Management** finally gives you persistent state across tool calls with a simple dict interface, while enhanced meta support lets you expose rich component metadata to clients. Combined with improved type annotations, string-based argument descriptions, and UV transport support, this release makes FastMCP feel more intuitive than ever.\n\nThis release represents a TON of community contributions and sets the foundation for even more ambitious features ahead.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Introduce experimental OpenAPI parser with improved performance and maintainability by [@jlowin](https://github.com/jlowin) in [#1209](https://github.com/jlowin/fastmcp/pull/1209)\n* Add state dict to Context (#1118) by [@mukulmurthy](https://github.com/mukulmurthy) in [#1160](https://github.com/jlowin/fastmcp/pull/1160)\n* Expose FastMCP tags to clients via component `meta` dict by [@jlowin](https://github.com/jlowin) in [#1281](https://github.com/jlowin/fastmcp/pull/1281)\n* Add _fastmcp meta namespace by [@jlowin](https://github.com/jlowin) in [#1290](https://github.com/jlowin/fastmcp/pull/1290)\n* Add TokenVerifier protocol support alongside existing OAuthProvider authentication by [@jlowin](https://github.com/jlowin) in [#1297](https://github.com/jlowin/fastmcp/pull/1297)\n* Add comprehensive OAuth 2.1 authentication system with WorkOS integration by [@jlowin](https://github.com/jlowin) in [#1327](https://github.com/jlowin/fastmcp/pull/1327)\n### Enhancements \ud83d\udd27\n* [\ud83d\udc36] Transform MCP Server Tools by [@strawgate](https://github.com/strawgate) in [#1132](https://github.com/jlowin/fastmcp/pull/1132)\n* Add --python, --project, and --with-requirements options to CLI commands by [@jlowin](https://github.com/jlowin) in [#1190](https://github.com/jlowin/fastmcp/pull/1190)\n* Support `fastmcp run mcp.json` by [@strawgate](https://github.com/strawgate) in [#1138](https://github.com/jlowin/fastmcp/pull/1138)\n* Support from __future__ import annotations by [@jlowin](https://github.com/jlowin) in [#1199](https://github.com/jlowin/fastmcp/pull/1199)\n* Optimize OpenAPI parser performance with single-pass schema processing by [@jlowin](https://github.com/jlowin) in [#1214](https://github.com/jlowin/fastmcp/pull/1214)\n* Log tool name on transform validation error by [@strawgate](https://github.com/strawgate) in [#1238](https://github.com/jlowin/fastmcp/pull/1238)\n* Refactor `get_http_request` and `context.session_id` by [@hopeful0](https://github.com/hopeful0) in [#1242](https://github.com/jlowin/fastmcp/pull/1242)\n* Support creating tool argument descriptions from string annotations by [@jlowin](https://github.com/jlowin) in [#1255](https://github.com/jlowin/fastmcp/pull/1255)\n* feat: Add Annotations support for resources and resource templates by [@chughtapan](https://github.com/chughtapan) in [#1260](https://github.com/jlowin/fastmcp/pull/1260)\n* Add UV Transport by [@strawgate](https://github.com/strawgate) in [#1270](https://github.com/jlowin/fastmcp/pull/1270)\n* Improve OpenAPI-to-JSONSchema conversion utilities by [@jlowin](https://github.com/jlowin) in [#1283](https://github.com/jlowin/fastmcp/pull/1283)\n* Ensure proxy components forward meta dicts by [@jlowin](https://github.com/jlowin) in [#1282](https://github.com/jlowin/fastmcp/pull/1282)\n* fix: server argument passing in CLI run command by [@chughtapan](https://github.com/chughtapan) in [#1293](https://github.com/jlowin/fastmcp/pull/1293)\n* Add meta support to tool transformation utilities by [@jlowin](https://github.com/jlowin) in [#1295](https://github.com/jlowin/fastmcp/pull/1295)\n* feat: Allow Resource Metadata URL as field in OAuthProvider by [@dacamposol](https://github.com/dacamposol) in [#1287](https://github.com/jlowin/fastmcp/pull/1287)\n* Use a simple overwrite instead of a merge for meta by [@jlowin](https://github.com/jlowin) in [#1296](https://github.com/jlowin/fastmcp/pull/1296)\n* Remove unused TimedCache by [@strawgate](https://github.com/strawgate) in [#1303](https://github.com/jlowin/fastmcp/pull/1303)\n* refactor: standardize logging usage across OpenAPI utilities by [@chi2liu](https://github.com/chi2liu) in [#1322](https://github.com/jlowin/fastmcp/pull/1322)\n* perf: optimize OpenAPI parsing by reducing dict copy operations by [@chi2liu](https://github.com/chi2liu) in [#1321](https://github.com/jlowin/fastmcp/pull/1321)\n* Structured client-side logging by [@cjermain](https://github.com/cjermain) in [#1326](https://github.com/jlowin/fastmcp/pull/1326)\n### Fixes \ud83d\udc1e\n* fix: preserve def reference when referenced in allOf / oneOf / anyOf by [@algirdasci](https://github.com/algirdasci) in [#1208](https://github.com/jlowin/fastmcp/pull/1208)\n* fix: add type hint to custom_route decorator by [@zzstoatzz](https://github.com/zzstoatzz) in [#1210](https://github.com/jlowin/fastmcp/pull/1210)\n* chore: typo by [@richardkmichael](https://github.com/richardkmichael) in [#1216](https://github.com/jlowin/fastmcp/pull/1216)\n* fix: handle non-string $ref values in experimental OpenAPI parser by [@jlowin](https://github.com/jlowin) in [#1217](https://github.com/jlowin/fastmcp/pull/1217)\n* Skip repeated type conversion and validation in proxy client elicitation handler by [@chughtapan](https://github.com/chughtapan) in [#1222](https://github.com/jlowin/fastmcp/pull/1222)\n* Ensure default fields are not marked nullable by [@jlowin](https://github.com/jlowin) in [#1224](https://github.com/jlowin/fastmcp/pull/1224)\n* Fix stateful proxy client mixing in multi-proxies sessions by [@hopeful0](https://github.com/hopeful0) in [#1245](https://github.com/jlowin/fastmcp/pull/1245)\n* Fix invalid async context manager usage in proxy documentation by [@zzstoatzz](https://github.com/zzstoatzz) in [#1246](https://github.com/jlowin/fastmcp/pull/1246)\n* fix: experimental FastMCPOpenAPI server lost headers in request when __init__(client with headers) by [@itaru2622](https://github.com/itaru2622) in [#1254](https://github.com/jlowin/fastmcp/pull/1254)\n* Fix typing, add tests for tool call middleware by [@jlowin](https://github.com/jlowin) in [#1269](https://github.com/jlowin/fastmcp/pull/1269)\n* Fix: prune hidden parameter defs by [@muhammadkhalid-03](https://github.com/muhammadkhalid-03) in [#1257](https://github.com/jlowin/fastmcp/pull/1257)\n* Fix nullable field handling in OpenAPI to JSON Schema conversion by [@jlowin](https://github.com/jlowin) in [#1279](https://github.com/jlowin/fastmcp/pull/1279)\n* Ensure fastmcp run supports v1 servers by [@jlowin](https://github.com/jlowin) in [#1332](https://github.com/jlowin/fastmcp/pull/1332)\n### Breaking Changes \ud83d\udeeb\n* Change server flag to --name by [@jlowin](https://github.com/jlowin) in [#1248](https://github.com/jlowin/fastmcp/pull/1248)\n### Docs \ud83d\udcda\n* Remove unused import from FastAPI integration documentation by [@mariotaddeucci](https://github.com/mariotaddeucci) in [#1194](https://github.com/jlowin/fastmcp/pull/1194)\n* Update fastapi docs by [@jlowin](https://github.com/jlowin) in [#1198](https://github.com/jlowin/fastmcp/pull/1198)\n* Add docs for context state management by [@jlowin](https://github.com/jlowin) in [#1227](https://github.com/jlowin/fastmcp/pull/1227)\n* Permit.io integration docs by [@orweis](https://github.com/orweis) in [#1226](https://github.com/jlowin/fastmcp/pull/1226)\n* Update docs to reflect sync tools by [@jlowin](https://github.com/jlowin) in [#1234](https://github.com/jlowin/fastmcp/pull/1234)\n* Update changelog.mdx by [@jlowin](https://github.com/jlowin) in [#1235](https://github.com/jlowin/fastmcp/pull/1235)\n* Update SDK docs by [@jlowin](https://github.com/jlowin) in [#1236](https://github.com/jlowin/fastmcp/pull/1236)\n* Update --name flag documentation for Cursor/Claude by [@adam-conway](https://github.com/adam-conway) in [#1239](https://github.com/jlowin/fastmcp/pull/1239)\n* Add annotations docs by [@jlowin](https://github.com/jlowin) in [#1268](https://github.com/jlowin/fastmcp/pull/1268)\n* Update openapi/fastapi URLs README.md by [@jbn](https://github.com/jbn) in [#1278](https://github.com/jlowin/fastmcp/pull/1278)\n* Add 2.11 version badge for state management by [@jlowin](https://github.com/jlowin) in [#1289](https://github.com/jlowin/fastmcp/pull/1289)\n* Add meta parameter support to tools, resources, templates, and prompts decorators by [@jlowin](https://github.com/jlowin) in [#1294](https://github.com/jlowin/fastmcp/pull/1294)\n* docs: update get_state and set_state references by [@Maxi91f](https://github.com/Maxi91f) in [#1306](https://github.com/jlowin/fastmcp/pull/1306)\n* Add unit tests and docs for denying tool calls with middleware by [@jlowin](https://github.com/jlowin) in [#1333](https://github.com/jlowin/fastmcp/pull/1333)\n* Remove reference to stacked decorators by [@jlowin](https://github.com/jlowin) in [#1334](https://github.com/jlowin/fastmcp/pull/1334)\n* Eunomia authorization server can run embedded within the MCP server by [@tommitt](https://github.com/tommitt) in [#1317](https://github.com/jlowin/fastmcp/pull/1317)\n### Other Changes \ud83e\uddbe\n* Update README.md by [@jlowin](https://github.com/jlowin) in [#1230](https://github.com/jlowin/fastmcp/pull/1230)\n* Logcapture addition to test_server file by [@Sourav-Tripathy](https://github.com/Sourav-Tripathy) in [#1229](https://github.com/jlowin/fastmcp/pull/1229)\n* Add tests for headers with both legacy and experimental openapi parser by [@jlowin](https://github.com/jlowin) in [#1259](https://github.com/jlowin/fastmcp/pull/1259)\n* Small clean-up from MCP Tool Transform PR by [@strawgate](https://github.com/strawgate) in [#1267](https://github.com/jlowin/fastmcp/pull/1267)\n* Add test for proxy tags visibility by [@jlowin](https://github.com/jlowin) in [#1302](https://github.com/jlowin/fastmcp/pull/1302)\n* Add unit test for sampling with image messages by [@jlowin](https://github.com/jlowin) in [#1329](https://github.com/jlowin/fastmcp/pull/1329)\n* Remove redundant resource_metadata_url assignment by [@jlowin](https://github.com/jlowin) in [#1328](https://github.com/jlowin/fastmcp/pull/1328)\n* Update bug.yml by [@jlowin](https://github.com/jlowin) in [#1331](https://github.com/jlowin/fastmcp/pull/1331)\n* Ensure validation errors are raised when masked by [@jlowin](https://github.com/jlowin) in [#1330](https://github.com/jlowin/fastmcp/pull/1330)\n\n## New Contributors\n* [@mariotaddeucci](https://github.com/mariotaddeucci) made their first contribution in [#1194](https://github.com/jlowin/fastmcp/pull/1194)\n* [@algirdasci](https://github.com/algirdasci) made their first contribution in [#1208](https://github.com/jlowin/fastmcp/pull/1208)\n* [@chughtapan](https://github.com/chughtapan) made their first contribution in [#1222](https://github.com/jlowin/fastmcp/pull/1222)\n* [@mukulmurthy](https://github.com/mukulmurthy) made their first contribution in [#1160](https://github.com/jlowin/fastmcp/pull/1160)\n* [@orweis](https://github.com/orweis) made their first contribution in [#1226](https://github.com/jlowin/fastmcp/pull/1226)\n* [@Sourav-Tripathy](https://github.com/Sourav-Tripathy) made their first contribution in [#1229](https://github.com/jlowin/fastmcp/pull/1229)\n* [@adam-conway](https://github.com/adam-conway) made their first contribution in [#1239](https://github.com/jlowin/fastmcp/pull/1239)\n* [@muhammadkhalid-03](https://github.com/muhammadkhalid-03) made their first contribution in [#1257](https://github.com/jlowin/fastmcp/pull/1257)\n* [@jbn](https://github.com/jbn) made their first contribution in [#1278](https://github.com/jlowin/fastmcp/pull/1278)\n* [@dacamposol](https://github.com/dacamposol) made their first contribution in [#1287](https://github.com/jlowin/fastmcp/pull/1287)\n* [@chi2liu](https://github.com/chi2liu) made their first contribution in [#1322](https://github.com/jlowin/fastmcp/pull/1322)\n* [@cjermain](https://github.com/cjermain) made their first contribution in [#1326](https://github.com/jlowin/fastmcp/pull/1326)\n\n**Full Changelog**: [v2.10.6...v2.11.0](https://github.com/jlowin/fastmcp/compare/v2.10.6...v2.11.0)\n\n</Update>\n\n<Update label=\"v2.10.6\" description=\"2025-07-19\">\n\n## [v2.10.6: Hymn for the Weekend](https://github.com/jlowin/fastmcp/releases/tag/v2.10.6)\n\nA special Saturday release with many fixes.\n\n## What's Changed\n### Enhancements \ud83d\udd27\n* Resolve #1139 -- Implement include_context argument in Context.sample by [@codingjoe](https://github.com/codingjoe) in [#1141](https://github.com/jlowin/fastmcp/pull/1141)\n* feat(settings): add log level normalization by [@ka2048](https://github.com/ka2048) in [#1171](https://github.com/jlowin/fastmcp/pull/1171)\n* add server name to mounted server warnings by [@artificial-aidan](https://github.com/artificial-aidan) in [#1147](https://github.com/jlowin/fastmcp/pull/1147)\n* Add StatefulProxyClient by [@hopeful0](https://github.com/hopeful0) in [#1109](https://github.com/jlowin/fastmcp/pull/1109)\n### Fixes \ud83d\udc1e\n* Fix OpenAPI empty parameters by [@FabrizioSandri](https://github.com/FabrizioSandri) in [#1128](https://github.com/jlowin/fastmcp/pull/1128)\n* Fix title field preservation in tool transformations by [@jlowin](https://github.com/jlowin) in [#1131](https://github.com/jlowin/fastmcp/pull/1131)\n* Fix optional parameter validation in OpenAPI integration by [@jlowin](https://github.com/jlowin) in [#1135](https://github.com/jlowin/fastmcp/pull/1135)\n* Do not silently exclude the \"context\" key from JSON body by [@melkamar](https://github.com/melkamar) in [#1153](https://github.com/jlowin/fastmcp/pull/1153)\n* Fix tool output schema generation to respect Pydantic serialization aliases by [@zzstoatzz](https://github.com/zzstoatzz) in [#1148](https://github.com/jlowin/fastmcp/pull/1148)\n* fix: _replace_ref_with_defs; ensure ref_path is string by [@itaru2622](https://github.com/itaru2622) in [#1164](https://github.com/jlowin/fastmcp/pull/1164)\n* Fix nesting when making OpenAPI arrays and objects optional by [@melkamar](https://github.com/melkamar) in [#1178](https://github.com/jlowin/fastmcp/pull/1178)\n* Fix `mcp-json` output format to include server name by [@jlowin](https://github.com/jlowin) in [#1185](https://github.com/jlowin/fastmcp/pull/1185)\n* Only configure logging one time by [@jlowin](https://github.com/jlowin) in [#1187](https://github.com/jlowin/fastmcp/pull/1187)\n### Docs \ud83d\udcda\n* Update changelog.mdx by [@jlowin](https://github.com/jlowin) in [#1127](https://github.com/jlowin/fastmcp/pull/1127)\n* Eunomia Authorization with native FastMCP's Middleware by [@tommitt](https://github.com/tommitt) in [#1144](https://github.com/jlowin/fastmcp/pull/1144)\n* update api ref for new `mdxify` version by [@zzstoatzz](https://github.com/zzstoatzz) in [#1182](https://github.com/jlowin/fastmcp/pull/1182)\n### Other Changes \ud83e\uddbe\n* Expand empty parameter filtering and add comprehensive tests by [@jlowin](https://github.com/jlowin) in [#1129](https://github.com/jlowin/fastmcp/pull/1129)\n* Add no-commit-to-branch hook by [@zzstoatzz](https://github.com/zzstoatzz) in [#1149](https://github.com/jlowin/fastmcp/pull/1149)\n* Update README.md by [@jlowin](https://github.com/jlowin) in [#1165](https://github.com/jlowin/fastmcp/pull/1165)\n* skip on rate limit by [@zzstoatzz](https://github.com/zzstoatzz) in [#1183](https://github.com/jlowin/fastmcp/pull/1183)\n* Remove deprecated proxy creation by [@jlowin](https://github.com/jlowin) in [#1186](https://github.com/jlowin/fastmcp/pull/1186)\n* Separate integration tests from unit tests in CI by [@jlowin](https://github.com/jlowin) in [#1188](https://github.com/jlowin/fastmcp/pull/1188)\n\n## New Contributors\n* [@FabrizioSandri](https://github.com/FabrizioSandri) made their first contribution in [#1128](https://github.com/jlowin/fastmcp/pull/1128)\n* [@melkamar](https://github.com/melkamar) made their first contribution in [#1153](https://github.com/jlowin/fastmcp/pull/1153)\n* [@codingjoe](https://github.com/codingjoe) made their first contribution in [#1141](https://github.com/jlowin/fastmcp/pull/1141)\n* [@itaru2622](https://github.com/itaru2622) made their first contribution in [#1164](https://github.com/jlowin/fastmcp/pull/1164)\n* [@ka2048](https://github.com/ka2048) made their first contribution in [#1171](https://github.com/jlowin/fastmcp/pull/1171)\n* [@artificial-aidan](https://github.com/artificial-aidan) made their first contribution in [#1147](https://github.com/jlowin/fastmcp/pull/1147)\n\n**Full Changelog**: [v2.10.5...v2.10.6](https://github.com/jlowin/fastmcp/compare/v2.10.5...v2.10.6)\n\n</Update>\n\n<Update label=\"v2.10.5\" description=\"2025-07-11\">\n\n## [v2.10.5: Middle Management](https://github.com/jlowin/fastmcp/releases/tag/v2.10.5)\n\nA maintenance release focused on OpenAPI refinements and middleware fixes, plus console improvements.\n\n## What's Changed\n### Enhancements \ud83d\udd27\n* Fix Claude Code CLI detection for npm global installations by [@jlowin](https://github.com/jlowin) in [#1106](https://github.com/jlowin/fastmcp/pull/1106)\n* Fix OpenAPI parameter name collisions with location suffixing by [@jlowin](https://github.com/jlowin) in [#1107](https://github.com/jlowin/fastmcp/pull/1107)\n* Add mirrored component support for proxy servers by [@jlowin](https://github.com/jlowin) in [#1105](https://github.com/jlowin/fastmcp/pull/1105)\n### Fixes \ud83d\udc1e\n* Fix OpenAPI deepObject style parameter encoding by [@jlowin](https://github.com/jlowin) in [#1122](https://github.com/jlowin/fastmcp/pull/1122)\n* xfail when github token is not set ('' or None) by [@jlowin](https://github.com/jlowin) in [#1123](https://github.com/jlowin/fastmcp/pull/1123)\n* fix: replace oneOf with anyOf in OpenAPI output schemas by [@MagnusS0](https://github.com/MagnusS0) in [#1119](https://github.com/jlowin/fastmcp/pull/1119)\n* Fix middleware list result types by [@jlowin](https://github.com/jlowin) in [#1125](https://github.com/jlowin/fastmcp/pull/1125)\n* Improve console width for logo by [@jlowin](https://github.com/jlowin) in [#1126](https://github.com/jlowin/fastmcp/pull/1126)\n### Docs \ud83d\udcda\n* Improve transport + integration docs by [@jlowin](https://github.com/jlowin) in [#1103](https://github.com/jlowin/fastmcp/pull/1103)\n* Update proxy.mdx by [@coldfire-x](https://github.com/coldfire-x) in [#1108](https://github.com/jlowin/fastmcp/pull/1108)\n### Other Changes \ud83e\uddbe\n* Update github remote server tests with secret by [@jlowin](https://github.com/jlowin) in [#1112](https://github.com/jlowin/fastmcp/pull/1112)\n\n## New Contributors\n* [@coldfire-x](https://github.com/coldfire-x) made their first contribution in [#1108](https://github.com/jlowin/fastmcp/pull/1108)\n* [@MagnusS0](https://github.com/MagnusS0) made their first contribution in [#1119](https://github.com/jlowin/fastmcp/pull/1119)\n\n**Full Changelog**: [v2.10.4...v2.10.5](https://github.com/jlowin/fastmcp/compare/v2.10.4...v2.10.5)\n\n</Update>\n\n<Update label=\"v2.10.4\" description=\"2025-07-09\">\n\n## [v2.10.4: Transport-ation](https://github.com/jlowin/fastmcp/releases/tag/v2.10.4)\n\nA quick fix to ensure the CLI accepts \"streamable-http\" as a valid transport option.\n\n## What's Changed\n### Fixes \ud83d\udc1e\n* Ensure the CLI accepts \"streamable-http\" as a valid transport by [@jlowin](https://github.com/jlowin) in [#1099](https://github.com/jlowin/fastmcp/pull/1099)\n\n**Full Changelog**: [v2.10.3...v2.10.4](https://github.com/jlowin/fastmcp/compare/v2.10.3...v2.10.4)\n\n</Update>\n\n<Update label=\"v2.10.3\" description=\"2025-07-09\">\n\n## [v2.10.3: CLI Me a River](https://github.com/jlowin/fastmcp/releases/tag/v2.10.3)\n\nA major CLI overhaul featuring a complete refactor from typer to cyclopts, new IDE integrations, and comprehensive OpenAPI improvements.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Refactor CLI from typer to cyclopts and add comprehensive tests by [@jlowin](https://github.com/jlowin) in [#1062](https://github.com/jlowin/fastmcp/pull/1062)\n* Add output schema support for OpenAPI tools by [@jlowin](https://github.com/jlowin) in [#1073](https://github.com/jlowin/fastmcp/pull/1073)\n### Enhancements \ud83d\udd27\n* Add Cursor support via CLI integration by [@jlowin](https://github.com/jlowin) in [#1052](https://github.com/jlowin/fastmcp/pull/1052)\n* Add Claude Code install integration by [@jlowin](https://github.com/jlowin) in [#1053](https://github.com/jlowin/fastmcp/pull/1053)\n* Generate MCP JSON config output from CLI as new `fastmcp install` command by [@jlowin](https://github.com/jlowin) in [#1056](https://github.com/jlowin/fastmcp/pull/1056)\n* Use isawaitable instead of iscoroutine by [@jlowin](https://github.com/jlowin) in [#1059](https://github.com/jlowin/fastmcp/pull/1059)\n* feat: Add `--path` Option to CLI for HTTP/SSE Route by [@davidbk-legit](https://github.com/davidbk-legit) in [#1087](https://github.com/jlowin/fastmcp/pull/1087)\n* Fix concurrent proxy client operations with session isolation by [@jlowin](https://github.com/jlowin) in [#1083](https://github.com/jlowin/fastmcp/pull/1083)\n### Fixes \ud83d\udc1e\n* Refactor Client context management to avoid concurrency issue by [@hopeful0](https://github.com/hopeful0) in [#1054](https://github.com/jlowin/fastmcp/pull/1054)\n* Keep json schema $defs on transform by [@strawgate](https://github.com/strawgate) in [#1066](https://github.com/jlowin/fastmcp/pull/1066)\n* Ensure fastmcp version copy is plaintext by [@jlowin](https://github.com/jlowin) in [#1071](https://github.com/jlowin/fastmcp/pull/1071)\n* Fix single-element list unwrapping in tool content by [@jlowin](https://github.com/jlowin) in [#1074](https://github.com/jlowin/fastmcp/pull/1074)\n* Fix max recursion error when pruning OpenAPI definitions by [@dimitribarbot](https://github.com/dimitribarbot) in [#1092](https://github.com/jlowin/fastmcp/pull/1092)\n* Fix OpenAPI tool name registration when modified by mcp_component_fn by [@jlowin](https://github.com/jlowin) in [#1096](https://github.com/jlowin/fastmcp/pull/1096)\n### Docs \ud83d\udcda\n* Docs: add example of more concise way to use bearer auth by [@neilconway](https://github.com/neilconway) in [#1055](https://github.com/jlowin/fastmcp/pull/1055)\n* Update favicon by [@jlowin](https://github.com/jlowin) in [#1058](https://github.com/jlowin/fastmcp/pull/1058)\n* Update environment note by [@jlowin](https://github.com/jlowin) in [#1075](https://github.com/jlowin/fastmcp/pull/1075)\n* Add fastmcp version --copy documentation by [@jlowin](https://github.com/jlowin) in [#1076](https://github.com/jlowin/fastmcp/pull/1076)\n### Other Changes \ud83e\uddbe\n* Remove asserts and add documentation following #1054 by [@jlowin](https://github.com/jlowin) in [#1057](https://github.com/jlowin/fastmcp/pull/1057)\n* Add --copy flag for fastmcp version by [@jlowin](https://github.com/jlowin) in [#1063](https://github.com/jlowin/fastmcp/pull/1063)\n* Fix docstring format for fastmcp.client.Client by [@neilconway](https://github.com/neilconway) in [#1094](https://github.com/jlowin/fastmcp/pull/1094)\n\n## New Contributors\n* [@neilconway](https://github.com/neilconway) made their first contribution in [#1055](https://github.com/jlowin/fastmcp/pull/1055)\n* [@davidbk-legit](https://github.com/davidbk-legit) made their first contribution in [#1087](https://github.com/jlowin/fastmcp/pull/1087)\n* [@dimitribarbot](https://github.com/dimitribarbot) made their first contribution in [#1092](https://github.com/jlowin/fastmcp/pull/1092)\n\n**Full Changelog**: [v2.10.2...v2.10.3](https://github.com/jlowin/fastmcp/compare/v2.10.2...v2.10.3)\n\n</Update>\n\n<Update label=\"v2.10.2\" description=\"2025-07-05\">\n\n## [v2.10.2: Forward March](https://github.com/jlowin/fastmcp/releases/tag/v2.10.2)\n\nThe headline feature of this release is the ability to \"forward\" advanced MCP interactions like logging, progress, and elicitation through proxy servers. If the remote server requests an elicitation, the proxy client will pass that request to the new, \"ultimate\" client.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Proxy support advanced MCP features by [@hopeful0](https://github.com/hopeful0) in [#1022](https://github.com/jlowin/fastmcp/pull/1022)\n### Enhancements \ud83d\udd27\n* Re-add splash screen by [@jlowin](https://github.com/jlowin) in [#1027](https://github.com/jlowin/fastmcp/pull/1027)\n* Reduce banner padding by [@jlowin](https://github.com/jlowin) in [#1030](https://github.com/jlowin/fastmcp/pull/1030)\n* Allow per-server timeouts in MCPConfig by [@cegersdoerfer](https://github.com/cegersdoerfer) in [#1031](https://github.com/jlowin/fastmcp/pull/1031)\n* Support 'scp' claim for OAuth scopes in BearerAuthProvider by [@jlowin](https://github.com/jlowin) in [#1033](https://github.com/jlowin/fastmcp/pull/1033)\n* Add path expansion to image/audio/file by [@jlowin](https://github.com/jlowin) in [#1038](https://github.com/jlowin/fastmcp/pull/1038)\n* Ensure multi-client configurations use new ProxyClient by [@jlowin](https://github.com/jlowin) in [#1045](https://github.com/jlowin/fastmcp/pull/1045)\n### Fixes \ud83d\udc1e\n* Expose stateless_http kwarg for mcp.run() by [@jlowin](https://github.com/jlowin) in [#1018](https://github.com/jlowin/fastmcp/pull/1018)\n* Avoid propagating logs by [@jlowin](https://github.com/jlowin) in [#1042](https://github.com/jlowin/fastmcp/pull/1042)\n### Docs \ud83d\udcda\n* Clean up docs by [@jlowin](https://github.com/jlowin) in [#1028](https://github.com/jlowin/fastmcp/pull/1028)\n* Docs: clarify server URL paths for ChatGPT integration by [@thap2331](https://github.com/thap2331) in [#1017](https://github.com/jlowin/fastmcp/pull/1017)\n### Other Changes \ud83e\uddbe\n* Split giant openapi test file into smaller files by [@jlowin](https://github.com/jlowin) in [#1034](https://github.com/jlowin/fastmcp/pull/1034)\n* Add comprehensive OpenAPI 3.0 vs 3.1 compatibility tests by [@jlowin](https://github.com/jlowin) in [#1035](https://github.com/jlowin/fastmcp/pull/1035)\n* Update banner and use console.log by [@jlowin](https://github.com/jlowin) in [#1041](https://github.com/jlowin/fastmcp/pull/1041)\n\n## New Contributors\n* [@cegersdoerfer](https://github.com/cegersdoerfer) made their first contribution in [#1031](https://github.com/jlowin/fastmcp/pull/1031)\n* [@hopeful0](https://github.com/hopeful0) made their first contribution in [#1022](https://github.com/jlowin/fastmcp/pull/1022)\n* [@thap2331](https://github.com/thap2331) made their first contribution in [#1017](https://github.com/jlowin/fastmcp/pull/1017)\n\n**Full Changelog**: [v2.10.1...v2.10.2](https://github.com/jlowin/fastmcp/compare/v2.10.1...v2.10.2)\n\n</Update>\n\n<Update label=\"v2.10.1\" description=\"2025-07-02\">\n\n## [v2.10.1: Revert to Sender](https://github.com/jlowin/fastmcp/releases/tag/v2.10.1)\n\nA quick patch to revert the CLI banner that was added in v2.10.0.\n\n## What's Changed\n### Docs \ud83d\udcda\n* Update changelog.mdx by [@jlowin](https://github.com/jlowin) in [#1009](https://github.com/jlowin/fastmcp/pull/1009)\n* Revert \"Add CLI banner\" by [@jlowin](https://github.com/jlowin) in [#1011](https://github.com/jlowin/fastmcp/pull/1011)\n\n**Full Changelog**: [v2.10.0...v2.10.1](https://github.com/jlowin/fastmcp/compare/v2.10.0...v2.10.1)\n\n</Update>\n\n<Update label=\"v2.10.0\" description=\"2024-07-01\">\n\n## [v2.10.0: Great Spec-tations](https://github.com/jlowin/fastmcp/releases/tag/v2.10.0)\n\nFastMCP 2.10 brings full compliance with the 6/18/2025 MCP spec update, introducing elicitation support for dynamic server-client communication and output schemas for structured tool responses. Please note that due to these changes, this release also includes a breaking change to the return signature of `client.call_tool()`.\n\n### Elicitation Support\nElicitation allows MCP servers to request additional information from clients during tool execution, enabling more interactive and dynamic server behavior. This opens up new possibilities for tools that need user input or confirmation during execution.\n\n### Output Schemas\nTools can now define structured output schemas, ensuring that responses conform to expected formats and making tool integration more predictable and type-safe.\n\n## What's Changed\n### New Features \ud83c\udf89\n* MCP 6/18/25: Add output schema to tools by [@jlowin](https://github.com/jlowin) in [#901](https://github.com/jlowin/fastmcp/pull/901)\n* MCP 6/18/25: Elicitation support by [@jlowin](https://github.com/jlowin) in [#889](https://github.com/jlowin/fastmcp/pull/889)\n### Enhancements \ud83d\udd27\n* Update types + tests for SDK changes by [@jlowin](https://github.com/jlowin) in [#888](https://github.com/jlowin/fastmcp/pull/888)\n* MCP 6/18/25: Update auth primitives by [@jlowin](https://github.com/jlowin) in [#966](https://github.com/jlowin/fastmcp/pull/966)\n* Add OpenAPI extensions support to HTTPRoute by [@maddymanu](https://github.com/maddymanu) in [#977](https://github.com/jlowin/fastmcp/pull/977)\n* Add title field support to FastMCP components by [@jlowin](https://github.com/jlowin) in [#982](https://github.com/jlowin/fastmcp/pull/982)\n* Support implicit Elicitation acceptance by [@jlowin](https://github.com/jlowin) in [#983](https://github.com/jlowin/fastmcp/pull/983)\n* Support 'no response' elicitation requests by [@jlowin](https://github.com/jlowin) in [#992](https://github.com/jlowin/fastmcp/pull/992)\n* Add Support for Configurable Algorithms by [@sstene1](https://github.com/sstene1) in [#997](https://github.com/jlowin/fastmcp/pull/997)\n### Fixes \ud83d\udc1e\n* Improve stdio error handling to raise connection failures immediately by [@jlowin](https://github.com/jlowin) in [#984](https://github.com/jlowin/fastmcp/pull/984)\n* Fix type hints for FunctionResource:fn by [@CfirTsabari](https://github.com/CfirTsabari) in [#986](https://github.com/jlowin/fastmcp/pull/986)\n* Update link to OpenAI MCP example by [@mossbanay](https://github.com/mossbanay) in [#985](https://github.com/jlowin/fastmcp/pull/985)\n* Fix output schema generation edge case by [@jlowin](https://github.com/jlowin) in [#995](https://github.com/jlowin/fastmcp/pull/995)\n* Refactor array parameter formatting to reduce code duplication by [@jlowin](https://github.com/jlowin) in [#1007](https://github.com/jlowin/fastmcp/pull/1007)\n* Fix OpenAPI array parameter explode handling by [@jlowin](https://github.com/jlowin) in [#1008](https://github.com/jlowin/fastmcp/pull/1008)\n### Breaking Changes \ud83d\udeeb\n* MCP 6/18/25: Upgrade to mcp 1.10 by [@jlowin](https://github.com/jlowin) in [#887](https://github.com/jlowin/fastmcp/pull/887)\n### Docs \ud83d\udcda\n* Update middleware imports and documentation by [@jlowin](https://github.com/jlowin) in [#999](https://github.com/jlowin/fastmcp/pull/999)\n* Update OpenAI docs by [@jlowin](https://github.com/jlowin) in [#1001](https://github.com/jlowin/fastmcp/pull/1001)\n* Add CLI banner by [@jlowin](https://github.com/jlowin) in [#1005](https://github.com/jlowin/fastmcp/pull/1005)\n### Examples & Contrib \ud83d\udca1\n* Component Manager by [@gorocode](https://github.com/gorocode) in [#976](https://github.com/jlowin/fastmcp/pull/976)\n### Other Changes \ud83e\uddbe\n* Minor auth improvements by [@jlowin](https://github.com/jlowin) in [#967](https://github.com/jlowin/fastmcp/pull/967)\n* Add .ccignore for copychat by [@jlowin](https://github.com/jlowin) in [#1000](https://github.com/jlowin/fastmcp/pull/1000)\n\n## New Contributors\n* [@maddymanu](https://github.com/maddymanu) made their first contribution in [#977](https://github.com/jlowin/fastmcp/pull/977)\n* [@github0hello](https://github.com/github0hello) made their first contribution in [#979](https://github.com/jlowin/fastmcp/pull/979)\n* [@tommitt](https://github.com/tommitt) made their first contribution in [#975](https://github.com/jlowin/fastmcp/pull/975)\n* [@CfirTsabari](https://github.com/CfirTsabari) made their first contribution in [#986](https://github.com/jlowin/fastmcp/pull/986)\n* [@mossbanay](https://github.com/mossbanay) made their first contribution in [#985](https://github.com/jlowin/fastmcp/pull/985)\n* [@sstene1](https://github.com/sstene1) made their first contribution in [#997](https://github.com/jlowin/fastmcp/pull/997)\n\n**Full Changelog**: [v2.9.2...v2.10.0](https://github.com/jlowin/fastmcp/compare/v2.9.2...v2.10.0)\n\n</Update>\n\n<Update label=\"v2.9.2\" description=\"2024-06-26\">\n\n## [v2.9.2: Safety Pin](https://github.com/jlowin/fastmcp/releases/tag/v2.9.2)\n\nThis is a patch release to pin `mcp` below 1.10, which includes changes related to the 6/18/2025 MCP spec update and could potentially break functionality for some FastMCP users.\n\n## What's Changed\n### Docs \ud83d\udcda\n* Fix version badge for messages by [@jlowin](https://github.com/jlowin) in [#960](https://github.com/jlowin/fastmcp/pull/960)\n### Dependencies \ud83d\udce6\n* Pin mcp dependency by [@jlowin](https://github.com/jlowin) in [#962](https://github.com/jlowin/fastmcp/pull/962)\n\n**Full Changelog**: [v2.9.1...v2.9.2](https://github.com/jlowin/fastmcp/compare/v2.9.1...v2.9.2)\n\n</Update>\n\n<Update label=\"v2.9.1\" description=\"2024-06-26\">\n\n## [v2.9.1: Call Me Maybe](https://github.com/jlowin/fastmcp/releases/tag/v2.9.1)\n\nFastMCP 2.9.1 introduces automatic MCP list change notifications, allowing servers to notify clients when tools, resources, or prompts are dynamically updated. This enables more responsive and adaptive MCP integrations.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Add automatic MCP list change notifications and client message handling by [@jlowin](https://github.com/jlowin) in [#939](https://github.com/jlowin/fastmcp/pull/939)\n### Enhancements \ud83d\udd27\n* Add debug logging to bearer token authentication by [@jlowin](https://github.com/jlowin) in [#952](https://github.com/jlowin/fastmcp/pull/952)\n### Fixes \ud83d\udc1e\n* Fix duplicate error logging in exception handlers by [@jlowin](https://github.com/jlowin) in [#938](https://github.com/jlowin/fastmcp/pull/938)\n* Fix parameter location enum handling in OpenAPI parser by [@jlowin](https://github.com/jlowin) in [#953](https://github.com/jlowin/fastmcp/pull/953)\n* Fix external schema reference handling in OpenAPI parser by [@jlowin](https://github.com/jlowin) in [#954](https://github.com/jlowin/fastmcp/pull/954)\n### Docs \ud83d\udcda\n* Update changelog for 2.9 release by [@jlowin](https://github.com/jlowin) in [#929](https://github.com/jlowin/fastmcp/pull/929)\n* Regenerate API references by [@zzstoatzz](https://github.com/zzstoatzz) in [#935](https://github.com/jlowin/fastmcp/pull/935)\n* Regenerate API references by [@zzstoatzz](https://github.com/zzstoatzz) in [#947](https://github.com/jlowin/fastmcp/pull/947)\n* Regenerate API references by [@zzstoatzz](https://github.com/zzstoatzz) in [#949](https://github.com/jlowin/fastmcp/pull/949)\n### Examples & Contrib \ud83d\udca1\n* Add `create_thread` tool to bsky MCP server by [@zzstoatzz](https://github.com/zzstoatzz) in [#927](https://github.com/jlowin/fastmcp/pull/927)\n* Update `mount_example.py` to work with current fastmcp API by [@rajephon](https://github.com/rajephon) in [#957](https://github.com/jlowin/fastmcp/pull/957)\n\n## New Contributors\n* [@rajephon](https://github.com/rajephon) made their first contribution in [#957](https://github.com/jlowin/fastmcp/pull/957)\n\n**Full Changelog**: [v2.9.0...v2.9.1](https://github.com/jlowin/fastmcp/compare/v2.9.0...v2.9.1)\n\n</Update>\n\n<Update label=\"v2.9.0\" description=\"2024-06-23\">\n\n## [v2.9.0: Stuck in the Middleware With You](https://github.com/jlowin/fastmcp/releases/tag/v2.9.0)\n\nFastMCP 2.9 introduces two important features that push beyond the basic MCP protocol: MCP Middleware and server-side type conversion.\n\n### MCP Middleware\nMCP middleware lets you intercept and modify requests and responses at the protocol level, giving you powerful capabilities for logging, authentication, validation, and more. This is particularly useful for building production-ready MCP servers that need sophisticated request handling.\n\n### Server-side Type Conversion\nThis release also introduces server-side type conversion for prompt arguments, ensuring that data is properly formatted before being passed to your functions. This reduces the burden on individual tools and prompts to handle type validation and conversion.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Add File utility for binary data by [@gorocode](https://github.com/gorocode) in [#843](https://github.com/jlowin/fastmcp/pull/843)\n* Consolidate prefix logic into FastMCP methods by [@jlowin](https://github.com/jlowin) in [#861](https://github.com/jlowin/fastmcp/pull/861)\n* Add MCP Middleware by [@jlowin](https://github.com/jlowin) in [#870](https://github.com/jlowin/fastmcp/pull/870)\n* Implement server-side type conversion for prompt arguments by [@jlowin](https://github.com/jlowin) in [#908](https://github.com/jlowin/fastmcp/pull/908)\n### Enhancements \ud83d\udd27\n* Fix tool description indentation issue by [@zfflxx](https://github.com/zfflxx) in [#845](https://github.com/jlowin/fastmcp/pull/845)\n* Add version parameter to FastMCP constructor by [@mkyutani](https://github.com/mkyutani) in [#842](https://github.com/jlowin/fastmcp/pull/842)\n* Update version to not be positional by [@jlowin](https://github.com/jlowin) in [#848](https://github.com/jlowin/fastmcp/pull/848)\n* Add key to component by [@jlowin](https://github.com/jlowin) in [#869](https://github.com/jlowin/fastmcp/pull/869)\n* Add session_id property to Context for data sharing by [@jlowin](https://github.com/jlowin) in [#881](https://github.com/jlowin/fastmcp/pull/881)\n* Fix CORS documentation example by [@jlowin](https://github.com/jlowin) in [#895](https://github.com/jlowin/fastmcp/pull/895)\n### Fixes \ud83d\udc1e\n* \"report_progress missing passing related_request_id causes notifications not working\" by [@alexsee](https://github.com/alexsee) in [#838](https://github.com/jlowin/fastmcp/pull/838)\n* Fix JWT issuer validation to support string values per RFC 7519 by [@jlowin](https://github.com/jlowin) in [#892](https://github.com/jlowin/fastmcp/pull/892)\n* Fix BearerAuthProvider audience type annotations by [@jlowin](https://github.com/jlowin) in [#894](https://github.com/jlowin/fastmcp/pull/894)\n### Docs \ud83d\udcda\n* Add CLAUDE.md development guidelines by [@jlowin](https://github.com/jlowin) in [#880](https://github.com/jlowin/fastmcp/pull/880)\n* Update context docs for session_id property by [@jlowin](https://github.com/jlowin) in [#882](https://github.com/jlowin/fastmcp/pull/882)\n* Add API reference by [@zzstoatzz](https://github.com/zzstoatzz) in [#893](https://github.com/jlowin/fastmcp/pull/893)\n* Fix API ref rendering by [@zzstoatzz](https://github.com/zzstoatzz) in [#900](https://github.com/jlowin/fastmcp/pull/900)\n* Simplify docs nav by [@jlowin](https://github.com/jlowin) in [#902](https://github.com/jlowin/fastmcp/pull/902)\n* Add fastmcp inspect command by [@jlowin](https://github.com/jlowin) in [#904](https://github.com/jlowin/fastmcp/pull/904)\n* Update client docs by [@jlowin](https://github.com/jlowin) in [#912](https://github.com/jlowin/fastmcp/pull/912)\n* Update docs nav by [@jlowin](https://github.com/jlowin) in [#913](https://github.com/jlowin/fastmcp/pull/913)\n* Update integration documentation for Claude Desktop, ChatGPT, and Claude Code by [@jlowin](https://github.com/jlowin) in [#915](https://github.com/jlowin/fastmcp/pull/915)\n* Add http as an alias for streamable http by [@jlowin](https://github.com/jlowin) in [#917](https://github.com/jlowin/fastmcp/pull/917)\n* Clean up parameter documentation by [@jlowin](https://github.com/jlowin) in [#918](https://github.com/jlowin/fastmcp/pull/918)\n* Add middleware examples for timing, logging, rate limiting, and error handling by [@jlowin](https://github.com/jlowin) in [#919](https://github.com/jlowin/fastmcp/pull/919)\n* ControlFlow \u2192 FastMCP rename by [@jlowin](https://github.com/jlowin) in [#922](https://github.com/jlowin/fastmcp/pull/922)\n### Examples & Contrib \ud83d\udca1\n* Add contrib.mcp_mixin support for annotations by [@rsp2k](https://github.com/rsp2k) in [#860](https://github.com/jlowin/fastmcp/pull/860)\n* Add ATProto (Bluesky) MCP Server Example by [@zzstoatzz](https://github.com/zzstoatzz) in [#916](https://github.com/jlowin/fastmcp/pull/916)\n* Fix path in atproto example pyproject by [@zzstoatzz](https://github.com/zzstoatzz) in [#920](https://github.com/jlowin/fastmcp/pull/920)\n* Remove uv source in example by [@zzstoatzz](https://github.com/zzstoatzz) in [#921](https://github.com/jlowin/fastmcp/pull/921)\n\n## New Contributors\n* [@alexsee](https://github.com/alexsee) made their first contribution in [#838](https://github.com/jlowin/fastmcp/pull/838)\n* [@zfflxx](https://github.com/zfflxx) made their first contribution in [#845](https://github.com/jlowin/fastmcp/pull/845)\n* [@mkyutani](https://github.com/mkyutani) made their first contribution in [#842](https://github.com/jlowin/fastmcp/pull/842)\n* [@gorocode](https://github.com/gorocode) made their first contribution in [#843](https://github.com/jlowin/fastmcp/pull/843)\n* [@rsp2k](https://github.com/rsp2k) made their first contribution in [#860](https://github.com/jlowin/fastmcp/pull/860)\n* [@owtaylor](https://github.com/owtaylor) made their first contribution in [#897](https://github.com/jlowin/fastmcp/pull/897)\n* [@Jason-CKY](https://github.com/Jason-CKY) made their first contribution in [#906](https://github.com/jlowin/fastmcp/pull/906)\n\n**Full Changelog**: [v2.8.1...v2.9.0](https://github.com/jlowin/fastmcp/compare/v2.8.1...v2.9.0)\n\n</Update>\n\n<Update label=\"v2.8.1\" description=\"2024-06-15\">\n\n## [v2.8.1: Sound Judgement](https://github.com/jlowin/fastmcp/releases/tag/v2.8.1)\n\n2.8.1 introduces audio support, as well as minor fixes and updates for deprecated features.\n\n### Audio Support\nThis release adds support for audio content in MCP tools and resources, expanding FastMCP's multimedia capabilities beyond text and images.\n\n## What's Changed\n### New Features \ud83c\udf89\n* Add audio support by [@jlowin](https://github.com/jlowin) in [#833](https://github.com/jlowin/fastmcp/pull/833)\n### Enhancements \ud83d\udd27\n* Add flag for disabling deprecation warnings by [@jlowin](https://github.com/jlowin) in [#802](https://github.com/jlowin/fastmcp/pull/802)\n* Add examples to Tool Arg Param transformation by [@strawgate](https://github.com/strawgate) in [#806](https://github.com/jlowin/fastmcp/pull/806)\n### Fixes \ud83d\udc1e\n* Restore .settings access as deprecated by [@jlowin](https://github.com/jlowin) in [#800](https://github.com/jlowin/fastmcp/pull/800)\n* Ensure handling of false http kwargs correctly; removed unused kwarg by [@jlowin](https://github.com/jlowin) in [#804](https://github.com/jlowin/fastmcp/pull/804)\n* Bump mcp 1.9.4 by [@jlowin](https://github.com/jlowin) in [#835](https://github.com/jlowin/fastmcp/pull/835)\n### Docs \ud83d\udcda\n* Update changelog for 2.8.0 by [@jlowin](https://github.com/jlowin) in [#794](https://github.com/jlowin/fastmcp/pull/794)\n* Update welcome docs by [@jlowin](https://github.com/jlowin) in [#808](https://github.com/jlowin/fastmcp/pull/808)\n* Update headers in docs by [@jlowin](https://github.com/jlowin) in [#809](https://github.com/jlowin/fastmcp/pull/809)\n* Add MCP group to tutorials by [@jlowin](https://github.com/jlowin) in [#810](https://github.com/jlowin/fastmcp/pull/810)\n* Add Community section to documentation by [@zzstoatzz](https://github.com/zzstoatzz) in [#819](https://github.com/jlowin/fastmcp/pull/819)\n* Add 2.8 update by [@jlowin](https://github.com/jlowin) in [#821](https://github.com/jlowin/fastmcp/pull/821)\n* Embed YouTube videos in community showcase by [@zzstoatzz](https://github.com/zzstoatzz) in [#820](https://github.com/jlowin/fastmcp/pull/820)\n### Other Changes \ud83e\uddbe\n* Ensure http args are passed through by [@jlowin](https://github.com/jlowin) in [#803](https://github.com/jlowin/fastmcp/pull/803)\n* Fix install link in readme by [@jlowin](https://github.com/jlowin) in [#836](https://github.com/jlowin/fastmcp/pull/836)\n\n**Full Changelog**: [v2.8.0...v2.8.1](https://github.com/jlowin/fastmcp/compare/v2.8.0...v2.8.1)\n\n</Update>\n\n<Update label=\"v2.8.0\" description=\"2024-06-10\">\n\n## [v2.8.0: Transform and Roll Out](https://github.com/jlowin/fastmcp/releases/tag/v2.8.0)\n\nFastMCP 2.8.0 introduces powerful new ways to customize and control your MCP servers! \n\n### Tool Transformation\n\nThe highlight of this release is first-class [**Tool Transformation**](/patterns/tool-transformation), a new feature that lets you create enhanced variations of existing tools. You can now easily rename arguments, hide parameters, modify descriptions, and even wrap tools with custom validation or post-processing logic\u2014all without rewriting the original code. This makes it easier than ever to adapt generic tools for specific LLM use cases or to simplify complex APIs. Huge thanks to [@strawgate](https://github.com/strawgate) for partnering on this, starting with [#591](https://github.com/jlowin/fastmcp/discussions/591) and [#599](https://github.com/jlowin/fastmcp/pull/599) and continuing offline.\n\n### Component Control\nThis release also gives you more granular control over which components are exposed to clients. With new [**tag-based filtering**](/servers/server#tag-based-filtering), you can selectively enable or disable tools, resources, and prompts based on tags, perfect for managing different environments or user permissions. Complementing this, every component now supports being [programmatically enabled or disabled](/servers/tools#disabling-tools), offering dynamic control over your server's capabilities.\n\n### Tools-by-Default\nFinally, to improve compatibility with a wider range of LLM clients, this release changes the default behavior for OpenAPI integration: all API endpoints are now converted to `Tools` by default. This is a **breaking change** but pragmatically necessitated by the fact that the majority of MCP clients available today are, sadly, only compatible with MCP tools. Therefore, this change significantly simplifies the out-of-the-box experience and ensures your entire API is immediately accessible to any tool-using agent.\n\n## What's Changed\n### New Features \ud83c\udf89\n* First-class tool transformation by [@jlowin](https://github.com/jlowin) in [#745](https://github.com/jlowin/fastmcp/pull/745)\n* Support enable/disable for all FastMCP components (tools, prompts, resources, templates) by [@jlowin](https://github.com/jlowin) in [#781](https://github.com/jlowin/fastmcp/pull/781)\n* Add support for tag-based component filtering by [@jlowin](https://github.com/jlowin) in [#748](https://github.com/jlowin/fastmcp/pull/748)\n* Allow tag assignments for OpenAPI by [@jlowin](https://github.com/jlowin) in [#791](https://github.com/jlowin/fastmcp/pull/791)\n### Enhancements \ud83d\udd27\n* Create common base class for components by [@jlowin](https://github.com/jlowin) in [#776](https://github.com/jlowin/fastmcp/pull/776)\n* Move components to own file; add resource by [@jlowin](https://github.com/jlowin) in [#777](https://github.com/jlowin/fastmcp/pull/777)\n* Update FastMCP component with __eq__ and __repr__ by [@jlowin](https://github.com/jlowin) in [#779](https://github.com/jlowin/fastmcp/pull/779)\n* Remove open-ended and server-specific settings by [@jlowin](https://github.com/jlowin) in [#750](https://github.com/jlowin/fastmcp/pull/750)\n### Fixes \ud83d\udc1e\n* Ensure client is only initialized once by [@jlowin](https://github.com/jlowin) in [#758](https://github.com/jlowin/fastmcp/pull/758)\n* Fix field validator for resource by [@jlowin](https://github.com/jlowin) in [#778](https://github.com/jlowin/fastmcp/pull/778)\n* Ensure proxies can overwrite remote tools without falling back to the remote by [@jlowin](https://github.com/jlowin) in [#782](https://github.com/jlowin/fastmcp/pull/782)\n### Breaking Changes \ud83d\udeeb\n* Treat all openapi routes as tools by [@jlowin](https://github.com/jlowin) in [#788](https://github.com/jlowin/fastmcp/pull/788)\n* Fix issue with global OpenAPI tags by [@jlowin](https://github.com/jlowin) in [#792](https://github.com/jlowin/fastmcp/pull/792)\n### Docs \ud83d\udcda\n* Minor docs updates by [@jlowin](https://github.com/jlowin) in [#755](https://github.com/jlowin/fastmcp/pull/755)\n* Add 2.7 update by [@jlowin](https://github.com/jlowin) in [#756](https://github.com/jlowin/fastmcp/pull/756)\n* Reduce 2.7 image size by [@jlowin](https://github.com/jlowin) in [#757](https://github.com/jlowin/fastmcp/pull/757)\n* Update updates.mdx by [@jlowin](https://github.com/jlowin) in [#765](https://github.com/jlowin/fastmcp/pull/765)\n* Hide docs sidebar scrollbar by default by [@jlowin](https://github.com/jlowin) in [#766](https://github.com/jlowin/fastmcp/pull/766)\n* Add \"stop vibe testing\" to tutorials by [@jlowin](https://github.com/jlowin) in [#767](https://github.com/jlowin/fastmcp/pull/767)\n* Add docs links by [@jlowin](https://github.com/jlowin) in [#768](https://github.com/jlowin/fastmcp/pull/768)\n* Fix: updated variable name under Gemini remote client by [@yrangana](https://github.com/yrangana) in [#769](https://github.com/jlowin/fastmcp/pull/769)\n* Revert \"Hide docs sidebar scrollbar by default\" by [@jlowin](https://github.com/jlowin) in [#770](https://github.com/jlowin/fastmcp/pull/770)\n* Add updates by [@jlowin](https://github.com/jlowin) in [#773](https://github.com/jlowin/fastmcp/pull/773)\n* Add tutorials by [@jlowin](https://github.com/jlowin) in [#783](https://github.com/jlowin/fastmcp/pull/783)\n* Update LLM-friendly docs by [@jlowin](https://github.com/jlowin) in [#784](https://github.com/jlowin/fastmcp/pull/784)\n* Update oauth.mdx by [@JeremyCraigMartinez](https://github.com/JeremyCraigMartinez) in [#787](https://github.com/jlowin/fastmcp/pull/787)\n* Add changelog by [@jlowin](https://github.com/jlowin) in [#789](https://github.com/jlowin/fastmcp/pull/789)\n* Add tutorials by [@jlowin](https://github.com/jlowin) in [#790](https://github.com/jlowin/fastmcp/pull/790)\n* Add docs for tag-based filtering by [@jlowin](https://github.com/jlowin) in [#793](https://github.com/jlowin/fastmcp/pull/793)\n### Other Changes \ud83e\uddbe\n* Create dependabot.yml by [@jlowin](https://github.com/jlowin) in [#759](https://github.com/jlowin/fastmcp/pull/759)\n* Bump astral-sh/setup-uv from 3 to 6 by [@dependabot](https://github.com/dependabot) in [#760](https://github.com/jlowin/fastmcp/pull/760)\n* Add dependencies section to release by [@jlowin](https://github.com/jlowin) in [#761](https://github.com/jlowin/fastmcp/pull/761)\n* Remove extra imports for MCPConfig by [@Maanas-Verma](https://github.com/Maanas-Verma) in [#763](https://github.com/jlowin/fastmcp/pull/763)\n* Split out enhancements in release notes by [@jlowin](https://github.com/jlowin) in [#764](https://github.com/jlowin/fastmcp/pull/764)\n\n## New Contributors\n* [@dependabot](https://github.com/dependabot) made their first contribution in [#760](https://github.com/jlowin/fastmcp/pull/760)\n* [@Maanas-Verma](https://github.com/Maanas-Verma) made their first contribution in [#763](https://github.com/jlowin/fastmcp/pull/763)\n* [@JeremyCraigMartinez](https://github.com/JeremyCraigMartinez) made their first contribution in [#787](https://github.com/jlowin/fastmcp/pull/787)\n\n**Full Changelog**: [v2.7.1...v2.8.0](https://github.com/jlowin/fastmcp/compare/v2.7.1...v2.8.0)\n\n</Update>\n\n<Update label=\"v2.7.1\" description=\"2024-06-08\">\n\n## [v2.7.1: The Bearer Necessities](https://github.com/jlowin/fastmcp/releases/tag/v2.7.1)\n\nThis release primarily contains a fix for parsing string tokens that are provided to FastMCP clients.\n\n### New Features \ud83c\udf89\n\n* Respect cache setting, set default to 1 second by [@jlowin](https://github.com/jlowin) in [#747](https://github.com/jlowin/fastmcp/pull/747)\n\n### Fixes \ud83d\udc1e\n\n* Ensure event store is properly typed by [@jlowin](https://github.com/jlowin) in [#753](https://github.com/jlowin/fastmcp/pull/753)\n* Fix passing token string to client auth & add auth to MCPConfig clients by [@jlowin](https://github.com/jlowin) in [#754](https://github.com/jlowin/fastmcp/pull/754)\n\n### Docs \ud83d\udcda\n\n* Docs : fix client to mcp\\_client in Gemini example by [@yrangana](https://github.com/yrangana) in [#734](https://github.com/jlowin/fastmcp/pull/734)\n* update add tool docstring by [@strawgate](https://github.com/strawgate) in [#739](https://github.com/jlowin/fastmcp/pull/739)\n* Fix contrib link by [@richardkmichael](https://github.com/richardkmichael) in [#749](https://github.com/jlowin/fastmcp/pull/749)\n\n### Other Changes \ud83e\uddbe\n\n* Switch Pydantic defaults to kwargs by [@strawgate](https://github.com/strawgate) in [#731](https://github.com/jlowin/fastmcp/pull/731)\n* Fix Typo in CLI module by [@wfclark5](https://github.com/wfclark5) in [#737](https://github.com/jlowin/fastmcp/pull/737)\n* chore: fix prompt docstring by [@danb27](https://github.com/danb27) in [#752](https://github.com/jlowin/fastmcp/pull/752)\n* Add accept to excluded headers by [@jlowin](https://github.com/jlowin) in [#751](https://github.com/jlowin/fastmcp/pull/751)\n\n### New Contributors\n\n* [@wfclark5](https://github.com/wfclark5) made their first contribution in [#737](https://github.com/jlowin/fastmcp/pull/737)\n* [@richardkmichael](https://github.com/richardkmichael) made their first contribution in [#749](https://github.com/jlowin/fastmcp/pull/749)\n* [@danb27](https://github.com/danb27) made their first contribution in [#752](https://github.com/jlowin/fastmcp/pull/752)\n\n**Full Changelog**: [v2.7.0...v2.7.1](https://github.com/jlowin/fastmcp/compare/v2.7.0...v2.7.1)\n</Update>\n\n<Update label=\"v2.7.0\" description=\"2024-06-05\">\n\n## [v2.7.0: Pare Programming](https://github.com/jlowin/fastmcp/releases/tag/v2.7.0)\n\nThis is primarily a housekeeping release to remove or deprecate cruft that's accumulated since v1. Primarily, this release refactors FastMCP's internals in preparation for features planned in the next few major releases. However please note that as a result, this release has some minor breaking changes (which is why it's 2.7, not 2.6.2, in accordance with repo guidelines) though not to the core user-facing APIs.\n\n### Breaking Changes \ud83d\udeeb\n\n* decorators return the objects they create, not the decorated function\n* websockets is an optional dependency\n* methods on the server for automatically converting functions into tools/resources/prompts have been deprecated in favor of using the decorators directly\n\n### New Features \ud83c\udf89\n\n* allow passing flags to servers by [@zzstoatzz](https://github.com/zzstoatzz) in [#690](https://github.com/jlowin/fastmcp/pull/690)\n* replace $ref pointing to `#/components/schemas/` with `#/$defs/` by [@phateffect](https://github.com/phateffect) in [#697](https://github.com/jlowin/fastmcp/pull/697)\n* Split Tool into Tool and FunctionTool by [@jlowin](https://github.com/jlowin) in [#700](https://github.com/jlowin/fastmcp/pull/700)\n* Use strict basemodel for Prompt; relax from\\_function deprecation by [@jlowin](https://github.com/jlowin) in [#701](https://github.com/jlowin/fastmcp/pull/701)\n* Formalize resource/functionresource replationship by [@jlowin](https://github.com/jlowin) in [#702](https://github.com/jlowin/fastmcp/pull/702)\n* Formalize template/functiontemplate split by [@jlowin](https://github.com/jlowin) in [#703](https://github.com/jlowin/fastmcp/pull/703)\n* Support flexible @tool decorator call patterns by [@jlowin](https://github.com/jlowin) in [#706](https://github.com/jlowin/fastmcp/pull/706)\n* Ensure deprecation warnings have stacklevel=2 by [@jlowin](https://github.com/jlowin) in [#710](https://github.com/jlowin/fastmcp/pull/710)\n* Allow naked prompt decorator by [@jlowin](https://github.com/jlowin) in [#711](https://github.com/jlowin/fastmcp/pull/711)\n\n### Fixes \ud83d\udc1e\n\n* Updates / Fixes for Tool Content Conversion by [@strawgate](https://github.com/strawgate) in [#642](https://github.com/jlowin/fastmcp/pull/642)\n* Fix pr labeler permissions by [@jlowin](https://github.com/jlowin) in [#708](https://github.com/jlowin/fastmcp/pull/708)\n* remove -n auto by [@jlowin](https://github.com/jlowin) in [#709](https://github.com/jlowin/fastmcp/pull/709)\n* Fix links in README.md by [@alainivars](https://github.com/alainivars) in [#723](https://github.com/jlowin/fastmcp/pull/723)\n\nHappily, this release DOES permit the use of \"naked\" decorators to align with Pythonic practice:\n\n```python\n@mcp.tool\ndef my_tool():\n    ...\n```\n\n**Full Changelog**: [v2.6.2...v2.7.0](https://github.com/jlowin/fastmcp/compare/v2.6.2...v2.7.0)\n</Update>\n\n<Update label=\"v2.6.1\" description=\"2024-06-03\">\n\n## [v2.6.1: Blast Auth (second ignition)](https://github.com/jlowin/fastmcp/releases/tag/v2.6.1)\n\nThis is a patch release to restore py.typed in #686.\n\n### Docs \ud83d\udcda\n\n* Update readme by [@jlowin](https://github.com/jlowin) in [#679](https://github.com/jlowin/fastmcp/pull/679)\n* Add gemini tutorial by [@jlowin](https://github.com/jlowin) in [#680](https://github.com/jlowin/fastmcp/pull/680)\n* Fix : fix path error to CLI Documentation by [@yrangana](https://github.com/yrangana) in [#684](https://github.com/jlowin/fastmcp/pull/684)\n* Update auth docs by [@jlowin](https://github.com/jlowin) in [#687](https://github.com/jlowin/fastmcp/pull/687)\n\n### Other Changes \ud83e\uddbe\n\n* Remove deprecation notice by [@jlowin](https://github.com/jlowin) in [#677](https://github.com/jlowin/fastmcp/pull/677)\n* Delete server.py by [@jlowin](https://github.com/jlowin) in [#681](https://github.com/jlowin/fastmcp/pull/681)\n* Restore py.typed by [@jlowin](https://github.com/jlowin) in [#686](https://github.com/jlowin/fastmcp/pull/686)\n\n### New Contributors\n\n* [@yrangana](https://github.com/yrangana) made their first contribution in [#684](https://github.com/jlowin/fastmcp/pull/684)\n\n**Full Changelog**: [v2.6.0...v2.6.1](https://github.com/jlowin/fastmcp/compare/v2.6.0...v2.6.1)\n</Update>\n\n<Update label=\"v2.6.0\" description=\"2024-06-02\">\n\n## [v2.6.0: Blast Auth](https://github.com/jlowin/fastmcp/releases/tag/v2.6.0)\n\n### New Features \ud83c\udf89\n\n* Introduce MCP client oauth flow by [@jlowin](https://github.com/jlowin) in [#478](https://github.com/jlowin/fastmcp/pull/478)\n* Support providing tools at init by [@jlowin](https://github.com/jlowin) in [#647](https://github.com/jlowin/fastmcp/pull/647)\n* Simplify code for running servers in processes during tests by [@jlowin](https://github.com/jlowin) in [#649](https://github.com/jlowin/fastmcp/pull/649)\n* Add basic bearer auth for server and client by [@jlowin](https://github.com/jlowin) in [#650](https://github.com/jlowin/fastmcp/pull/650)\n* Support configuring bearer auth from env vars by [@jlowin](https://github.com/jlowin) in [#652](https://github.com/jlowin/fastmcp/pull/652)\n* feat(tool): add support for excluding arguments from tool definition by [@deepak-stratforge](https://github.com/deepak-stratforge) in [#626](https://github.com/jlowin/fastmcp/pull/626)\n* Add docs for server + client auth by [@jlowin](https://github.com/jlowin) in [#655](https://github.com/jlowin/fastmcp/pull/655)\n\n### Fixes \ud83d\udc1e\n\n* fix: Support concurrency in FastMcpProxy (and Client) by [@Sillocan](https://github.com/Sillocan) in [#635](https://github.com/jlowin/fastmcp/pull/635)\n* Ensure Client.close() cleans up client context appropriately by [@jlowin](https://github.com/jlowin) in [#643](https://github.com/jlowin/fastmcp/pull/643)\n* Update client.mdx: ClientError namespace by [@mjkaye](https://github.com/mjkaye) in [#657](https://github.com/jlowin/fastmcp/pull/657)\n\n### Docs \ud83d\udcda\n\n* Make FastMCPTransport support simulated Streamable HTTP Transport (didn't work) by [@jlowin](https://github.com/jlowin) in [#645](https://github.com/jlowin/fastmcp/pull/645)\n* Document exclude\\_args by [@jlowin](https://github.com/jlowin) in [#653](https://github.com/jlowin/fastmcp/pull/653)\n* Update welcome by [@jlowin](https://github.com/jlowin) in [#673](https://github.com/jlowin/fastmcp/pull/673)\n* Add Anthropic + Claude desktop integration guides by [@jlowin](https://github.com/jlowin) in [#674](https://github.com/jlowin/fastmcp/pull/674)\n* Minor docs design updates by [@jlowin](https://github.com/jlowin) in [#676](https://github.com/jlowin/fastmcp/pull/676)\n\n### Other Changes \ud83e\uddbe\n\n* Update test typing by [@jlowin](https://github.com/jlowin) in [#646](https://github.com/jlowin/fastmcp/pull/646)\n* Add OpenAI integration docs by [@jlowin](https://github.com/jlowin) in [#660](https://github.com/jlowin/fastmcp/pull/660)\n\n### New Contributors\n\n* [@Sillocan](https://github.com/Sillocan) made their first contribution in [#635](https://github.com/jlowin/fastmcp/pull/635)\n* [@deepak-stratforge](https://github.com/deepak-stratforge) made their first contribution in [#626](https://github.com/jlowin/fastmcp/pull/626)\n* [@mjkaye](https://github.com/mjkaye) made their first contribution in [#657](https://github.com/jlowin/fastmcp/pull/657)\n\n**Full Changelog**: [v2.5.2...v2.6.0](https://github.com/jlowin/fastmcp/compare/v2.5.2...v2.6.0)\n</Update>\n\n<Update label=\"v2.5.2\" description=\"2024-05-29\">\n\n## [v2.5.2: Stayin' Alive](https://github.com/jlowin/fastmcp/releases/tag/v2.5.2)\n\n### New Features \ud83c\udf89\n\n* Add graceful error handling for unreachable mounted servers by [@davenpi](https://github.com/davenpi) in [#605](https://github.com/jlowin/fastmcp/pull/605)\n* Improve type inference from client transport by [@jlowin](https://github.com/jlowin) in [#623](https://github.com/jlowin/fastmcp/pull/623)\n* Add keep\\_alive param to reuse subprocess by [@jlowin](https://github.com/jlowin) in [#624](https://github.com/jlowin/fastmcp/pull/624)\n\n### Fixes \ud83d\udc1e\n\n* Fix handling tools without descriptions by [@jlowin](https://github.com/jlowin) in [#610](https://github.com/jlowin/fastmcp/pull/610)\n* Don't print env vars to console when format is wrong by [@jlowin](https://github.com/jlowin) in [#615](https://github.com/jlowin/fastmcp/pull/615)\n* Ensure behavior-affecting headers are excluded when forwarding proxies/openapi by [@jlowin](https://github.com/jlowin) in [#620](https://github.com/jlowin/fastmcp/pull/620)\n\n### Docs \ud83d\udcda\n\n* Add notes about uv and claude desktop by [@jlowin](https://github.com/jlowin) in [#597](https://github.com/jlowin/fastmcp/pull/597)\n\n### Other Changes \ud83e\uddbe\n\n* add init\\_timeout for mcp client by [@jfouret](https://github.com/jfouret) in [#607](https://github.com/jlowin/fastmcp/pull/607)\n* Add init\\_timeout for mcp client (incl settings) by [@jlowin](https://github.com/jlowin) in [#609](https://github.com/jlowin/fastmcp/pull/609)\n* Support for uppercase letters at the log level by [@ksawaray](https://github.com/ksawaray) in [#625](https://github.com/jlowin/fastmcp/pull/625)\n\n### New Contributors\n\n* [@jfouret](https://github.com/jfouret) made their first contribution in [#607](https://github.com/jlowin/fastmcp/pull/607)\n* [@ksawaray](https://github.com/ksawaray) made their first contribution in [#625](https://github.com/jlowin/fastmcp/pull/625)\n\n**Full Changelog**: [v2.5.1...v2.5.2](https://github.com/jlowin/fastmcp/compare/v2.5.1...v2.5.2)\n</Update>\n\n<Update label=\"v2.5.1\" description=\"2024-05-24\">\n\n## [v2.5.1: Route Awakening (Part 2)](https://github.com/jlowin/fastmcp/releases/tag/v2.5.1)\n\n### Fixes \ud83d\udc1e\n\n* Ensure content-length is always stripped from client headers by [@jlowin](https://github.com/jlowin) in [#589](https://github.com/jlowin/fastmcp/pull/589)\n\n### Docs \ud83d\udcda\n\n* Fix redundant section of docs by [@jlowin](https://github.com/jlowin) in [#583](https://github.com/jlowin/fastmcp/pull/583)\n\n**Full Changelog**: [v2.5.0...v2.5.1](https://github.com/jlowin/fastmcp/compare/v2.5.0...v2.5.1)\n</Update>\n\n<Update label=\"v2.5.0\" description=\"2024-05-24\">\n\n## [v2.5.0: Route Awakening](https://github.com/jlowin/fastmcp/releases/tag/v2.5.0)\n\nThis release introduces completely new tools for generating and customizing MCP servers from OpenAPI specs and FastAPI apps, including popular requests like mechanisms for determining what routes map to what MCP components; renaming routes; and customizing the generated MCP components.\n\n### New Features \ud83c\udf89\n\n* Add FastMCP 1.0 server support for in-memory Client / Testing by [@jlowin](https://github.com/jlowin) in [#539](https://github.com/jlowin/fastmcp/pull/539)\n* Minor addition: add transport to stdio server in mcpconfig, with default by [@jlowin](https://github.com/jlowin) in [#555](https://github.com/jlowin/fastmcp/pull/555)\n* Raise an error if a Client is created with no servers in config by [@jlowin](https://github.com/jlowin) in [#554](https://github.com/jlowin/fastmcp/pull/554)\n* Expose model preferences in `Context.sample` for flexible model selection. by [@davenpi](https://github.com/davenpi) in [#542](https://github.com/jlowin/fastmcp/pull/542)\n* Ensure custom routes are respected by [@jlowin](https://github.com/jlowin) in [#558](https://github.com/jlowin/fastmcp/pull/558)\n* Add client method to send cancellation notifications by [@davenpi](https://github.com/davenpi) in [#563](https://github.com/jlowin/fastmcp/pull/563)\n* Enhance route map logic for include/exclude OpenAPI routes by [@jlowin](https://github.com/jlowin) in [#564](https://github.com/jlowin/fastmcp/pull/564)\n* Add tag-based route maps by [@jlowin](https://github.com/jlowin) in [#565](https://github.com/jlowin/fastmcp/pull/565)\n* Add advanced control of openAPI route creation by [@jlowin](https://github.com/jlowin) in [#566](https://github.com/jlowin/fastmcp/pull/566)\n* Make error masking configurable by [@jlowin](https://github.com/jlowin) in [#550](https://github.com/jlowin/fastmcp/pull/550)\n* Ensure client headers are passed through to remote servers by [@jlowin](https://github.com/jlowin) in [#575](https://github.com/jlowin/fastmcp/pull/575)\n* Use lowercase name for headers when comparing by [@jlowin](https://github.com/jlowin) in [#576](https://github.com/jlowin/fastmcp/pull/576)\n* Permit more flexible name generation for OpenAPI servers by [@jlowin](https://github.com/jlowin) in [#578](https://github.com/jlowin/fastmcp/pull/578)\n* Ensure that tools/templates/prompts are compatible with callable objects by [@jlowin](https://github.com/jlowin) in [#579](https://github.com/jlowin/fastmcp/pull/579)\n\n### Docs \ud83d\udcda\n\n* Add version badge for prefix formats by [@jlowin](https://github.com/jlowin) in [#537](https://github.com/jlowin/fastmcp/pull/537)\n* Add versioning note to docs by [@jlowin](https://github.com/jlowin) in [#551](https://github.com/jlowin/fastmcp/pull/551)\n* Bump 2.3.6 references to 2.4.0 by [@jlowin](https://github.com/jlowin) in [#567](https://github.com/jlowin/fastmcp/pull/567)\n\n**Full Changelog**: [v2.4.0...v2.5.0](https://github.com/jlowin/fastmcp/compare/v2.4.0...v2.5.0)\n</Update>\n\n<Update label=\"v2.4.0\" description=\"2024-05-21\">\n\n## [v2.4.0: Config and Conquer](https://github.com/jlowin/fastmcp/releases/tag/v2.4.0)\n\n**Note**: this release includes a backwards-incompatible change to how resources are prefixed when mounted in composed servers. However, it is only backwards-incompatible if users were running tests or manually loading resources by prefixed key; LLMs should not have any issue discovering the new route.\n\n### New Features \ud83c\udf89\n\n* Allow \\* Methods and all routes as tools shortcuts by [@jlowin](https://github.com/jlowin) in [#520](https://github.com/jlowin/fastmcp/pull/520)\n* Improved support for config dicts by [@jlowin](https://github.com/jlowin) in [#522](https://github.com/jlowin/fastmcp/pull/522)\n* Support creating clients from MCP config dicts, including multi-server clients by [@jlowin](https://github.com/jlowin) in [#527](https://github.com/jlowin/fastmcp/pull/527)\n* Make resource prefix format configurable by [@jlowin](https://github.com/jlowin) in [#534](https://github.com/jlowin/fastmcp/pull/534)\n\n### Fixes \ud83d\udc1e\n\n* Avoid hanging on initializing server session by [@jlowin](https://github.com/jlowin) in [#523](https://github.com/jlowin/fastmcp/pull/523)\n\n### Breaking Changes \ud83d\udeeb\n\n* Remove customizable separators; improve resource separator by [@jlowin](https://github.com/jlowin) in [#526](https://github.com/jlowin/fastmcp/pull/526)\n\n### Docs \ud83d\udcda\n\n* Improve client documentation by [@jlowin](https://github.com/jlowin) in [#517](https://github.com/jlowin/fastmcp/pull/517)\n\n### Other Changes \ud83e\uddbe\n\n* Ensure openapi path params are handled properly by [@jlowin](https://github.com/jlowin) in [#519](https://github.com/jlowin/fastmcp/pull/519)\n* better error when missing lifespan by [@zzstoatzz](https://github.com/zzstoatzz) in [#521](https://github.com/jlowin/fastmcp/pull/521)\n\n**Full Changelog**: [v2.3.5...v2.4.0](https://github.com/jlowin/fastmcp/compare/v2.3.5...v2.4.0)\n</Update>\n\n<Update label=\"v2.3.5\" description=\"2024-05-20\">\n\n## [v2.3.5: Making Progress](https://github.com/jlowin/fastmcp/releases/tag/v2.3.5)\n\n### New Features \ud83c\udf89\n\n* support messages in progress notifications by [@rickygenhealth](https://github.com/rickygenhealth) in [#471](https://github.com/jlowin/fastmcp/pull/471)\n* feat: Add middleware option in server.run by [@Maxi91f](https://github.com/Maxi91f) in [#475](https://github.com/jlowin/fastmcp/pull/475)\n* Add lifespan property to app by [@jlowin](https://github.com/jlowin) in [#483](https://github.com/jlowin/fastmcp/pull/483)\n* Update `fastmcp run` to work with remote servers by [@jlowin](https://github.com/jlowin) in [#491](https://github.com/jlowin/fastmcp/pull/491)\n* Add FastMCP.as\\_proxy() by [@jlowin](https://github.com/jlowin) in [#490](https://github.com/jlowin/fastmcp/pull/490)\n* Infer sse transport from urls containing /sse by [@jlowin](https://github.com/jlowin) in [#512](https://github.com/jlowin/fastmcp/pull/512)\n* Add progress handler to client by [@jlowin](https://github.com/jlowin) in [#513](https://github.com/jlowin/fastmcp/pull/513)\n* Store the initialize result on the client by [@jlowin](https://github.com/jlowin) in [#509](https://github.com/jlowin/fastmcp/pull/509)\n\n### Fixes \ud83d\udc1e\n\n* Remove patch and use upstream SSEServerTransport by [@jlowin](https://github.com/jlowin) in [#425](https://github.com/jlowin/fastmcp/pull/425)\n\n### Docs \ud83d\udcda\n\n* Update transport docs by [@jlowin](https://github.com/jlowin) in [#458](https://github.com/jlowin/fastmcp/pull/458)\n* update proxy docs + example by [@zzstoatzz](https://github.com/zzstoatzz) in [#460](https://github.com/jlowin/fastmcp/pull/460)\n* doc(asgi): Change custom route example to PlainTextResponse by [@mcw0933](https://github.com/mcw0933) in [#477](https://github.com/jlowin/fastmcp/pull/477)\n* Store FastMCP instance on app.state.fastmcp\\_server by [@jlowin](https://github.com/jlowin) in [#489](https://github.com/jlowin/fastmcp/pull/489)\n* Improve AGENTS.md overview by [@jlowin](https://github.com/jlowin) in [#492](https://github.com/jlowin/fastmcp/pull/492)\n* Update release numbers for anticipated version by [@jlowin](https://github.com/jlowin) in [#516](https://github.com/jlowin/fastmcp/pull/516)\n\n### Other Changes \ud83e\uddbe\n\n* run tests on all PRs by [@jlowin](https://github.com/jlowin) in [#468](https://github.com/jlowin/fastmcp/pull/468)\n* add null check by [@zzstoatzz](https://github.com/zzstoatzz) in [#473](https://github.com/jlowin/fastmcp/pull/473)\n* strict typing for `server.py` by [@zzstoatzz](https://github.com/zzstoatzz) in [#476](https://github.com/jlowin/fastmcp/pull/476)\n* Doc(quickstart): Fix import statements by [@mai-nakagawa](https://github.com/mai-nakagawa) in [#479](https://github.com/jlowin/fastmcp/pull/479)\n* Add labeler by [@jlowin](https://github.com/jlowin) in [#484](https://github.com/jlowin/fastmcp/pull/484)\n* Fix flaky timeout test by increasing timeout (#474) by [@davenpi](https://github.com/davenpi) in [#486](https://github.com/jlowin/fastmcp/pull/486)\n* Skipping `test_permission_error` if runner is root. by [@ZiadAmerr](https://github.com/ZiadAmerr) in [#502](https://github.com/jlowin/fastmcp/pull/502)\n* allow passing full uvicorn config by [@zzstoatzz](https://github.com/zzstoatzz) in [#504](https://github.com/jlowin/fastmcp/pull/504)\n* Skip timeout tests on windows by [@jlowin](https://github.com/jlowin) in [#514](https://github.com/jlowin/fastmcp/pull/514)\n\n### New Contributors\n\n* [@rickygenhealth](https://github.com/rickygenhealth) made their first contribution in [#471](https://github.com/jlowin/fastmcp/pull/471)\n* [@Maxi91f](https://github.com/Maxi91f) made their first contribution in [#475](https://github.com/jlowin/fastmcp/pull/475)\n* [@mcw0933](https://github.com/mcw0933) made their first contribution in [#477](https://github.com/jlowin/fastmcp/pull/477)\n* [@mai-nakagawa](https://github.com/mai-nakagawa) made their first contribution in [#479](https://github.com/jlowin/fastmcp/pull/479)\n* [@ZiadAmerr](https://github.com/ZiadAmerr) made their first contribution in [#502](https://github.com/jlowin/fastmcp/pull/502)\n\n**Full Changelog**: [v2.3.4...v2.3.5](https://github.com/jlowin/fastmcp/compare/v2.3.4...v2.3.5)\n</Update>\n\n<Update label=\"v2.3.4\" description=\"2024-05-15\">\n\n## [v2.3.4: Error Today, Gone Tomorrow](https://github.com/jlowin/fastmcp/releases/tag/v2.3.4)\n\n### New Features \ud83c\udf89\n\n* logging stack trace for easier debugging by [@jbkoh](https://github.com/jbkoh) in [#413](https://github.com/jlowin/fastmcp/pull/413)\n* add missing StreamableHttpTransport in client exports by [@yihuang](https://github.com/yihuang) in [#408](https://github.com/jlowin/fastmcp/pull/408)\n* Improve error handling for tools and resources by [@jlowin](https://github.com/jlowin) in [#434](https://github.com/jlowin/fastmcp/pull/434)\n* feat: add support for removing tools from server by [@davenpi](https://github.com/davenpi) in [#437](https://github.com/jlowin/fastmcp/pull/437)\n* Prune titles from JSONSchemas by [@jlowin](https://github.com/jlowin) in [#449](https://github.com/jlowin/fastmcp/pull/449)\n* Declare toolsChanged capability for stdio server. by [@davenpi](https://github.com/davenpi) in [#450](https://github.com/jlowin/fastmcp/pull/450)\n* Improve handling of exceptiongroups when raised in clients by [@jlowin](https://github.com/jlowin) in [#452](https://github.com/jlowin/fastmcp/pull/452)\n* Add timeout support to client by [@jlowin](https://github.com/jlowin) in [#455](https://github.com/jlowin/fastmcp/pull/455)\n\n### Fixes \ud83d\udc1e\n\n* Pin to mcp 1.8.1 to resolve callback deadlocks with SHTTP by [@jlowin](https://github.com/jlowin) in [#427](https://github.com/jlowin/fastmcp/pull/427)\n* Add reprs for OpenAPI objects by [@jlowin](https://github.com/jlowin) in [#447](https://github.com/jlowin/fastmcp/pull/447)\n* Ensure openapi defs for structured objects are loaded properly by [@jlowin](https://github.com/jlowin) in [#448](https://github.com/jlowin/fastmcp/pull/448)\n* Ensure tests run against correct python version by [@jlowin](https://github.com/jlowin) in [#454](https://github.com/jlowin/fastmcp/pull/454)\n* Ensure result is only returned if a new key was found by [@jlowin](https://github.com/jlowin) in [#456](https://github.com/jlowin/fastmcp/pull/456)\n\n### Docs \ud83d\udcda\n\n* Add documentation for tool removal by [@jlowin](https://github.com/jlowin) in [#440](https://github.com/jlowin/fastmcp/pull/440)\n\n### Other Changes \ud83e\uddbe\n\n* Deprecate passing settings to the FastMCP instance by [@jlowin](https://github.com/jlowin) in [#424](https://github.com/jlowin/fastmcp/pull/424)\n* Add path prefix to test by [@jlowin](https://github.com/jlowin) in [#432](https://github.com/jlowin/fastmcp/pull/432)\n\n### New Contributors\n\n* [@jbkoh](https://github.com/jbkoh) made their first contribution in [#413](https://github.com/jlowin/fastmcp/pull/413)\n* [@davenpi](https://github.com/davenpi) made their first contribution in [#437](https://github.com/jlowin/fastmcp/pull/437)\n\n**Full Changelog**: [v2.3.3...v2.3.4](https://github.com/jlowin/fastmcp/compare/v2.3.3...v2.3.4)\n</Update>\n\n<Update label=\"v2.3.3\" description=\"2024-05-10\">\n\n## [v2.3.3: SSE you later](https://github.com/jlowin/fastmcp/releases/tag/v2.3.3)\n\nThis is a hotfix for a bug introduced in 2.3.2 that broke SSE servers\n\n### Fixes \ud83d\udc1e\n\n* Fix bug that sets message path and sse path to same value by [@jlowin](https://github.com/jlowin) in [#405](https://github.com/jlowin/fastmcp/pull/405)\n\n### Docs \ud83d\udcda\n\n* Update composition docs by [@jlowin](https://github.com/jlowin) in [#403](https://github.com/jlowin/fastmcp/pull/403)\n\n### Other Changes \ud83e\uddbe\n\n* Add test for no prefix when importing by [@jlowin](https://github.com/jlowin) in [#404](https://github.com/jlowin/fastmcp/pull/404)\n\n**Full Changelog**: [v2.3.2...v2.3.3](https://github.com/jlowin/fastmcp/compare/v2.3.2...v2.3.3)\n</Update>\n\n<Update label=\"v2.3.2\" description=\"2024-05-10\">\n\n## [v2.3.2: Stuck in the Middleware With You](https://github.com/jlowin/fastmcp/releases/tag/v2.3.2)\n\n### New Features \ud83c\udf89\n\n* Allow users to pass middleware to starlette app constructors by [@jlowin](https://github.com/jlowin) in [#398](https://github.com/jlowin/fastmcp/pull/398)\n* Deprecate transport-specific methods on FastMCP server by [@jlowin](https://github.com/jlowin) in [#401](https://github.com/jlowin/fastmcp/pull/401)\n\n### Docs \ud83d\udcda\n\n* Update CLI docs by [@jlowin](https://github.com/jlowin) in [#402](https://github.com/jlowin/fastmcp/pull/402)\n\n### Other Changes \ud83e\uddbe\n\n* Adding 23 tests for CLI by [@didier-durand](https://github.com/didier-durand) in [#394](https://github.com/jlowin/fastmcp/pull/394)\n\n**Full Changelog**: [v2.3.1...v2.3.2](https://github.com/jlowin/fastmcp/compare/v2.3.1...v2.3.2)\n</Update>\n\n<Update label=\"v2.3.1\" description=\"2024-05-09\">\n\n## [v2.3.1: For Good-nests Sake](https://github.com/jlowin/fastmcp/releases/tag/v2.3.1)\n\nThis release primarily patches a long-standing bug with nested ASGI SSE servers.\n\n### Fixes \ud83d\udc1e\n\n* Fix tool result serialization when the tool returns a list by [@strawgate](https://github.com/strawgate) in [#379](https://github.com/jlowin/fastmcp/pull/379)\n* Ensure FastMCP handles nested SSE and SHTTP apps properly in ASGI frameworks by [@jlowin](https://github.com/jlowin) in [#390](https://github.com/jlowin/fastmcp/pull/390)\n\n### Docs \ud83d\udcda\n\n* Update transport docs by [@jlowin](https://github.com/jlowin) in [#377](https://github.com/jlowin/fastmcp/pull/377)\n* Add llms.txt to docs by [@jlowin](https://github.com/jlowin) in [#384](https://github.com/jlowin/fastmcp/pull/384)\n* Fixing various text typos by [@didier-durand](https://github.com/didier-durand) in [#385](https://github.com/jlowin/fastmcp/pull/385)\n\n### Other Changes \ud83e\uddbe\n\n* Adding a few tests to Image type by [@didier-durand](https://github.com/didier-durand) in [#387](https://github.com/jlowin/fastmcp/pull/387)\n* Adding tests for TimedCache by [@didier-durand](https://github.com/didier-durand) in [#388](https://github.com/jlowin/fastmcp/pull/388)\n\n### New Contributors\n\n* [@didier-durand](https://github.com/didier-durand) made their first contribution in [#385](https://github.com/jlowin/fastmcp/pull/385)\n\n**Full Changelog**: [v2.3.0...v2.3.1](https://github.com/jlowin/fastmcp/compare/v2.3.0...v2.3.1)\n</Update>\n\n<Update label=\"v2.3.0\" description=\"2024-05-08\">\n\n## [v2.3.0: Stream Me Up, Scotty](https://github.com/jlowin/fastmcp/releases/tag/v2.3.0)\n\n### New Features \ud83c\udf89\n\n* Add streaming support for HTTP transport by [@jlowin](https://github.com/jlowin) in [#365](https://github.com/jlowin/fastmcp/pull/365)\n* Support streaming HTTP transport in clients by [@jlowin](https://github.com/jlowin) in [#366](https://github.com/jlowin/fastmcp/pull/366)\n* Add streaming support to CLI by [@jlowin](https://github.com/jlowin) in [#367](https://github.com/jlowin/fastmcp/pull/367)\n\n### Fixes \ud83d\udc1e\n\n* Fix streaming transport initialization by [@jlowin](https://github.com/jlowin) in [#368](https://github.com/jlowin/fastmcp/pull/368)\n\n### Docs \ud83d\udcda\n\n* Update transport documentation for streaming support by [@jlowin](https://github.com/jlowin) in [#369](https://github.com/jlowin/fastmcp/pull/369)\n\n**Full Changelog**: [v2.2.10...v2.3.0](https://github.com/jlowin/fastmcp/compare/v2.2.10...v2.3.0)\n</Update>\n\n<Update label=\"v2.2.10\" description=\"2024-05-06\">\n\n## [v2.2.10: That's JSON Bourne](https://github.com/jlowin/fastmcp/releases/tag/v2.2.10)\n\n### Fixes \ud83d\udc1e\n\n* Disable automatic JSON parsing of tool args by [@jlowin](https://github.com/jlowin) in [#341](https://github.com/jlowin/fastmcp/pull/341)\n* Fix prompt test by [@jlowin](https://github.com/jlowin) in [#342](https://github.com/jlowin/fastmcp/pull/342)\n\n### Other Changes \ud83e\uddbe\n\n* Update docs.json by [@jlowin](https://github.com/jlowin) in [#338](https://github.com/jlowin/fastmcp/pull/338)\n* Add test coverage + tests on 4 examples by [@alainivars](https://github.com/alainivars) in [#306](https://github.com/jlowin/fastmcp/pull/306)\n\n### New Contributors\n\n* [@alainivars](https://github.com/alainivars) made their first contribution in [#306](https://github.com/jlowin/fastmcp/pull/306)\n\n**Full Changelog**: [v2.2.9...v2.2.10](https://github.com/jlowin/fastmcp/compare/v2.2.9...v2.2.10)\n</Update>\n\n<Update label=\"v2.2.9\" description=\"2024-05-06\">\n\n## [v2.2.9: Str-ing the Pot (Hotfix)](https://github.com/jlowin/fastmcp/releases/tag/v2.2.9)\n\nThis release is a hotfix for the issue detailed in #330\n\n### Fixes \ud83d\udc1e\n\n* Prevent invalid resource URIs by [@jlowin](https://github.com/jlowin) in [#336](https://github.com/jlowin/fastmcp/pull/336)\n* Coerce numbers to str by [@jlowin](https://github.com/jlowin) in [#337](https://github.com/jlowin/fastmcp/pull/337)\n\n### Docs \ud83d\udcda\n\n* Add client badge by [@jlowin](https://github.com/jlowin) in [#327](https://github.com/jlowin/fastmcp/pull/327)\n* Update bug.yml by [@jlowin](https://github.com/jlowin) in [#328](https://github.com/jlowin/fastmcp/pull/328)\n\n### Other Changes \ud83e\uddbe\n\n* Update quickstart.mdx example to include import by [@discdiver](https://github.com/discdiver) in [#329](https://github.com/jlowin/fastmcp/pull/329)\n\n### New Contributors\n\n* [@discdiver](https://github.com/discdiver) made their first contribution in [#329](https://github.com/jlowin/fastmcp/pull/329)\n\n**Full Changelog**: [v2.2.8...v2.2.9](https://github.com/jlowin/fastmcp/compare/v2.2.8...v2.2.9)\n</Update>\n\n<Update label=\"v2.2.8\" description=\"2024-05-05\">\n\n## [v2.2.8: Parse and Recreation](https://github.com/jlowin/fastmcp/releases/tag/v2.2.8)\n\n### New Features \ud83c\udf89\n\n* Replace custom parsing with TypeAdapter by [@jlowin](https://github.com/jlowin) in [#314](https://github.com/jlowin/fastmcp/pull/314)\n* Handle \\*args/\\*\\*kwargs appropriately for various components by [@jlowin](https://github.com/jlowin) in [#317](https://github.com/jlowin/fastmcp/pull/317)\n* Add timeout-graceful-shutdown as a default config for SSE app by [@jlowin](https://github.com/jlowin) in [#323](https://github.com/jlowin/fastmcp/pull/323)\n* Ensure prompts return descriptions by [@jlowin](https://github.com/jlowin) in [#325](https://github.com/jlowin/fastmcp/pull/325)\n\n### Fixes \ud83d\udc1e\n\n* Ensure that tool serialization has a graceful fallback by [@jlowin](https://github.com/jlowin) in [#310](https://github.com/jlowin/fastmcp/pull/310)\n\n### Docs \ud83d\udcda\n\n* Update docs for clarity by [@jlowin](https://github.com/jlowin) in [#312](https://github.com/jlowin/fastmcp/pull/312)\n\n### Other Changes \ud83e\uddbe\n\n* Remove is\\_async attribute by [@jlowin](https://github.com/jlowin) in [#315](https://github.com/jlowin/fastmcp/pull/315)\n* Dry out retrieving context kwarg by [@jlowin](https://github.com/jlowin) in [#316](https://github.com/jlowin/fastmcp/pull/316)\n\n**Full Changelog**: [v2.2.7...v2.2.8](https://github.com/jlowin/fastmcp/compare/v2.2.7...v2.2.8)\n</Update>\n\n<Update label=\"v2.2.7\" description=\"2024-05-03\">\n\n## [v2.2.7: You Auth to Know Better](https://github.com/jlowin/fastmcp/releases/tag/v2.2.7)\n\n### New Features \ud83c\udf89\n\n* use pydantic\\_core.to\\_json by [@jlowin](https://github.com/jlowin) in [#290](https://github.com/jlowin/fastmcp/pull/290)\n* Ensure openapi descriptions are included in tool details by [@jlowin](https://github.com/jlowin) in [#293](https://github.com/jlowin/fastmcp/pull/293)\n* Bump mcp to 1.7.1 by [@jlowin](https://github.com/jlowin) in [#298](https://github.com/jlowin/fastmcp/pull/298)\n* Add support for tool annotations by [@jlowin](https://github.com/jlowin) in [#299](https://github.com/jlowin/fastmcp/pull/299)\n* Add auth support by [@jlowin](https://github.com/jlowin) in [#300](https://github.com/jlowin/fastmcp/pull/300)\n* Add low-level methods to client by [@jlowin](https://github.com/jlowin) in [#301](https://github.com/jlowin/fastmcp/pull/301)\n* Add method for retrieving current starlette request to FastMCP context by [@jlowin](https://github.com/jlowin) in [#302](https://github.com/jlowin/fastmcp/pull/302)\n* get\\_starlette\\_request \u2192 get\\_http\\_request by [@jlowin](https://github.com/jlowin) in [#303](https://github.com/jlowin/fastmcp/pull/303)\n* Support custom Serializer for Tools by [@strawgate](https://github.com/strawgate) in [#308](https://github.com/jlowin/fastmcp/pull/308)\n* Support proxy mount by [@jlowin](https://github.com/jlowin) in [#309](https://github.com/jlowin/fastmcp/pull/309)\n\n### Other Changes \ud83e\uddbe\n\n* Improve context injection type checks by [@jlowin](https://github.com/jlowin) in [#291](https://github.com/jlowin/fastmcp/pull/291)\n* add readme to smarthome example by [@zzstoatzz](https://github.com/zzstoatzz) in [#294](https://github.com/jlowin/fastmcp/pull/294)\n\n**Full Changelog**: [v2.2.6...v2.2.7](https://github.com/jlowin/fastmcp/compare/v2.2.6...v2.2.7)\n</Update>\n\n<Update label=\"v2.2.6\" description=\"2024-04-30\">\n\n## [v2.2.6: The REST is History](https://github.com/jlowin/fastmcp/releases/tag/v2.2.6)\n\n### New Features \ud83c\udf89\n\n* Added feature : Load MCP server using config by [@sandipan1](https://github.com/sandipan1) in [#260](https://github.com/jlowin/fastmcp/pull/260)\n* small typing fixes by [@zzstoatzz](https://github.com/zzstoatzz) in [#237](https://github.com/jlowin/fastmcp/pull/237)\n* Expose configurable timeout for OpenAPI by [@jlowin](https://github.com/jlowin) in [#279](https://github.com/jlowin/fastmcp/pull/279)\n* Lower websockets pin for compatibility by [@jlowin](https://github.com/jlowin) in [#286](https://github.com/jlowin/fastmcp/pull/286)\n* Improve OpenAPI param handling by [@jlowin](https://github.com/jlowin) in [#287](https://github.com/jlowin/fastmcp/pull/287)\n\n### Fixes \ud83d\udc1e\n\n* Ensure openapi tool responses are properly converted by [@jlowin](https://github.com/jlowin) in [#283](https://github.com/jlowin/fastmcp/pull/283)\n* Fix OpenAPI examples by [@jlowin](https://github.com/jlowin) in [#285](https://github.com/jlowin/fastmcp/pull/285)\n* Fix client docs for advanced features, add tests for logging by [@jlowin](https://github.com/jlowin) in [#284](https://github.com/jlowin/fastmcp/pull/284)\n\n### Other Changes \ud83e\uddbe\n\n* add testing doc by [@jlowin](https://github.com/jlowin) in [#264](https://github.com/jlowin/fastmcp/pull/264)\n* #267 Fix openapi template resource to support multiple path parameters by [@jeger-at](https://github.com/jeger-at) in [#278](https://github.com/jlowin/fastmcp/pull/278)\n\n### New Contributors\n\n* [@sandipan1](https://github.com/sandipan1) made their first contribution in [#260](https://github.com/jlowin/fastmcp/pull/260)\n* [@jeger-at](https://github.com/jeger-at) made their first contribution in [#278](https://github.com/jlowin/fastmcp/pull/278)\n\n**Full Changelog**: [v2.2.5...v2.2.6](https://github.com/jlowin/fastmcp/compare/v2.2.5...v2.2.6)\n</Update>\n\n<Update label=\"v2.2.5\" description=\"2024-04-26\">\n\n## [v2.2.5: Context Switching](https://github.com/jlowin/fastmcp/releases/tag/v2.2.5)\n\n### New Features \ud83c\udf89\n\n* Add tests for tool return types; improve serialization behavior by [@jlowin](https://github.com/jlowin) in [#262](https://github.com/jlowin/fastmcp/pull/262)\n* Support context injection in resources, templates, and prompts (like tools) by [@jlowin](https://github.com/jlowin) in [#263](https://github.com/jlowin/fastmcp/pull/263)\n\n### Docs \ud83d\udcda\n\n* Update wildcards to 2.2.4 by [@jlowin](https://github.com/jlowin) in [#257](https://github.com/jlowin/fastmcp/pull/257)\n* Update note in templates docs by [@jlowin](https://github.com/jlowin) in [#258](https://github.com/jlowin/fastmcp/pull/258)\n* Significant documentation and test expansion for tool input types by [@jlowin](https://github.com/jlowin) in [#261](https://github.com/jlowin/fastmcp/pull/261)\n\n**Full Changelog**: [v2.2.4...v2.2.5](https://github.com/jlowin/fastmcp/compare/v2.2.4...v2.2.5)\n</Update>\n\n<Update label=\"v2.2.4\" description=\"2024-04-25\">\n\n## [v2.2.4: The Wild Side, Actually](https://github.com/jlowin/fastmcp/releases/tag/v2.2.4)\n\nThe wildcard URI templates exposed in v2.2.3 were blocked by a server-level check which is removed in this release.\n\n### New Features \ud83c\udf89\n\n* Allow customization of inspector proxy port, ui port, and version by [@jlowin](https://github.com/jlowin) in [#253](https://github.com/jlowin/fastmcp/pull/253)\n\n### Fixes \ud83d\udc1e\n\n* fix: unintended type convert by [@cutekibry](https://github.com/cutekibry) in [#252](https://github.com/jlowin/fastmcp/pull/252)\n* Ensure openapi resources return valid responses by [@jlowin](https://github.com/jlowin) in [#254](https://github.com/jlowin/fastmcp/pull/254)\n* Ensure servers expose template wildcards by [@jlowin](https://github.com/jlowin) in [#256](https://github.com/jlowin/fastmcp/pull/256)\n\n### Docs \ud83d\udcda\n\n* Update README.md Grammar error by [@TechWithTy](https://github.com/TechWithTy) in [#249](https://github.com/jlowin/fastmcp/pull/249)\n\n### Other Changes \ud83e\uddbe\n\n* Add resource template tests by [@jlowin](https://github.com/jlowin) in [#255](https://github.com/jlowin/fastmcp/pull/255)\n\n### New Contributors\n\n* [@TechWithTy](https://github.com/TechWithTy) made their first contribution in [#249](https://github.com/jlowin/fastmcp/pull/249)\n* [@cutekibry](https://github.com/cutekibry) made their first contribution in [#252](https://github.com/jlowin/fastmcp/pull/252)\n\n**Full Changelog**: [v2.2.3...v2.2.4](https://github.com/jlowin/fastmcp/compare/v2.2.3...v2.2.4)\n</Update>\n\n<Update label=\"v2.2.3\" description=\"2024-04-25\">\n\n## [v2.2.3: The Wild Side](https://github.com/jlowin/fastmcp/releases/tag/v2.2.3)\n\n### New Features \ud83c\udf89\n\n* Add wildcard params for resource templates by [@jlowin](https://github.com/jlowin) in [#246](https://github.com/jlowin/fastmcp/pull/246)\n\n### Docs \ud83d\udcda\n\n* Indicate that Image class is for returns by [@jlowin](https://github.com/jlowin) in [#242](https://github.com/jlowin/fastmcp/pull/242)\n* Update mermaid diagram by [@jlowin](https://github.com/jlowin) in [#243](https://github.com/jlowin/fastmcp/pull/243)\n\n### Other Changes \ud83e\uddbe\n\n* update version badges by [@jlowin](https://github.com/jlowin) in [#248](https://github.com/jlowin/fastmcp/pull/248)\n\n**Full Changelog**: [v2.2.2...v2.2.3](https://github.com/jlowin/fastmcp/compare/v2.2.2...v2.2.3)\n</Update>\n\n<Update label=\"v2.2.2\" description=\"2024-04-24\">\n\n## [v2.2.2: Prompt and Circumstance](https://github.com/jlowin/fastmcp/releases/tag/v2.2.2)\n\n### New Features \ud83c\udf89\n\n* Add prompt support by [@jlowin](https://github.com/jlowin) in [#235](https://github.com/jlowin/fastmcp/pull/235)\n\n### Fixes \ud83d\udc1e\n\n* Ensure that resource templates are properly exposed by [@jlowin](https://github.com/jlowin) in [#238](https://github.com/jlowin/fastmcp/pull/238)\n\n### Docs \ud83d\udcda\n\n* Update docs for prompts by [@jlowin](https://github.com/jlowin) in [#236](https://github.com/jlowin/fastmcp/pull/236)\n\n### Other Changes \ud83e\uddbe\n\n* Add prompt tests by [@jlowin](https://github.com/jlowin) in [#239](https://github.com/jlowin/fastmcp/pull/239)\n\n**Full Changelog**: [v2.2.1...v2.2.2](https://github.com/jlowin/fastmcp/compare/v2.2.1...v2.2.2)\n</Update>\n\n<Update label=\"v2.2.1\" description=\"2024-04-23\">\n\n## [v2.2.1: Template for Success](https://github.com/jlowin/fastmcp/releases/tag/v2.2.1)\n\n### New Features \ud83c\udf89\n\n* Add resource templates by [@jlowin](https://github.com/jlowin) in [#230](https://github.com/jlowin/fastmcp/pull/230)\n\n### Fixes \ud83d\udc1e\n\n* Ensure that resource templates are properly exposed by [@jlowin](https://github.com/jlowin) in [#231](https://github.com/jlowin/fastmcp/pull/231)\n\n### Docs \ud83d\udcda\n\n* Update docs for resource templates by [@jlowin](https://github.com/jlowin) in [#232](https://github.com/jlowin/fastmcp/pull/232)\n\n### Other Changes \ud83e\uddbe\n\n* Add resource template tests by [@jlowin](https://github.com/jlowin) in [#233](https://github.com/jlowin/fastmcp/pull/233)\n\n**Full Changelog**: [v2.2.0...v2.2.1](https://github.com/jlowin/fastmcp/compare/v2.2.0...v2.2.1)\n</Update>\n\n<Update label=\"v2.2.0\" description=\"2024-04-22\">\n\n## [v2.2.0: Compose Yourself](https://github.com/jlowin/fastmcp/releases/tag/v2.2.0)\n\n### New Features \ud83c\udf89\n\n* Add support for mounting FastMCP servers by [@jlowin](https://github.com/jlowin) in [#175](https://github.com/jlowin/fastmcp/pull/175)\n* Add support for duplicate behavior == ignore by [@jlowin](https://github.com/jlowin) in [#169](https://github.com/jlowin/fastmcp/pull/169)\n\n### Breaking Changes \ud83d\udeeb\n\n* Refactor MCP composition by [@jlowin](https://github.com/jlowin) in [#176](https://github.com/jlowin/fastmcp/pull/176)\n\n### Docs \ud83d\udcda\n\n* Improve integration documentation by [@jlowin](https://github.com/jlowin) in [#184](https://github.com/jlowin/fastmcp/pull/184)\n* Improve documentation by [@jlowin](https://github.com/jlowin) in [#185](https://github.com/jlowin/fastmcp/pull/185)\n\n### Other Changes \ud83e\uddbe\n\n* Add transport kwargs for mcp.run() and fastmcp run by [@jlowin](https://github.com/jlowin) in [#161](https://github.com/jlowin/fastmcp/pull/161)\n* Allow resource templates to have optional / excluded arguments by [@jlowin](https://github.com/jlowin) in [#164](https://github.com/jlowin/fastmcp/pull/164)\n* Update resources.mdx by [@jlowin](https://github.com/jlowin) in [#165](https://github.com/jlowin/fastmcp/pull/165)\n\n### New Contributors\n\n* [@kongqi404](https://github.com/kongqi404) made their first contribution in [#181](https://github.com/jlowin/fastmcp/pull/181)\n\n**Full Changelog**: [v2.1.2...v2.2.0](https://github.com/jlowin/fastmcp/compare/v2.1.2...v2.2.0)\n</Update>\n\n<Update label=\"v2.1.2\" description=\"2024-04-14\">\n\n## [v2.1.2: Copy That, Good Buddy](https://github.com/jlowin/fastmcp/releases/tag/v2.1.2)\n\nThe main improvement in this release is a fix that allows FastAPI / OpenAPI-generated servers to be mounted as sub-servers.\n\n### Fixes \ud83d\udc1e\n\n* Ensure objects are copied properly and test mounting fastapi by [@jlowin](https://github.com/jlowin) in [#153](https://github.com/jlowin/fastmcp/pull/153)\n\n### Docs \ud83d\udcda\n\n* Fix broken links in docs by [@jlowin](https://github.com/jlowin) in [#154](https://github.com/jlowin/fastmcp/pull/154)\n\n### Other Changes \ud83e\uddbe\n\n* Update README.md by [@jlowin](https://github.com/jlowin) in [#149](https://github.com/jlowin/fastmcp/pull/149)\n* Only apply log config to FastMCP loggers by [@jlowin](https://github.com/jlowin) in [#155](https://github.com/jlowin/fastmcp/pull/155)\n* Update pyproject.toml by [@jlowin](https://github.com/jlowin) in [#156](https://github.com/jlowin/fastmcp/pull/156)\n\n**Full Changelog**: [v2.1.1...v2.1.2](https://github.com/jlowin/fastmcp/compare/v2.1.1...v2.1.2)\n</Update>\n\n<Update label=\"v2.1.1\" description=\"2024-04-14\">\n\n## [v2.1.1: Doc Holiday](https://github.com/jlowin/fastmcp/releases/tag/v2.1.1)\n\nFastMCP's docs are now available at gofastmcp.com.\n\n### Docs \ud83d\udcda\n\n* Add docs by [@jlowin](https://github.com/jlowin) in [#136](https://github.com/jlowin/fastmcp/pull/136)\n* Add docs link to readme by [@jlowin](https://github.com/jlowin) in [#137](https://github.com/jlowin/fastmcp/pull/137)\n* Minor docs updates by [@jlowin](https://github.com/jlowin) in [#138](https://github.com/jlowin/fastmcp/pull/138)\n\n### Fixes \ud83d\udc1e\n\n* fix branch name in example by [@zzstoatzz](https://github.com/zzstoatzz) in [#140](https://github.com/jlowin/fastmcp/pull/140)\n\n### Other Changes \ud83e\uddbe\n\n* smart home example by [@zzstoatzz](https://github.com/zzstoatzz) in [#115](https://github.com/jlowin/fastmcp/pull/115)\n* Remove mac os tests by [@jlowin](https://github.com/jlowin) in [#142](https://github.com/jlowin/fastmcp/pull/142)\n* Expand support for various method interactions by [@jlowin](https://github.com/jlowin) in [#143](https://github.com/jlowin/fastmcp/pull/143)\n* Update docs and add\\_resource\\_fn by [@jlowin](https://github.com/jlowin) in [#144](https://github.com/jlowin/fastmcp/pull/144)\n* Update description by [@jlowin](https://github.com/jlowin) in [#145](https://github.com/jlowin/fastmcp/pull/145)\n* Support openapi 3.0 and 3.1 by [@jlowin](https://github.com/jlowin) in [#147](https://github.com/jlowin/fastmcp/pull/147)\n\n**Full Changelog**: [v2.1.0...v2.1.1](https://github.com/jlowin/fastmcp/compare/v2.1.0...v2.1.1)\n</Update>\n\n<Update label=\"v2.1.0\" description=\"2024-04-13\">\n\n## [v2.1.0: Tag, You're It](https://github.com/jlowin/fastmcp/releases/tag/v2.1.0)\n\nThe primary motivation for this release is the fix in #128 for Claude desktop compatibility, but the primary new feature of this release is per-object tags. Currently these are for bookkeeping only but will become useful in future releases.\n\n### New Features \ud83c\udf89\n\n* Add tags for all core MCP objects by [@jlowin](https://github.com/jlowin) in [#121](https://github.com/jlowin/fastmcp/pull/121)\n* Ensure that openapi tags are transferred to MCP objects by [@jlowin](https://github.com/jlowin) in [#124](https://github.com/jlowin/fastmcp/pull/124)\n\n### Fixes \ud83d\udc1e\n\n* Change default mounted tool separator from / to \\_ by [@jlowin](https://github.com/jlowin) in [#128](https://github.com/jlowin/fastmcp/pull/128)\n* Enter mounted app lifespans by [@jlowin](https://github.com/jlowin) in [#129](https://github.com/jlowin/fastmcp/pull/129)\n* Fix CLI that called mcp instead of fastmcp by [@jlowin](https://github.com/jlowin) in [#128](https://github.com/jlowin/fastmcp/pull/128)\n\n### Breaking Changes \ud83d\udeeb\n\n* Changed configuration for duplicate resources/tools/prompts by [@jlowin](https://github.com/jlowin) in [#121](https://github.com/jlowin/fastmcp/pull/121)\n* Improve client return types by [@jlowin](https://github.com/jlowin) in [#123](https://github.com/jlowin/fastmcp/pull/123)\n\n### Other Changes \ud83e\uddbe\n\n* Add tests for tags in server decorators by [@jlowin](https://github.com/jlowin) in [#122](https://github.com/jlowin/fastmcp/pull/122)\n* Clean up server tests by [@jlowin](https://github.com/jlowin) in [#125](https://github.com/jlowin/fastmcp/pull/125)\n\n**Full Changelog**: [v2.0.0...v2.1.0](https://github.com/jlowin/fastmcp/compare/v2.0.0...v2.1.0)\n</Update>\n\n<Update label=\"v2.0.0\" description=\"2024-04-11\">\n\n## [v2.0.0: Second to None](https://github.com/jlowin/fastmcp/releases/tag/v2.0.0)\n\n### New Features \ud83c\udf89\n\n* Support mounting FastMCP instances as sub-MCPs by [@jlowin](https://github.com/jlowin) in [#99](https://github.com/jlowin/fastmcp/pull/99)\n* Add in-memory client for calling FastMCP servers (and tests) by [@jlowin](https://github.com/jlowin) in [#100](https://github.com/jlowin/fastmcp/pull/100)\n* Add MCP proxy server by [@jlowin](https://github.com/jlowin) in [#105](https://github.com/jlowin/fastmcp/pull/105)\n* Update FastMCP for upstream changes by [@jlowin](https://github.com/jlowin) in [#107](https://github.com/jlowin/fastmcp/pull/107)\n* Generate FastMCP servers from OpenAPI specs and FastAPI by [@jlowin](https://github.com/jlowin) in [#110](https://github.com/jlowin/fastmcp/pull/110)\n* Reorganize all client / transports by [@jlowin](https://github.com/jlowin) in [#111](https://github.com/jlowin/fastmcp/pull/111)\n* Add sampling and roots by [@jlowin](https://github.com/jlowin) in [#117](https://github.com/jlowin/fastmcp/pull/117)\n\n### Fixes \ud83d\udc1e\n\n* Fix bug with tools that return lists by [@jlowin](https://github.com/jlowin) in [#116](https://github.com/jlowin/fastmcp/pull/116)\n\n### Other Changes \ud83e\uddbe\n\n* Add back FastMCP CLI by [@jlowin](https://github.com/jlowin) in [#108](https://github.com/jlowin/fastmcp/pull/108)\n* Update Readme for v2 by [@jlowin](https://github.com/jlowin) in [#112](https://github.com/jlowin/fastmcp/pull/112)\n* fix deprecation warnings by [@zzstoatzz](https://github.com/zzstoatzz) in [#113](https://github.com/jlowin/fastmcp/pull/113)\n* Readme by [@jlowin](https://github.com/jlowin) in [#118](https://github.com/jlowin/fastmcp/pull/118)\n* FastMCP 2.0 by [@jlowin](https://github.com/jlowin) in [#119](https://github.com/jlowin/fastmcp/pull/119)\n\n**Full Changelog**: [v1.0...v2.0.0](https://github.com/jlowin/fastmcp/compare/v1.0...v2.0.0)\n</Update>\n\n<Update label=\"v1.0\" description=\"2024-04-11\">\n\n## [v1.0: It's Official](https://github.com/jlowin/fastmcp/releases/tag/v1.0)\n\nThis release commemorates FastMCP 1.0, which is included in the official Model Context Protocol SDK:\n\n```python\nfrom mcp.server.fastmcp import FastMCP\n```\n\nTo the best of my knowledge, v1 is identical to the upstream version included with `mcp`.\n\n### Docs \ud83d\udcda\n\n* Update readme to redirect to the official SDK by [@jlowin](https://github.com/jlowin) in [#79](https://github.com/jlowin/fastmcp/pull/79)\n\n### Other Changes \ud83e\uddbe\n\n* fix: use Mount instead of Route for SSE message handling by [@samihamine](https://github.com/samihamine) in [#77](https://github.com/jlowin/fastmcp/pull/77)\n\n### New Contributors\n\n* [@samihamine](https://github.com/samihamine) made their first contribution in [#77](https://github.com/jlowin/fastmcp/pull/77)\n\n**Full Changelog**: [v0.4.1...v1.0](https://github.com/jlowin/fastmcp/compare/v0.4.1...v1.0)\n</Update>\n\n<Update label=\"v0.4.1\" description=\"2024-12-09\">\n\n## [v0.4.1: String Theory](https://github.com/jlowin/fastmcp/releases/tag/v0.4.1)\n\n### Fixes \ud83d\udc1e\n\n* fix: handle strings containing numbers correctly by [@sd2k](https://github.com/sd2k) in [#63](https://github.com/jlowin/fastmcp/pull/63)\n\n### Docs \ud83d\udcda\n\n* patch: Update pyproject.toml license by [@leonkozlowski](https://github.com/leonkozlowski) in [#67](https://github.com/jlowin/fastmcp/pull/67)\n\n### Other Changes \ud83e\uddbe\n\n* Avoid new try\\_eval\\_type unavailable with older pydantic by [@jurasofish](https://github.com/jurasofish) in [#57](https://github.com/jlowin/fastmcp/pull/57)\n* Decorator typing by [@jurasofish](https://github.com/jurasofish) in [#56](https://github.com/jlowin/fastmcp/pull/56)\n\n### New Contributors\n\n* [@leonkozlowski](https://github.com/leonkozlowski) made their first contribution in [#67](https://github.com/jlowin/fastmcp/pull/67)\n\n**Full Changelog**: [v0.4.0...v0.4.1](https://github.com/jlowin/fastmcp/compare/v0.4.0...v0.4.1)\n</Update>\n\n<Update label=\"v0.4.0\" description=\"2024-12-05\">\n\n## [v0.4.0: Nice to MIT You](https://github.com/jlowin/fastmcp/releases/tag/v0.4.0)\n\nThis is a relatively small release in terms of features, but the version is bumped to 0.4 to reflect that the code is being relicensed from Apache 2.0 to MIT. This is to facilitate FastMCP's inclusion in the official MCP SDK.\n\n### New Features \ud83c\udf89\n\n* Add pyright + tests by [@jlowin](https://github.com/jlowin) in [#52](https://github.com/jlowin/fastmcp/pull/52)\n* add pgvector memory example by [@zzstoatzz](https://github.com/zzstoatzz) in [#49](https://github.com/jlowin/fastmcp/pull/49)\n\n### Fixes \ud83d\udc1e\n\n* fix: use stderr for logging by [@sd2k](https://github.com/sd2k) in [#51](https://github.com/jlowin/fastmcp/pull/51)\n\n### Docs \ud83d\udcda\n\n* Update ai-labeler.yml by [@jlowin](https://github.com/jlowin) in [#48](https://github.com/jlowin/fastmcp/pull/48)\n* Relicense from Apache 2.0 to MIT by [@jlowin](https://github.com/jlowin) in [#54](https://github.com/jlowin/fastmcp/pull/54)\n\n### Other Changes \ud83e\uddbe\n\n* fix warning and flake by [@zzstoatzz](https://github.com/zzstoatzz) in [#47](https://github.com/jlowin/fastmcp/pull/47)\n\n### New Contributors\n\n* [@sd2k](https://github.com/sd2k) made their first contribution in [#51](https://github.com/jlowin/fastmcp/pull/51)\n\n**Full Changelog**: [v0.3.5...v0.4.0](https://github.com/jlowin/fastmcp/compare/v0.3.5...v0.4.0)\n</Update>\n\n<Update label=\"v0.3.5\" description=\"2024-12-03\">\n\n## [v0.3.5: Windows of Opportunity](https://github.com/jlowin/fastmcp/releases/tag/v0.3.5)\n\nThis release is highlighted by the ability to handle complex JSON objects as MCP inputs and improved Windows compatibility.\n\n### New Features \ud83c\udf89\n\n* Set up multiple os tests by [@jlowin](https://github.com/jlowin) in [#44](https://github.com/jlowin/fastmcp/pull/44)\n* Changes to accommodate windows users. by [@justjoehere](https://github.com/justjoehere) in [#42](https://github.com/jlowin/fastmcp/pull/42)\n* Handle complex inputs by [@jurasofish](https://github.com/jurasofish) in [#31](https://github.com/jlowin/fastmcp/pull/31)\n\n### Docs \ud83d\udcda\n\n* Make AI labeler more conservative by [@jlowin](https://github.com/jlowin) in [#46](https://github.com/jlowin/fastmcp/pull/46)\n\n### Other Changes \ud83e\uddbe\n\n* Additional Windows Fixes for Dev running and for importing modules in a server by [@justjoehere](https://github.com/justjoehere) in [#43](https://github.com/jlowin/fastmcp/pull/43)\n\n### New Contributors\n\n* [@justjoehere](https://github.com/justjoehere) made their first contribution in [#42](https://github.com/jlowin/fastmcp/pull/42)\n* [@jurasofish](https://github.com/jurasofish) made their first contribution in [#31](https://github.com/jlowin/fastmcp/pull/31)\n\n**Full Changelog**: [v0.3.4...v0.3.5](https://github.com/jlowin/fastmcp/compare/v0.3.4...v0.3.5)\n</Update>\n\n<Update label=\"v0.3.4\" description=\"2024-12-02\">\n\n## [v0.3.4: URL's Well That Ends Well](https://github.com/jlowin/fastmcp/releases/tag/v0.3.4)\n\n### Fixes \ud83d\udc1e\n\n* Handle missing config file when installing by [@jlowin](https://github.com/jlowin) in [#37](https://github.com/jlowin/fastmcp/pull/37)\n* Remove BaseURL reference and use AnyURL by [@jlowin](https://github.com/jlowin) in [#40](https://github.com/jlowin/fastmcp/pull/40)\n\n**Full Changelog**: [v0.3.3...v0.3.4](https://github.com/jlowin/fastmcp/compare/v0.3.3...v0.3.4)\n</Update>\n\n<Update label=\"v0.3.3\" description=\"2024-12-02\">\n\n## [v0.3.3: Dependence Day](https://github.com/jlowin/fastmcp/releases/tag/v0.3.3)\n\n### New Features \ud83c\udf89\n\n* Surge example by [@zzstoatzz](https://github.com/zzstoatzz) in [#29](https://github.com/jlowin/fastmcp/pull/29)\n* Support Python dependencies in Server by [@jlowin](https://github.com/jlowin) in [#34](https://github.com/jlowin/fastmcp/pull/34)\n\n### Docs \ud83d\udcda\n\n* add `Contributing` section to README by [@zzstoatzz](https://github.com/zzstoatzz) in [#32](https://github.com/jlowin/fastmcp/pull/32)\n\n**Full Changelog**: [v0.3.2...v0.3.3](https://github.com/jlowin/fastmcp/compare/v0.3.2...v0.3.3)\n</Update>\n\n<Update label=\"v0.3.2\" date=\"2024-12-01\" description=\"Green with ENVy\">\n\n## [v0.3.2: Green with ENVy](https://github.com/jlowin/fastmcp/releases/tag/v0.3.2)\n\n### New Features \ud83c\udf89\n\n* Support env vars when installing by [@jlowin](https://github.com/jlowin) in [#27](https://github.com/jlowin/fastmcp/pull/27)\n\n### Docs \ud83d\udcda\n\n* Remove top level env var by [@jlowin](https://github.com/jlowin) in [#28](https://github.com/jlowin/fastmcp/pull/28)\n\n**Full Changelog**: [v0.3.1...v0.3.2](https://github.com/jlowin/fastmcp/compare/v0.3.1...v0.3.2)\n</Update>\n\n<Update label=\"v0.3.1\" description=\"2024-12-01\">\n\n## [v0.3.1](https://github.com/jlowin/fastmcp/releases/tag/v0.3.1)\n\n### New Features \ud83c\udf89\n\n* Update README.md by [@jlowin](https://github.com/jlowin) in [#23](https://github.com/jlowin/fastmcp/pull/23)\n* add rich handler and dotenv loading for settings by [@zzstoatzz](https://github.com/zzstoatzz) in [#22](https://github.com/jlowin/fastmcp/pull/22)\n* print exception when server can't start by [@jlowin](https://github.com/jlowin) in [#25](https://github.com/jlowin/fastmcp/pull/25)\n\n### Docs \ud83d\udcda\n\n* Update README.md by [@jlowin](https://github.com/jlowin) in [#24](https://github.com/jlowin/fastmcp/pull/24)\n\n### Other Changes \ud83e\uddbe\n\n* Remove log by [@jlowin](https://github.com/jlowin) in [#26](https://github.com/jlowin/fastmcp/pull/26)\n\n**Full Changelog**: [v0.3.0...v0.3.1](https://github.com/jlowin/fastmcp/compare/v0.3.0...v0.3.1)\n</Update>\n\n<Update label=\"v0.3.0\" description=\"2024-12-01\">\n\n## [v0.3.0: Prompt and Circumstance](https://github.com/jlowin/fastmcp/releases/tag/v0.3.0)\n\n### New Features \ud83c\udf89\n\n* Update README by [@jlowin](https://github.com/jlowin) in [#3](https://github.com/jlowin/fastmcp/pull/3)\n* Make log levels strings by [@jlowin](https://github.com/jlowin) in [#4](https://github.com/jlowin/fastmcp/pull/4)\n* Make content method a function by [@jlowin](https://github.com/jlowin) in [#5](https://github.com/jlowin/fastmcp/pull/5)\n* Add template support by [@jlowin](https://github.com/jlowin) in [#6](https://github.com/jlowin/fastmcp/pull/6)\n* Refactor resources module by [@jlowin](https://github.com/jlowin) in [#7](https://github.com/jlowin/fastmcp/pull/7)\n* Clean up cli imports by [@jlowin](https://github.com/jlowin) in [#8](https://github.com/jlowin/fastmcp/pull/8)\n* Prepare to list templates by [@jlowin](https://github.com/jlowin) in [#11](https://github.com/jlowin/fastmcp/pull/11)\n* Move image to separate module by [@jlowin](https://github.com/jlowin) in [#9](https://github.com/jlowin/fastmcp/pull/9)\n* Add support for request context, progress, logging, etc. by [@jlowin](https://github.com/jlowin) in [#12](https://github.com/jlowin/fastmcp/pull/12)\n* Add context tests and better runtime loads by [@jlowin](https://github.com/jlowin) in [#13](https://github.com/jlowin/fastmcp/pull/13)\n* Refactor tools + resourcemanager by [@jlowin](https://github.com/jlowin) in [#14](https://github.com/jlowin/fastmcp/pull/14)\n* func \u2192 fn everywhere by [@jlowin](https://github.com/jlowin) in [#15](https://github.com/jlowin/fastmcp/pull/15)\n* Add support for prompts by [@jlowin](https://github.com/jlowin) in [#16](https://github.com/jlowin/fastmcp/pull/16)\n* Create LICENSE by [@jlowin](https://github.com/jlowin) in [#18](https://github.com/jlowin/fastmcp/pull/18)\n* Update cli file spec by [@jlowin](https://github.com/jlowin) in [#19](https://github.com/jlowin/fastmcp/pull/19)\n* Update readmeUpdate README by [@jlowin](https://github.com/jlowin) in [#20](https://github.com/jlowin/fastmcp/pull/20)\n* Use hatchling for version by [@jlowin](https://github.com/jlowin) in [#21](https://github.com/jlowin/fastmcp/pull/21)\n\n### Other Changes \ud83e\uddbe\n\n* Add echo server by [@jlowin](https://github.com/jlowin) in [#1](https://github.com/jlowin/fastmcp/pull/1)\n* Add github workflows by [@jlowin](https://github.com/jlowin) in [#2](https://github.com/jlowin/fastmcp/pull/2)\n* typing updates by [@zzstoatzz](https://github.com/zzstoatzz) in [#17](https://github.com/jlowin/fastmcp/pull/17)\n\n### New Contributors\n\n* [@jlowin](https://github.com/jlowin) made their first contribution in [#1](https://github.com/jlowin/fastmcp/pull/1)\n* [@zzstoatzz](https://github.com/zzstoatzz) made their first contribution in [#17](https://github.com/jlowin/fastmcp/pull/17)\n\n**Full Changelog**: [v0.2.0...v0.3.0](https://github.com/jlowin/fastmcp/compare/v0.2.0...v0.3.0)\n</Update>\n\n<Update label=\"v0.2.0\" description=\"2024-11-30\">\n\n## [v0.2.0](https://github.com/jlowin/fastmcp/releases/tag/v0.2.0)\n\n**Full Changelog**: [v0.1.0...v0.2.0](https://github.com/jlowin/fastmcp/compare/v0.1.0...v0.2.0)\n</Update>\n\n<Update label=\"v0.1.0\" description=\"2024-11-30\">\n\n## [v0.1.0](https://github.com/jlowin/fastmcp/releases/tag/v0.1.0)\n\nThe very first release of FastMCP! \ud83c\udf89\n\n**Full Changelog**: [Initial commits](https://github.com/jlowin/fastmcp/commits/v0.1.0)\n</Update>"}, {"filename": "docs/clients/auth/bearer.mdx", "content": "---\ntitle: Bearer Token Authentication\nsidebarTitle: Bearer Auth\ndescription: Authenticate your FastMCP client with a Bearer token.\nicon: key\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.6.0\" />\n\n<Tip>\nBearer Token authentication is only relevant for HTTP-based transports.\n</Tip>\n\nYou can configure your FastMCP client to use **bearer authentication** by supplying a valid access token. This is most appropriate for service accounts, long-lived API keys, CI/CD, applications where authentication is managed separately, or other non-interactive authentication methods.\n\nA Bearer token is a JSON Web Token (JWT) that is used to authenticate a request. It is most commonly used in the `Authorization` header of an HTTP request, using the `Bearer` scheme:\n\n```http\nAuthorization: Bearer <token>\n```\n\n\n## Client Usage\n\nThe most straightforward way to use a pre-existing Bearer token is to provide it as a string to the `auth` parameter of the `fastmcp.Client` or transport instance. FastMCP will automatically format it correctly for the `Authorization` header and bearer scheme.\n\n<Tip>\nIf you're using a string token, do not include the `Bearer` prefix. FastMCP will add it for you.\n</Tip>\n\n```python {5}\nfrom fastmcp import Client\n\nasync with Client(\n    \"https://fastmcp.cloud/mcp\", \n    auth=\"<your-token>\",\n) as client:\n    await client.ping()\n```\n\nYou can also supply a Bearer token to a transport instance, such as `StreamableHttpTransport` or `SSETransport`:\n\n```python {6}\nfrom fastmcp import Client\nfrom fastmcp.client.transports import StreamableHttpTransport\n\ntransport = StreamableHttpTransport(\n    \"http://fastmcp.cloud/mcp\", \n    auth=\"<your-token>\",\n)\n\nasync with Client(transport) as client:\n    await client.ping()\n```\n\n## `BearerAuth` Helper\n\nIf you prefer to be more explicit and not rely on FastMCP to transform your string token, you can use the `BearerAuth` class yourself, which implements the `httpx.Auth` interface.\n\n```python {6}\nfrom fastmcp import Client\nfrom fastmcp.client.auth import BearerAuth\n\nasync with Client(\n    \"https://fastmcp.cloud/mcp\", \n    auth=BearerAuth(token=\"<your-token>\"),\n) as client:\n    await client.ping()\n```\n\n## Custom Headers\n\nIf the MCP server expects a custom header or token scheme, you can manually set the client's `headers` instead of using the `auth` parameter by setting them on your transport:\n\n```python {5}\nfrom fastmcp import Client\nfrom fastmcp.client.transports import StreamableHttpTransport\n\nasync with Client(\n    transport=StreamableHttpTransport(\n        \"https://fastmcp.cloud/mcp\", \n        headers={\"X-API-Key\": \"<your-token>\"},\n    ),\n) as client:\n    await client.ping()\n```\n"}, {"filename": "docs/clients/auth/oauth.mdx", "content": "---\ntitle: OAuth Authentication\nsidebarTitle: OAuth\ndescription: Authenticate your FastMCP client via OAuth 2.1.\nicon: window\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.6.0\" />\n\n<Tip>\nOAuth authentication is only relevant for HTTP-based transports and requires user interaction via a web browser.\n</Tip>\n\nWhen your FastMCP client needs to access an MCP server protected by OAuth 2.1, and the process requires user interaction (like logging in and granting consent), you should use the Authorization Code Flow. FastMCP provides the `fastmcp.client.auth.OAuth` helper to simplify this entire process.\n\nThis flow is common for user-facing applications where the application acts on behalf of the user.\n\n## Client Usage\n\n\n### Default Configuration\n\nThe simplest way to use OAuth is to pass the string `\"oauth\"` to the `auth` parameter of the `Client` or transport instance. FastMCP will automatically configure the client to use OAuth with default settings:\n\n```python {4}\nfrom fastmcp import Client\n\n# Uses default OAuth settings\nasync with Client(\"https://fastmcp.cloud/mcp\", auth=\"oauth\") as client:\n    await client.ping()\n```\n\n\n### `OAuth` Helper\n\nTo fully configure the OAuth flow, use the `OAuth` helper and pass it to the `auth` parameter of the `Client` or transport instance. `OAuth` manages the complexities of the OAuth 2.1 Authorization Code Grant with PKCE (Proof Key for Code Exchange) for enhanced security, and implements the full `httpx.Auth` interface.\n\n```python {2, 4, 6}\nfrom fastmcp import Client\nfrom fastmcp.client.auth import OAuth\n\noauth = OAuth(mcp_url=\"https://fastmcp.cloud/mcp\")\n\nasync with Client(\"https://fastmcp.cloud/mcp\", auth=oauth) as client:\n    await client.ping()\n```\n\n#### `OAuth` Parameters\n\n- **`mcp_url`** (`str`): The full URL of the target MCP server endpoint. Used to discover OAuth server metadata\n- **`scopes`** (`str | list[str]`, optional): OAuth scopes to request. Can be space-separated string or list of strings\n- **`client_name`** (`str`, optional): Client name for dynamic registration. Defaults to `\"FastMCP Client\"`\n- **`token_storage`** (`AsyncKeyValue`, optional): Storage backend for persisting OAuth tokens. Defaults to in-memory storage (tokens lost on restart). See [Token Storage](#token-storage) for encrypted storage options\n- **`additional_client_metadata`** (`dict[str, Any]`, optional): Extra metadata for client registration\n- **`callback_port`** (`int`, optional): Fixed port for OAuth callback server. If not specified, uses a random available port\n\n\n## OAuth Flow\n\nThe OAuth flow is triggered when you use a FastMCP `Client` configured to use OAuth.\n\n<Steps>\n<Step title=\"Token Check\">\nThe client first checks the configured `token_storage` backend for existing, valid tokens for the target server. If one is found, it will be used to authenticate the client.\n</Step>\n<Step title=\"OAuth Server Discovery\">\nIf no valid tokens exist, the client attempts to discover the OAuth server's endpoints using a well-known URI (e.g., `/.well-known/oauth-authorization-server`) based on the `mcp_url`.\n</Step>\n<Step title=\"Dynamic Client Registration\">\nIf the OAuth server supports it and the client isn't already registered (or credentials aren't cached), the client performs dynamic client registration according to RFC 7591.\n</Step>\n<Step title=\"Local Callback Server\">\nA temporary local HTTP server is started on an available port (or the port specified via `callback_port`). This server's address (e.g., `http://127.0.0.1:<port>/callback`) acts as the `redirect_uri` for the OAuth flow.\n</Step>\n<Step title=\"Browser Interaction\">\nThe user's default web browser is automatically opened, directing them to the OAuth server's authorization endpoint. The user logs in and grants (or denies) the requested `scopes`.\n</Step>\n<Step title=\"Authorization Code & Token Exchange\">\nUpon approval, the OAuth server redirects the user's browser to the local callback server with an `authorization_code`. The client captures this code and exchanges it with the OAuth server's token endpoint for an `access_token` (and often a `refresh_token`) using PKCE for security.\n</Step>\n<Step title=\"Token Caching\">\nThe obtained tokens are saved to the configured `token_storage` backend for future use, eliminating the need for repeated browser interactions.\n</Step>\n<Step title=\"Authenticated Requests\">\nThe access token is automatically included in the `Authorization` header for requests to the MCP server.\n</Step>\n<Step title=\"Refresh Token\">\nIf the access token expires, the client will automatically use the refresh token to get a new access token.\n</Step>\n</Steps>\n\n## Token Storage\n\n<VersionBadge version=\"2.13.0\" />\n\nBy default, tokens are stored in memory and lost when your application restarts. For persistent storage, pass an `AsyncKeyValue`-compatible storage backend to the `token_storage` parameter.\n\n<Warning>\n**Security Consideration**: Use encrypted storage for production. MCP clients can accumulate OAuth credentials for many servers over time, and a compromised token store could expose access to multiple services.\n</Warning>\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.auth import OAuth\nfrom key_value.aio.stores.disk import DiskStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\nimport os\n\n# Create encrypted disk storage\nencrypted_storage = FernetEncryptionWrapper(\n    key_value=DiskStore(directory=\"~/.fastmcp/oauth-tokens\"),\n    fernet=Fernet(os.environ[\"OAUTH_STORAGE_ENCRYPTION_KEY\"])\n)\n\noauth = OAuth(\n    mcp_url=\"https://fastmcp.cloud/mcp\",\n    token_storage=encrypted_storage\n)\n\nasync with Client(\"https://fastmcp.cloud/mcp\", auth=oauth) as client:\n    await client.ping()\n```\n\nYou can use any `AsyncKeyValue`-compatible backend from the [key-value library](https://github.com/strawgate/py-key-value) including Redis, DynamoDB, and more. Wrap your storage in `FernetEncryptionWrapper` for encryption.\n\n<Note>\nWhen selecting a storage backend, review the [py-key-value documentation](https://github.com/strawgate/py-key-value) to understand the maturity level and limitations of your chosen backend. Some backends may be in preview or have constraints that affect production suitability.\n</Note>\n"}, {"filename": "docs/clients/client.mdx", "content": "---\ntitle: The FastMCP Client\nsidebarTitle: Overview\ndescription: Programmatic client for interacting with MCP servers through a well-typed, Pythonic interface.\nicon: user-robot\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nThe central piece of MCP client applications is the `fastmcp.Client` class. This class provides a **programmatic interface** for interacting with any Model Context Protocol (MCP) server, handling protocol details and connection management automatically.\n\nThe FastMCP Client is designed for deterministic, controlled interactions rather than autonomous behavior, making it ideal for:\n\n- **Testing MCP servers** during development\n- **Building deterministic applications** that need reliable MCP interactions  \n- **Creating the foundation for agentic or LLM-based clients** with structured, type-safe operations\n\nAll client operations require using the `async with` context manager for proper connection lifecycle management.\n\n\n<Note>\nThis is not an agentic client - it requires explicit function calls and provides direct control over all MCP operations. Use it as a building block for higher-level systems.\n</Note>\n\n## Creating a Client\n\nCreating a client is straightforward. You provide a server source and the client automatically infers the appropriate transport mechanism.\n\n```python\nimport asyncio\nfrom fastmcp import Client, FastMCP\n\n# In-memory server (ideal for testing)\nserver = FastMCP(\"TestServer\")\nclient = Client(server)\n\n# HTTP server\nclient = Client(\"https://example.com/mcp\")\n\n# Local Python script\nclient = Client(\"my_mcp_server.py\")\n\nasync def main():\n    async with client:\n        # Basic server interaction\n        await client.ping()\n        \n        # List available operations\n        tools = await client.list_tools()\n        resources = await client.list_resources()\n        prompts = await client.list_prompts()\n        \n        # Execute operations\n        result = await client.call_tool(\"example_tool\", {\"param\": \"value\"})\n        print(result)\n\nasyncio.run(main())\n```\n\n## Client-Transport Architecture\n\nThe FastMCP Client separates concerns between protocol and connection:\n\n- **`Client`**: Handles MCP protocol operations (tools, resources, prompts) and manages callbacks\n- **`Transport`**: Establishes and maintains the connection (WebSockets, HTTP, Stdio, in-memory)\n\n### Transport Inference\n\nThe client automatically infers the appropriate transport based on the input:\n\n1. **`FastMCP` instance** \u2192 In-memory transport (perfect for testing)\n2. **File path ending in `.py`** \u2192 Python Stdio transport\n3. **File path ending in `.js`** \u2192 Node.js Stdio transport  \n4. **URL starting with `http://` or `https://`** \u2192 HTTP transport\n5. **`MCPConfig` dictionary** \u2192 Multi-server client\n\n```python\nfrom fastmcp import Client, FastMCP\n\n# Examples of transport inference\nclient_memory = Client(FastMCP(\"TestServer\"))\nclient_script = Client(\"./server.py\") \nclient_http = Client(\"https://api.example.com/mcp\")\n```\n\n<Tip>\nFor testing and development, always prefer the in-memory transport by passing a `FastMCP` server directly to the client. This eliminates network complexity and separate processes.\n</Tip>\n\n## Configuration-Based Clients\n\n<VersionBadge version=\"2.4.0\" />\n\nCreate clients from MCP configuration dictionaries, which can include multiple servers. While there is no official standard for MCP configuration format, FastMCP follows established conventions used by tools like Claude Desktop.\n\n### Configuration Format\n\n```python\nconfig = {\n    \"mcpServers\": {\n        \"server_name\": {\n            # Remote HTTP/SSE server\n            \"transport\": \"http\",  # or \"sse\" \n            \"url\": \"https://api.example.com/mcp\",\n            \"headers\": {\"Authorization\": \"Bearer token\"},\n            \"auth\": \"oauth\"  # or bearer token string\n        },\n        \"local_server\": {\n            # Local stdio server\n            \"transport\": \"stdio\",\n            \"command\": \"python\",\n            \"args\": [\"./server.py\", \"--verbose\"],\n            \"env\": {\"DEBUG\": \"true\"},\n            \"cwd\": \"/path/to/server\",\n        }\n    }\n}\n```\n\n### Multi-Server Example\n\n```python\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\"url\": \"https://weather-api.example.com/mcp\"},\n        \"assistant\": {\"command\": \"python\", \"args\": [\"./assistant_server.py\"]}\n    }\n}\n\nclient = Client(config)\n\nasync with client:\n    # Tools are prefixed with server names\n    weather_data = await client.call_tool(\"weather_get_forecast\", {\"city\": \"London\"})\n    response = await client.call_tool(\"assistant_answer_question\", {\"question\": \"What's the capital of France?\"})\n    \n    # Resources use prefixed URIs\n    icons = await client.read_resource(\"weather://weather/icons/sunny\")\n    templates = await client.read_resource(\"resource://assistant/templates/list\")\n```\n\n## Connection Lifecycle\n\nThe client operates asynchronously and uses context managers for connection management:\n\n```python\nasync def example():\n    client = Client(\"my_mcp_server.py\")\n    \n    # Connection established here\n    async with client:\n        print(f\"Connected: {client.is_connected()}\")\n        \n        # Make multiple calls within the same session\n        tools = await client.list_tools()\n        result = await client.call_tool(\"greet\", {\"name\": \"World\"})\n        \n    # Connection closed automatically here\n    print(f\"Connected: {client.is_connected()}\")\n```\n\n## Operations\n\nFastMCP clients can interact with several types of server components:\n\n### Tools\n\nTools are server-side functions that the client can execute with arguments.\n\n```python\nasync with client:\n    # List available tools\n    tools = await client.list_tools()\n    \n    # Execute a tool\n    result = await client.call_tool(\"multiply\", {\"a\": 5, \"b\": 3})\n    print(result.data)  # 15\n```\n\nSee [Tools](/clients/tools) for detailed documentation.\n\n### Resources\n\nResources are data sources that the client can read, either static or templated.\n\n```python\nasync with client:\n    # List available resources\n    resources = await client.list_resources()\n    \n    # Read a resource\n    content = await client.read_resource(\"file:///config/settings.json\")\n    print(content[0].text)\n```\n\nSee [Resources](/clients/resources) for detailed documentation.\n\n### Prompts\n\nPrompts are reusable message templates that can accept arguments.\n\n```python\nasync with client:\n    # List available prompts\n    prompts = await client.list_prompts()\n    \n    # Get a rendered prompt\n    messages = await client.get_prompt(\"analyze_data\", {\"data\": [1, 2, 3]})\n    print(messages.messages)\n```\n\nSee [Prompts](/clients/prompts) for detailed documentation.\n\n### Server Connectivity\n\nUse `ping()` to verify the server is reachable:\n\n```python\nasync with client:\n    await client.ping()\n    print(\"Server is reachable\")\n```\n\n### Initialization and Server Information\n\nWhen you enter the client context manager, the client automatically performs an MCP initialization handshake with the server. This handshake exchanges capabilities, server metadata, and instructions. The result is available through the `initialize_result` property.\n\n```python\nfrom fastmcp import Client, FastMCP\n\nmcp = FastMCP(name=\"MyServer\", instructions=\"Use the greet tool to say hello!\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    \"\"\"Greet a user by name.\"\"\"\n    return f\"Hello, {name}!\"\n\nasync with Client(mcp) as client:\n    # Initialization already happened automatically\n    print(f\"Server: {client.initialize_result.serverInfo.name}\")\n    print(f\"Version: {client.initialize_result.serverInfo.version}\")\n    print(f\"Instructions: {client.initialize_result.instructions}\")\n    print(f\"Capabilities: {client.initialize_result.capabilities.tools}\")\n```\n\n#### Manual Initialization Control\n\nIn advanced scenarios, you might want precise control over when initialization happens. For example, you may need custom error handling, want to defer initialization until after other setup, or need to measure initialization timing separately.\n\nDisable automatic initialization and call `initialize()` manually:\n\n```python\nfrom fastmcp import Client\n\n# Disable automatic initialization\nclient = Client(\"my_mcp_server.py\", auto_initialize=False)\n\nasync with client:\n    # Connection established, but not initialized yet\n    print(f\"Connected: {client.is_connected()}\")\n    print(f\"Initialized: {client.initialize_result is not None}\")  # False\n\n    # Initialize manually with custom timeout\n    result = await client.initialize(timeout=10.0)\n    print(f\"Server: {result.serverInfo.name}\")\n\n    # Now ready for operations\n    tools = await client.list_tools()\n```\n\nThe `initialize()` method is idempotent - calling it multiple times returns the cached result from the first successful call.\n\n## Client Configuration\n\nClients can be configured with additional handlers and settings for specialized use cases.\n\n### Callback Handlers\n\nThe client supports several callback handlers for advanced server interactions:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.logging import LogMessage\n\nasync def log_handler(message: LogMessage):\n    print(f\"Server log: {message.data}\")\n\nasync def progress_handler(progress: float, total: float | None, message: str | None):\n    print(f\"Progress: {progress}/{total} - {message}\")\n\nasync def sampling_handler(messages, params, context):\n    # Integrate with your LLM service here\n    return \"Generated response\"\n\nclient = Client(\n    \"my_mcp_server.py\",\n    log_handler=log_handler,\n    progress_handler=progress_handler,\n    sampling_handler=sampling_handler,\n    timeout=30.0\n)\n```\n\nThe `Client` constructor accepts several configuration options:\n\n- `transport`: Transport instance or source for automatic inference  \n- `log_handler`: Handle server log messages\n- `progress_handler`: Monitor long-running operations\n- `sampling_handler`: Respond to server LLM requests\n- `roots`: Provide local context to servers\n- `timeout`: Default timeout for requests (in seconds)\n\n### Transport Configuration\n\nFor detailed transport configuration (headers, authentication, environment variables), see the [Transports](/clients/transports) documentation.\n\n## Next Steps\n\nExplore the detailed documentation for each operation type:\n\n### Core Operations\n- **[Tools](/clients/tools)** - Execute server-side functions and handle results\n- **[Resources](/clients/resources)** - Access static and templated resources  \n- **[Prompts](/clients/prompts)** - Work with message templates and argument serialization\n\n### Advanced Features\n- **[Logging](/clients/logging)** - Handle server log messages\n- **[Progress](/clients/progress)** - Monitor long-running operations\n- **[Sampling](/clients/sampling)** - Respond to server LLM requests\n- **[Roots](/clients/roots)** - Provide local context to servers\n\n### Connection Details\n- **[Transports](/clients/transports)** - Configure connection methods and parameters\n- **[Authentication](/clients/auth/oauth)** - Set up OAuth and bearer token authentication\n\n<Tip>\nThe FastMCP Client is designed as a foundational tool. Use it directly for deterministic operations, or build higher-level agentic systems on top of its reliable, type-safe interface.\n</Tip>"}, {"filename": "docs/clients/elicitation.mdx", "content": "---\ntitle: User Elicitation\nsidebarTitle: Elicitation\ndescription: Handle server-initiated user input requests with structured schemas.\nicon: message-question\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.10.0\" />\n\n## What is Elicitation?\n\nElicitation allows MCP servers to request structured input from users during tool execution. Instead of requiring all inputs upfront, servers can interactively ask users for information as needed - like prompting for missing parameters, requesting clarification, or gathering additional context.\n\nFor example, a file management tool might ask \"Which directory should I create?\" or a data analysis tool might request \"What date range should I analyze?\"\n\n## How FastMCP Makes Elicitation Easy\n\nFastMCP's client provides a helpful abstraction layer that:\n\n- **Converts JSON schemas to Python types**: The raw MCP protocol uses JSON schemas, but FastMCP automatically converts these to Python dataclasses\n- **Provides structured constructors**: Instead of manually building dictionaries that match the schema, you get dataclass constructors that ensure correct structure\n- **Handles type conversion**: FastMCP takes care of converting between JSON representations and Python objects\n- **Runtime introspection**: You can inspect the generated dataclass fields to understand the expected structure\n\nWhen you implement an elicitation handler, FastMCP gives you a dataclass type that matches the server's schema, making it easy to create properly structured responses without having to manually parse JSON schemas.\n\n## Elicitation Handler\n\nProvide an `elicitation_handler` function when creating the client. FastMCP automatically converts the server's JSON schema into a Python dataclass type, making it easy to construct the response:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.elicitation import ElicitResult\n\nasync def elicitation_handler(message: str, response_type: type, params, context):\n    # Present the message to the user and collect input\n    user_input = input(f\"{message}: \")\n    \n    # Create response using the provided dataclass type\n    # FastMCP converted the JSON schema to this Python type for you\n    response_data = response_type(value=user_input)\n    \n    # You can return data directly - FastMCP will implicitly accept the elicitation\n    return response_data\n    \n    # Or explicitly return an ElicitResult for more control\n    # return ElicitResult(action=\"accept\", content=response_data)\n\nclient = Client(\n    \"my_mcp_server.py\",\n    elicitation_handler=elicitation_handler,\n)\n```\n\n### Handler Parameters\n\nThe elicitation handler receives four parameters:\n\n<Card icon=\"code\" title=\"Elicitation Handler Parameters\">\n<ResponseField name=\"message\" type=\"str\">\n  The prompt message to display to the user\n</ResponseField>\n\n<ResponseField name=\"response_type\" type=\"type\">\n  A Python dataclass type that FastMCP created from the server's JSON schema. Use this to construct your response with proper typing and IDE support. If the server requests an empty object (indicating no response), this will be `None`.\n</ResponseField>\n\n<ResponseField name=\"params\" type=\"ElicitRequestParams\">\n  The original MCP elicitation request parameters, including the raw JSON schema in `params.requestedSchema` if you need it\n</ResponseField>\n\n<ResponseField name=\"context\" type=\"RequestContext\">\n  Request context containing metadata about the elicitation request\n</ResponseField>\n</Card>\n\n### Response Actions\n\nThe handler can return data directly (which implicitly accepts the elicitation) or an `ElicitResult` object for more control over the response action:\n\n<Card icon=\"code\" title=\"ElicitResult Structure\">\n<ResponseField name=\"action\" type=\"Literal['accept', 'decline', 'cancel']\">\n  How the user responded to the elicitation request\n</ResponseField>\n\n<ResponseField name=\"content\" type=\"dataclass instance | dict | None\">\n  The user's input data (required for \"accept\", omitted for \"decline\"/\"cancel\")\n</ResponseField>\n</Card>\n\n**Action Types:**\n- **`accept`**: User provided valid input - include their data in the `content` field\n- **`decline`**: User chose not to provide the requested information - omit `content`  \n- **`cancel`**: User cancelled the entire operation - omit `content`\n\n## Basic Example\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.elicitation import ElicitResult\n\nasync def basic_elicitation_handler(message: str, response_type: type, params, context):\n    print(f\"Server asks: {message}\")\n    \n    # Simple text input for demonstration\n    user_response = input(\"Your response: \")\n    \n    if not user_response:\n        # For non-acceptance, use ElicitResult explicitly\n        return ElicitResult(action=\"decline\")\n    \n    # Use the response_type dataclass to create a properly structured response\n    # FastMCP handles the conversion from JSON schema to Python type\n    # Return data directly - FastMCP will implicitly accept the elicitation\n    return response_type(value=user_response)\n\nclient = Client(\n    \"my_mcp_server.py\", \n    elicitation_handler=basic_elicitation_handler\n)\n```\n\n\n"}, {"filename": "docs/clients/logging.mdx", "content": "---\ntitle: Server Logging\nsidebarTitle: Logging\ndescription: Receive and handle log messages from MCP servers.\nicon: receipt\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nMCP servers can emit log messages to clients. The client can handle these logs through a log handler callback.\n\n## Log Handler\n\nProvide a `log_handler` function when creating the client. For robust logging, the log messages can be integrated with Python's standard `logging` module.\n\n```python\nimport logging\nfrom fastmcp import Client\nfrom fastmcp.client.logging import LogMessage\n\n# In a real app, you might configure this in your main entry point\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\n# Get a logger for the module where the client is used\nlogger = logging.getLogger(__name__)\n\n# This mapping is useful for converting MCP level strings to Python's levels\nLOGGING_LEVEL_MAP = logging.getLevelNamesMapping()\n\nasync def log_handler(message: LogMessage):\n    \"\"\"\n    Handles incoming logs from the MCP server and forwards them\n    to the standard Python logging system.\n    \"\"\"\n    msg = message.data.get('msg')\n    extra = message.data.get('extra')\n\n    # Convert the MCP log level to a Python log level\n    level = LOGGING_LEVEL_MAP.get(message.level.upper(), logging.INFO)\n\n    # Log the message using the standard logging library\n    logger.log(level, msg, extra=extra)\n\n\nclient = Client(\n    \"my_mcp_server.py\",\n    log_handler=log_handler,\n)\n```\n\n## Handling Structured Logs\n\nThe `message.data` attribute is a dictionary that contains the log payload from the server. This enables structured logging, allowing you to receive rich, contextual information.\n\nThe dictionary contains two keys:\n- `msg`: The string log message.\n- `extra`: A dictionary containing any extra data sent from the server.\n\nThis structure is preserved even when logs are forwarded through a FastMCP proxy, making it a powerful tool for debugging complex, multi-server applications.\n\n### Handler Parameters\n\nThe `log_handler` is called every time a log message is received. It receives a `LogMessage` object:\n\n<Card icon=\"code\" title=\"Log Handler Parameters\">\n<ResponseField name=\"LogMessage\" type=\"Log Message Object\">\n  <Expandable title=\"attributes\">\n    <ResponseField name=\"level\" type='Literal[\"debug\", \"info\", \"notice\", \"warning\", \"error\", \"critical\", \"alert\", \"emergency\"]'>\n      The log level\n    </ResponseField>\n\n    <ResponseField name=\"logger\" type=\"str | None\">\n      The logger name (optional, may be None)\n    </ResponseField>\n\n    <ResponseField name=\"data\" type=\"dict\">\n      The log payload, containing `msg` and `extra` keys.\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n```python\nasync def detailed_log_handler(message: LogMessage):\n    msg = message.data.get('msg')\n    extra = message.data.get('extra')\n\n    if message.level == \"error\":\n        print(f\"ERROR: {msg} | Details: {extra}\")\n    elif message.level == \"warning\":\n        print(f\"WARNING: {msg} | Details: {extra}\")\n    else:\n        print(f\"{message.level.upper()}: {msg}\")\n```\n\n## Default Log Handling\n\nIf you don't provide a custom `log_handler`, FastMCP's default handler routes server logs to the appropriate Python logging levels. The MCP levels are mapped as follows: `notice` \u2192 INFO; `alert` and `emergency` \u2192 CRITICAL. If the server includes a logger name, it is prefixed in the message, and any `extra` data is forwarded via the logging `extra` parameter.\n\n```python\nclient = Client(\"my_mcp_server.py\")\n\nasync with client:\n    # Server logs are forwarded at their proper severity (DEBUG/INFO/WARNING/ERROR/CRITICAL)\n    await client.call_tool(\"some_tool\")\n```\n"}, {"filename": "docs/clients/messages.mdx", "content": "---\ntitle: Message Handling\nsidebarTitle: Messages\ndescription: Handle MCP messages, requests, and notifications with custom message handlers.\nicon: envelope\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.9.1\" />\n\nMCP clients can receive various types of messages from servers, including requests that need responses and notifications that don't. The message handler provides a unified way to process all these messages.\n\n## Function-Based Handler\n\nThe simplest way to handle messages is with a function that receives all messages:\n\n```python\nfrom fastmcp import Client\n\nasync def message_handler(message):\n    \"\"\"Handle all MCP messages from the server.\"\"\"\n    if hasattr(message, 'root'):\n        method = message.root.method\n        print(f\"Received: {method}\")\n        \n        # Handle specific notifications\n        if method == \"notifications/tools/list_changed\":\n            print(\"Tools have changed - might want to refresh tool cache\")\n        elif method == \"notifications/resources/list_changed\":\n            print(\"Resources have changed\")\n\nclient = Client(\n    \"my_mcp_server.py\",\n    message_handler=message_handler,\n)\n```\n\n## Message Handler Class\n\nFor fine-grained targeting, FastMCP provides a `MessageHandler` class you can subclass to take advantage of specific hooks:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.messages import MessageHandler\nimport mcp.types\n\nclass MyMessageHandler(MessageHandler):\n    async def on_tool_list_changed(\n        self, notification: mcp.types.ToolListChangedNotification\n    ) -> None:\n        \"\"\"Handle tool list changes specifically.\"\"\"\n        print(\"Tool list changed - refreshing available tools\")\n\nclient = Client(\n    \"my_mcp_server.py\",\n    message_handler=MyMessageHandler(),\n)\n```\n\n### Available Handler Methods\n\nAll handler methods receive a single argument - the specific message type:\n\n<Card icon=\"code\" title=\"Message Handler Methods\">\n<ResponseField name=\"on_message(message)\" type=\"Any MCP message\">\n  Called for ALL messages (requests and notifications)\n</ResponseField>\n\n<ResponseField name=\"on_request(request)\" type=\"mcp.types.ClientRequest\">\n  Called for requests that expect responses\n</ResponseField>\n\n<ResponseField name=\"on_notification(notification)\" type=\"mcp.types.ServerNotification\">\n  Called for notifications (fire-and-forget)\n</ResponseField>\n\n<ResponseField name=\"on_tool_list_changed(notification)\" type=\"mcp.types.ToolListChangedNotification\">\n  Called when the server's tool list changes\n</ResponseField>\n\n<ResponseField name=\"on_resource_list_changed(notification)\" type=\"mcp.types.ResourceListChangedNotification\">\n  Called when the server's resource list changes\n</ResponseField>\n\n<ResponseField name=\"on_prompt_list_changed(notification)\" type=\"mcp.types.PromptListChangedNotification\">\n  Called when the server's prompt list changes\n</ResponseField>\n\n<ResponseField name=\"on_progress(notification)\" type=\"mcp.types.ProgressNotification\">\n  Called for progress updates during long-running operations\n</ResponseField>\n\n<ResponseField name=\"on_logging_message(notification)\" type=\"mcp.types.LoggingMessageNotification\">\n  Called for log messages from the server\n</ResponseField>\n</Card>\n\n## Example: Handling Tool Changes\n\nHere's a practical example of handling tool list changes:\n\n```python\nfrom fastmcp.client.messages import MessageHandler\nimport mcp.types\n\nclass ToolCacheHandler(MessageHandler):\n    def __init__(self):\n        self.cached_tools = []\n    \n    async def on_tool_list_changed(\n        self, notification: mcp.types.ToolListChangedNotification\n    ) -> None:\n        \"\"\"Clear tool cache when tools change.\"\"\"\n        print(\"Tools changed - clearing cache\")\n        self.cached_tools = []  # Force refresh on next access\n\nclient = Client(\"server.py\", message_handler=ToolCacheHandler())\n```\n\n## Handling Requests\n\nWhile the message handler receives server-initiated requests, for most use cases you should use the dedicated callback parameters instead:\n\n- **Sampling requests**: Use [`sampling_handler`](/clients/sampling)\n- **Progress requests**: Use [`progress_handler`](/clients/progress)  \n- **Log requests**: Use [`log_handler`](/clients/logging)\n\nThe message handler is primarily for monitoring and handling notifications rather than responding to requests."}, {"filename": "docs/clients/progress.mdx", "content": "---\ntitle: Progress Monitoring\nsidebarTitle: Progress\ndescription: Handle progress notifications from long-running server operations.\nicon: bars-progress\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.3.5\" />\n\nMCP servers can report progress during long-running operations. The client can receive these updates through a progress handler.\n\n## Progress Handler\n\nSet a progress handler when creating the client:\n\n```python\nfrom fastmcp import Client\n\nasync def my_progress_handler(\n    progress: float, \n    total: float | None, \n    message: str | None\n) -> None:\n    if total is not None:\n        percentage = (progress / total) * 100\n        print(f\"Progress: {percentage:.1f}% - {message or ''}\")\n    else:\n        print(f\"Progress: {progress} - {message or ''}\")\n\nclient = Client(\n    \"my_mcp_server.py\",\n    progress_handler=my_progress_handler\n)\n```\n\n### Handler Parameters\n\nThe progress handler receives three parameters:\n\n\n<Card icon=\"code\" title=\"Progress Handler Parameters\">\n<ResponseField name=\"progress\" type=\"float\">\n  Current progress value\n</ResponseField>\n\n<ResponseField name=\"total\" type=\"float | None\">\n  Expected total value (may be None)\n</ResponseField>\n\n<ResponseField name=\"message\" type=\"str | None\">\n  Optional status message (may be None)\n</ResponseField>\n</Card>\n\n\n## Per-Call Progress Handler\n\nOverride the progress handler for specific tool calls:\n\n```python\nasync with client:\n    # Override with specific progress handler for this call\n    result = await client.call_tool(\n        \"long_running_task\", \n        {\"param\": \"value\"}, \n        progress_handler=my_progress_handler\n    )\n```\n"}, {"filename": "docs/clients/prompts.mdx", "content": "---\ntitle: Prompts\nsidebarTitle: Prompts\ndescription: Use server-side prompt templates with automatic argument serialization.\nicon: message-lines\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nPrompts are reusable message templates exposed by MCP servers. They can accept arguments to generate personalized message sequences for LLM interactions.\n\n## Listing Prompts\n\nUse `list_prompts()` to retrieve all available prompt templates:\n\n```python\nasync with client:\n    prompts = await client.list_prompts()\n    # prompts -> list[mcp.types.Prompt]\n    \n    for prompt in prompts:\n        print(f\"Prompt: {prompt.name}\")\n        print(f\"Description: {prompt.description}\")\n        if prompt.arguments:\n            print(f\"Arguments: {[arg.name for arg in prompt.arguments]}\")\n        # Access tags and other metadata\n        if hasattr(prompt, '_meta') and prompt._meta:\n            fastmcp_meta = prompt._meta.get('_fastmcp', {})\n            print(f\"Tags: {fastmcp_meta.get('tags', [])}\")\n```\n\n### Filtering by Tags\n\n<VersionBadge version=\"2.11.0\" />\n\nYou can use the `meta` field to filter prompts based on their tags:\n\n```python\nasync with client:\n    prompts = await client.list_prompts()\n    \n    # Filter prompts by tag\n    analysis_prompts = [\n        prompt for prompt in prompts \n        if hasattr(prompt, '_meta') and prompt._meta and\n           prompt._meta.get('_fastmcp', {}) and\n           'analysis' in prompt._meta.get('_fastmcp', {}).get('tags', [])\n    ]\n    \n    print(f\"Found {len(analysis_prompts)} analysis prompts\")\n```\n\n<Note>\nThe `_meta` field is part of the standard MCP specification. FastMCP servers include tags and other metadata within a `_fastmcp` namespace (e.g., `_meta._fastmcp.tags`) to avoid conflicts with user-defined metadata. This behavior can be controlled with the server's `include_fastmcp_meta` setting - when disabled, the `_fastmcp` namespace won't be included. Other MCP server implementations may not provide this metadata structure.\n</Note>\n\n## Using Prompts\n\n### Basic Usage\n\nRequest a rendered prompt using `get_prompt()` with the prompt name and arguments:\n\n```python\nasync with client:\n    # Simple prompt without arguments\n    result = await client.get_prompt(\"welcome_message\")\n    # result -> mcp.types.GetPromptResult\n    \n    # Access the generated messages\n    for message in result.messages:\n        print(f\"Role: {message.role}\")\n        print(f\"Content: {message.content}\")\n```\n\n### Prompts with Arguments\n\nPass arguments as a dictionary to customize the prompt:\n\n```python\nasync with client:\n    # Prompt with simple arguments\n    result = await client.get_prompt(\"user_greeting\", {\n        \"name\": \"Alice\",\n        \"role\": \"administrator\"\n    })\n    \n    # Access the personalized messages\n    for message in result.messages:\n        print(f\"Generated message: {message.content}\")\n```\n\n## Automatic Argument Serialization\n\n<VersionBadge version=\"2.9.0\" />\n\nFastMCP automatically serializes complex arguments to JSON strings as required by the MCP specification. This allows you to pass typed objects directly:\n\n```python\nfrom dataclasses import dataclass\n\n@dataclass\nclass UserData:\n    name: str\n    age: int\n\nasync with client:\n    # Complex arguments are automatically serialized\n    result = await client.get_prompt(\"analyze_user\", {\n        \"user\": UserData(name=\"Alice\", age=30),     # Automatically serialized to JSON\n        \"preferences\": {\"theme\": \"dark\"},           # Dict serialized to JSON string\n        \"scores\": [85, 92, 78],                     # List serialized to JSON string\n        \"simple_name\": \"Bob\"                        # Strings passed through unchanged\n    })\n```\n\nThe client handles serialization using `pydantic_core.to_json()` for consistent formatting. FastMCP servers can automatically deserialize these JSON strings back to the expected types.\n\n### Serialization Examples\n\n```python\nasync with client:\n    result = await client.get_prompt(\"data_analysis\", {\n        # These will be automatically serialized to JSON strings:\n        \"config\": {\n            \"format\": \"csv\",\n            \"include_headers\": True,\n            \"delimiter\": \",\"\n        },\n        \"filters\": [\n            {\"field\": \"age\", \"operator\": \">\", \"value\": 18},\n            {\"field\": \"status\", \"operator\": \"==\", \"value\": \"active\"}\n        ],\n        # This remains a string:\n        \"report_title\": \"Monthly Analytics Report\"\n    })\n```\n\n## Working with Prompt Results\n\nThe `get_prompt()` method returns a `GetPromptResult` object containing a list of messages:\n\n```python\nasync with client:\n    result = await client.get_prompt(\"conversation_starter\", {\"topic\": \"climate\"})\n    \n    # Access individual messages\n    for i, message in enumerate(result.messages):\n        print(f\"Message {i + 1}:\")\n        print(f\"  Role: {message.role}\")\n        print(f\"  Content: {message.content.text if hasattr(message.content, 'text') else message.content}\")\n```\n\n## Raw MCP Protocol Access\n\nFor access to the complete MCP protocol objects, use the `*_mcp` methods:\n\n```python\nasync with client:\n    # Raw MCP method returns full protocol object\n    prompts_result = await client.list_prompts_mcp()\n    # prompts_result -> mcp.types.ListPromptsResult\n    \n    prompt_result = await client.get_prompt_mcp(\"example_prompt\", {\"arg\": \"value\"})\n    # prompt_result -> mcp.types.GetPromptResult\n```\n\n## Multi-Server Clients\n\nWhen using multi-server clients, prompts are accessible without prefixing (unlike tools):\n\n```python\nasync with client:  # Multi-server client\n    # Prompts from any server are directly accessible\n    result1 = await client.get_prompt(\"weather_prompt\", {\"city\": \"London\"})\n    result2 = await client.get_prompt(\"assistant_prompt\", {\"query\": \"help\"})\n```\n\n## Common Prompt Patterns\n\n### System Messages\n\nMany prompts generate system messages for LLM configuration:\n\n```python\nasync with client:\n    result = await client.get_prompt(\"system_configuration\", {\n        \"role\": \"helpful assistant\",\n        \"expertise\": \"python programming\"\n    })\n    \n    # Typically returns messages with role=\"system\"\n    system_message = result.messages[0]\n    print(f\"System prompt: {system_message.content}\")\n```\n\n### Conversation Templates\n\nPrompts can generate multi-turn conversation templates:\n\n```python\nasync with client:\n    result = await client.get_prompt(\"interview_template\", {\n        \"candidate_name\": \"Alice\",\n        \"position\": \"Senior Developer\"\n    })\n    \n    # Multiple messages for a conversation flow\n    for message in result.messages:\n        print(f\"{message.role}: {message.content}\")\n```\n\n<Tip>\nPrompt arguments and their expected types depend on the specific prompt implementation. Check the server's documentation or use `list_prompts()` to see available arguments for each prompt.\n</Tip>"}, {"filename": "docs/clients/resources.mdx", "content": "---\ntitle: Resource Operations\nsidebarTitle: Resources\ndescription: Access static and templated resources from MCP servers.\nicon: folder-open\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nResources are data sources exposed by MCP servers. They can be static files or dynamic templates that generate content based on parameters.\n\n## Types of Resources\n\nMCP servers expose two types of resources:\n\n- **Static Resources**: Fixed content accessible via URI (e.g., configuration files, documentation)\n- **Resource Templates**: Dynamic resources that accept parameters to generate content (e.g., API endpoints, database queries)\n\n## Listing Resources\n\n### Static Resources\n\nUse `list_resources()` to retrieve all static resources available on the server:\n\n```python\nasync with client:\n    resources = await client.list_resources()\n    # resources -> list[mcp.types.Resource]\n    \n    for resource in resources:\n        print(f\"Resource URI: {resource.uri}\")\n        print(f\"Name: {resource.name}\")\n        print(f\"Description: {resource.description}\")\n        print(f\"MIME Type: {resource.mimeType}\")\n        # Access tags and other metadata\n        if hasattr(resource, '_meta') and resource._meta:\n            fastmcp_meta = resource._meta.get('_fastmcp', {})\n            print(f\"Tags: {fastmcp_meta.get('tags', [])}\")\n```\n\n### Resource Templates\n\nUse `list_resource_templates()` to retrieve available resource templates:\n\n```python\nasync with client:\n    templates = await client.list_resource_templates()\n    # templates -> list[mcp.types.ResourceTemplate]\n    \n    for template in templates:\n        print(f\"Template URI: {template.uriTemplate}\")\n        print(f\"Name: {template.name}\")\n        print(f\"Description: {template.description}\")\n        # Access tags and other metadata\n        if hasattr(template, '_meta') and template._meta:\n            fastmcp_meta = template._meta.get('_fastmcp', {})\n            print(f\"Tags: {fastmcp_meta.get('tags', [])}\")\n```\n\n### Filtering by Tags\n\n<VersionBadge version=\"2.11.0\" />\n\nYou can use the `meta` field to filter resources based on their tags:\n\n```python\nasync with client:\n    resources = await client.list_resources()\n    \n    # Filter resources by tag\n    config_resources = [\n        resource for resource in resources \n        if hasattr(resource, '_meta') and resource._meta and\n           resource._meta.get('_fastmcp', {}) and\n           'config' in resource._meta.get('_fastmcp', {}).get('tags', [])\n    ]\n    \n    print(f\"Found {len(config_resources)} config resources\")\n```\n\n<Note>\nThe `_meta` field is part of the standard MCP specification. FastMCP servers include tags and other metadata within a `_fastmcp` namespace (e.g., `_meta._fastmcp.tags`) to avoid conflicts with user-defined metadata. This behavior can be controlled with the server's `include_fastmcp_meta` setting - when disabled, the `_fastmcp` namespace won't be included. Other MCP server implementations may not provide this metadata structure.\n</Note>\n\n## Reading Resources\n\n### Static Resources\n\nRead a static resource using its URI:\n\n```python\nasync with client:\n    # Read a static resource\n    content = await client.read_resource(\"file:///path/to/README.md\")\n    # content -> list[mcp.types.TextResourceContents | mcp.types.BlobResourceContents]\n    \n    # Access text content\n    if hasattr(content[0], 'text'):\n        print(content[0].text)\n    \n    # Access binary content\n    if hasattr(content[0], 'blob'):\n        print(f\"Binary data: {len(content[0].blob)} bytes\")\n```\n\n### Resource Templates\n\nRead from a resource template by providing the URI with parameters:\n\n```python\nasync with client:\n    # Read a resource generated from a template\n    # For example, a template like \"weather://{{city}}/current\"\n    weather_content = await client.read_resource(\"weather://london/current\")\n    \n    # Access the generated content\n    print(weather_content[0].text)  # Assuming text JSON response\n```\n\n## Content Types\n\nResources can return different content types:\n\n### Text Resources\n\n```python\nasync with client:\n    content = await client.read_resource(\"resource://config/settings.json\")\n    \n    for item in content:\n        if hasattr(item, 'text'):\n            print(f\"Text content: {item.text}\")\n            print(f\"MIME type: {item.mimeType}\")\n```\n\n### Binary Resources\n\n```python\nasync with client:\n    content = await client.read_resource(\"resource://images/logo.png\")\n    \n    for item in content:\n        if hasattr(item, 'blob'):\n            print(f\"Binary content: {len(item.blob)} bytes\")\n            print(f\"MIME type: {item.mimeType}\")\n            \n            # Save to file\n            with open(\"downloaded_logo.png\", \"wb\") as f:\n                f.write(item.blob)\n```\n\n## Working with Multi-Server Clients\n\nWhen using multi-server clients, resource URIs are automatically prefixed with the server name:\n\n```python\nasync with client:  # Multi-server client\n    # Access resources from different servers\n    weather_icons = await client.read_resource(\"weather://weather/icons/sunny\")\n    templates = await client.read_resource(\"resource://assistant/templates/list\")\n    \n    print(f\"Weather icon: {weather_icons[0].blob}\")\n    print(f\"Templates: {templates[0].text}\")\n```\n\n## Raw MCP Protocol Access\n\nFor access to the complete MCP protocol objects, use the `*_mcp` methods:\n\n```python\nasync with client:\n    # Raw MCP methods return full protocol objects\n    resources_result = await client.list_resources_mcp()\n    # resources_result -> mcp.types.ListResourcesResult\n    \n    templates_result = await client.list_resource_templates_mcp()\n    # templates_result -> mcp.types.ListResourceTemplatesResult\n    \n    content_result = await client.read_resource_mcp(\"resource://example\")\n    # content_result -> mcp.types.ReadResourceResult\n```\n\n## Common Resource URI Patterns\n\nDifferent MCP servers may use various URI schemes:\n\n```python\n# File system resources\n\"file:///path/to/file.txt\"\n\n# Custom protocol resources  \n\"weather://london/current\"\n\"database://users/123\"\n\n# Generic resource protocol\n\"resource://config/settings\"\n\"resource://templates/email\"\n```\n\n<Tip>\nResource URIs and their formats depend on the specific MCP server implementation. Check the server's documentation for available resources and their URI patterns.\n</Tip>"}, {"filename": "docs/clients/roots.mdx", "content": "---\ntitle: Client Roots\nsidebarTitle: Roots\ndescription: Provide local context and resource boundaries to MCP servers.\nicon: folder-tree\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nRoots are a way for clients to inform servers about the resources they have access to. Servers can use this information to adjust behavior or provide more relevant responses.\n\n## Setting Static Roots\n\nProvide a list of roots when creating the client:\n\n<CodeGroup>\n```python Static Roots\nfrom fastmcp import Client\n\nclient = Client(\n    \"my_mcp_server.py\", \n    roots=[\"/path/to/root1\", \"/path/to/root2\"]\n)\n```\n\n```python Dynamic Roots Callback\nfrom fastmcp import Client\nfrom fastmcp.client.roots import RequestContext\n\nasync def roots_callback(context: RequestContext) -> list[str]:\n    print(f\"Server requested roots (Request ID: {context.request_id})\")\n    return [\"/path/to/root1\", \"/path/to/root2\"]\n\nclient = Client(\n    \"my_mcp_server.py\", \n    roots=roots_callback\n)\n```\n</CodeGroup>\n\n"}, {"filename": "docs/clients/sampling.mdx", "content": "---\ntitle: LLM Sampling\nsidebarTitle: Sampling\ndescription: Handle server-initiated LLM sampling requests.\nicon: robot\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.0.0\" />\n\nMCP servers can request LLM completions from clients. The client handles these requests through a sampling handler callback.\n\n## Sampling Handler\n\nProvide a `sampling_handler` function when creating the client:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.sampling import (\n    SamplingMessage,\n    SamplingParams,\n    RequestContext,\n)\n\nasync def sampling_handler(\n    messages: list[SamplingMessage],\n    params: SamplingParams,\n    context: RequestContext\n) -> str:\n    # Your LLM integration logic here\n    # Extract text from messages and generate a response\n    return \"Generated response based on the messages\"\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=sampling_handler,\n)\n```\n\n### Handler Parameters\n\nThe sampling handler receives three parameters:\n\n<Card icon=\"code\" title=\"Sampling Handler Parameters\">\n<ResponseField name=\"SamplingMessage\" type=\"Sampling Message Object\">\n  <Expandable title=\"attributes\">\n    <ResponseField name=\"role\" type='Literal[\"user\", \"assistant\"]'>\n      The role of the message.\n    </ResponseField>\n\n    <ResponseField name=\"content\" type=\"TextContent | ImageContent | AudioContent\">\n      The content of the message.\n\n      TextContent is most common, and has a `.text` attribute.\n    </ResponseField>\n\n  </Expandable>\n</ResponseField>\n<ResponseField name=\"SamplingParams\" type=\"Sampling Parameters Object\">\n  <Expandable title=\"attributes\">\n    <ResponseField name=\"messages\" type=\"list[SamplingMessage]\">\n      The messages to sample from\n    </ResponseField>\n\n    <ResponseField name=\"modelPreferences\" type=\"ModelPreferences | None\">\n      The server's preferences for which model to select. The client MAY ignore\n    these preferences.\n    <Expandable title=\"attributes\">\n      <ResponseField name=\"hints\" type=\"list[ModelHint] | None\">\n        The hints to use for model selection.\n      </ResponseField>\n\n      <ResponseField name=\"costPriority\" type=\"float | None\">\n        The cost priority for model selection.\n      </ResponseField>\n\n      <ResponseField name=\"speedPriority\" type=\"float | None\">\n        The speed priority for model selection.\n      </ResponseField>\n\n      <ResponseField name=\"intelligencePriority\" type=\"float | None\">\n        The intelligence priority for model selection.\n      </ResponseField>\n    </Expandable>\n    </ResponseField>\n\n    <ResponseField name=\"systemPrompt\" type=\"str | None\">\n      An optional system prompt the server wants to use for sampling.\n    </ResponseField>\n\n    <ResponseField name=\"includeContext\" type=\"IncludeContext | None\">\n      A request to include context from one or more MCP servers (including the caller), to\n      be attached to the prompt.\n    </ResponseField>\n\n    <ResponseField name=\"temperature\" type=\"float | None\">\n      The sampling temperature.\n    </ResponseField>\n\n    <ResponseField name=\"maxTokens\" type=\"int\">\n      The maximum number of tokens to sample.\n    </ResponseField>\n\n    <ResponseField name=\"stopSequences\" type=\"list[str] | None\">\n      The stop sequences to use for sampling.\n    </ResponseField>\n\n    <ResponseField name=\"metadata\" type=\"dict[str, Any] | None\">\n      Optional metadata to pass through to the LLM provider.\n    </ResponseField>\n\n    <ResponseField name=\"tools\" type=\"list[Tool] | None\">\n      Optional list of tools the LLM can use during sampling. See [Using the OpenAI Handler](#using-the-openai-handler).\n    </ResponseField>\n\n    <ResponseField name=\"toolChoice\" type=\"ToolChoice | None\">\n      Optional control over tool usage behavior (`auto`, `required`, or `none`).\n    </ResponseField>\n    </Expandable>\n\n</ResponseField>\n<ResponseField name=\"RequestContext\" type=\"Request Context Object\">\n  <Expandable title=\"attributes\">\n    <ResponseField name=\"request_id\" type=\"RequestId\">\n      Unique identifier for the MCP request\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n## Basic Example\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.sampling import SamplingMessage, SamplingParams, RequestContext\n\nasync def basic_sampling_handler(\n    messages: list[SamplingMessage],\n    params: SamplingParams,\n    context: RequestContext\n) -> str:\n    # Extract message content\n    conversation = []\n    for message in messages:\n        content = message.content.text if hasattr(message.content, 'text') else str(message.content)\n        conversation.append(f\"{message.role}: {content}\")\n\n    # Use the system prompt if provided\n    system_prompt = params.systemPrompt or \"You are a helpful assistant.\"\n\n    # Here you would integrate with your preferred LLM service\n    # This is just a placeholder response\n    return f\"Response based on conversation: {' | '.join(conversation)}\"\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=basic_sampling_handler\n)\n```\n\n<Note>\nIf the client doesn't provide a sampling handler, servers can optionally configure a fallback handler. See [Server Sampling](/servers/sampling#sampling-fallback-handler) for details.\n</Note>\n\n## Sampling Capabilities\n\nWhen you provide a `sampling_handler`, FastMCP automatically advertises full sampling capabilities to the server, including tool support. To disable tool support (for simpler handlers that don't support tools), pass `sampling_capabilities` explicitly:\n\n```python\nfrom mcp.types import SamplingCapability\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=basic_handler,\n    sampling_capabilities=SamplingCapability(),  # No tool support\n)\n```\n\n## Built-in Handlers\n\nFastMCP provides built-in sampling handlers for OpenAI and Anthropic APIs. These handlers support the full sampling API including tool use, handling message conversion and response formatting automatically.\n\n### OpenAI Handler\n\n<VersionBadge version=\"2.11.0\" />\n\nThe OpenAI handler works with OpenAI's API and any OpenAI-compatible provider:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.sampling.handlers.openai import OpenAISamplingHandler\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=OpenAISamplingHandler(default_model=\"gpt-4o\"),\n)\n```\n\nFor OpenAI-compatible APIs (like local models), pass a custom client:\n\n```python\nfrom openai import AsyncOpenAI\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=OpenAISamplingHandler(\n        default_model=\"llama-3.1-70b\",\n        client=AsyncOpenAI(base_url=\"http://localhost:8000/v1\"),\n    ),\n)\n```\n\n<Note>\nInstall the OpenAI handler with `pip install fastmcp[openai]`.\n</Note>\n\n### Anthropic Handler\n\n<VersionBadge version=\"2.14.1\" />\n\nThe Anthropic handler uses Claude models via the Anthropic API:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.sampling.handlers.anthropic import AnthropicSamplingHandler\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=AnthropicSamplingHandler(default_model=\"claude-sonnet-4-5\"),\n)\n```\n\nYou can pass a custom client for advanced configuration:\n\n```python\nfrom anthropic import AsyncAnthropic\n\nclient = Client(\n    \"my_mcp_server.py\",\n    sampling_handler=AnthropicSamplingHandler(\n        default_model=\"claude-sonnet-4-5\",\n        client=AsyncAnthropic(),  # Uses ANTHROPIC_API_KEY env var\n    ),\n)\n```\n\n<Note>\nInstall the Anthropic handler with `pip install fastmcp[anthropic]`.\n</Note>\n\n### Tool Execution\n\nTool execution happens on the server side. The client's role is to pass tools to the LLM and return the LLM's response (which may include tool use requests). The server then executes the tools and may send follow-up sampling requests with tool results.\n\n<Tip>\nTo implement a custom sampling handler, see the [handler source code](https://github.com/jlowin/fastmcp/tree/main/src/fastmcp/client/sampling/handlers) as a reference.\n</Tip>"}, {"filename": "docs/clients/tasks.mdx", "content": "---\ntitle: Background Tasks\nsidebarTitle: Background Tasks\ndescription: Execute operations asynchronously and track their progress\nicon: clock\ntag: \"NEW\"\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.14.0\" />\n\nThe [MCP task protocol](https://modelcontextprotocol.io/specification/2025-11-25/basic/utilities/tasks) lets you request operations to run asynchronously. This returns a Task object immediately, letting you track progress, cancel operations, or await results.\n\nSee [Server Background Tasks](/servers/tasks) for how to enable this on the server side.\n\n## Requesting Background Execution\n\nPass `task=True` to run an operation as a background task. The call returns immediately with a Task object while the work executes on the server.\n\n```python\nfrom fastmcp import Client\n\nasync with Client(server) as client:\n    # Start a background task\n    task = await client.call_tool(\"slow_computation\", {\"duration\": 10}, task=True)\n\n    print(f\"Task started: {task.task_id}\")\n\n    # Do other work while it runs...\n\n    # Get the result when ready\n    result = await task.result()\n```\n\nThis works with tools, resources, and prompts:\n\n```python\ntool_task = await client.call_tool(\"my_tool\", args, task=True)\nresource_task = await client.read_resource(\"file://large.txt\", task=True)\nprompt_task = await client.get_prompt(\"my_prompt\", args, task=True)\n```\n\n## Working with Task Objects\n\nAll task types share a common interface for retrieving results, checking status, and receiving updates.\n\nTo get the result, call `await task.result()` or simply `await task`. This blocks until the task completes and returns the result. You can also check status without blocking using `await task.status()`, which returns the current state (`\"working\"`, `\"completed\"`, `\"failed\"`, or `\"cancelled\"`) along with any progress message from the server.\n\n```python\ntask = await client.call_tool(\"analyze\", {\"text\": \"hello\"}, task=True)\n\n# Check current status (non-blocking)\nstatus = await task.status()\nprint(f\"{status.status}: {status.statusMessage}\")\n\n# Wait for result (blocking)\nresult = await task.result()\n```\n\nFor more control over waiting, use `task.wait()` with an optional timeout or target state:\n\n```python\n# Wait up to 30 seconds for completion\nstatus = await task.wait(timeout=30.0)\n\n# Wait for a specific state\nstatus = await task.wait(state=\"completed\", timeout=30.0)\n```\n\nTo cancel a running task, call `await task.cancel()`.\n\n### Real-Time Status Updates\n\nRegister callbacks to receive status updates as the server reports progress. Both sync and async callbacks are supported.\n\n```python\ndef on_status_change(status):\n    print(f\"Task {status.taskId}: {status.status} - {status.statusMessage}\")\n\ntask.on_status_change(on_status_change)\n\n# Async callbacks work too\nasync def on_status_async(status):\n    await log_status(status)\n\ntask.on_status_change(on_status_async)\n```\n\n## Graceful Degradation\n\nYou can always pass `task=True` regardless of whether the server supports background tasks. Per the MCP specification, servers without task support execute the operation immediately and return the result inline. The Task API provides a consistent interface either way.\n\n```python\ntask = await client.call_tool(\"my_tool\", args, task=True)\n\nif task.returned_immediately:\n    print(\"Server executed immediately (no background support)\")\nelse:\n    print(\"Running in background\")\n\n# Either way, this works\nresult = await task.result()\n```\n\nThis means you can write task-aware client code without worrying about server capabilities.\n\n## Complete Example\n\n```python\nimport asyncio\nfrom fastmcp import Client\n\nasync def main():\n    async with Client(server) as client:\n        # Start background task\n        task = await client.call_tool(\n            \"slow_computation\",\n            {\"duration\": 10},\n            task=True,\n        )\n\n        # Subscribe to updates\n        def on_update(status):\n            print(f\"Progress: {status.statusMessage}\")\n\n        task.on_status_change(on_update)\n\n        # Do other work while task runs\n        print(\"Doing other work...\")\n        await asyncio.sleep(2)\n\n        # Wait for completion and get result\n        result = await task.result()\n        print(f\"Result: {result.content}\")\n\nasyncio.run(main())\n```\n"}, {"filename": "docs/clients/tools.mdx", "content": "---\ntitle: Tool Operations\nsidebarTitle: Tools\ndescription: Discover and execute server-side tools with the FastMCP client.\nicon: wrench\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nTools are executable functions exposed by MCP servers. The FastMCP client provides methods to discover available tools and execute them with arguments.\n\n## Discovering Tools\n\nUse `list_tools()` to retrieve all tools available on the server:\n\n```python\nasync with client:\n    tools = await client.list_tools()\n    # tools -> list[mcp.types.Tool]\n    \n    for tool in tools:\n        print(f\"Tool: {tool.name}\")\n        print(f\"Description: {tool.description}\")\n        if tool.inputSchema:\n            print(f\"Parameters: {tool.inputSchema}\")\n        # Access tags and other metadata\n        if hasattr(tool, 'meta') and tool.meta:\n            fastmcp_meta = tool.meta.get('_fastmcp', {})\n            print(f\"Tags: {fastmcp_meta.get('tags', [])}\")\n```\n\n### Filtering by Tags\n\n<VersionBadge version=\"2.11.0\" />\n\nYou can use the `meta` field to filter tools based on their tags:\n\n```python\nasync with client:\n    tools = await client.list_tools()\n    \n    # Filter tools by tag\n    analysis_tools = [\n        tool for tool in tools \n        if hasattr(tool, 'meta') and tool.meta and\n           tool.meta.get('_fastmcp', {}) and\n           'analysis' in tool.meta.get('_fastmcp', {}).get('tags', [])\n    ]\n    \n    print(f\"Found {len(analysis_tools)} analysis tools\")\n```\n\n<Note>\nThe `meta` field is part of the standard MCP specification. FastMCP servers include tags and other metadata within a `_fastmcp` namespace (e.g., `meta._fastmcp.tags`) to avoid conflicts with user-defined metadata. This behavior can be controlled with the server's `include_fastmcp_meta` setting - when disabled, the `_fastmcp` namespace won't be included. Other MCP server implementations may not provide this metadata structure.\n</Note>\n\n## Executing Tools\n\n### Basic Execution\n\nExecute a tool using `call_tool()` with the tool name and arguments:\n\n```python\nasync with client:\n    # Simple tool call\n    result = await client.call_tool(\"add\", {\"a\": 5, \"b\": 3})\n    # result -> CallToolResult with structured and unstructured data\n    \n    # Access structured data (automatically deserialized)\n    print(result.data)  # 8 (int) or {\"result\": 8} for primitive types\n    \n    # Access traditional content blocks  \n    print(result.content[0].text)  # \"8\" (TextContent)\n```\n\n### Advanced Execution Options\n\nThe `call_tool()` method supports additional parameters for timeout control and progress monitoring:\n\n```python\nasync with client:\n    # With timeout (aborts if execution takes longer than 2 seconds)\n    result = await client.call_tool(\n        \"long_running_task\", \n        {\"param\": \"value\"}, \n        timeout=2.0\n    )\n    \n    # With progress handler (to track execution progress)\n    result = await client.call_tool(\n        \"long_running_task\",\n        {\"param\": \"value\"},\n        progress_handler=my_progress_handler\n    )\n```\n\n**Parameters:**\n- `name`: The tool name (string)\n- `arguments`: Dictionary of arguments to pass to the tool (optional)\n- `timeout`: Maximum execution time in seconds (optional, overrides client-level timeout)\n- `progress_handler`: Progress callback function (optional, overrides client-level handler)\n- `meta`: Dictionary of metadata to send with the request (optional, see below)\n\n## Sending Metadata\n\n<VersionBadge version=\"2.13.1\" />\n\nThe `meta` parameter sends ancillary information alongside tool calls. This can be used for various purposes like observability, debugging, client identification, or any context the server may need beyond the tool's primary arguments.\n\n```python\nasync with client:\n    result = await client.call_tool(\n        name=\"send_email\",\n        arguments={\n            \"to\": \"user@example.com\",\n            \"subject\": \"Hello\",\n            \"body\": \"Welcome!\"\n        },\n        meta={\n            \"trace_id\": \"abc-123\",\n            \"request_source\": \"mobile_app\"\n        }\n    )\n```\n\nThe structure and usage of `meta` is determined by your application. See [Client Metadata](/servers/context#client-metadata) in the server documentation to learn how to access this data in your tool implementations.\n\n## Handling Results\n\n<VersionBadge version=\"2.10.0\" />\n\nTool execution returns a `CallToolResult` object with both structured and traditional content. FastMCP's standout feature is the `.data` property, which doesn't just provide raw JSON but actually hydrates complete Python objects including complex types like datetimes, UUIDs, and custom classes.\n\n### CallToolResult Properties\n\n<Card icon=\"code\" title=\"CallToolResult Properties\">\n<ResponseField name=\".data\" type=\"Any\">\n  **FastMCP exclusive**: Fully hydrated Python objects with complex type support (datetimes, UUIDs, custom classes). Goes beyond JSON to provide complete object reconstruction from output schemas.\n</ResponseField>\n\n<ResponseField name=\".content\" type=\"list[mcp.types.ContentBlock]\">\n  Standard MCP content blocks (`TextContent`, `ImageContent`, `AudioContent`, etc.) available from all MCP servers.\n</ResponseField>\n\n<ResponseField name=\".structured_content\" type=\"dict[str, Any] | None\">\n  Standard MCP structured JSON data as sent by the server, available from all MCP servers that support structured outputs.\n</ResponseField>\n\n<ResponseField name=\".is_error\" type=\"bool\">\n  Boolean indicating if the tool execution failed.\n</ResponseField>\n</Card>\n\n### Structured Data Access\n\nFastMCP's `.data` property provides fully hydrated Python objects, not just JSON dictionaries. This includes complex type reconstruction:\n\n```python\nfrom datetime import datetime\nfrom uuid import UUID\n\nasync with client:\n    result = await client.call_tool(\"get_weather\", {\"city\": \"London\"})\n    \n    # FastMCP reconstructs complete Python objects from the server's output schema\n    weather = result.data  # Server-defined WeatherReport object\n    print(f\"Temperature: {weather.temperature}\u00b0C at {weather.timestamp}\")\n    print(f\"Station: {weather.station_id}\")\n    print(f\"Humidity: {weather.humidity}%\")\n    \n    # The timestamp is a real datetime object, not a string!\n    assert isinstance(weather.timestamp, datetime)\n    assert isinstance(weather.station_id, UUID)\n    \n    # Compare with raw structured JSON (standard MCP)\n    print(f\"Raw JSON: {result.structured_content}\")\n    # {\"temperature\": 20, \"timestamp\": \"2024-01-15T14:30:00Z\", \"station_id\": \"123e4567-...\"}\n    \n    # Traditional content blocks (standard MCP)  \n    print(f\"Text content: {result.content[0].text}\")\n```\n\n### Fallback Behavior\n\nFor tools without output schemas or when deserialization fails, `.data` will be `None`:\n\n```python\nasync with client:\n    result = await client.call_tool(\"legacy_tool\", {\"param\": \"value\"})\n    \n    if result.data is not None:\n        # Structured output available and successfully deserialized\n        print(f\"Structured: {result.data}\")\n    else:\n        # No structured output or deserialization failed - use content blocks\n        for content in result.content:\n            if hasattr(content, 'text'):\n                print(f\"Text result: {content.text}\")\n            elif hasattr(content, 'data'):\n                print(f\"Binary data: {len(content.data)} bytes\")\n```\n\n### Primitive Type Unwrapping\n\n<Tip>\nFastMCP servers automatically wrap non-object results (like `int`, `str`, `bool`) in a `{\"result\": value}` structure to create valid structured outputs. FastMCP clients understand this convention and automatically unwrap the value in `.data` for convenience, so you get the original primitive value instead of a wrapper object.\n</Tip>\n\n```python\nasync with client:\n    result = await client.call_tool(\"calculate_sum\", {\"a\": 5, \"b\": 3})\n    \n    # FastMCP client automatically unwraps for convenience\n    print(result.data)  # 8 (int) - the original value\n    \n    # Raw structured content shows the server-side wrapping\n    print(result.structured_content)  # {\"result\": 8}\n    \n    # Other MCP clients would need to manually access [\"result\"]\n    # value = result.structured_content[\"result\"]  # Not needed with FastMCP!\n```\n\n## Error Handling\n\n### Exception-Based Error Handling\n\nBy default, `call_tool()` raises a `ToolError` if the tool execution fails:\n\n```python\nfrom fastmcp.exceptions import ToolError\n\nasync with client:\n    try:\n        result = await client.call_tool(\"potentially_failing_tool\", {\"param\": \"value\"})\n        print(\"Tool succeeded:\", result.data)\n    except ToolError as e:\n        print(f\"Tool failed: {e}\")\n```\n\n### Manual Error Checking\n\nYou can disable automatic error raising and manually check the result:\n\n```python\nasync with client:\n    result = await client.call_tool(\n        \"potentially_failing_tool\", \n        {\"param\": \"value\"}, \n        raise_on_error=False\n    )\n    \n    if result.is_error:\n        print(f\"Tool failed: {result.content[0].text}\")\n    else:\n        print(f\"Tool succeeded: {result.data}\")\n```\n\n### Raw MCP Protocol Access\n\nFor complete control, use `call_tool_mcp()` which returns the raw MCP protocol object:\n\n```python\nasync with client:\n    result = await client.call_tool_mcp(\"potentially_failing_tool\", {\"param\": \"value\"})\n    # result -> mcp.types.CallToolResult\n    \n    if result.isError:\n        print(f\"Tool failed: {result.content}\")\n    else:\n        print(f\"Tool succeeded: {result.content}\")\n        # Note: No automatic deserialization with call_tool_mcp()\n```\n\n## Argument Handling\n\nArguments are passed as a dictionary to the tool:\n\n```python\nasync with client:\n    # Simple arguments\n    result = await client.call_tool(\"greet\", {\"name\": \"World\"})\n    \n    # Complex arguments\n    result = await client.call_tool(\"process_data\", {\n        \"config\": {\"format\": \"json\", \"validate\": True},\n        \"items\": [1, 2, 3, 4, 5],\n        \"metadata\": {\"source\": \"api\", \"version\": \"1.0\"}\n    })\n```\n\n<Tip>\nFor multi-server clients, tool names are automatically prefixed with the server name (e.g., `weather_get_forecast` for a tool named `get_forecast` on the `weather` server).\n</Tip>"}, {"filename": "docs/clients/transports.mdx", "content": "---\ntitle: Client Transports\nsidebarTitle: Transports\ndescription: Configure how FastMCP Clients connect to and communicate with servers.\nicon: link\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.0.0\" />\n\nThe FastMCP `Client` communicates with MCP servers through transport objects that handle the underlying connection mechanics. While the client can automatically select a transport based on what you pass to it, instantiating transports explicitly gives you full control over configuration\u2014environment variables, authentication, session management, and more.\n\nThink of transports as configurable adapters between your client code and MCP servers. Each transport type handles a different communication pattern: subprocesses with pipes, HTTP connections, or direct in-memory calls.\n\n## Choosing the Right Transport\n\n- **Use [STDIO Transport](#stdio-transport)** when you need to run local MCP servers with full control over their environment and lifecycle\n- **Use [Remote Transports](#remote-transports)** when connecting to production services or shared MCP servers running independently  \n- **Use [In-Memory Transport](#in-memory-transport)** for testing FastMCP servers without subprocess or network overhead\n- **Use [MCP JSON Configuration](#mcp-json-configuration-transport)** when you need to connect to multiple servers defined in configuration files\n\n## STDIO Transport\n\nSTDIO (Standard Input/Output) transport communicates with MCP servers through subprocess pipes. This is the standard mechanism used by desktop clients like Claude Desktop and is the primary way to run local MCP servers.\n\n### The Client Runs the Server\n\n<Warning>\n**Critical Concept**: When using STDIO transport, your client actually launches and manages the server process. This is fundamentally different from network transports where you connect to an already-running server. Understanding this relationship is key to using STDIO effectively.\n</Warning>\n\nWith STDIO transport, your client:\n- Starts the server as a subprocess when you connect\n- Manages the server's lifecycle (start, stop, restart)\n- Controls the server's environment and configuration\n- Communicates through stdin/stdout pipes\n\nThis architecture enables powerful local integrations but requires understanding environment isolation and process management.\n\n### Environment Isolation\n\nSTDIO servers run in isolated environments by default. This is a security feature enforced by the MCP protocol to prevent accidental exposure of sensitive data.\n\nWhen your client launches an MCP server:\n- The server does NOT inherit your shell's environment variables\n- API keys, paths, and other configuration must be explicitly passed\n- The working directory and system paths may differ from your shell\n\nTo pass environment variables to your server, use the `env` parameter:\n\n```python\nfrom fastmcp import Client\n\n# If your server needs environment variables (like API keys),\n# you must explicitly pass them:\nclient = Client(\n    \"my_server.py\",\n    env={\"API_KEY\": \"secret\", \"DEBUG\": \"true\"}\n)\n\n# This won't work - the server runs in isolation:\n# export API_KEY=\"secret\"  # in your shell\n# client = Client(\"my_server.py\")  # server can't see API_KEY\n```\n\n### Basic Usage\n\nTo use STDIO transport, you create a transport instance with the command and arguments needed to run your server:\n\n```python\nfrom fastmcp.client.transports import StdioTransport\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"my_server.py\"]\n)\nclient = Client(transport)\n```\n\nYou can configure additional settings like environment variables, working directory, or command arguments:\n\n```python\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"my_server.py\", \"--verbose\"],\n    env={\"LOG_LEVEL\": \"DEBUG\"},\n    cwd=\"/path/to/server\"\n)\nclient = Client(transport)\n```\n\nFor convenience, the client can also infer STDIO transport from file paths, but this doesn't allow configuration:\n\n```python\nfrom fastmcp import Client\n\nclient = Client(\"my_server.py\")  # Limited - no configuration options\n```\n\n### Environment Variables\n\nSince STDIO servers don't inherit your environment, you need strategies for passing configuration. Here are two common approaches:\n\n**Selective forwarding** passes only the variables your server actually needs:\n\n```python\nimport os\nfrom fastmcp.client.transports import StdioTransport\n\nrequired_vars = [\"API_KEY\", \"DATABASE_URL\", \"REDIS_HOST\"]\nenv = {\n    var: os.environ[var] \n    for var in required_vars \n    if var in os.environ\n}\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    env=env\n)\nclient = Client(transport)\n```\n\n**Loading from .env files** keeps configuration separate from code:\n\n```python\nfrom dotenv import dotenv_values\nfrom fastmcp.client.transports import StdioTransport\n\nenv = dotenv_values(\".env\")\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    env=env\n)\nclient = Client(transport)\n```\n\n### Session Persistence\n\nSTDIO transports maintain sessions across multiple client contexts by default (`keep_alive=True`). This improves performance by reusing the same subprocess for multiple connections, but can be controlled when you need isolation.\n\nBy default, the subprocess persists between connections:\n\n```python\nfrom fastmcp.client.transports import StdioTransport\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"]\n)\nclient = Client(transport)\n\nasync def efficient_multiple_operations():\n    async with client:\n        await client.ping()\n    \n    async with client:  # Reuses the same subprocess\n        await client.call_tool(\"process_data\", {\"file\": \"data.csv\"})\n```\n\nFor complete isolation between connections, disable session persistence:\n\n```python\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    keep_alive=False\n)\nclient = Client(transport)\n```\n\nUse `keep_alive=False` when you need complete isolation (e.g., in test suites) or when server state could cause issues between connections.\n\n### Specialized STDIO Transports\n\nFastMCP provides convenience transports that are thin wrappers around `StdioTransport` with pre-configured commands:\n\n- **`PythonStdioTransport`** - Uses `python` command for `.py` files\n- **`NodeStdioTransport`** - Uses `node` command for `.js` files  \n- **`UvStdioTransport`** - Uses `uv` for Python packages (uses `env_vars` parameter)\n- **`UvxStdioTransport`** - Uses `uvx` for Python packages (uses `env_vars` parameter)\n- **`NpxStdioTransport`** - Uses `npx` for Node packages (uses `env_vars` parameter)\n\nFor most use cases, instantiate `StdioTransport` directly with your desired command. These specialized transports are primarily useful for client inference shortcuts.\n\n## Remote Transports\n\nRemote transports connect to MCP servers running as web services. This is a fundamentally different model from STDIO transports\u2014instead of your client launching and managing a server process, you connect to an already-running service that manages its own environment and lifecycle.\n\n### Streamable HTTP Transport\n\n<VersionBadge version=\"2.3.0\" />\n\nStreamable HTTP is the recommended transport for production deployments, providing efficient bidirectional streaming over HTTP connections.\n\n- **Class:** `StreamableHttpTransport`\n- **Server compatibility:** FastMCP servers running with `mcp run --transport http`\n\nThe transport requires a URL and optionally supports custom headers for authentication and configuration:\n\n```python\nfrom fastmcp.client.transports import StreamableHttpTransport\n\n# Basic connection\ntransport = StreamableHttpTransport(url=\"https://api.example.com/mcp\")\nclient = Client(transport)\n\n# With custom headers for authentication\ntransport = StreamableHttpTransport(\n    url=\"https://api.example.com/mcp\",\n    headers={\n        \"Authorization\": \"Bearer your-token-here\",\n        \"X-Custom-Header\": \"value\"\n    }\n)\nclient = Client(transport)\n```\n\nFor convenience, FastMCP also provides authentication helpers:\n\n```python\nfrom fastmcp.client.auth import BearerAuth\n\nclient = Client(\n    \"https://api.example.com/mcp\",\n    auth=BearerAuth(\"your-token-here\")\n)\n```\n\n### SSE Transport (Legacy)\n\nServer-Sent Events transport is maintained for backward compatibility but is superseded by Streamable HTTP for new deployments.\n\n- **Class:** `SSETransport`  \n- **Server compatibility:** FastMCP servers running with `mcp run --transport sse`\n\nSSE transport supports the same configuration options as Streamable HTTP:\n\n```python\nfrom fastmcp.client.transports import SSETransport\n\ntransport = SSETransport(\n    url=\"https://api.example.com/sse\",\n    headers={\"Authorization\": \"Bearer token\"}\n)\nclient = Client(transport)\n```\n\nUse Streamable HTTP for new deployments unless you have specific infrastructure requirements for SSE.\n\n## In-Memory Transport\n\nIn-memory transport connects directly to a FastMCP server instance within the same Python process. This eliminates both subprocess management and network overhead, making it ideal for testing and development.\n\n- **Class:** `FastMCPTransport`\n\n<Note>\nUnlike STDIO transports, in-memory servers have full access to your Python process's environment. They share the same memory space and environment variables as your client code\u2014no isolation or explicit environment passing required.\n</Note>\n\n```python\nfrom fastmcp import FastMCP, Client\nimport os\n\nmcp = FastMCP(\"TestServer\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    prefix = os.environ.get(\"GREETING_PREFIX\", \"Hello\")\n    return f\"{prefix}, {name}!\"\n\nclient = Client(mcp)\n\nasync with client:\n    result = await client.call_tool(\"greet\", {\"name\": \"World\"})\n```\n\n## MCP JSON Configuration Transport\n\n<VersionBadge version=\"2.4.0\" />\n\nThis transport supports the emerging MCP JSON configuration standard for defining multiple servers:\n\n- **Class:** `MCPConfigTransport`\n\n```python\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\"\n        },\n        \"assistant\": {\n            \"command\": \"python\",\n            \"args\": [\"./assistant.py\"],\n            \"env\": {\"LOG_LEVEL\": \"INFO\"}\n        }\n    }\n}\n\nclient = Client(config)\n\nasync with client:\n    # Tools are namespaced by server\n    weather = await client.call_tool(\"weather_get_forecast\", {\"city\": \"NYC\"})\n    answer = await client.call_tool(\"assistant_ask\", {\"question\": \"What?\"})\n```\n\n### Tool Transformation with FastMCP and MCPConfig\n\nFastMCP supports basic tool transformations to be defined alongside the MCP Servers in the MCPConfig file.\n\n```python\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": { }   #  <--- This is the tool transformation section\n        }\n    }\n}\n```\n\nWith these transformations, you can transform (change) the name, title, description, tags, enablement, and arguments of a tool.\n\nFor each argument the tool takes, you can transform (change) the name, description, default, visibility, whether it's required, and you can provide example values.\n\nIn the following example, we're transforming the `weather_get_forecast` tool to only retrieve the weather for `Miami` and hiding the `city` argument from the client.\n\n```python\ntool_transformations = {\n    \"weather_get_forecast\": {\n        \"name\": \"miami_weather\",\n        \"description\": \"Get the weather for Miami\",\n        \"arguments\": {\n            \"city\": {\n                \"name\": \"city\",\n                \"default\": \"Miami\",\n                \"hide\": True,\n            }\n        }\n    }\n}\n\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": tool_transformations\n        }\n    }\n}\n```\n\n#### Allowlisting and Blocklisting Tools\n\nTools can be allowlisted or blocklisted from the client by applying `tags` to the tools on the server. In the following example, we're allowlisting only tools marked with the `forecast` tag, all other tools will be unavailable to the client.\n\n```python\ntool_transformations = {\n    \"weather_get_forecast\": {\n        \"enabled\": True,\n        \"tags\": [\"forecast\"]\n    }\n}\n\n\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": tool_transformations,\n            \"include_tags\": [\"forecast\"]\n        }\n    }\n}\n```"}, {"filename": "docs/community/README.md", "content": "# Community Section\n\nThis directory contains community-contributed content and showcases for FastMCP.\n\n## Structure\n\n- `showcase.mdx` - Main community showcase page featuring high-quality projects and examples\n\n## Adding Content\n\nTo add new community content:\n1. Create a new MDX file in this directory\n2. Update `docs.json` to include it in the navigation\n3. Follow the existing format for consistency\n\n## Guidelines\n\nCommunity content should:\n- Demonstrate best practices\n- Provide educational value\n- Include proper documentation\n- Be maintained and up-to-date"}, {"filename": "docs/community/showcase.mdx", "content": "---\ntitle: 'Community Showcase'\ndescription: 'High-quality projects and examples from the FastMCP community'\nicon: 'users'\n---\n\nimport { YouTubeEmbed } from '/snippets/youtube-embed.mdx'\n\n## Join the Community\n\n<Card title=\"FastMCP Discord\" icon=\"discord\" href=\"https://discord.gg/uu8dJCgttd\">\n  Connect with other FastMCP developers, share your projects, and discuss ideas.\n</Card>\n\n## Featured Projects\n\nDiscover exemplary MCP servers and implementations created by our community. These projects demonstrate best practices and innovative uses of FastMCP.\n\n### Learning Resources\n\n<Card title=\"MCP Dummy Server\" icon=\"graduation-cap\" href=\"https://github.com/WaiYanNyeinNaing/mcp-dummy-server\">\n  A comprehensive educational example demonstrating FastMCP best practices with professional dual-transport server implementation, interactive test client, and detailed documentation.\n</Card>\n\n#### Video Tutorials\n\n**Build Remote MCP Servers w/ Python & FastMCP** - Claude Integrations Tutorial by Greg + Code\n\n<YouTubeEmbed \n  videoId=\"bOYkbXP-GGo\" \n  title=\"Build Remote MCP Servers w/ Python & FastMCP\" \n/>\n\n**FastMCP \u2014 the best way to build an MCP server with Python** - Tutorial by ZazenCodes\n\n<YouTubeEmbed \n  videoId=\"rnljvmHorQw\" \n  title=\"FastMCP \u2014 the best way to build an MCP server with Python\" \n/>\n\n**Speedrun a MCP server for Claude Desktop (fastmcp)** - Tutorial by Nate from Prefect\n\n<YouTubeEmbed \n  videoId=\"67ZwpkUEtSI\" \n  title=\"Speedrun a MCP server for Claude Desktop (fastmcp)\" \n/>\n\n### Community Examples\n\nHave you built something interesting with FastMCP? We'd love to feature high-quality examples here! Start a [discussion on GitHub](https://github.com/jlowin/fastmcp/discussions) to share your project.\n\n## Contributing\n\nTo get your project featured:\n\n1. Ensure your project demonstrates best practices\n2. Include comprehensive documentation\n3. Add clear usage examples\n4. Open a discussion in our [GitHub Discussions](https://github.com/jlowin/fastmcp/discussions)\n\nWe review submissions regularly and feature projects that provide value to the FastMCP community.\n\n## Further Reading\n\n- [Contrib Modules](/patterns/contrib) - Community-contributed modules that are distributed with FastMCP itself"}, {"filename": "docs/deployment/fastmcp-cloud.mdx", "content": "---\ntitle: FastMCP Cloud\nsidebarTitle: FastMCP Cloud\ndescription: The fastest way to deploy your MCP server\nicon: cloud\ntag: NEW\n---\n\n[FastMCP Cloud](https://fastmcp.cloud) is a managed platform for hosting MCP servers, built by the FastMCP team. While the FastMCP framework will always be fully open-source, we created FastMCP Cloud to solve the deployment challenges we've seen developers face. Our goal is to provide the absolute fastest way to make your MCP server available to LLM clients like Claude and Cursor. \n\nFastMCP Cloud is a young product and we welcome your feedback. Please join our [Discord](https://discord.com/invite/aGsSC3yDF4) to share your thoughts and ideas, and you can expect to see new features and improvements every week.\n\n\n<Note>\nFastMCP Cloud supports both **FastMCP 2.0** servers and also **FastMCP 1.0** servers that were created with the official MCP Python SDK.\n</Note>\n\n<Tip>\nFastMCP Cloud is completely free while in beta!\n</Tip>\n\n## Prerequisites\n\nTo use FastMCP Cloud, you'll need a [GitHub](https://github.com) account. In addition, you'll need a GitHub repo that contains a FastMCP server instance. If you don't want to create one yet, you can proceed to [step 1](#step-1-create-a-project) and use the FastMCP Cloud quickstart repo. \n\nYour repo can be public or private, but must include at least a Python file that contains a FastMCP server instance. \n<Tip>\nTo ensure your file is compatible with FastMCP Cloud, you can run `fastmcp inspect <file.py:server_object>` to see what FastMCP Cloud will see when it runs your server.\n</Tip>\n\nIf you have a `requirements.txt` or `pyproject.toml` in the repo, FastMCP Cloud will automatically detect your server's dependencies and install them for you. Note that your file *can* have an `if __name__ == \"__main__\"` block, but it will be ignored by FastMCP Cloud.\n\nFor example, a minimal server file might look like:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n```\n\n## Getting Started\n\nThere are just three steps to deploying a server to FastMCP Cloud:\n\n### Step 1: Create a Project\n\nVisit [fastmcp.cloud](https://fastmcp.cloud) and sign in with your GitHub account. Then, create a project. Each project corresponds to a GitHub repo, and you can create one from either your own repo or using the FastMCP Cloud quickstart repo.\n\n<img src=\"/assets/images/fastmcp_cloud/quickstart.png\" alt=\"FastMCP Cloud Quickstart Screen\" />\n\nNext, you'll be prompted to configure your project.\n\n<img src=\"/assets/images/fastmcp_cloud/create_project.png\" alt=\"FastMCP Cloud Configuration Screen\" />\n\nThe configuration screen lets you specify:\n- **Name**: The name of your project. This will be used to generate a unique URL for your server.\n- **Entrypoint**: The Python file containing your FastMCP server (e.g., `echo.py`). This field has the same syntax as the `fastmcp run` command, for example `echo.py:my_server` to specify a specific object in the file.\n- **Authentication**: If disabled, your server is open to the public. If enabled, only other members of your FastMCP Cloud organization will be able to connect.\n\nNote that FastMCP Cloud will automatically detect yours server's Python dependencies from either a `requirements.txt` or `pyproject.toml` file.\n\n### Step 2: Deploy Your Server\n\nOnce you configure your project, FastMCP Cloud will:\n1. Clone the repository\n2. Build your FastMCP server\n3. Deploy it to a unique URL\n4. Make it immediately available for connections\n\n<img src=\"/assets/images/fastmcp_cloud/deployment.png\" alt=\"FastMCP Cloud Deployment Screen\" />\n\nFastMCP Cloud will monitor your repo and redeploy your server whenever you push a change to the `main` branch. In addition, FastMCP Cloud will build and deploy servers for every PR your open, hosting them on unique URLs, so you can test changes before updating your production server.\n\n### Step 3: Connect to Your Server\n\nOnce your server is deployed, it will be accessible at a URL like:\n\n```\nhttps://your-project-name.fastmcp.app/mcp\n```\n\nYou should be able to connect to it as soon as you see the deployment succeed! FastMCP Cloud provides instant connection options for popular LLM clients:\n\n<img src=\"/assets/images/fastmcp_cloud/connect.png\" alt=\"FastMCP Cloud Connection Screen\" />\n\n"}, {"filename": "docs/deployment/http.mdx", "content": "---\ntitle: HTTP Deployment\nsidebarTitle: HTTP Deployment\ndescription: Deploy your FastMCP server over HTTP for remote access\nicon: server\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<Tip>\nSTDIO transport is perfect for local development and desktop applications. But to unlock the full potential of MCP\u2014centralized services, multi-client access, and network availability\u2014you need remote HTTP deployment.\n</Tip>\n\nThis guide walks you through deploying your FastMCP server as a remote MCP service that's accessible via a URL. Once deployed, your MCP server will be available over the network, allowing multiple clients to connect simultaneously and enabling integration with cloud-based LLM applications. This guide focuses specifically on remote MCP deployment, not local STDIO servers.\n\n## Choosing Your Approach\n\nFastMCP provides two ways to deploy your server as an HTTP service. Understanding the trade-offs helps you choose the right approach for your needs.\n\nThe **direct HTTP server** approach is simpler and perfect for getting started quickly. You modify your server's `run()` method to use HTTP transport, and FastMCP handles all the web server configuration. This approach works well for standalone deployments where you want your MCP server to be the only service running on a port.\n\nThe **ASGI application** approach gives you more control and flexibility. Instead of running the server directly, you create an ASGI application that can be served by Uvicorn. This approach is better when you need advanced server features like multiple workers, custom middleware, or when you're integrating with existing web applications.\n\n### Direct HTTP Server\n\nThe simplest way to get your MCP server online is to use the built-in `run()` method with HTTP transport. This approach handles all the server configuration for you and is ideal when you want a standalone MCP server without additional complexity.\n\n```python server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My Server\")\n\n@mcp.tool\ndef process_data(input: str) -> str:\n    \"\"\"Process data on the server\"\"\"\n    return f\"Processed: {input}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", host=\"0.0.0.0\", port=8000)\n```\n\nRun your server with a simple Python command:\n```bash\npython server.py\n```\n\nYour server is now accessible at `http://localhost:8000/mcp` (or use your server's actual IP address for remote access).\n\nThis approach is ideal when you want to get online quickly with minimal configuration. It's perfect for internal tools, development environments, or simple deployments where you don't need advanced server features. The built-in server handles all the HTTP details, letting you focus on your MCP implementation.\n\n### ASGI Application\n\nFor production deployments, you'll often want more control over how your server runs. FastMCP can create a standard ASGI application that works with any ASGI server like Uvicorn, Gunicorn, or Hypercorn. This approach is particularly useful when you need to configure advanced server options, run multiple workers, or integrate with existing infrastructure.\n\n```python app.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My Server\")\n\n@mcp.tool\ndef process_data(input: str) -> str:\n    \"\"\"Process data on the server\"\"\"\n    return f\"Processed: {input}\"\n\n# Create ASGI application\napp = mcp.http_app()\n```\n\nRun with any ASGI server - here's an example with Uvicorn:\n```bash\nuvicorn app:app --host 0.0.0.0 --port 8000\n```\n\nYour server is accessible at the same URL: `http://localhost:8000/mcp` (or use your server's actual IP address for remote access).\n\nThe ASGI approach shines in production environments where you need reliability and performance. You can run multiple worker processes to handle concurrent requests, add custom middleware for logging or monitoring, integrate with existing deployment pipelines, or mount your MCP server as part of a larger application.\n\n## Configuring Your Server\n\n### Custom Path\n\nBy default, your MCP server is accessible at `/mcp/` on your domain. You can customize this path to fit your URL structure or avoid conflicts with existing endpoints. This is particularly useful when integrating MCP into an existing application or following specific API conventions.\n\n```python\n# Option 1: With mcp.run()\nmcp.run(transport=\"http\", host=\"0.0.0.0\", port=8000, path=\"/api/mcp/\")\n\n# Option 2: With ASGI app\napp = mcp.http_app(path=\"/api/mcp/\")\n```\n\nNow your server is accessible at `http://localhost:8000/api/mcp/`.\n\n### Authentication\n\n<Warning>\nAuthentication is **highly recommended** for remote MCP servers. Some LLM clients require authentication for remote servers and will refuse to connect without it.\n</Warning>\n\nFastMCP supports multiple authentication methods to secure your remote server. See the [Authentication Overview](/servers/auth/authentication) for complete configuration options including Bearer tokens, JWT, and OAuth.\n\nIf you're mounting an authenticated server under a path prefix, see [Mounting Authenticated Servers](#mounting-authenticated-servers) below for important routing considerations.\n\n### Health Checks\n\nHealth check endpoints are essential for monitoring your deployed server and ensuring it's responding correctly. FastMCP allows you to add custom routes alongside your MCP endpoints, making it easy to implement health checks that work with both deployment approaches.\n\n```python\nfrom starlette.responses import JSONResponse\n\n@mcp.custom_route(\"/health\", methods=[\"GET\"])\nasync def health_check(request):\n    return JSONResponse({\"status\": \"healthy\", \"service\": \"mcp-server\"})\n```\n\nThis health endpoint will be available at `http://localhost:8000/health` and can be used by load balancers, monitoring systems, or deployment platforms to verify your server is running.\n\n### Custom Middleware\n\n\n<VersionBadge version=\"2.3.2\" />\n\nAdd custom Starlette middleware to your FastMCP ASGI apps:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.middleware import Middleware\nfrom starlette.middleware.cors import CORSMiddleware\n\n# Create your FastMCP server\nmcp = FastMCP(\"MyServer\")\n\n# Define middleware\nmiddleware = [\n    Middleware(\n        CORSMiddleware,\n        allow_origins=[\"*\"],\n        allow_methods=[\"*\"],\n        allow_headers=[\"*\"],\n    )\n]\n\n# Create ASGI app with middleware\nhttp_app = mcp.http_app(middleware=middleware)\n```\n\n### CORS for Browser-Based Clients\n\n<Tip>\nMost MCP clients, including those that you access through a browser like ChatGPT or Claude, don't need CORS configuration. Only enable CORS if you're working with an MCP client that connects directly from a browser, such as debugging tools or inspectors.\n</Tip>\n\nCORS (Cross-Origin Resource Sharing) is needed when JavaScript running in a web browser connects directly to your MCP server. This is different from using an LLM through a browser\u2014in that case, the browser connects to the LLM service, and the LLM service connects to your MCP server (no CORS needed).\n\nBrowser-based MCP clients that need CORS include:\n\n- **MCP Inspector** - Browser-based debugging tool for testing MCP servers\n- **Custom browser-based MCP clients** - If you're building a web app that directly connects to MCP servers\n\nFor these scenarios, add CORS middleware with the specific headers required for MCP protocol:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.middleware import Middleware\nfrom starlette.middleware.cors import CORSMiddleware\n\nmcp = FastMCP(\"MyServer\")\n\n# Configure CORS for browser-based clients\nmiddleware = [\n    Middleware(\n        CORSMiddleware,\n        allow_origins=[\"*\"],  # Allow all origins; use specific origins for security\n        allow_methods=[\"GET\", \"POST\", \"DELETE\", \"OPTIONS\"],\n        allow_headers=[\n            \"mcp-protocol-version\",\n            \"mcp-session-id\",\n            \"Authorization\",\n            \"Content-Type\",\n        ],\n        expose_headers=[\"mcp-session-id\"],\n    )\n]\n\napp = mcp.http_app(middleware=middleware)\n```\n\n**Key configuration details:**\n\n- **`allow_origins`**: Specify exact origins (e.g., `[\"http://localhost:3000\"]`) rather than `[\"*\"]` for production deployments\n- **`allow_headers`**: Must include `mcp-protocol-version`, `mcp-session-id`, and `Authorization` (for authenticated servers)\n- **`expose_headers`**: Must include `mcp-session-id` so JavaScript can read the session ID from responses and send it in subsequent requests\n\nWithout `expose_headers=[\"mcp-session-id\"]`, browsers will receive the session ID but JavaScript won't be able to access it, causing session management to fail.\n\n<Warning>\n**Production Security**: Never use `allow_origins=[\"*\"]` in production. Specify the exact origins of your browser-based clients. Using wildcards exposes your server to unauthorized access from any website.\n</Warning>\n\n### SSE Polling for Long-Running Operations\n\n<VersionBadge version=\"2.14.0\" />\n\n<Note>\nThis feature only applies to the **StreamableHTTP transport** (the default for `http_app()`). It does not apply to the legacy SSE transport (`transport=\"sse\"`).\n</Note>\n\nWhen running tools that take a long time to complete, you may encounter issues with load balancers or proxies terminating connections that stay idle too long. [SEP-1699](https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1699) introduces SSE polling to solve this by allowing the server to gracefully close connections and have clients automatically reconnect.\n\nTo enable SSE polling, configure an `EventStore` when creating your HTTP application:\n\n```python\nfrom fastmcp import FastMCP, Context\nfrom fastmcp.server.event_store import EventStore\n\nmcp = FastMCP(\"My Server\")\n\n@mcp.tool\nasync def long_running_task(ctx: Context) -> str:\n    \"\"\"A task that takes several minutes to complete.\"\"\"\n    for i in range(100):\n        await ctx.report_progress(i, 100)\n\n        # Periodically close the connection to avoid load balancer timeouts\n        # Client will automatically reconnect and resume receiving progress\n        if i % 30 == 0 and i > 0:\n            await ctx.close_sse_stream()\n\n        await do_expensive_work()\n\n    return \"Done!\"\n\n# Configure with EventStore for resumability\nevent_store = EventStore()\napp = mcp.http_app(\n    event_store=event_store,\n    retry_interval=2000,  # Client reconnects after 2 seconds\n)\n```\n\n**How it works:**\n\n1. When `event_store` is configured, the server stores all events (progress updates, results) with unique IDs\n2. Calling `ctx.close_sse_stream()` gracefully closes the HTTP connection\n3. The client automatically reconnects with a `Last-Event-ID` header\n4. The server replays any events the client missed during the disconnection\n\nThe `retry_interval` parameter (in milliseconds) controls how long clients wait before reconnecting. Choose a value that balances responsiveness with server load.\n\n<Note>\n`close_sse_stream()` is a no-op if called without an `EventStore` configured, so you can safely include it in tools that may run in different deployment configurations.\n</Note>\n\n#### Custom Storage Backends\n\nBy default, `EventStore` uses in-memory storage. For production deployments with multiple server instances, you can provide a custom storage backend using the `key_value` package:\n\n```python\nfrom fastmcp.server.event_store import EventStore\nfrom key_value.aio.stores.redis import RedisStore\n\n# Use Redis for distributed deployments\nredis_store = RedisStore(url=\"redis://localhost:6379\")\nevent_store = EventStore(\n    storage=redis_store,\n    max_events_per_stream=100,  # Keep last 100 events per stream\n    ttl=3600,  # Events expire after 1 hour\n)\n\napp = mcp.http_app(event_store=event_store)\n```\n\n## Integration with Web Frameworks\n\nIf you already have a web application running, you can add MCP capabilities by mounting a FastMCP server as a sub-application. This allows you to expose MCP tools alongside your existing API endpoints, sharing the same domain and infrastructure. The MCP server becomes just another route in your application, making it easy to manage and deploy.\n\n### Mounting in Starlette\n\nMount your FastMCP server in a Starlette application:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.applications import Starlette\nfrom starlette.routing import Mount\n\n# Create your FastMCP server\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool\ndef analyze(data: str) -> dict:\n    return {\"result\": f\"Analyzed: {data}\"}\n\n# Create the ASGI app\nmcp_app = mcp.http_app(path='/mcp')\n\n# Create a Starlette app and mount the MCP server\napp = Starlette(\n    routes=[\n        Mount(\"/mcp-server\", app=mcp_app),\n        # Add other routes as needed\n    ],\n    lifespan=mcp_app.lifespan,\n)\n```\n\nThe MCP endpoint will be available at `/mcp-server/mcp/` of the resulting Starlette app.\n\n<Warning>\nFor Streamable HTTP transport, you **must** pass the lifespan context from the FastMCP app to the resulting Starlette app, as nested lifespans are not recognized. Otherwise, the FastMCP server's session manager will not be properly initialized.\n</Warning>\n\n#### Nested Mounts\n\nYou can create complex routing structures by nesting mounts:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.applications import Starlette\nfrom starlette.routing import Mount\n\n# Create your FastMCP server\nmcp = FastMCP(\"MyServer\")\n\n# Create the ASGI app\nmcp_app = mcp.http_app(path='/mcp')\n\n# Create nested application structure\ninner_app = Starlette(routes=[Mount(\"/inner\", app=mcp_app)])\napp = Starlette(\n    routes=[Mount(\"/outer\", app=inner_app)],\n    lifespan=mcp_app.lifespan,\n)\n```\n\nIn this setup, the MCP server is accessible at the `/outer/inner/mcp/` path.\n\n### FastAPI Integration\n\nFor FastAPI-specific integration patterns including both mounting MCP servers into FastAPI apps and generating MCP servers from FastAPI apps, see the [FastAPI Integration guide](/integrations/fastapi).\n\nHere's a quick example showing how to add MCP to an existing FastAPI application:\n\n```python\nfrom fastapi import FastAPI\nfrom fastmcp import FastMCP\n\n# Your existing API\napi = FastAPI()\n\n@api.get(\"/api/status\")\ndef status():\n    return {\"status\": \"ok\"}\n\n# Create your MCP server\nmcp = FastMCP(\"API Tools\")\n\n@mcp.tool\ndef query_database(query: str) -> dict:\n    \"\"\"Run a database query\"\"\"\n    return {\"result\": \"data\"}\n\n# Mount MCP at /mcp\napi.mount(\"/mcp\", mcp.http_app())\n\n# Run with: uvicorn app:api --host 0.0.0.0 --port 8000\n```\n\nYour existing API remains at `http://localhost:8000/api` while MCP is available at `http://localhost:8000/mcp`.\n\n## Mounting Authenticated Servers\n\n<VersionBadge version=\"2.13.0\" />\n\n<Tip>\nThis section only applies if you're **mounting an OAuth-protected FastMCP server under a path prefix** (like `/api`) inside another application using `Mount()`.\n\nIf you're deploying your FastMCP server at root level without any `Mount()` prefix, the well-known routes are automatically included in `mcp.http_app()` and you don't need to do anything special.\n</Tip>\n\nOAuth specifications (RFC 8414 and RFC 9728) require discovery metadata to be accessible at well-known paths under the root level of your domain. When you mount an OAuth-protected FastMCP server under a path prefix like `/api`, this creates a routing challenge: your operational OAuth endpoints move under the prefix, but discovery endpoints must remain at the root.\n\n<Warning>\n**Common Mistakes to Avoid:**\n\n1. **Forgetting to mount `.well-known` routes at root** - FastMCP cannot do this automatically when your server is mounted under a path prefix. You must explicitly mount well-known routes at the root level.\n\n2. **Including mount prefix in both base_url AND mcp_path** - The mount prefix (like `/api`) should only be in `base_url`, not in `mcp_path`. Otherwise you'll get double paths.\n\n   \u2705 **Correct:**\n   ```python\n   base_url = \"http://localhost:8000/api\"\n   mcp_path = \"/mcp\"\n   # Result: /api/mcp\n   ```\n\n   \u274c **Wrong:**\n   ```python\n   base_url = \"http://localhost:8000/api\"\n   mcp_path = \"/api/mcp\"\n   # Result: /api/api/mcp (double prefix!)\n   ```\n\nFollow the configuration instructions below to set up mounting correctly.\n</Warning>\n\n<Warning>\n**CORS Middleware Conflicts:**\n\nIf you're integrating FastMCP into an existing application with its own CORS middleware, be aware that layering CORS middleware can cause conflicts (such as 404 errors on `.well-known` routes or OPTIONS requests).\n\nFastMCP and the MCP SDK already handle CORS for OAuth routes. If you need CORS on your own application routes, consider using the sub-app pattern: mount FastMCP and your routes as separate apps, each with their own middleware, rather than adding application-wide CORS middleware.\n</Warning>\n\n### Route Types\n\nOAuth-protected MCP servers expose two categories of routes:\n\n**Operational routes** handle the OAuth flow and MCP protocol:\n- `/authorize` - OAuth authorization endpoint\n- `/token` - Token exchange endpoint\n- `/auth/callback` - OAuth callback handler\n- `/mcp` - MCP protocol endpoint\n\n**Discovery routes** provide metadata for OAuth clients:\n- `/.well-known/oauth-authorization-server` - Authorization server metadata\n- `/.well-known/oauth-protected-resource/*` - Protected resource metadata\n\nWhen you mount your MCP app under a prefix, operational routes move with it, but discovery routes must stay at root level for RFC compliance.\n\n### Configuration Parameters\n\nThree parameters control where routes are located and how they combine:\n\n**`base_url`** tells clients where to find operational endpoints. This includes any Starlette `Mount()` path prefix (e.g., `/api`):\n\n```python\nbase_url=\"http://localhost:8000/api\"  # Includes mount prefix\n```\n\n**`mcp_path`** is the internal FastMCP endpoint path, which gets appended to `base_url`:\n\n```python\nmcp_path=\"/mcp\"  # Internal MCP path, NOT the mount prefix\n```\n\n**`issuer_url`** (optional) controls the authorization server identity for OAuth discovery. Defaults to `base_url`.\n\n```python\n# Usually not needed - just set base_url and it works\nissuer_url=\"http://localhost:8000\"  # Only if you want root-level discovery\n```\n\nWhen `issuer_url` has a path (either explicitly or by defaulting from `base_url`), FastMCP creates path-aware discovery routes per RFC 8414. For example, if `base_url` is `http://localhost:8000/api`, the authorization server metadata will be at `/.well-known/oauth-authorization-server/api`.\n\n**Key Invariant:** `base_url + mcp_path = actual externally-accessible MCP URL`\n\nExample:\n- `base_url`: `http://localhost:8000/api` (mount prefix `/api`)\n- `mcp_path`: `/mcp` (internal path)\n- Result: `http://localhost:8000/api/mcp` (final MCP endpoint)\n\nNote that the mount prefix (`/api` from `Mount(\"/api\", ...)`) goes in `base_url`, while `mcp_path` is just the internal MCP route. Don't include the mount prefix in both places or you'll get `/api/api/mcp`.\n\n### Mounting Strategy\n\nWhen mounting an OAuth-protected server under a path prefix, declare your URLs upfront to make the relationships clear:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom starlette.applications import Starlette\nfrom starlette.routing import Mount\n\n# Define the routing structure\nROOT_URL = \"http://localhost:8000\"\nMOUNT_PREFIX = \"/api\"\nMCP_PATH = \"/mcp\"\n```\n\nCreate the auth provider with `base_url`:\n\n```python\nauth = GitHubProvider(\n    client_id=\"your-client-id\",\n    client_secret=\"your-client-secret\",\n    base_url=f\"{ROOT_URL}{MOUNT_PREFIX}\",  # Operational endpoints under prefix\n    # issuer_url defaults to base_url - path-aware discovery works automatically\n)\n```\n\nCreate the MCP app, which generates operational routes at the specified path:\n\n```python\nmcp = FastMCP(\"Protected Server\", auth=auth)\nmcp_app = mcp.http_app(path=MCP_PATH)\n```\n\nRetrieve the discovery routes from the auth provider. The `mcp_path` argument should match the path used when creating the MCP app:\n\n```python\nwell_known_routes = auth.get_well_known_routes(mcp_path=MCP_PATH)\n```\n\nFinally, mount everything in the Starlette app with discovery routes at root and the MCP app under the prefix:\n\n```python\napp = Starlette(\n    routes=[\n        *well_known_routes,  # Discovery routes at root level\n        Mount(MOUNT_PREFIX, app=mcp_app),  # Operational routes under prefix\n    ],\n    lifespan=mcp_app.lifespan,\n)\n```\n\nThis configuration produces the following URL structure:\n\n- MCP endpoint: `http://localhost:8000/api/mcp`\n- OAuth authorization: `http://localhost:8000/api/authorize`\n- OAuth callback: `http://localhost:8000/api/auth/callback`\n- Authorization server metadata: `http://localhost:8000/.well-known/oauth-authorization-server/api`\n- Protected resource metadata: `http://localhost:8000/.well-known/oauth-protected-resource/api/mcp`\n\nBoth discovery endpoints use path-aware URLs per RFC 8414 and RFC 9728, matching the `base_url` path.\n\n### Complete Example\n\nHere's a complete working example showing all the pieces together:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom starlette.applications import Starlette\nfrom starlette.routing import Mount\nimport uvicorn\n\n# Define routing structure\nROOT_URL = \"http://localhost:8000\"\nMOUNT_PREFIX = \"/api\"\nMCP_PATH = \"/mcp\"\n\n# Create OAuth provider\nauth = GitHubProvider(\n    client_id=\"your-client-id\",\n    client_secret=\"your-client-secret\",\n    base_url=f\"{ROOT_URL}{MOUNT_PREFIX}\",\n    # issuer_url defaults to base_url - path-aware discovery works automatically\n)\n\n# Create MCP server\nmcp = FastMCP(\"Protected Server\", auth=auth)\n\n@mcp.tool\ndef analyze(data: str) -> dict:\n    return {\"result\": f\"Analyzed: {data}\"}\n\n# Create MCP app\nmcp_app = mcp.http_app(path=MCP_PATH)\n\n# Get discovery routes for root level\nwell_known_routes = auth.get_well_known_routes(mcp_path=MCP_PATH)\n\n# Assemble the application\napp = Starlette(\n    routes=[\n        *well_known_routes,\n        Mount(MOUNT_PREFIX, app=mcp_app),\n    ],\n    lifespan=mcp_app.lifespan,\n)\n\nif __name__ == \"__main__\":\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n```\n\nFor more details on OAuth authentication, see the [Authentication guide](/servers/auth).\n\n## Production Deployment\n\n### Running with Uvicorn\n\nWhen deploying to production, you'll want to optimize your server for performance and reliability. Uvicorn provides several options to improve your server's capabilities:\n\n```bash\n# Run with basic configuration\nuvicorn app:app --host 0.0.0.0 --port 8000\n\n# Run with multiple workers for production (requires stateless mode - see below)\nuvicorn app:app --host 0.0.0.0 --port 8000 --workers 4\n```\n\n### Horizontal Scaling\n\n<VersionBadge version=\"2.10.2\" />\n\nWhen deploying FastMCP behind a load balancer or running multiple server instances, you need to understand how the HTTP transport handles sessions and configure your server appropriately.\n\n#### Understanding Sessions\n\nBy default, FastMCP's Streamable HTTP transport maintains server-side sessions. Sessions enable stateful MCP features like [elicitation](/servers/elicitation) and [sampling](/servers/sampling), where the server needs to maintain context across multiple requests from the same client.\n\nThis works perfectly for single-instance deployments. However, sessions are stored in memory on each server instance, which creates challenges when scaling horizontally.\n\n#### Without Stateless Mode\n\nWhen running multiple server instances behind a load balancer (Traefik, nginx, HAProxy, Kubernetes, etc.), requests from the same client may be routed to different instances:\n\n1. Client connects to Instance A \u2192 session created on Instance A\n2. Next request routes to Instance B \u2192 session doesn't exist \u2192 **request fails**\n\nYou might expect sticky sessions (session affinity) to solve this, but they don't work reliably with MCP clients.\n\n<Warning>\n**Why sticky sessions don't work:** Most MCP clients\u2014including Cursor and Claude Code\u2014use `fetch()` internally and don't properly forward `Set-Cookie` headers. Without cookies, load balancers can't identify which instance should handle subsequent requests. This is a limitation in how these clients implement HTTP, not something you can fix with load balancer configuration.\n</Warning>\n\n#### Enabling Stateless Mode\n\nFor horizontally scaled deployments, enable stateless HTTP mode. In stateless mode, each request creates a fresh transport context, eliminating the need for session affinity entirely.\n\n**Option 1: Via constructor**\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My Server\", stateless_http=True)\n\n@mcp.tool\ndef process(data: str) -> str:\n    return f\"Processed: {data}\"\n\napp = mcp.http_app()\n```\n\n**Option 2: Via `run()`**\n\n```python\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", stateless_http=True)\n```\n\n**Option 3: Via environment variable**\n\n```bash\nFASTMCP_STATELESS_HTTP=true uvicorn app:app --host 0.0.0.0 --port 8000 --workers 4\n```\n\n### Environment Variables\n\nProduction deployments should never hardcode sensitive information like API keys or authentication tokens. Instead, use environment variables to configure your server at runtime. This keeps your code secure and makes it easy to deploy the same code to different environments with different configurations.\n\nHere's an example using bearer token authentication (though OAuth is recommended for production):\n\n```python\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import BearerTokenAuth\n\n# Read configuration from environment\nauth_token = os.environ.get(\"MCP_AUTH_TOKEN\")\nif auth_token:\n    auth = BearerTokenAuth(token=auth_token)\n    mcp = FastMCP(\"Production Server\", auth=auth)\nelse:\n    mcp = FastMCP(\"Production Server\")\n\napp = mcp.http_app()\n```\n\nDeploy with your secrets safely stored in environment variables:\n```bash\nMCP_AUTH_TOKEN=secret uvicorn app:app --host 0.0.0.0 --port 8000\n```\n\n### OAuth Token Security\n\n<VersionBadge version=\"2.13.0\" />\n\nIf you're using the [OAuth Proxy](/servers/auth/oauth-proxy), FastMCP issues its own JWT tokens to clients instead of forwarding upstream provider tokens. This maintains proper OAuth 2.0 token boundaries.\n\n**Default Behavior (Development Only):**\n\nBy default, FastMCP automatically manages cryptographic keys:\n- **Mac/Windows**: Keys are generated and stored in your system keyring, surviving server restarts. Suitable **only** for development and local testing.\n- **Linux**: Keys are ephemeral (random salt at startup), so tokens are invalidated on restart.\n\nThis automatic approach is convenient for development but not suitable for production deployments.\n\n**For Production:**\n\nProduction requires explicit key management to ensure tokens survive restarts and can be shared across multiple server instances. This requires the following two things working together:\n\n1. **Explicit JWT signing key** for signing tokens issued to clients\n3. **Persistent network-accessible storage** for upstream tokens (wrapped in `FernetEncryptionWrapper` to encrypt sensitive data at rest)\n\n**Configuration:**\n\nAdd two parameters to your auth provider:\n\n```python {8-12}\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\nauth = GitHubProvider(\n    client_id=os.environ[\"GITHUB_CLIENT_ID\"],\n    client_secret=os.environ[\"GITHUB_CLIENT_SECRET\"],\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(host=\"redis.example.com\", port=6379),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    ),\n    base_url=\"https://your-server.com\"  # use HTTPS\n)\n```\n\nBoth parameters are required for production. Without an explicit signing key, keys are signed using a key derived from the client_secret, which will cause invalidation upon rotation of the client secret. Without persistent storage, tokens are local to the server and won't be trusted across hosts. **Wrap your storage backend in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without encryption, tokens are stored in plaintext.\n\nFor more details on the token architecture and key management, see [OAuth Proxy Key and Storage Management](/servers/auth/oauth-proxy#key-and-storage-management).\n\n## Testing Your Deployment\n\nOnce your server is deployed, you'll need to verify it's accessible and functioning correctly. For comprehensive testing strategies including connectivity tests, client testing, and authentication testing, see the [Testing Your Server](/development/tests) guide.\n\n## Hosting Your Server\n\nThis guide has shown you how to create an HTTP-accessible MCP server, but you'll still need a hosting provider to make it available on the internet. Your FastMCP server can run anywhere that supports Python web applications:\n\n- **Cloud VMs** (AWS EC2, Google Compute Engine, Azure VMs)\n- **Container platforms** (Cloud Run, Container Instances, ECS)  \n- **Platform-as-a-Service** (Railway, Render, Vercel)\n- **Edge platforms** (Cloudflare Workers)\n- **Kubernetes clusters** (self-managed or managed)\n\nThe key requirements are Python 3.10+ support and the ability to expose an HTTP port. Most providers will require you to package your server (requirements.txt, Dockerfile, etc.) according to their deployment format. For managed, zero-configuration deployment, see [FastMCP Cloud](/deployment/fastmcp-cloud).\n"}, {"filename": "docs/deployment/running-server.mdx", "content": "---\ntitle: Running Your Server\nsidebarTitle: Running Your Server\ndescription: Learn how to run your FastMCP server locally for development and testing\nicon: circle-play\n---\n\nFastMCP servers can be run in different ways depending on your needs. This guide focuses on running servers locally for development and testing. For production deployment to a URL, see the [HTTP Deployment](/deployment/http) guide.\n\n## The `run()` Method\n\nEvery FastMCP server needs to be started to accept connections. The simplest way to run a server is by calling the `run()` method on your FastMCP instance. This method starts the server and blocks until it's stopped, handling all the connection management for you.\n\n<Tip>\nFor maximum compatibility, it's best practice to place the `run()` call within an `if __name__ == \"__main__\":` block. This ensures the server starts only when the script is executed directly, not when imported as a module.\n</Tip>\n\n```python {9-10} my_server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"MyServer\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\nYou can now run this MCP server by executing `python my_server.py`.\n\n## Transport Protocols\n\nMCP servers communicate with clients through different transport protocols. Think of transports as the \"language\" your server speaks to communicate with clients. FastMCP supports three main transport protocols, each designed for specific use cases and deployment scenarios.\n\nThe choice of transport determines how clients connect to your server, what network capabilities are available, and how many clients can connect simultaneously. Understanding these transports helps you choose the right approach for your application.\n\n### STDIO Transport (Default)\n\nSTDIO (Standard Input/Output) is the default transport for FastMCP servers. When you call `run()` without arguments, your server uses STDIO transport. This transport communicates through standard input and output streams, making it perfect for command-line tools and desktop applications like Claude Desktop.\n\nWith STDIO transport, the client spawns a new server process for each session and manages its lifecycle. The server reads MCP messages from stdin and writes responses to stdout. This is why STDIO servers don't stay running - they're started on-demand by the client.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    mcp.run()  # Uses STDIO transport by default\n```\n\nSTDIO is ideal for:\n- Local development and testing\n- Claude Desktop integration\n- Command-line tools\n- Single-user applications\n\n### HTTP Transport (Streamable)\n\nHTTP transport turns your MCP server into a web service accessible via a URL. This transport uses the Streamable HTTP protocol, which allows clients to connect over the network. Unlike STDIO where each client gets its own process, an HTTP server can handle multiple clients simultaneously.\n\nThe Streamable HTTP protocol provides full bidirectional communication between client and server, supporting all MCP operations including streaming responses. This makes it the recommended choice for network-based deployments.\n\nTo use HTTP transport, specify it in the `run()` method along with networking options:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    # Start an HTTP server on port 8000\n    mcp.run(transport=\"http\", host=\"127.0.0.1\", port=8000)\n```\n\nYour server is now accessible at `http://localhost:8000/mcp`. This URL is the MCP endpoint that clients will connect to. HTTP transport enables:\n- Network accessibility\n- Multiple concurrent clients\n- Integration with web infrastructure\n- Remote deployment capabilities\n\nFor production HTTP deployment with authentication and advanced configuration, see the [HTTP Deployment](/deployment/http) guide.\n\n### SSE Transport (Legacy)\n\nServer-Sent Events (SSE) transport was the original HTTP-based transport for MCP. While still supported for backward compatibility, it has limitations compared to the newer Streamable HTTP transport. SSE only supports server-to-client streaming, making it less efficient for bidirectional communication.\n\n```python\nif __name__ == \"__main__\":\n    # SSE transport - use HTTP instead for new projects\n    mcp.run(transport=\"sse\", host=\"127.0.0.1\", port=8000)\n```\n\nWe recommend using HTTP transport instead of SSE for all new projects. SSE remains available only for compatibility with older clients that haven't upgraded to Streamable HTTP.\n\n### Choosing the Right Transport\n\nEach transport serves different needs. STDIO is perfect when you need simple, local execution - it's what Claude Desktop and most command-line tools expect. HTTP transport is essential when you need network access, want to serve multiple clients, or plan to deploy your server remotely. SSE exists only for backward compatibility and shouldn't be used in new projects.\n\nConsider your deployment scenario: Are you building a tool for local use? STDIO is your best choice. Need a centralized service that multiple clients can access? HTTP transport is the way to go.\n\n## The FastMCP CLI\n\nFastMCP provides a powerful command-line interface for running servers without modifying the source code. The CLI can automatically find and run your server with different transports, manage dependencies, and handle development workflows:\n\n```bash\nfastmcp run server.py\n```\n\nThe CLI automatically finds a FastMCP instance in your file (named `mcp`, `server`, or `app`) and runs it with the specified options. This is particularly useful for testing different transports or configurations without changing your code.\n\n### Dependency Management\n\nThe CLI integrates with `uv` to manage Python environments and dependencies:\n\n```bash\n# Run with a specific Python version\nfastmcp run server.py --python 3.11\n\n# Run with additional packages\nfastmcp run server.py --with pandas --with numpy\n\n# Run with dependencies from a requirements file\nfastmcp run server.py --with-requirements requirements.txt\n\n# Combine multiple options\nfastmcp run server.py --python 3.10 --with httpx --transport http\n\n# Run within a specific project directory\nfastmcp run server.py --project /path/to/project\n```\n\n<Note>\nWhen using `--python`, `--with`, `--project`, or `--with-requirements`, the server runs via `uv run` subprocess instead of using your local environment.\n</Note>\n\n### Passing Arguments to Servers\n\nWhen servers accept command line arguments (using argparse, click, or other libraries), you can pass them after `--`:\n\n```bash\nfastmcp run config_server.py -- --config config.json\nfastmcp run database_server.py -- --database-path /tmp/db.sqlite --debug\n```\n\nThis is useful for servers that need configuration files, database paths, API keys, or other runtime options.\n\nFor more CLI features including development mode with the MCP Inspector, see the [CLI documentation](/patterns/cli).\n\n### Async Usage\n\nFastMCP servers are built on async Python, but the framework provides both synchronous and asynchronous APIs to fit your application's needs. The `run()` method we've been using is actually a synchronous wrapper around the async server implementation.\n\nFor applications that are already running in an async context, FastMCP provides the `run_async()` method:\n\n```python {10-12}\nfrom fastmcp import FastMCP\nimport asyncio\n\nmcp = FastMCP(name=\"MyServer\")\n\n@mcp.tool\ndef hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nasync def main():\n    # Use run_async() in async contexts\n    await mcp.run_async(transport=\"http\", port=8000)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\n<Warning>\nThe `run()` method cannot be called from inside an async function because it creates its own async event loop internally. If you attempt to call `run()` from inside an async function, you'll get an error about the event loop already running.\n\nAlways use `run_async()` inside async functions and `run()` in synchronous contexts.\n</Warning>\n\nBoth `run()` and `run_async()` accept the same transport arguments, so all the examples above apply to both methods.\n\n## Custom Routes\n\nWhen using HTTP transport, you might want to add custom web endpoints alongside your MCP server. This is useful for health checks, status pages, or simple APIs. FastMCP lets you add custom routes using the `@custom_route` decorator:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.requests import Request\nfrom starlette.responses import PlainTextResponse\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.custom_route(\"/health\", methods=[\"GET\"])\nasync def health_check(request: Request) -> PlainTextResponse:\n    return PlainTextResponse(\"OK\")\n\n@mcp.tool\ndef process(data: str) -> str:\n    return f\"Processed: {data}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\")  # Health check at http://localhost:8000/health\n```\n\nCustom routes are served by the same web server as your MCP endpoint. They're available at the root of your domain while the MCP endpoint is at `/mcp/`. For more complex web applications, consider [mounting your MCP server into a FastAPI or Starlette app](/deployment/http#integration-with-web-frameworks).\n\n## Alternative Initialization Patterns\n\nThe `if __name__ == \"__main__\"` pattern works well for standalone scripts, but some deployment scenarios require different approaches. FastMCP handles these cases automatically.\n\n### CLI-Only Servers\n\nWhen using the FastMCP CLI, you don't need the `if __name__` block at all. The CLI will find your FastMCP instance and run it:\n\n```python\n# server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")  # CLI looks for 'mcp', 'server', or 'app'\n\n@mcp.tool\ndef process(data: str) -> str:\n    return f\"Processed: {data}\"\n\n# No if __name__ block needed - CLI will find and run 'mcp'\n```\n\n### ASGI Applications\n\nFor ASGI deployment (running with Uvicorn or similar), you'll want to create an ASGI application object. This approach is common in production deployments where you need more control over the server configuration:\n\n```python\n# app.py\nfrom fastmcp import FastMCP\n\ndef create_app():\n    mcp = FastMCP(\"MyServer\")\n    \n    @mcp.tool\n    def process(data: str) -> str:\n        return f\"Processed: {data}\"\n    \n    return mcp.http_app()\n\napp = create_app()  # Uvicorn will use this\n```\n\nSee the [HTTP Deployment](/deployment/http) guide for more ASGI deployment patterns."}, {"filename": "docs/deployment/server-configuration.mdx", "content": "---\ntitle: \"Project Configuration\"\nsidebarTitle: \"Project Configuration\"\ndescription: Use fastmcp.json for portable, declarative project configuration\nicon: file-code\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.0\" />\n\nFastMCP supports declarative configuration through `fastmcp.json` files. This is the canonical and preferred way to configure FastMCP projects, providing a single source of truth for server settings, dependencies, and deployment options that replaces complex command-line arguments.\n\nThe `fastmcp.json` file is designed to be a portable description of your server configuration that can be shared across environments and teams. When running from a `fastmcp.json` file, you can override any configuration values using CLI arguments.\n\n## Overview\n\nThe `fastmcp.json` configuration file allows you to define all aspects of your FastMCP server in a structured, shareable format. Instead of remembering command-line arguments or writing shell scripts, you declare your server's configuration once and use it everywhere.\n\nWhen you have a `fastmcp.json` file, running your server becomes as simple as:\n\n```bash\n# Run the server using the configuration\nfastmcp run fastmcp.json\n\n# Or if fastmcp.json exists in the current directory\nfastmcp run\n```\n\nThis configuration approach ensures reproducible deployments across different environments, from local development to production servers. It works seamlessly with Claude Desktop, VS Code extensions, and any MCP-compatible client.\n\n## File Structure\n\nThe `fastmcp.json` configuration answers three fundamental questions about your server:\n\n- **Source** = WHERE does your server code live?\n- **Environment** = WHAT environment setup does it require?\n- **Deployment** = HOW should the server run?\n\nThis conceptual model helps you understand the purpose of each configuration section and organize your settings effectively. The configuration file maps directly to these three concerns:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    // WHERE: Location of your server code\n    \"type\": \"filesystem\",  // Optional, defaults to \"filesystem\"\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    // WHAT: Environment setup and dependencies\n    \"type\": \"uv\",  // Optional, defaults to \"uv\"\n    \"python\": \">=3.10\",\n    \"dependencies\": [\"pandas\", \"numpy\"]\n  },\n  \"deployment\": {\n    // HOW: Runtime configuration\n    \"transport\": \"stdio\",\n    \"log_level\": \"INFO\"\n  }\n}\n```\n\nOnly the `source` field is required. The `environment` and `deployment` sections are optional and provide additional configuration when needed.\n\n### JSON Schema Support\n\nFastMCP provides JSON schemas for IDE autocomplete and validation. Add the schema reference to your `fastmcp.json` for enhanced developer experience:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  }\n}\n```\n\nTwo schema URLs are available:\n- **Version-specific**: `https://gofastmcp.com/public/schemas/fastmcp.json/v1.json`\n- **Latest version**: `https://gofastmcp.com/public/schemas/fastmcp.json/latest.json`\n\nModern IDEs like VS Code will automatically provide autocomplete suggestions, validation, and inline documentation when the schema is specified.\n\n### Source Configuration\n\nThe source configuration determines **WHERE** your server code lives. It tells FastMCP how to find and load your server, whether it's a local Python file, a remote repository, or hosted in the cloud. This section is required and forms the foundation of your configuration.\n\n<Card icon=\"code\" title=\"Source\">\n<ParamField body=\"source\" type=\"object\" required>\n  The server source configuration that determines where your server code lives.\n  \n  <ParamField body=\"type\" type=\"string\" default=\"filesystem\">\n    The source type identifier that determines which implementation to use. Currently supports `\"filesystem\"` for local files. Future releases will add support for `\"git\"` and `\"cloud\"` source types.\n  </ParamField>\n  \n  <Expandable title=\"FileSystemSource\">\n    When `type` is `\"filesystem\"` (or omitted), the source points to a local Python file containing your FastMCP server:\n    \n    <ParamField body=\"path\" type=\"string\" required>\n      Path to the Python file containing your FastMCP server. \n    </ParamField>\n    \n    <ParamField body=\"entrypoint\" type=\"string\">\n      Name of the server instance or factory function within the module:\n      - Can be a FastMCP server instance (e.g., `mcp = FastMCP(\"MyServer\")`)\n      - Can be a function with no arguments that returns a FastMCP server\n      - If not specified, FastMCP searches for common names: `mcp`, `server`, or `app`\n    </ParamField>\n    \n    **Example:**\n    ```json\n    \"source\": {\n      \"type\": \"filesystem\",\n      \"path\": \"src/server.py\",\n      \"entrypoint\": \"mcp\"\n    }\n    ```\n    \n    Note: File paths are resolved relative to the configuration file's location.\n  </Expandable>\n</ParamField>\n</Card>\n\n<Note>\n**Future Source Types**\n\nFuture releases will support additional source types:\n- **Git repositories** (`type: \"git\"`) for loading server code directly from version control\n- **FastMCP Cloud** (`type: \"cloud\"`) for hosted servers with automatic scaling and management\n</Note>\n\n### Environment Configuration\n\nThe environment configuration determines **WHAT** environment setup your server requires. It controls the build-time setup of your Python environment, ensuring your server runs with the exact Python version and dependencies it requires. This section creates isolated, reproducible environments across different systems.\n\nFastMCP uses an extensible environment system with a base `Environment` class that can be implemented by different environment providers. Currently, FastMCP supports the `UVEnvironment` for Python environment management using `uv`'s powerful dependency resolver.\n\n<Card icon=\"code\" title=\"Environment\">\n<ParamField body=\"environment\" type=\"object\">\n  Optional environment configuration. When specified, FastMCP uses the appropriate environment implementation to set up your server's runtime.\n  \n  <ParamField body=\"type\" type=\"string\" default=\"uv\">\n    The environment type identifier that determines which implementation to use. Currently supports `\"uv\"` for Python environments managed by uv. If omitted, defaults to `\"uv\"`.\n  </ParamField>\n  \n  <Expandable title=\"UVEnvironment\">\n    When `type` is `\"uv\"` (or omitted), the environment uses uv to manage Python dependencies:\n    \n    <ParamField body=\"python\" type=\"string\">\n      Python version constraint. Examples:\n      - Exact version: `\"3.12\"`\n      - Minimum version: `\">=3.10\"`\n      - Version range: `\">=3.10,<3.13\"`\n    </ParamField>\n    \n    <ParamField body=\"dependencies\" type=\"list[str]\">\n      List of pip packages with optional version specifiers (PEP 508 format).\n      ```json\n      \"dependencies\": [\"pandas>=2.0\", \"requests\", \"httpx\"]\n      ```\n    </ParamField>\n    \n    <ParamField body=\"requirements\" type=\"string\">\n      Path to a requirements.txt file, resolved relative to the config file location.\n      ```json\n      \"requirements\": \"requirements.txt\"\n      ```\n    </ParamField>\n    \n    <ParamField body=\"project\" type=\"string\">\n      Path to a project directory containing pyproject.toml for uv project management.\n      ```json\n      \"project\": \".\"\n      ```\n    </ParamField>\n    \n    <ParamField body=\"editable\" type=\"list[string]\">\n      List of paths to packages to install in editable/development mode. Useful for local development when you want changes to be reflected immediately. Supports multiple packages for monorepo setups or shared libraries.\n      ```json\n      \"editable\": [\".\"]\n      ```\n      Or with multiple packages:\n      ```json\n      \"editable\": [\".\", \"../shared-lib\", \"/path/to/another-package\"]\n      ```\n    </ParamField>\n    \n    **Example:**\n    ```json\n    \"environment\": {\n      \"type\": \"uv\",\n      \"python\": \">=3.10\",\n      \"dependencies\": [\"pandas\", \"numpy\"],\n      \"editable\": [\".\"]\n    }\n    ```\n    \n    Note: When any UVEnvironment field is specified, FastMCP automatically creates an isolated environment using `uv` before running your server.\n  </Expandable>\n</ParamField>\n</Card>\n\nWhen environment configuration is provided, FastMCP:\n1. Detects the environment type (defaults to `\"uv\"` if not specified)\n2. Creates an isolated environment using the appropriate provider\n3. Installs the specified dependencies\n4. Runs your server in this clean environment\n\nThis build-time setup ensures your server always has the dependencies it needs, without polluting your system Python or conflicting with other projects.\n\n<Note>\n**Future Environment Types**\n\nSimilar to source types, future releases may support additional environment types for different runtime requirements, such as Docker containers or language-specific environments beyond Python.\n</Note>\n\n### Deployment Configuration\n\nThe deployment configuration controls **HOW** your server runs. It defines the runtime behavior including network settings, environment variables, and execution context. These settings determine how your server operates when it executes, from transport protocols to logging levels.\n\nEnvironment variables are included in this section because they're runtime configuration that affects how your server behaves when it executes, not how its environment is built. The deployment configuration is applied every time your server starts, controlling its operational characteristics.\n\n<Card icon=\"code\" title=\"Deployment Fields\">\n<ParamField body=\"deployment\" type=\"object\">\n  Optional runtime configuration for the server.\n  \n  <Expandable title=\"Deployment Fields\">\n    <ParamField body=\"transport\" type=\"string\" default=\"stdio\">\n      Protocol for client communication:\n      - `\"stdio\"`: Standard input/output for desktop clients\n      - `\"http\"`: Network-accessible HTTP server\n      - `\"sse\"`: Server-sent events\n    </ParamField>\n    \n    <ParamField body=\"host\" type=\"string\" default=\"127.0.0.1\">\n      Network interface to bind (HTTP transport only):\n      - `\"127.0.0.1\"`: Local connections only\n      - `\"0.0.0.0\"`: All network interfaces\n    </ParamField>\n    \n    <ParamField body=\"port\" type=\"integer\" default=\"3000\">\n      Port number for HTTP transport.\n    </ParamField>\n    \n    <ParamField body=\"path\" type=\"string\" default=\"/mcp/\">\n      URL path for the MCP endpoint when using HTTP transport.\n    </ParamField>\n    \n    <ParamField body=\"log_level\" type=\"string\" default=\"INFO\">\n      Server logging verbosity. Options:\n      - `\"DEBUG\"`: Detailed debugging information\n      - `\"INFO\"`: General informational messages\n      - `\"WARNING\"`: Warning messages\n      - `\"ERROR\"`: Error messages only\n      - `\"CRITICAL\"`: Critical errors only\n    </ParamField>\n    \n    <ParamField body=\"env\" type=\"object\">\n      Environment variables to set when running the server. Supports `${VAR_NAME}` syntax for runtime interpolation.\n      ```json\n      \"env\": {\n        \"API_KEY\": \"secret-key\",\n        \"DATABASE_URL\": \"postgres://${DB_USER}@${DB_HOST}/mydb\"\n      }\n      ```\n    </ParamField>\n    \n    <ParamField body=\"cwd\" type=\"string\">\n      Working directory for the server process. Relative paths are resolved from the config file location.\n    </ParamField>\n    \n    <ParamField body=\"args\" type=\"list[str]\">\n      Command-line arguments to pass to the server, passed after `--` to the server's argument parser.\n      ```json\n      \"args\": [\"--config\", \"server-config.json\"]\n      ```\n    </ParamField>\n  </Expandable>\n</ParamField>\n</Card>\n\n#### Environment Variable Interpolation\n\nThe `env` field in deployment configuration supports runtime interpolation of environment variables using `${VAR_NAME}` syntax. This enables dynamic configuration based on your deployment environment:\n\n```json\n{\n  \"deployment\": {\n    \"env\": {\n      \"API_URL\": \"https://api.${ENVIRONMENT}.example.com\",\n      \"DATABASE_URL\": \"postgres://${DB_USER}:${DB_PASS}@${DB_HOST}/myapp\",\n      \"CACHE_KEY\": \"myapp_${ENVIRONMENT}_${VERSION}\"\n    }\n  }\n}\n```\n\nWhen the server starts, FastMCP replaces `${ENVIRONMENT}`, `${DB_USER}`, etc. with values from your system's environment variables. If a variable doesn't exist, the placeholder is preserved as-is.\n\n**Example**: If your system has `ENVIRONMENT=production` and `DB_HOST=db.example.com`:\n```json\n// Configuration\n{\n  \"deployment\": {\n    \"env\": {\n      \"API_URL\": \"https://api.${ENVIRONMENT}.example.com\",\n      \"DB_HOST\": \"${DB_HOST}\"\n    }\n  }\n}\n\n// Result at runtime\n{\n  \"API_URL\": \"https://api.production.example.com\",\n  \"DB_HOST\": \"db.example.com\"\n}\n```\n\nThis feature is particularly useful for:\n- Deploying the same configuration across development, staging, and production\n- Keeping sensitive values out of configuration files\n- Building dynamic URLs and connection strings\n- Creating environment-specific prefixes or suffixes\n\n## Usage with CLI Commands\n\nFastMCP automatically detects and uses a file specifically named `fastmcp.json` in the current directory, making server execution simple and consistent. Files with FastMCP configuration format but different names are not auto-detected and must be specified explicitly:\n\n```bash\n# Auto-detect fastmcp.json in current directory\ncd my-project\nfastmcp run  # No arguments needed!\n\n# Or specify a configuration file explicitly\nfastmcp run prod.fastmcp.json\n\n# Skip environment setup when already in a uv environment\nfastmcp run fastmcp.json --skip-env\n\n# Skip source preparation when source is already prepared\nfastmcp run fastmcp.json --skip-source\n\n# Skip both environment and source preparation\nfastmcp run fastmcp.json --skip-env --skip-source\n```\n\n### Pre-building Environments\n\nYou can use `fastmcp project prepare` to create a persistent uv project with all dependencies pre-installed:\n\n```bash\n# Create a persistent environment\nfastmcp project prepare fastmcp.json --output-dir ./env\n\n# Use the pre-built environment to run the server\nfastmcp run fastmcp.json --project ./env\n```\n\nThis pattern separates environment setup (slow) from server execution (fast), useful for deployment scenarios.\n\n### Using an Existing Environment\n\nBy default, FastMCP creates an isolated environment with `uv` based on your configuration. When you already have a suitable Python environment, use the `--skip-env` flag to skip environment creation:\n\n```bash\nfastmcp run fastmcp.json --skip-env\n```\n\n**When you already have an environment:**\n- You're in an activated virtual environment with all dependencies installed\n- You're inside a Docker container with pre-installed dependencies  \n- You're in a CI/CD pipeline that pre-builds the environment\n- You're using a system-wide installation with all required packages\n- You're in a uv-managed environment (prevents infinite recursion)\n\nThis flag tells FastMCP: \"I already have everything installed, just run the server.\"\n\n### Using an Existing Source\n\nWhen working with source types that require preparation (future support for git repositories or cloud sources), use the `--skip-source` flag when you already have the source code available:\n\n```bash\nfastmcp run fastmcp.json --skip-source\n```\n\n**When you already have the source:**\n- You've previously cloned a git repository and don't need to re-fetch\n- You have a cached copy of a cloud-hosted server\n- You're in a CI/CD pipeline where source checkout is a separate step\n- You're iterating locally on already-downloaded code\n\nThis flag tells FastMCP: \"I already have the source code, skip any download/clone steps.\"\n\nNote: For filesystem sources (local Python files), this flag has no effect since they don't require preparation.\n\nThe configuration file works with all FastMCP commands:\n- **`run`** - Start the server in production mode\n- **`dev`** - Launch with the Inspector UI for development  \n- **`inspect`** - View server capabilities and configuration\n- **`install`** - Install to Claude Desktop, Cursor, or other MCP clients\n\nWhen no file argument is provided, FastMCP searches the current directory for `fastmcp.json`. This means you can simply navigate to your project directory and run `fastmcp run` to start your server with all its configured settings.\n\n### CLI Override Behavior\n\nCommand-line arguments take precedence over configuration file values, allowing ad-hoc adjustments without modifying the file:\n\n```bash\n# Config specifies port 3000, CLI overrides to 8080\nfastmcp run fastmcp.json --port 8080\n\n# Config specifies stdio, CLI overrides to HTTP\nfastmcp run fastmcp.json --transport http\n\n# Add extra dependencies not in config\nfastmcp run fastmcp.json --with requests --with httpx\n```\n\nThis precedence order enables:\n- Quick testing of different settings\n- Environment-specific overrides in deployment scripts\n- Debugging with increased log levels\n- Temporary configuration changes\n\n### Custom Naming Patterns\n\nYou can use different configuration files for different environments:\n\n- `fastmcp.json` - Default configuration\n- `dev.fastmcp.json` - Development settings\n- `prod.fastmcp.json` - Production settings\n- `test_fastmcp.json` - Test configuration\n\nAny file with \"fastmcp.json\" in the name is recognized as a configuration file.\n\n## Examples\n\n<Tabs>\n<Tab title=\"Basic Configuration\">\n\nA minimal configuration for a simple server:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  }\n}\n```\nThis configuration explicitly specifies the server entrypoint (`mcp`), making it clear which server instance or factory function to use. Uses all defaults: STDIO transport, no special dependencies, standard logging.\n</Tab>\n<Tab title=\"Development Configuration\">\n\nA configuration optimized for local development:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  // WHERE does the server live?\n  \"source\": {\n    \"path\": \"src/server.py\",\n    \"entrypoint\": \"app\"\n  },\n  // WHAT dependencies does it need?\n  \"environment\": {\n    \"type\": \"uv\",\n    \"python\": \"3.12\",\n    \"dependencies\": [\"fastmcp[dev]\"],\n    \"editable\": \".\"\n  },\n  // HOW should it run?\n  \"deployment\": {\n    \"transport\": \"http\",\n    \"host\": \"127.0.0.1\",\n    \"port\": 8000,\n    \"log_level\": \"DEBUG\",\n    \"env\": {\n      \"DEBUG\": \"true\",\n      \"ENV\": \"development\"\n    }\n  }\n}\n```\n</Tab>\n<Tab title=\"Production Configuration\">\n\nA production-ready configuration with full dependency management:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  // WHERE does the server live?\n  \"source\": {\n    \"path\": \"app/main.py\",\n    \"entrypoint\": \"mcp_server\"\n  },\n  // WHAT dependencies does it need?\n  \"environment\": {\n    \"python\": \"3.11\",\n    \"requirements\": \"requirements/production.txt\",\n    \"project\": \".\"\n  },\n  // HOW should it run?\n  \"deployment\": {\n    \"transport\": \"http\",\n    \"host\": \"0.0.0.0\",\n    \"port\": 3000,\n    \"path\": \"/api/mcp/\",\n    \"log_level\": \"INFO\",\n    \"env\": {\n      \"ENV\": \"production\",\n      \"API_BASE_URL\": \"https://api.example.com\",\n      \"DATABASE_URL\": \"postgresql://user:pass@db.example.com/prod\"\n    },\n    \"cwd\": \"/app\",\n    \"args\": [\"--workers\", \"4\"]\n  }\n}\n```\n</Tab>\n<Tab title=\"Data Science Server\">\n\nConfiguration for a data analysis server with scientific packages:\n\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"analysis_server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"python\": \"3.11\",\n    \"dependencies\": [\n      \"pandas>=2.0\",\n      \"numpy\",\n      \"scikit-learn\",\n      \"matplotlib\",\n      \"jupyterlab\"\n    ]\n  },\n  \"deployment\": {\n    \"transport\": \"stdio\",\n    \"env\": {\n      \"MATPLOTLIB_BACKEND\": \"Agg\",\n      \"DATA_PATH\": \"./datasets\"\n    }\n  }\n}\n```\n</Tab>\n<Tab title=\"Multi-Environment Setup\"> \n\nYou can maintain multiple configuration files for different environments:\n\n**dev.fastmcp.json**:\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"deployment\": {\n    \"transport\": \"http\",\n    \"log_level\": \"DEBUG\"\n  }\n}\n```\n\n**prod.fastmcp.json**:\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"requirements\": \"requirements/production.txt\"\n  },\n  \"deployment\": {\n    \"transport\": \"http\",\n    \"host\": \"0.0.0.0\",\n    \"log_level\": \"WARNING\"\n  }\n}\n```\n\nRun different configurations:\n```bash\nfastmcp run dev.fastmcp.json   # Development\nfastmcp run prod.fastmcp.json  # Production\n```\n</Tab>\n</Tabs>\n\n## Migrating from CLI Arguments\n\nIf you're currently using command-line arguments or shell scripts, migrating to `fastmcp.json` simplifies your workflow. Here's how common CLI patterns map to configuration:\n\n**CLI Command**:\n```bash\nuv run --with pandas --with requests \\\n  fastmcp run server.py \\\n  --transport http \\\n  --port 8000 \\\n  --log-level INFO\n```\n\n**Equivalent fastmcp.json**:\n```json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"requests\"]\n  },\n  \"deployment\": {\n    \"transport\": \"http\",\n    \"port\": 8000,\n    \"log_level\": \"INFO\"\n  }\n}\n```\n\nNow simply run:\n```bash\nfastmcp run  # Automatically finds and uses fastmcp.json\n```\n\nThe configuration file approach provides better documentation, easier sharing, and consistent execution across different environments while maintaining the flexibility to override settings when needed."}, {"filename": "docs/development/contributing.mdx", "content": "---\ntitle: \"Contributing\"\ndescription: \"Development workflow for FastMCP contributors\"\nicon: code-pull-request\n---\n\nContributing to FastMCP means joining a community that values clean, maintainable code and thoughtful API design. All contributions are valued - from fixing typos in documentation to implementing major features.\n\n## Issues\n\n### Issue First, Code Second\n\n**Every pull request requires a corresponding issue - no exceptions.** This requirement creates a collaborative space where approach, scope, and alignment are established before code is written. Issues serve as design documents where maintainers and contributors discuss implementation strategy, identify potential conflicts with existing patterns, and ensure proposed changes advance FastMCP's vision.\n\n**FastMCP is an opinionated framework, not a kitchen sink.** The maintainers have strong beliefs about what FastMCP should and shouldn't do. Just because something takes N lines of code and you want it in fewer lines doesn't mean FastMCP should take on the maintenance burden or endorse that pattern. This is judged at the maintainers' discretion.\n\nUse issues to understand scope BEFORE opening PRs. The issue discussion determines whether a feature belongs in core, contrib, or not at all.\n\n### Writing Good Issues\n\nFastMCP is an extremely highly-trafficked repository maintained by a very small team. Issues that appear to transfer burden to maintainers without any effort to validate the problem will be closed. Please help the maintainers help you by always providing a minimal reproducible example and clearly describing the problem.\n\n**LLM-generated issues will be closed immediately.** Issues that contain paragraphs of unnecessary explanation, verbose problem descriptions, or obvious LLM authorship patterns obfuscate the actual problem and transfer burden to maintainers.\n\nWrite clear, concise issues that:\n- State the problem directly\n- Provide a minimal reproducible example\n- Skip unnecessary background or context\n- Take responsibility for clear communication\n\nIssues may be labeled \"Invalid\" simply due to confusion caused by verbosity or not adhering to the guidelines outlined here.\n\n## Pull Requests\n\nPRs that deviate from FastMCP's core principles will be rejected regardless of implementation quality. **PRs are NOT for iterating on ideas** - they should only be opened for ideas that already have a bias toward acceptance based on issue discussion.\n\n\n### Development Environment\n\n#### Installation\n\nTo contribute to FastMCP, you'll need to set up a development environment with all necessary tools and dependencies.\n\n```bash\n# Clone the repository\ngit clone https://github.com/jlowin/fastmcp.git\ncd fastmcp\n\n# Install all dependencies including dev tools\nuv sync\n\n# Install prek hooks\nuv run prek install\n```\n\nIn addition, some development commands require [just](https://github.com/casey/just) to be installed.\n\nPrek hooks will run automatically on every commit to catch issues before they reach CI. If you see failures, fix them before committing - never commit broken code expecting to fix it later.\n\n### Development Standards\n\n#### Scope\n\nLarge pull requests create review bottlenecks and quality risks. Unless you're fixing a discrete bug or making an incredibly well-scoped change, keep PRs small and focused. \n\nA PR that changes 50 lines across 3 files can be thoroughly reviewed in minutes. A PR that changes 500 lines across 20 files requires hours of careful analysis and often hides subtle issues.\n\nBreaking large features into smaller PRs:\n- Creates better review experiences\n- Makes git history clear\n- Simplifies debugging with bisect\n- Reduces merge conflicts\n- Gets your code merged faster\n\n#### Code Quality\n\nFastMCP values clarity over cleverness. Every line you write will be maintained by someone else - possibly years from now, possibly without context about your decisions.\n\n**PRs can be rejected for two opposing reasons:**\n1. **Insufficient quality** - Code that doesn't meet our standards for clarity, maintainability, or idiomaticity\n2. **Overengineering** - Code that is overbearing, unnecessarily complex, or tries to be too clever\n\nThe focus is on idiomatic, high-quality Python. FastMCP uses patterns like `NotSet` type as an alternative to `None` in certain situations - follow existing patterns.\n\n#### Required Practices\n\n**Full type annotations** on all functions and methods. They catch bugs before runtime and serve as inline documentation.\n\n**Async/await patterns** for all I/O operations. Even if your specific use case doesn't need concurrency, consistency means users can compose features without worrying about blocking operations.\n\n**Descriptive names** make code self-documenting. `auth_token` is clear; `tok` requires mental translation.\n\n**Specific exception types** make error handling predictable. Catching `ValueError` tells readers exactly what error you expect. Never use bare `except` clauses.\n\n#### Anti-Patterns to Avoid\n\n**Complex one-liners** are hard to debug and modify. Break operations into clear steps.\n\n**Mutable default arguments** cause subtle bugs. Use `None` as the default and create the mutable object inside the function.\n\n**Breaking established patterns** confuses readers. If you must deviate, discuss in the issue first.\n\n### Prek Checks\n\n```bash\n# Runs automatically on commit, or manually:\nuv run prek run --all-files\n```\n\nThis runs three critical tools:\n- **Ruff**: Linting and formatting\n- **Prettier**: Code formatting\n- **ty**: Static type checking\n\nPytest runs separately as a distinct workflow step after prek checks pass. CI will reject PRs that fail these checks. Always run them locally first.\n\n### Testing\n\nTests are documentation that shows how features work. Good tests give reviewers confidence and help future maintainers understand intent.\n\n```bash\n# Run specific test directory\nuv run pytest tests/server/ -v\n\n# Run all tests before submitting PR\nuv run pytest\n```\n\nEvery new feature needs tests. See the [Testing Guide](/development/tests) for patterns and requirements.\n\n### Documentation\n\nA feature doesn't exist unless it's documented. Note that FastMCP's hosted documentation always tracks the main branch - users who want historical documentation can clone the repo, checkout a specific tag, and host it themselves.\n\n```bash\n# Preview documentation locally\njust docs\n```\n\nDocumentation requirements:\n- **Explain concepts in prose first** - Code without context is just syntax\n- **Complete, runnable examples** - Every code block should be copy-pasteable\n- **Register in docs.json** - Makes pages appear in navigation\n- **Version badges** - Mark when features were added using `<VersionBadge />`\n\n#### SDK Documentation\n\nFastMCP's SDK documentation is auto-generated from the source code docstrings and type annotations. It is automatically updated on every merge to main by a GitHub Actions workflow, so users are *not* responsible for keeping the documentation up to date. However, to generate it proactively, you can use the following command:\n\n```bash\njust api-ref-all\n```\n\n### Submitting Your PR\n\n#### Before Submitting\n\n1. **Run all checks**: `uv run prek run --all-files && uv run pytest`\n2. **Keep scope small**: One feature or fix per PR\n3. **Write clear description**: Your PR description becomes permanent documentation\n4. **Update docs**: Include documentation for API changes\n\n#### PR Description\n\nWrite PR descriptions that explain:\n- What problem you're solving\n- Why you chose this approach  \n- Any trade-offs or alternatives considered\n- Migration path for breaking changes\n\nFocus on the \"why\" - the code shows the \"what\". Keep it concise but complete.\n\n#### What We Look For\n\n**Framework Philosophy**: FastMCP is NOT trying to do all things or provide all shortcuts. Features are rejected when they don't align with the framework's vision, even if perfectly implemented. The burden of proof is on the PR to demonstrate value.\n\n**Code Quality**: We verify code follows existing patterns. Consistency reduces cognitive load. When every module works similarly, developers understand new code quickly.\n\n**Test Coverage**: Not every line needs testing, but every behavior does. Tests document intent and protect against regressions.\n\n**Breaking Changes**: May be acceptable in minor versions but must be clearly documented. See the [versioning policy](/development/releases#versioning-policy).\n\n## Special Modules\n\n**`contrib`**: Community-maintained patterns and utilities. Original authors maintain their contributions. Not representative of the core framework.\n\n**`experimental`**: Maintainer-developed features that may preview future functionality. Can break or be deleted at any time without notice. Pin your FastMCP version when using these features."}, {"filename": "docs/development/releases.mdx", "content": "---\ntitle: \"Releases\"\ndescription: \"FastMCP versioning and release process\"\nicon: \"truck-fast\"\n---\n\nFastMCP releases frequently to deliver features quickly in the rapidly evolving MCP ecosystem. We use semantic versioning pragmatically - the Model Context Protocol is young, patterns are still emerging, and waiting for perfect stability would mean missing opportunities to empower developers with better tools.\n\n## Versioning Policy\n\n### Semantic Versioning\n\n**Major (x.0.0)**: Complete API redesigns\n\nMajor versions represent fundamental shifts. FastMCP 2.x is entirely different from 1.x in both implementation and design philosophy.\n\n**Minor (2.x.0)**: New features and evolution\n\n<Warning>\nUnlike traditional semantic versioning, minor versions **may** include [breaking changes](#breaking-changes) when necessary for the ecosystem's evolution. This flexibility is essential in a young ecosystem where perfect backwards compatibility would prevent important improvements.\n</Warning>\n\nFastMCP always targets the most current MCP Protocol version. Breaking changes in the MCP spec or MCP SDK automatically flow through to FastMCP - we prioritize staying current with the latest features and conventions over maintaining compatibility with older protocol versions.\n\n**Patch (2.0.x)**: Bug fixes and refinements\n\nPatch versions contain only bug fixes without breaking changes. These are safe updates you can apply with confidence.\n\n### Breaking Changes\n\nWe permit breaking changes in minor versions because the MCP ecosystem is rapidly evolving. Refusing to break problematic APIs would accumulate design debt that eventually makes the framework unusable. Each breaking change represents a deliberate decision to keep FastMCP aligned with the ecosystem's evolution.\n\nWhen breaking changes occur:\n- They only happen in minor versions (e.g., 2.3.x to 2.4.0)\n- Release notes explain what changed and how to migrate\n- We provide deprecation warnings at least 1 minor version in advance when possible\n- Changes must substantially benefit users to justify disruption\n\nThe public API is what's covered by our compatibility guarantees - these are the parts of FastMCP you can rely on to remain stable within a minor version. The public API consists of:\n- `FastMCP` server class, `Client` class, and FastMCP `Context`\n- Core MCP components: `Tool`, `Prompt`, `Resource`, `ResourceTemplate`, and transports\n- Their public methods and documented behaviors\n\nEverything else (utilities, private methods, internal modules) may change without notice. This boundary lets us refactor internals and improve implementation details without breaking your code. For production stability, pin to specific versions.\n\n<Warning>\nThe `fastmcp.server.auth` module was introduced in 2.12.0 and is exempted from this policy temporarily, meaning it is *expected* to have breaking changes even on patch versions. This is because auth is a rapidly evolving part of the MCP spec and it would be dangerous to be beholden to old decisions. Please pin your FastMCP version if using authentication in production.\n\nWe expect this exemption to last through at least the 2.12.x and 2.13.x release series. \n</Warning>\n\n### Production Use\n\nPin to exact versions:\n```\nfastmcp==2.11.0  # Good\nfastmcp>=2.11.0  # Bad - will install breaking changes\n```\n\n## Creating Releases\n\nOur release process is intentionally simple:\n\n1. Create GitHub release with tag `vMAJOR.MINOR.PATCH` (e.g., `v2.11.0`)\n2. Generate release notes automatically, and curate or add additional editorial information as needed\n3. GitHub releases automatically trigger PyPI deployments\n\nThis automation lets maintainers focus on code quality rather than release mechanics.\n\n### Release Cadence\n\nWe follow a feature-driven release cadence rather than a fixed schedule. Minor versions ship approximately every 3-4 weeks when significant functionality is ready.\n\nPatch releases ship promptly for:\n- Critical bug fixes\n- Security updates (immediate release)\n- Regression fixes\n\nThis approach means you get improvements as soon as they're ready rather than waiting for arbitrary release dates.\n"}, {"filename": "docs/development/tests.mdx", "content": "---\ntitle: \"Tests\"\ndescription: \"Testing patterns and requirements for FastMCP\"\nicon: vial\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\nGood tests are the foundation of reliable software. In FastMCP, we treat tests as first-class documentation that demonstrates how features work while protecting against regressions. Every new capability needs comprehensive tests that demonstrate correctness.\n\n## FastMCP Tests\n\n### Running Tests\n\n```bash\n# Run all tests\nuv run pytest\n\n# Run specific test file\nuv run pytest tests/server/test_auth.py\n\n# Run with coverage\nuv run pytest --cov=fastmcp\n\n# Skip integration tests for faster runs\nuv run pytest -m \"not integration\"\n\n# Skip tests that spawn processes\nuv run pytest -m \"not integration and not client_process\"\n```\n\nTests should complete in under 1 second unless marked as integration tests. This speed encourages running them frequently, catching issues early.\n\n### Test Organization\n\nOur test organization mirrors the `src/` directory structure, creating a predictable mapping between code and tests. When you're working on `src/fastmcp/server/auth.py`, you'll find its tests in `tests/server/test_auth.py`. In rare cases tests are split further - for example, the OpenAPI tests are so comprehensive they're split across multiple files.\n\n### Test Markers\n\nWe use pytest markers to categorize tests that require special resources or take longer to run:\n\n```python\n@pytest.mark.integration\nasync def test_github_api_integration():\n    \"\"\"Test GitHub API integration with real service.\"\"\"\n    token = os.getenv(\"FASTMCP_GITHUB_TOKEN\")\n    if not token:\n        pytest.skip(\"FASTMCP_GITHUB_TOKEN not available\")\n    \n    # Test against real GitHub API\n    client = GitHubClient(token)\n    repos = await client.list_repos(\"jlowin\")\n    assert \"fastmcp\" in [repo.name for repo in repos]\n\n@pytest.mark.client_process\nasync def test_stdio_transport():\n    \"\"\"Test STDIO transport with separate process.\"\"\"\n    # This spawns a subprocess\n    async with Client(\"python examples/simple_echo.py\") as client:\n        result = await client.call_tool(\"echo\", {\"message\": \"test\"})\n        assert result.content[0].text == \"test\"\n```\n\n## Writing Tests\n\n\n### Test Requirements\n\nFollowing these practices creates maintainable, debuggable test suites that serve as both documentation and regression protection.\n\n#### Single Behavior Per Test\n\nEach test should verify exactly one behavior. When it fails, you need to know immediately what broke. A test that checks five things gives you five potential failure points to investigate. A test that checks one thing points directly to the problem.\n\n<CodeGroup>\n\n```python Good: Atomic Test\nasync def test_tool_registration():\n    \"\"\"Test that tools are properly registered with the server.\"\"\"\n    mcp = FastMCP(\"test-server\")\n    \n    @mcp.tool\n    def add(a: int, b: int) -> int:\n        return a + b\n    \n    tools = mcp.list_tools()\n    assert len(tools) == 1\n    assert tools[0].name == \"add\"\n```\n\n```python Bad: Multi-Behavior Test\nasync def test_server_functionality():\n    \"\"\"Test multiple server features at once.\"\"\"\n    mcp = FastMCP(\"test-server\")\n    \n    # Tool registration\n    @mcp.tool\n    def add(a: int, b: int) -> int:\n        return a + b\n    \n    # Resource creation\n    @mcp.resource(\"config://app\")\n    def get_config():\n        return {\"version\": \"1.0\"}\n    \n    # Authentication setup\n    mcp.auth = BearerTokenProvider({\"token\": \"user\"})\n    \n    # What exactly are we testing? If this fails, what broke?\n    assert mcp.list_tools()\n    assert mcp.list_resources()\n    assert mcp.auth is not None\n```\n\n</CodeGroup>\n\n#### Self-Contained Setup\n\nEvery test must create its own setup. Tests should be runnable in any order, in parallel, or in isolation. When a test fails, you should be able to run just that test to reproduce the issue.\n\n<CodeGroup>\n\n```python Good: Self-Contained\nasync def test_tool_execution_with_error():\n    \"\"\"Test that tool errors are properly handled.\"\"\"\n    mcp = FastMCP(\"test-server\")\n    \n    @mcp.tool\n    def divide(a: int, b: int) -> float:\n        if b == 0:\n            raise ValueError(\"Cannot divide by zero\")\n        return a / b\n    \n    async with Client(mcp) as client:\n        with pytest.raises(Exception):\n            await client.call_tool(\"divide\", {\"a\": 10, \"b\": 0})\n```\n\n```python Bad: Test Dependencies\n# Global state that tests depend on\ntest_server = None\n\ndef test_setup_server():\n    \"\"\"Setup for other tests.\"\"\"\n    global test_server\n    test_server = FastMCP(\"shared-server\")\n\ndef test_server_works():\n    \"\"\"Test server functionality.\"\"\"\n    # Depends on test_setup_server running first\n    assert test_server is not None\n```\n\n</CodeGroup>\n\n#### Clear Intent\n\nTest names and assertions should make the verified behavior obvious. A developer reading your test should understand what feature it validates and how that feature should behave.\n\n```python\nasync def test_authenticated_tool_requires_valid_token():\n    \"\"\"Test that authenticated users can access protected tools.\"\"\"\n    mcp = FastMCP(\"test-server\")\n    mcp.auth = BearerTokenProvider({\"secret-token\": \"test-user\"})\n    \n    @mcp.tool\n    def protected_action() -> str:\n        return \"success\"\n    \n    async with Client(mcp, auth=BearerAuth(\"secret-token\")) as client:\n        result = await client.call_tool(\"protected_action\", {})\n        assert result.content[0].text == \"success\"\n```\n\n#### Using Fixtures\n\nUse fixtures to create reusable data, server configurations, or other resources for your tests. Note that you should **not** open FastMCP clients in your fixtures as it can create hard-to-diagnose issues with event loops.\n\n```python\nimport pytest\nfrom fastmcp import FastMCP, Client\n\n@pytest.fixture\ndef weather_server():\n    server = FastMCP(\"WeatherServer\")\n    \n    @server.tool\n    def get_temperature(city: str) -> dict:\n        temps = {\"NYC\": 72, \"LA\": 85, \"Chicago\": 68}\n        return {\"city\": city, \"temp\": temps.get(city, 70)}\n    \n    return server\n\nasync def test_temperature_tool(weather_server):\n    async with Client(weather_server) as client:\n        result = await client.call_tool(\"get_temperature\", {\"city\": \"LA\"})\n        assert result.data == {\"city\": \"LA\", \"temp\": 85}\n```\n\n#### Effective Assertions\n\nAssertions should be specific and provide context on failure. When a test fails during CI, the assertion message should tell you exactly what went wrong.\n\n```python\n# Basic assertion - minimal context on failure\nassert result.status == \"success\"\n\n# Better - explains what was expected\nassert result.status == \"success\", f\"Expected successful operation, got {result.status}: {result.error}\"\n```\n\nTry not to have too many assertions in a single test unless you truly need to check various aspects of the same behavior. In general, assertions of different behaviors should be in separate tests.\n\n#### Inline Snapshots\n\nFastMCP uses `inline-snapshot` for testing complex data structures. On first run of `pytest --inline-snapshot=create` with an empty `snapshot()`, pytest will auto-populate the expected value. To update snapshots after intentional changes, run `pytest --inline-snapshot=fix`. This is particularly useful for testing JSON schemas and API responses.\n\n```python\nfrom inline_snapshot import snapshot\n\nasync def test_tool_schema_generation():\n    \"\"\"Test that tool schemas are generated correctly.\"\"\"\n    mcp = FastMCP(\"test-server\")\n    \n    @mcp.tool\n    def calculate_tax(amount: float, rate: float = 0.1) -> dict:\n        \"\"\"Calculate tax on an amount.\"\"\"\n        return {\"amount\": amount, \"tax\": amount * rate, \"total\": amount * (1 + rate)}\n    \n    tools = mcp.list_tools()\n    schema = tools[0].inputSchema\n    \n    # First run: snapshot() is empty, gets auto-populated\n    # Subsequent runs: compares against stored snapshot\n    assert schema == snapshot({\n        \"type\": \"object\", \n        \"properties\": {\n            \"amount\": {\"type\": \"number\"}, \n            \"rate\": {\"type\": \"number\", \"default\": 0.1}\n        }, \n        \"required\": [\"amount\"]\n    })\n```\n\n### In-Memory Testing\n\nFastMCP uses in-memory transport for testing, where servers and clients communicate directly. The majority of functionality can be tested in a deterministic fashion this way. We use more complex setups only when testing transports themselves.\n\nThe in-memory transport runs the real MCP protocol implementation without network overhead. Instead of deploying your server or managing network connections, you pass your server instance directly to the client. Everything runs in the same Python process - you can set breakpoints anywhere and step through with your debugger.\n\n```python\nfrom fastmcp import FastMCP, Client\n\n# Create your server\nserver = FastMCP(\"WeatherServer\")\n\n@server.tool\ndef get_temperature(city: str) -> dict:\n    \"\"\"Get current temperature for a city\"\"\"\n    temps = {\"NYC\": 72, \"LA\": 85, \"Chicago\": 68}\n    return {\"city\": city, \"temp\": temps.get(city, 70)}\n\nasync def test_weather_operations():\n    # Pass server directly - no deployment needed\n    async with Client(server) as client:\n        result = await client.call_tool(\"get_temperature\", {\"city\": \"NYC\"})\n        assert result.data == {\"city\": \"NYC\", \"temp\": 72}\n```\n\nThis pattern makes tests deterministic and fast - typically completing in milliseconds rather than seconds.\n\n### Mocking External Dependencies\n\nFastMCP servers are standard Python objects, so you can mock external dependencies using your preferred approach:\n\n```python\nfrom unittest.mock import AsyncMock\n\nasync def test_database_tool():\n    server = FastMCP(\"DataServer\")\n    \n    # Mock the database\n    mock_db = AsyncMock()\n    mock_db.fetch_users.return_value = [\n        {\"id\": 1, \"name\": \"Alice\"},\n        {\"id\": 2, \"name\": \"Bob\"}\n    ]\n    \n    @server.tool\n    async def list_users() -> list:\n        return await mock_db.fetch_users()\n    \n    async with Client(server) as client:\n        result = await client.call_tool(\"list_users\", {})\n        assert len(result.data) == 2\n        assert result.data[0][\"name\"] == \"Alice\"\n        mock_db.fetch_users.assert_called_once()\n```\n\n### Testing Network Transports\n\nWhile in-memory testing covers most unit testing needs, you'll occasionally need to test actual network transports like HTTP or SSE. FastMCP provides two approaches: in-process async servers (preferred), and separate subprocess servers (for special cases).\n\n#### In-Process Network Testing (Preferred)\n\n<VersionBadge version=\"2.13.0\" />\n\nFor most network transport tests, use `run_server_async` as an async context manager. This runs the server as a task in the same process, providing fast, deterministic tests with full debugger support:\n\n```python\nimport pytest\nfrom fastmcp import FastMCP, Client\nfrom fastmcp.client.transports import StreamableHttpTransport\nfrom fastmcp.utilities.tests import run_server_async\n\ndef create_test_server() -> FastMCP:\n    \"\"\"Create a test server instance.\"\"\"\n    server = FastMCP(\"TestServer\")\n\n    @server.tool\n    def greet(name: str) -> str:\n        return f\"Hello, {name}!\"\n\n    return server\n\n@pytest.fixture\nasync def http_server() -> str:\n    \"\"\"Start server in-process for testing.\"\"\"\n    server = create_test_server()\n    async with run_server_async(server) as url:\n        yield url\n\nasync def test_http_transport(http_server: str):\n    \"\"\"Test actual HTTP transport behavior.\"\"\"\n    async with Client(\n        transport=StreamableHttpTransport(http_server)\n    ) as client:\n        result = await client.ping()\n        assert result is True\n\n        greeting = await client.call_tool(\"greet\", {\"name\": \"World\"})\n        assert greeting.data == \"Hello, World!\"\n```\n\nThe `run_server_async` context manager automatically handles server lifecycle and cleanup. This approach is faster than subprocess-based testing and provides better error messages.\n\n#### Subprocess Testing (Special Cases)\n\nFor tests that require complete process isolation (like STDIO transport or testing subprocess behavior), use `run_server_in_process`:\n\n```python\nimport pytest\nfrom fastmcp.utilities.tests import run_server_in_process\nfrom fastmcp import FastMCP, Client\nfrom fastmcp.client.transports import StreamableHttpTransport\n\ndef run_server(host: str, port: int) -> None:\n    \"\"\"Function to run in subprocess.\"\"\"\n    server = FastMCP(\"TestServer\")\n    \n    @server.tool\n    def greet(name: str) -> str:\n        return f\"Hello, {name}!\"\n    \n    server.run(host=host, port=port)\n\n@pytest.fixture\nasync def http_server():\n    \"\"\"Fixture that runs server in subprocess.\"\"\"\n    with run_server_in_process(run_server, transport=\"http\") as url:\n        yield f\"{url}/mcp\"\n\nasync def test_http_transport(http_server: str):\n    \"\"\"Test actual HTTP transport behavior.\"\"\"\n    async with Client(\n        transport=StreamableHttpTransport(http_server)\n    ) as client:\n        result = await client.ping()\n        assert result is True\n```\n\nThe `run_server_in_process` utility handles server lifecycle, port allocation, and cleanup automatically. Use this only when subprocess isolation is truly necessary, as it's slower and harder to debug than in-process testing. FastMCP uses the `client_process` marker to isolate these tests in CI.\n\n### Documentation Testing\n\nDocumentation requires the same validation as code. The `just docs` command launches a local Mintlify server that renders your documentation exactly as users will see it:\n\n```bash\n# Start local documentation server with hot reload\njust docs\n\n# Or run Mintlify directly\nmintlify dev\n```\n\nThe local server watches for changes and automatically refreshes. This preview catches formatting issues and helps you see documentation as users will experience it."}, {"filename": "docs/development/upgrade-guide.mdx", "content": "---\ntitle: Upgrade Guide\nsidebarTitle: Upgrade Guide\ndescription: Migration instructions for upgrading between FastMCP versions\nicon: up\ntag: NEW\n---\n\nThis guide provides migration instructions for breaking changes and major updates when upgrading between FastMCP versions.\n\n## v3.0.0\n\n### Component Enable/Disable\n\nThe `enabled` field and `enable()`/`disable()` methods have been removed from component objects. Use server or provider methods instead:\n\n<CodeGroup>\n```python Before\ntool = await server.get_tool(\"my_tool\")\ntool.disable()\ntool.enable()\n```\n\n```python After\nserver.disable(keys=[\"tool:my_tool\"])\nserver.enable(keys=[\"tool:my_tool\"])\n```\n</CodeGroup>\n\nComponents describe capabilities; servers and providers control availability. This ensures mutations work correctly even when components pass through transforming providers.\n\n**Allowlist mode:**\n\nUse `only=True` to restrict visibility to specific components:\n\n```python\n# Show ONLY tools with \"public\" tag\nserver.enable(tags={\"public\"}, only=True)\n```\n\n**`FastMCP(include_tags=..., exclude_tags=...)` deprecated:**\n\nThese init parameters emit deprecation warnings. Use the new methods instead:\n\n```python\n# Before\nmcp = FastMCP(\"server\", exclude_tags={\"internal\"})\n\n# After\nmcp = FastMCP(\"server\")\nmcp.disable(tags={\"internal\"})\n```\n\n### Component Lookup Method Parameter Names\n\nThe server lookup methods now use semantic parameter names instead of generic `key`:\n\n- `FastMCP.get_tool(name=...)` (was `key`)\n- `FastMCP.get_resource(uri=...)` (was `key`)\n- `FastMCP.get_resource_template(uri=...)` (was `key`)\n- `FastMCP.get_prompt(name=...)` (was `key`)\n\nIf you were passing arguments positionally, no change is needed. If you were using keyword arguments:\n\n<CodeGroup>\n```python Before\ntool = await mcp.get_tool(key=\"my_tool\")\n```\n\n```python After\ntool = await mcp.get_tool(name=\"my_tool\")\n```\n</CodeGroup>\n\n### Component Listing Methods Return Lists\n\nThe `get_tools()`, `get_resources()`, `get_prompts()`, and `get_resource_templates()` methods now return lists instead of dicts:\n\n<CodeGroup>\n```python Before\ntools = await server.get_tools()\nif \"my_tool\" in tools:\n    tool = tools[\"my_tool\"]\n```\n\n```python After\ntools = await server.get_tools()\ntool = next((t for t in tools if t.name == \"my_tool\"), None)\n```\n</CodeGroup>\n\nThe dict key was redundant since components already have `.name` or `.uri` attributes. Use list comprehensions or `next()` for lookups.\n\n## v2.14.0\n\n### OpenAPI Parser Promotion\n\nThe experimental OpenAPI parser is now the standard implementation. The legacy parser has been removed.\n\n**If you were using the legacy parser:** No code changes required. The new parser is a drop-in replacement with improved architecture.\n\n**If you were using the experimental parser:** Update your imports from the experimental module to the standard location:\n\n<CodeGroup>\n```python Before\nfrom fastmcp.experimental.server.openapi import FastMCPOpenAPI, RouteMap, MCPType\n```\n\n```python After\nfrom fastmcp.server.openapi import FastMCPOpenAPI, RouteMap, MCPType\n```\n</CodeGroup>\n\nThe experimental imports will continue working temporarily but will show deprecation warnings. The `FASTMCP_EXPERIMENTAL_ENABLE_NEW_OPENAPI_PARSER` environment variable is no longer needed and can be removed.\n\n### Deprecated Features Removed\n\nThe following deprecated features have been removed in v2.14.0:\n\n**BearerAuthProvider** (deprecated in v2.11):\n<CodeGroup>\n```python Before\nfrom fastmcp.server.auth.providers.bearer import BearerAuthProvider\n```\n\n```python After\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n```\n</CodeGroup>\n\n**Context.get_http_request()** (deprecated in v2.2.11):\n<CodeGroup>\n```python Before\nrequest = context.get_http_request()\n```\n\n```python After\nfrom fastmcp.server.dependencies import get_http_request\nrequest = get_http_request()\n```\n</CodeGroup>\n\n**Top-level Image import** (deprecated in v2.8.1):\n<CodeGroup>\n```python Before\nfrom fastmcp import Image\n```\n\n```python After\nfrom fastmcp.utilities.types import Image\n```\n</CodeGroup>\n\n**FastMCP dependencies parameter** (deprecated in v2.11.4):\n<CodeGroup>\n```python Before\nmcp = FastMCP(\"server\", dependencies=[\"requests\", \"pandas\"])\n```\n\n```json After\n{\n  \"environment\": {\n    \"dependencies\": [\"requests\", \"pandas\"]\n  }\n}\n```\n</CodeGroup>\n\n**Legacy resource prefix format**: The `resource_prefix_format` parameter and \"protocol\" format have been removed. Only the \"path\" format is supported (this was already the default).\n\n**FastMCPProxy client parameter**:\n<CodeGroup>\n```python Before\nproxy = FastMCPProxy(client=my_client)\n```\n\n```python After\nproxy = FastMCPProxy(client_factory=lambda: my_client)\n```\n</CodeGroup>\n\n**output_schema=False**:\n<CodeGroup>\n```python Before\n@mcp.tool(output_schema=False)\ndef my_tool() -> str:\n    return \"result\"\n```\n\n```python After\n@mcp.tool(output_schema=None)\ndef my_tool() -> str:\n    return \"result\"\n```\n</CodeGroup>\n\n## v2.13.0\n\n### OAuth Token Key Management\n\nThe OAuth proxy now issues its own JWT tokens to clients instead of forwarding upstream provider tokens. This improves security by maintaining proper token audience boundaries.\n\n**What changed:**\n\nThe OAuth proxy now implements a token factory pattern - it receives tokens from your OAuth provider (GitHub, Google, etc.), encrypts and stores them, then issues its own FastMCP JWT tokens to clients. This requires cryptographic keys for JWT signing and token encryption.\n\n**Default behavior (development):**\n\nBy default, FastMCP automatically manages keys based on your platform:\n- **Mac/Windows**: Keys are auto-managed via system keyring, surviving server restarts with zero configuration. Suitable **only** for development and local testing.\n- **Linux**: Keys are ephemeral (random salt at startup, regenerated on each restart).\n\nThis works fine for development and testing where re-authentication after restart is acceptable.\n\n**For production:**\n\nProduction deployments must provide explicit keys and use persistent storage. Add these three things:\n\n```python\nauth = GitHubProvider(\n    client_id=os.environ[\"GITHUB_CLIENT_ID\"],\n    client_secret=os.environ[\"GITHUB_CLIENT_SECRET\"],\n    base_url=\"https://your-server.com\",\n\n    # Explicit keys (required for production)\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n\n    # Persistent network storage (required for production)\n    client_storage=RedisStore(host=\"redis.example.com\", port=6379)\n)\n```\n\n**More information:**\n- [OAuth Token Security](/deployment/http#oauth-token-security) - Complete production setup guide\n- [Key and Storage Management](/servers/auth/oauth-proxy#key-and-storage-management) - Detailed explanation of defaults and production requirements\n- [OAuth Proxy Parameters](/servers/auth/oauth-proxy#configuration-parameters) - Parameter documentation\n"}, {"filename": "docs/getting-started/installation.mdx", "content": "---\ntitle: Installation\nicon: arrow-down-to-line\n---\n## Install FastMCP\n\nWe recommend using [uv](https://docs.astral.sh/uv/getting-started/installation/) to install and manage FastMCP.\n\nIf you plan to use FastMCP in your project, you can add it as a dependency with:\n\n```bash\nuv add fastmcp\n```\n\nAlternatively, you can install it directly with `pip` or `uv pip`:\n<CodeGroup>\n    ```bash uv\n    uv pip install fastmcp\n    ```\n\n    ```bash pip\n    pip install fastmcp\n    ```\n</CodeGroup>\n\n### Verify Installation\n\nTo verify that FastMCP is installed correctly, you can run the following command:\n\n```bash\nfastmcp version\n```\n\nYou should see output like the following:\n\n```bash\n$ fastmcp version\n\nFastMCP version:                           2.11.3\nMCP version:                               1.12.4\nPython version:                            3.12.2\nPlatform:            macOS-15.3.1-arm64-arm-64bit\nFastMCP root path:            ~/Developer/fastmcp\n```\n\n### Dependency Licensing\n\n<Info>\nFastMCP depends on Cyclopts for CLI functionality. Cyclopts v4 includes docutils as a transitive dependency, which has complex licensing that may trigger compliance reviews in some organizations.\n\nIf this is a concern, you can install Cyclopts v5 alpha which removes this dependency:\n\n```bash\npip install \"cyclopts>=5.0.0a1\"\n```\n\nAlternatively, wait for the stable v5 release. See [this issue](https://github.com/BrianPugh/cyclopts/issues/672) for details.\n</Info>\n## Upgrading from the Official MCP SDK\n\nUpgrading from the official MCP SDK's FastMCP 1.0 to FastMCP 2.0 is generally straightforward. The core server API is highly compatible, and in many cases, changing your import statement from `from mcp.server.fastmcp import FastMCP` to `from fastmcp import FastMCP` will be sufficient. \n\n\n```python {5}\n# Before\n# from mcp.server.fastmcp import FastMCP\n\n# After\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My MCP Server\")\n```\n\n<Warning>\nPrior to `fastmcp==2.3.0` and `mcp==1.8.0`, the 2.x API always mirrored the official 1.0 API. However, as the projects diverge, this can not be guaranteed. You may see deprecation warnings if you attempt to use 1.0 APIs in FastMCP 2.x. Please refer to this documentation for details on new capabilities.\n</Warning>\n\n## Versioning Policy\n\nFastMCP follows semantic versioning with pragmatic adaptations for the rapidly evolving MCP ecosystem. Breaking changes may occur in minor versions (e.g., 2.3.x to 2.4.0) when necessary to stay current with the MCP Protocol.\n\nFor production use, always pin to exact versions:\n```\nfastmcp==2.11.0  # Good\nfastmcp>=2.11.0  # Bad - will install breaking changes\n```\n\nSee the full [versioning and release policy](/development/releases#versioning-policy) for details on our public API, deprecation practices, and breaking change philosophy. \n\n## Contributing to FastMCP\n\nInterested in contributing to FastMCP? See the [Contributing Guide](/development/contributing) for details on:\n- Setting up your development environment\n- Running tests and pre-commit hooks\n- Submitting issues and pull requests\n- Code standards and review process\n"}, {"filename": "docs/getting-started/quickstart.mdx", "content": "---\ntitle: Quickstart\nicon: rocket-launch\n---\n\nWelcome! This guide will help you quickly set up FastMCP, run your first MCP server, and deploy a server to FastMCP Cloud.\n\nIf you haven't already installed FastMCP, follow the [installation instructions](/getting-started/installation).\n\n## Create a FastMCP Server\n\nA FastMCP server is a collection of tools, resources, and other MCP components. To create a server, start by instantiating the `FastMCP` class. \n\nCreate a new file called `my_server.py` and add the following code:\n\n```python my_server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My MCP Server\")\n```\n\n\nThat's it! You've created a FastMCP server, albeit a very boring one. Let's add a tool to make it more interesting.\n\n\n## Add a Tool\n\nTo add a tool that returns a simple greeting, write a function and decorate it with `@mcp.tool` to register it with the server:\n\n```python my_server.py {5-7}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My MCP Server\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    return f\"Hello, {name}!\"\n```\n\n\n## Run the Server\n\nThe simplest way to run your FastMCP server is to call its `run()` method. You can choose between different transports, like `stdio` for local servers, or `http` for remote access:\n\n<CodeGroup>\n\n```python my_server.py (stdio) {9, 10}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My MCP Server\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n```python my_server.py (HTTP) {9, 10}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"My MCP Server\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n</CodeGroup>\n\nThis lets us run the server with `python my_server.py`. The stdio transport is the traditional way to connect MCP servers to clients, while the HTTP transport enables remote connections.\n\n<Tip>\nWhy do we need the `if __name__ == \"__main__\":` block?\n\nThe `__main__` block is recommended for consistency and compatibility, ensuring your server works with all MCP clients that execute your server file as a script. Users who will exclusively run their server with the FastMCP CLI can omit it, as the CLI imports the server object directly.\n</Tip>\n\n### Using the FastMCP CLI\n\nYou can also use the `fastmcp run` command to start your server. Note that the FastMCP CLI **does not** execute the `__main__` block of your server file. Instead, it imports your server object and runs it with whatever transport and options you provide.\n\nFor example, to run this server with the default stdio transport (no matter how you called `mcp.run()`), you can use the following command:\n```bash\nfastmcp run my_server.py:mcp\n```\n\nTo run this server with the HTTP transport, you can use the following command:\n```bash\nfastmcp run my_server.py:mcp --transport http --port 8000\n```\n\n## Call Your Server\n\nOnce your server is running with HTTP transport, you can connect to it with a FastMCP client or any LLM client that supports the MCP protocol:\n\n```python my_client.py\nimport asyncio\nfrom fastmcp import Client\n\nclient = Client(\"http://localhost:8000/mcp\")\n\nasync def call_tool(name: str):\n    async with client:\n        result = await client.call_tool(\"greet\", {\"name\": name})\n        print(result)\n\nasyncio.run(call_tool(\"Ford\"))\n```\n\nNote that:\n- FastMCP clients are asynchronous, so we need to use `asyncio.run` to run the client\n- We must enter a client context (`async with client:`) before using the client\n- You can make multiple client calls within the same context\n\n## Deploy to FastMCP Cloud\n\n[FastMCP Cloud](https://fastmcp.cloud) is a hosting service run by the FastMCP team at [Prefect](https://www.prefect.io/fastmcp). It is optimized to deploy authenticated FastMCP servers as quickly as possible, giving you a secure URL that you can plug into any LLM client.\n\n<Info>\nFastMCP Cloud is **free for personal servers** and offers simple pay-as-you-go pricing for teams.\n</Info>\n\nTo deploy your server, you'll need a [GitHub account](https://github.com). Once you have one, you can deploy your server in three steps:\n\n1. Push your `my_server.py` file to a GitHub repository\n2. Sign in to [FastMCP Cloud](https://fastmcp.cloud) with your GitHub account\n3. Create a new project from your repository and enter `my_server.py:mcp` as the server entrypoint\n\nThat's it! FastMCP Cloud will build and deploy your server, making it available at a URL like `https://your-project.fastmcp.app/mcp`. You can chat with it to test its functionality, or connect to it from any LLM client that supports the MCP protocol.\n\nFor more details, see the [FastMCP Cloud guide](/deployment/fastmcp-cloud).\n"}, {"filename": "docs/getting-started/welcome.mdx", "content": "---\ntitle: \"Welcome to FastMCP 2.0!\"\nsidebarTitle: \"Welcome!\"\ndescription: The fast, Pythonic way to build MCP servers and clients.\nicon: hand-wave\n---\n<img \n  src=\"/assets/brand/f-watercolor-waves.png\" \n  \n  alt=\"'F' logo on a watercolor background\"\n  noZoom\n  className=\"rounded-2xl block dark:hidden\"\n  />\n<img \n  src=\"/assets/brand/f-watercolor-waves-dark.png\" \n  alt=\"'F' logo on a watercolor background\"\n  noZoom\n  className=\"rounded-2xl hidden dark:block\"\n  />\n\n\n**FastMCP is the standard framework for building MCP applications.** The [Model Context Protocol](https://modelcontextprotocol.io/) (MCP) provides a standardized way to connect LLMs to tools and data, and FastMCP makes it production-ready with clean, Pythonic code:\n\n```python {1}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"Demo \ud83d\ude80\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Add two numbers\"\"\"\n    return a + b\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n\n## Beyond Basic MCP\n\nFastMCP pioneered Python MCP development, and FastMCP 1.0 was incorporated into the [official MCP SDK](https://github.com/modelcontextprotocol/python-sdk) in 2024.\n\n**This is FastMCP 2.0,** the actively maintained version that extends far beyond basic protocol implementation. While the SDK provides core functionality, FastMCP 2.0 delivers everything needed for production: advanced MCP patterns (server composition, proxying, OpenAPI/FastAPI generation, tool transformation), enterprise auth (Google, GitHub, Azure, Auth0, WorkOS, and more), deployment tools, testing frameworks, and comprehensive client libraries.\n\nReady to build? Start with our [installation guide](/getting-started/installation) or jump straight to the [quickstart](/getting-started/quickstart).\n\nFastMCP is made with \ud83d\udc99 by [Prefect](https://www.prefect.io/).\n\n## What is MCP?\n\nThe Model Context Protocol lets you build servers that expose data and functionality to LLM applications in a secure, standardized way. It is often described as \"the USB-C port for AI\", providing a uniform way to connect LLMs to resources they can use. It may be easier to think of it as an API, but specifically designed for LLM interactions. MCP servers can:\n\n- Expose data through `Resources` (think of these sort of like GET endpoints; they are used to load information into the LLM's context)\n- Provide functionality through `Tools` (sort of like POST endpoints; they are used to execute code or otherwise produce a side effect)\n- Define interaction patterns through `Prompts` (reusable templates for LLM interactions)\n- And more!\n\nFastMCP provides a high-level, Pythonic interface for building, managing, and interacting with these servers.\n\n## Why FastMCP?\n\nFastMCP handles all the complex protocol details so you can focus on building. In most cases, decorating a Python function is all you need \u2014 FastMCP handles the rest.\n\n\ud83d\ude80 **Fast**: High-level interface means less code and faster development\n\n\ud83c\udf40 **Simple**: Build MCP servers with minimal boilerplate\n\n\ud83d\udc0d **Pythonic**: Feels natural to Python developers\n\n\ud83d\udd0d **Complete**: Everything for production \u2014 enterprise auth (Google, GitHub, Azure, Auth0, WorkOS), deployment tools, testing frameworks, client libraries, and more\n\nFastMCP provides the shortest path from idea to production. Deploy locally, to the cloud with [FastMCP Cloud](https://fastmcp.cloud) (free for personal servers), or to your own infrastructure.\n\n<Tip>\n**This documentation reflects FastMCP's `main` branch**, meaning it always reflects the latest development version. Features are generally marked with version badges (e.g. `New in version: 2.13.1`) to indicate when they were introduced. Note that this may include features that are not yet released.\n</Tip>\n\n## LLM-Friendly Docs\n\nThe FastMCP documentation is available in multiple LLM-friendly formats:\n\n### MCP Server\n\nThe FastMCP docs are accessible via MCP! The server URL is `https://gofastmcp.com/mcp`. \n\nIn fact, you can use FastMCP to search the FastMCP docs:\n\n```python\nimport asyncio\nfrom fastmcp import Client\n\nasync def main():\n    async with Client(\"https://gofastmcp.com/mcp\") as client:\n        result = await client.call_tool(\n            name=\"SearchFastMcp\", \n            arguments={\"query\": \"deploy a FastMCP server\"}\n        )\n    print(result)\n\nasyncio.run(main())\n```\n\n### Text Formats\n\nThe docs are also available in [llms.txt format](https://llmstxt.org/):\n- [llms.txt](https://gofastmcp.com/llms.txt) - A sitemap listing all documentation pages\n- [llms-full.txt](https://gofastmcp.com/llms-full.txt) - The entire documentation in one file (may exceed context windows)\n\nAny page can be accessed as markdown by appending `.md` to the URL. For example, this page becomes `https://gofastmcp.com/getting-started/welcome.md`.\n\nYou can also copy any page as markdown by pressing \"Cmd+C\" (or \"Ctrl+C\" on Windows) on your keyboard.\n"}, {"filename": "docs/integrations/anthropic.mdx", "content": "---\ntitle: Anthropic API \ud83e\udd1d FastMCP\nsidebarTitle: Anthropic API\ndescription: Connect FastMCP servers to the Anthropic API\nicon: message-code\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n\nAnthropic's [Messages API](https://docs.anthropic.com/en/api/messages) supports MCP servers as remote tool sources. This tutorial will show you how to create a FastMCP server and deploy it to a public URL, then how to call it from the Messages API.\n\n<Tip>\nCurrently, the MCP connector only accesses **tools** from MCP servers\u2014it queries the `list_tools` endpoint and exposes those functions to Claude. Other MCP features like resources and prompts are not currently supported. You can read more about the MCP connector in the [Anthropic documentation](https://docs.anthropic.com/en/docs/agents-and-tools/mcp-connector).\n</Tip>\n\n## Create a Server\n\nFirst, create a FastMCP server with the tools you want to expose. For this example, we'll create a server with a single tool that rolls dice.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n## Deploy the Server\n\nYour server must be deployed to a public URL in order for Anthropic to access it. The MCP connector supports both SSE and Streamable HTTP transports.\n\nFor development, you can use tools like `ngrok` to temporarily expose a locally-running server to the internet. We'll do that for this example (you may need to install `ngrok` and create a free account), but you can use any other method to deploy your server.\n\nAssuming you saved the above code as `server.py`, you can run the following two commands in two separate terminals to deploy your server and expose it to the internet:\n\n<CodeGroup>\n```bash FastMCP server\npython server.py\n```\n\n```bash ngrok\nngrok http 8000\n```\n</CodeGroup>\n\n<Warning>\nThis exposes your unauthenticated server to the internet. Only run this command in a safe environment if you understand the risks.\n</Warning>\n\n## Call the Server\n\nTo use the Messages API with MCP servers, you'll need to install the Anthropic Python SDK (not included with FastMCP):\n\n```bash\npip install anthropic\n```\n\nYou'll also need to authenticate with Anthropic. You can do this by setting the `ANTHROPIC_API_KEY` environment variable. Consult the Anthropic SDK documentation for more information.\n\n```bash\nexport ANTHROPIC_API_KEY=\"your-api-key\"\n```\n\nHere is an example of how to call your server from Python. Note that you'll need to replace `https://your-server-url.com` with the actual URL of your server. In addition, we use `/mcp/` as the endpoint because we deployed a streamable-HTTP server with the default path; you may need to use a different endpoint if you customized your server's deployment. **At this time you must also include the `extra_headers` parameter with the `anthropic-beta` header.**\n\n```python {5, 13-22}\nimport anthropic\nfrom rich import print\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\nclient = anthropic.Anthropic()\n\nresponse = client.beta.messages.create(\n    model=\"claude-sonnet-4-20250514\",\n    max_tokens=1000,\n    messages=[{\"role\": \"user\", \"content\": \"Roll a few dice!\"}],\n    mcp_servers=[\n        {\n            \"type\": \"url\",\n            \"url\": f\"{url}/mcp/\",\n            \"name\": \"dice-server\",\n        }\n    ],\n    extra_headers={\n        \"anthropic-beta\": \"mcp-client-2025-04-04\"\n    }\n)\n\nprint(response.content)\n```\n\nIf you run this code, you'll see something like the following output:\n\n```text\nI'll roll some dice for you! Let me use the dice rolling tool.\n\nI rolled 3 dice and got: 4, 2, 6\n\nThe results were 4, 2, and 6. Would you like me to roll again or roll a different number of dice?\n```\n\n\n## Authentication\n\n<VersionBadge version=\"2.6.0\" />\n\nThe MCP connector supports OAuth authentication through authorization tokens, which means you can secure your server while still allowing Anthropic to access it.\n\n### Server Authentication\n\nThe simplest way to add authentication to the server is to use a bearer token scheme. \n\nFor this example, we'll quickly generate our own tokens with FastMCP's `RSAKeyPair` utility, but this may not be appropriate for production use. For more details, see the complete server-side [Token Verification](/servers/auth/token-verification) documentation. \n\nWe'll start by creating an RSA key pair to sign and verify tokens.\n\n```python\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n```\n\n<Warning>\nFastMCP's `RSAKeyPair` utility is for development and testing only.\n</Warning> \n\nNext, we'll create a `JWTVerifier` to authenticate the server. \n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n```\n\nHere is a complete example that you can copy/paste. For simplicity and the purposes of this example only, it will print the token to the console. **Do NOT do this in production!**\n\n```python server.py [expandable]\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\nimport random\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    print(f\"\\n---\\n\\n\ud83d\udd11 Dice Roller access token:\\n\\n{access_token}\\n\\n---\\n\")\n    mcp.run(transport=\"http\", port=8000)\n```\n\n### Client Authentication\n\nIf you try to call the authenticated server with the same Anthropic code we wrote earlier, you'll get an error indicating that the server rejected the request because it's not authenticated.\n\n```python\nError code: 400 - {\n    \"type\": \"error\", \n    \"error\": {\n        \"type\": \"invalid_request_error\", \n        \"message\": \"MCP server 'dice-server' requires authentication. Please provide an authorization_token.\",\n    },\n}\n```\n\nTo authenticate the client, you can pass the token using the `authorization_token` parameter in your MCP server configuration:\n\n```python {8, 21}\nimport anthropic\nfrom rich import print\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\n# Your access token (replace with your actual token)\naccess_token = 'your-access-token'\n\nclient = anthropic.Anthropic()\n\nresponse = client.beta.messages.create(\n    model=\"claude-sonnet-4-20250514\",\n    max_tokens=1000,\n    messages=[{\"role\": \"user\", \"content\": \"Roll a few dice!\"}],\n    mcp_servers=[\n        {\n            \"type\": \"url\",\n            \"url\": f\"{url}/mcp/\",\n            \"name\": \"dice-server\",\n            \"authorization_token\": access_token\n        }\n    ],\n    extra_headers={\n        \"anthropic-beta\": \"mcp-client-2025-04-04\"\n    }\n)\n\nprint(response.content)\n```\n\nYou should now see the dice roll results in the output.\n"}, {"filename": "docs/integrations/auth0.mdx", "content": "---\ntitle: Auth0 OAuth \ud83e\udd1d FastMCP\nsidebarTitle: Auth0\ndescription: Secure your FastMCP server with Auth0 OAuth\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.4\" />\n\nThis guide shows you how to secure your FastMCP server using **Auth0 OAuth**. While Auth0 does have support for Dynamic Client Registration, it is not enabled by default so this integration uses the [**OIDC Proxy**](/servers/auth/oidc-proxy) pattern to bridge Auth0's dynamic OIDC configuration with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. An **[Auth0 Account](https://auth0.com/)** with access to create Applications\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create an Auth0 Application\n\nCreate an Application in your Auth0 settings to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to Applications\">\n    Go to **Applications \u2192 Applications** in your Auth0 account.\n\n    Click **\"+ Create Application\"** to create a new application.\n</Step>\n\n<Step title=\"Create Your Application\">\n    - **Name**: Choose a name users will recognize (e.g., \"My FastMCP Server\")\n    - **Choose an application type**: Choose \"Single Page Web Applications\"\n    - Click **Create** to create the application\n</Step>\n\n<Step title=\"Configure Your Application\">\n    Select the \"Settings\" tab for your application, then find the \"Application URIs\" section.\n\n    - **Allowed Callback URLs**: Your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n    - Click **Save** to save your changes\n\n    <Warning>\n    The callback URL must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter.\n    </Warning>\n\n    <Tip>\n    If you want to use a custom callback path (e.g., `/auth/auth0/callback`), make sure to set the same path in both your Auth0 Application settings and the `redirect_path` parameter when configuring the Auth0Provider.\n    </Tip>\n</Step>\n\n<Step title=\"Save Your Credentials\">\n    After creating the app, in the \"Basic Information\" section you'll see:\n\n    - **Client ID**: A public identifier like `tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB`\n    - **Client Secret**: A private hidden value that should always be stored securely\n\n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n\n<Step title=\"Select Your Audience\">\n  Go to **Applications \u2192 APIs** in your Auth0 account.\n\n    - Find the API that you want to use for your application\n    - **API Audience**: A URL that uniquely identifies the API\n\n    <Tip>\n    Store this along with of the credentials above. Never commit this to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `Auth0Provider`.\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.auth0 import Auth0Provider\n\n# The Auth0Provider utilizes Auth0 OIDC configuration\nauth_provider = Auth0Provider(\n    config_url=\"https://.../.well-known/openid-configuration\",  # Your Auth0 configuration URL\n    client_id=\"tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB\",               # Your Auth0 application Client ID\n    client_secret=\"vPYqbjemq...\",                               # Your Auth0 application Client Secret\n    audience=\"https://...\",                                     # Your Auth0 API audience\n    base_url=\"http://localhost:8000\",                           # Must match your application configuration\n    # redirect_path=\"/auth/callback\"                            # Default value, customize if needed\n)\n\nmcp = FastMCP(name=\"Auth0 Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_token_info() -> dict:\n    \"\"\"Returns information about the Auth0 token.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n\n    token = get_access_token()\n\n    return {\n        \"issuer\": token.claims.get(\"iss\"),\n        \"audience\": token.claims.get(\"aud\"),\n        \"scope\": token.claims.get(\"scope\")\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Auth0 authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Auth0-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle Auth0 OAuth flows\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open Auth0 login in your browser\n        print(\"\u2713 Authenticated with Auth0!\")\n\n        # Test the protected tool\n        result = await client.call_tool(\"get_token_info\")\n        print(f\"Auth0 audience: {result['audience']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to Auth0's authorization page\n2. After you authorize the app, you'll be redirected back\n3. The client receives the token and can make authenticated requests\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key`, and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.auth0 import Auth0Provider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = Auth0Provider(\n    config_url=\"https://.../.well-known/openid-configuration\",\n    client_id=\"tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB\",\n    client_secret=\"vPYqbjemq...\",\n    audience=\"https://...\",\n    base_url=\"https://your-production-domain.com\",\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production Auth0 App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Auth0 provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.auth0.Auth0Provider` to use Auth0 authentication.\n</ParamField>\n</Card>\n\n### Auth0-Specific Configuration\n\nThese environment variables provide default values for the Auth0 provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_CONFIG_URL\" required>\nYour Auth0 Application Configuration URL (e.g., `https://.../.well-known/openid-configuration`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_CLIENT_ID\" required>\nYour Auth0 Application Client ID (e.g., `tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_CLIENT_SECRET\" required>\nYour Auth0 Application Client Secret (e.g., `vPYqbjemq...`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_AUDIENCE\" required>\nYour Auth0 API Audience\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_BASE_URL\" required>\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your Auth0 Application\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTH0_REQUIRED_SCOPES\" default='[\"openid\"]'>\nComma-, space-, or JSON-separated list of required AUth0 scopes (e.g., `openid email` or `[\"openid\",\"email\"]`)\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the Auth0 provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.auth0.Auth0Provider\n\n# Auth0 configuration and credentials\nFASTMCP_SERVER_AUTH_AUTH0_CONFIG_URL=https://.../.well-known/openid-configuration\nFASTMCP_SERVER_AUTH_AUTH0_CLIENT_ID=tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB\nFASTMCP_SERVER_AUTH_AUTH0_CLIENT_SECRET=vPYqbjemq...\nFASTMCP_SERVER_AUTH_AUTH0_AUDIENCE=https://...\nFASTMCP_SERVER_AUTH_AUTH0_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_AUTH0_REQUIRED_SCOPES=openid,email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"Auth0 Secured App\")\n\n@mcp.tool\nasync def search_logs() -> list[str]:\n    \"\"\"Search the service logs.\"\"\"\n    # Your tool implementation here\n    pass\n```\n"}, {"filename": "docs/integrations/authkit.mdx", "content": "---\ntitle: AuthKit \ud83e\udd1d FastMCP\nsidebarTitle: AuthKit\ndescription: Secure your FastMCP server with AuthKit by WorkOS\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.11.0\" />\n\nThis guide shows you how to secure your FastMCP server using WorkOS's **AuthKit**, a complete authentication and user management solution. This integration uses the [**Remote OAuth**](/servers/auth/remote-oauth) pattern, where AuthKit handles user login and your FastMCP server validates the tokens.\n\n\n## Configuration\n### Prerequisites\n\nBefore you begin, you will need:\n1.  A **[WorkOS Account](https://workos.com/)** and a new **Project**.\n2.  An **[AuthKit](https://www.authkit.com/)** instance configured within your WorkOS project.\n3.  Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`).\n\n### Step 1: AuthKit Configuration\n\nIn your WorkOS Dashboard, enable AuthKit and configure the following settings:\n\n<Steps>\n<Step title=\"Enable Dynamic Client Registration\">\n    Go to **Applications \u2192 Configuration** and enable **Dynamic Client Registration**. This allows MCP clients register with your application automatically.\n\n    ![Enable Dynamic Client Registration](./images/authkit/enable_dcr.png)\n</Step>\n\n<Step title=\"Note Your AuthKit Domain\">\n    Find your **AuthKit Domain** on the configuration page. It will look like `https://your-project-12345.authkit.app`. You'll need this for your FastMCP server configuration.\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server file and use the `AuthKitProvider` to handle all the OAuth integration automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import AuthKitProvider\n\n# The AuthKitProvider automatically discovers WorkOS endpoints\n# and configures JWT token validation\nauth_provider = AuthKitProvider(\n    authkit_domain=\"https://your-project-12345.authkit.app\",\n    base_url=\"http://localhost:8000\"  # Use your actual server URL\n)\n\nmcp = FastMCP(name=\"AuthKit Secured App\", auth=auth_provider)\n```\n\n## Testing\n\nTo test your server, you can use the `fastmcp` CLI to run it locally. Assuming you've saved the above code to `server.py` (after replacing the `authkit_domain` and `base_url` with your actual values!), you can run the following command:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nNow, you can use a FastMCP client to test that you can reach your server after authenticating:\n\n```python\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        assert await client.ping()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the AuthKit provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.workos.AuthKitProvider` to use AuthKit authentication.\n</ParamField>\n</Card>\n\n### AuthKit-Specific Configuration\n\nThese environment variables provide default values for the AuthKit provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_AUTHKIT_DOMAIN\" required>\nYour AuthKit domain (e.g., `https://your-project-12345.authkit.app`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_BASE_URL\" required>\nPublic URL of your FastMCP server (e.g., `https://your-server.com` or `http://localhost:8000` for development)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_REQUIRED_SCOPES\" default=\"[]\">\nComma-, space-, or JSON-separated list of required OAuth scopes (e.g., `openid profile email` or `[\"openid\", \"profile\", \"email\"]`)\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the AuthKit provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.AuthKitProvider\n\n# AuthKit configuration\nFASTMCP_SERVER_AUTH_AUTHKITPROVIDER_AUTHKIT_DOMAIN=https://your-project-12345.authkit.app\nFASTMCP_SERVER_AUTH_AUTHKITPROVIDER_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_AUTHKITPROVIDER_REQUIRED_SCOPES=openid,profile,email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"AuthKit Secured App\")\n```"}, {"filename": "docs/integrations/aws-cognito.mdx", "content": "---\ntitle: AWS Cognito OAuth \ud83e\udd1d FastMCP\nsidebarTitle: AWS Cognito\ndescription: Secure your FastMCP server with AWS Cognito user pools\nicon: aws\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.4\" />\n\nThis guide shows you how to secure your FastMCP server using **AWS Cognito user pools**. Since AWS Cognito doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge AWS Cognito's traditional OAuth with MCP's authentication requirements. It also includes robust JWT token validation, ensuring enterprise-grade authentication.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. An **[AWS Account](https://aws.amazon.com/)** with access to create AWS Cognito user pools\n2. Basic familiarity with AWS Cognito concepts (user pools, app clients)\n3. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create an AWS Cognito User Pool and App Client\n\nSet up AWS Cognito user pool with an app client to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to AWS Cognito\">\n    Go to the **[AWS Cognito Console](https://console.aws.amazon.com/cognito/)** and ensure you're in your desired AWS region.\n\n    Select **\"User pools\"** from the side navigation (click on the hamburger icon at the top left in case you don't see any), and click **\"Create user pool\"** to create a new user pool.\n</Step>\n\n<Step title=\"Define Your Application\">\n    AWS Cognito now provides a streamlined setup experience:\n\n    1. **Application type**: Select **\"Traditional web application\"** (this is the correct choice for FastMCP server-side authentication)\n    2. **Name your application**: Enter a descriptive name (e.g., `FastMCP Server`)\n\n    The traditional web application type automatically configures:\n    - Server-side authentication with client secrets\n    - Authorization code grant flow\n    - Appropriate security settings for confidential clients\n\n    <Info>\n    Choose \"Traditional web application\" rather than SPA, Mobile app, or Machine-to-machine options. This ensures proper OAuth 2.0 configuration for FastMCP.\n    </Info>\n</Step>\n\n<Step title=\"Configure Options\">\n    AWS will guide you through configuration options:\n\n    - **Sign-in identifiers**: Choose how users will sign in (email, username, or phone)\n    - **Required attributes**: Select any additional user information you need\n    - **Return URL**: Add your callback URL (e.g., `http://localhost:8000/auth/callback` for development)\n\n    <Tip>\n    The simplified interface handles most OAuth security settings automatically based on your application type selection.\n    </Tip>\n</Step>\n\n<Step title=\"Review and Create\">\n    Review your configuration and click **\"Create user pool\"**.\n\n    After creation, you'll see your user pool details. Save these important values:\n    - **User pool ID** (format: `eu-central-1_XXXXXXXXX`)\n    - **Client ID** (found under \u2192 \"Applications\" \u2192 \"App clients\" in the side navigation \u2192 \\<Your application name, e.g., `FastMCP Server`\\> \u2192 \"App client information\")\n    - **Client Secret** (found under \u2192 \"Applications\" \u2192 \"App clients\" in the side navigation \u2192 \\<Your application name, e.g., `FastMCP Server`\\> \u2192 \"App client information\")\n\n    <Tip>\n    The user pool ID and app client credentials are all you need for FastMCP configuration.\n    </Tip>\n</Step>\n\n<Step title=\"Configure OAuth Settings\">\n    Under \"Login pages\" in your app client's settings, you can double check and adjust the OAuth configuration:\n\n    - **Allowed callback URLs**: Add your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n    - **Allowed sign-out URLs**: Optional, for logout functionality\n    - **OAuth 2.0 grant types**: Ensure \"Authorization code grant\" is selected\n    - **OpenID Connect scopes**: Select scopes your application needs (e.g., `openid`, `email`, `profile`)\n\n    <Tip>\n    For local development, you can use `http://localhost` URLs. For production, you must use HTTPS.\n    </Tip>\n</Step>\n\n<Step title=\"Configure Resource Server\">\n    AWS Cognito requires a resource server entry to support OAuth with protected resources. Without this, token exchange will fail with an `invalid_grant` error.\n\n    Navigate to **\"Branding\" \u2192 \"Domain\"** in the side navigation, then:\n\n    1. Click **\"Create resource server\"**\n    2. **Resource server name**: Enter a descriptive name (e.g., `My MCP Server`)\n    3. **Resource server identifier**: Enter your MCP endpoint URL exactly as it will be accessed (e.g., `http://localhost:8000/mcp` for development, or `https://your-server.com/mcp` for production)\n    4. Click **\"Create resource server\"**\n\n    <Warning>\n    The resource server identifier must exactly match your `base_url + mcp_path`. For the default configuration with `base_url=\"http://localhost:8000\"` and `path=\"/mcp\"`, use `http://localhost:8000/mcp`.\n    </Warning>\n</Step>\n\n<Step title=\"Save Your Credentials\">\n    After setup, you'll have:\n\n    - **User Pool ID**: Format like `eu-central-1_XXXXXXXXX`\n    - **Client ID**: Your application's client identifier\n    - **Client Secret**: Generated client secret (keep secure)\n    - **AWS Region**: Where Your AWS Cognito user pool is located\n\n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or AWS Secrets Manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `AWSCognitoProvider`, which handles AWS Cognito's JWT tokens and user claims automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.aws import AWSCognitoProvider\nfrom fastmcp.server.dependencies import get_access_token\n\n# The AWSCognitoProvider handles JWT validation and user claims\nauth_provider = AWSCognitoProvider(\n    user_pool_id=\"eu-central-1_XXXXXXXXX\",   # Your AWS Cognito user pool ID\n    aws_region=\"eu-central-1\",               # AWS region (defaults to eu-central-1)\n    client_id=\"your-app-client-id\",          # Your app client ID\n    client_secret=\"your-app-client-secret\",  # Your app client Secret\n    base_url=\"http://localhost:8000\",        # Must match your callback URL\n    # redirect_path=\"/auth/callback\"         # Default value, customize if needed\n)\n\nmcp = FastMCP(name=\"AWS Cognito Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_access_token_claims() -> dict:\n    \"\"\"Get the authenticated user's access token claims.\"\"\"\n    token = get_access_token()\n    return {\n        \"sub\": token.claims.get(\"sub\"),\n        \"username\": token.claims.get(\"username\"),\n        \"cognito:groups\": token.claims.get(\"cognito:groups\", []),\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by AWS Cognito OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with Your AWS Cognito-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle AWS Cognito OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open AWS Cognito login in your browser\n        print(\"\u2713 Authenticated with AWS Cognito!\")\n\n        # Test the protected tool\n        print(\"Calling protected tool: get_access_token_claims\")\n        result = await client.call_tool(\"get_access_token_claims\")\n        user_data = result.data\n        print(\"Available access token claims:\")\n        print(f\"- sub: {user_data.get('sub', 'N/A')}\")\n        print(f\"- username: {user_data.get('username', 'N/A')}\")\n        print(f\"- cognito:groups: {user_data.get('cognito:groups', [])}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to AWS Cognito's hosted UI login page\n2. After you sign in (or sign up), you'll be redirected back to your MCP server\n3. The client receives the JWT token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key`, and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.aws import AWSCognitoProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = AWSCognitoProvider(\n    user_pool_id=\"eu-central-1_XXXXXXXXX\",\n    aws_region=\"eu-central-1\",\n    client_id=\"your-app-client-id\",\n    client_secret=\"your-app-client-secret\",\n    base_url=\"https://your-production-domain.com\",\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production AWS Cognito App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the AWS Cognito provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.aws.AWSCognitoProvider` to use AWS Cognito authentication.\n</ParamField>\n</Card>\n\n### AWS Cognito-Specific Configuration\n\nThese environment variables provide default values for the AWS Cognito provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_USER_POOL_ID\" required>\nYour AWS Cognito user pool ID (e.g., `eu-central-1_XXXXXXXXX`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_AWS_REGION\" default=\"eu-central-1\">\nAWS region where your AWS Cognito user pool is located\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_ID\" required>\nYour AWS Cognito app client ID\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_SECRET\" required>\nYour AWS Cognito app client secret\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_REDIRECT_PATH\" default=\"/auth/callback\">\nOne of the redirect paths configured in your AWS Cognito app client\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AWS_COGNITO_REQUIRED_SCOPES\" default='[\"openid\"]'>\nComma-, space-, or JSON-separated list of required OAuth scopes (e.g., `openid email` or `[\"openid\",\"email\",\"profile\"]`)\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the AWS Cognito provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.aws.AWSCognitoProvider\n\n# AWS Cognito credentials\nFASTMCP_SERVER_AUTH_AWS_COGNITO_USER_POOL_ID=eu-central-1_XXXXXXXXX\nFASTMCP_SERVER_AUTH_AWS_COGNITO_AWS_REGION=eu-central-1\nFASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_ID=your-app-client-id\nFASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_SECRET=your-app-client-secret\nFASTMCP_SERVER_AUTH_AWS_COGNITO_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_AWS_COGNITO_REQUIRED_SCOPES=openid,email,profile\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_access_token\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"AWS Cognito Secured App\")\n\n@mcp.tool\nasync def get_access_token_claims() -> dict:\n    \"\"\"Get the authenticated user's access token claims.\"\"\"\n    token = get_access_token()\n    return {\n        \"sub\": token.claims.get(\"sub\"),\n        \"username\": token.claims.get(\"username\"),\n        \"cognito:groups\": token.claims.get(\"cognito:groups\", []),\n    }\n```\n\n## Features\n\n### JWT Token Validation\n\nThe AWS Cognito provider includes robust JWT token validation:\n\n- **Signature Verification**: Validates tokens against AWS Cognito's public keys (JWKS)\n- **Expiration Checking**: Automatically rejects expired tokens\n- **Issuer Validation**: Ensures tokens come from your specific AWS Cognito user pool\n- **Scope Enforcement**: Verifies required OAuth scopes are present\n\n### User Claims and Groups\n\nAccess rich user information from AWS Cognito JWT tokens:\n\n```python\nfrom fastmcp.server.dependencies import get_access_token\n\n@mcp.tool\nasync def admin_only_tool() -> str:\n    \"\"\"A tool only available to admin users.\"\"\"\n    token = get_access_token()\n    user_groups = token.claims.get(\"cognito:groups\", [])\n\n    if \"admin\" not in user_groups:\n        raise ValueError(\"This tool requires admin access\")\n\n    return \"Admin access granted!\"\n```\n\n### Enterprise Integration\n\nPerfect for enterprise environments with:\n\n- **Single Sign-On (SSO)**: Integrate with corporate identity providers\n- **Multi-Factor Authentication (MFA)**: Leverage AWS Cognito's built-in MFA\n- **User Groups**: Role-based access control through AWS Cognito groups\n- **Custom Attributes**: Access custom user attributes defined in your AWS Cognito user pool\n- **Compliance**: Meet enterprise security and compliance requirements"}, {"filename": "docs/integrations/azure.mdx", "content": "---\ntitle: Azure (Microsoft Entra ID) OAuth \ud83e\udd1d FastMCP\nsidebarTitle: Azure (Entra ID)\ndescription: Secure your FastMCP server with Azure/Microsoft Entra OAuth\nicon: microsoft\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.0\" />\n\nThis guide shows you how to secure your FastMCP server using **Azure OAuth** (Microsoft Entra ID). Since Azure doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge Azure's traditional OAuth with MCP's authentication requirements. FastMCP validates Azure JWTs against your application's client_id.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. An **[Azure Account](https://portal.azure.com/)** with access to create App registrations\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n3. Your Azure tenant ID (found in Azure Portal under Microsoft Entra ID)\n\n### Step 1: Create an Azure App Registration\n\nCreate an App registration in Azure Portal to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to App registrations\">\n    Go to the [Azure Portal](https://portal.azure.com) and navigate to **Microsoft Entra ID \u2192 App registrations**.\n    \n    Click **\"New registration\"** to create a new application.\n</Step>\n\n<Step title=\"Configure Your Application\">\n    Fill in the application details:\n    \n    - **Name**: Choose a name users will recognize (e.g., \"My FastMCP Server\")\n    - **Supported account types**: Choose based on your needs:\n      - **Single tenant**: Only users in your organization\n      - **Multitenant**: Users in any Microsoft Entra directory\n      - **Multitenant + personal accounts**: Any Microsoft account\n    - **Redirect URI**: Select \"Web\" and enter your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n    \n    <Warning>\n    The redirect URI must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter. For local development, Azure allows `http://localhost` URLs. For production, you must use HTTPS.\n    </Warning>\n    \n    <Tip>\n    If you want to use a custom callback path (e.g., `/auth/azure/callback`), make sure to set the same path in both your Azure App registration and the `redirect_path` parameter when configuring the AzureProvider.\n    </Tip>\n\n    - **Expose an API**: Configure your Application ID URI and define scopes\n      - Go to **Expose an API** in the App registration sidebar.\n      - Click **Set** next to \"Application ID URI\" and choose one of:\n        - Keep the default `api://{client_id}`\n        - Set a custom value, following the supported formats (see [Identifier URI restrictions](https://learn.microsoft.com/en-us/entra/identity-platform/identifier-uri-restrictions))\n      - Click **Add a scope** and create a scope your app will require, for example:\n        - Scope name: `read` (or `write`, etc.)\n        - Admin consent display name/description: as appropriate for your org\n        - Who can consent: as needed (Admins only or Admins and users)\n\n    - **Configure Access Token Version**: Ensure your app uses access token v2\n      - Go to **Manifest** in the App registration sidebar.\n      - Find the `requestedAccessTokenVersion` property and set it to `2`:\n        ```json\n        \"api\": {\n            \"requestedAccessTokenVersion\": 2\n        }\n        ```\n      - Click **Save** at the top of the manifest editor.\n\n    <Warning>\n    Access token v2 is required for FastMCP's Azure integration to work correctly. If this is not set, you may encounter authentication errors.\n    </Warning>\n\n    <Note>\n    In FastMCP's `AzureProvider`, set `identifier_uri` to your Application ID URI (optional; defaults to `api://{client_id}`) and set `required_scopes` to the unprefixed scope names (e.g., `read`, `write`). During authorization, FastMCP automatically prefixes scopes with your `identifier_uri`.\n    </Note>\n\n\n</Step>\n\n\n<Step title=\"Create Client Secret\">\n    After registration, navigate to **Certificates & secrets** in your app's settings.\n    \n    - Click **\"New client secret\"**\n    - Add a description (e.g., \"FastMCP Server\")\n    - Choose an expiration period\n    - Click **\"Add\"**\n    \n    <Warning>\n    Copy the secret value immediately - it won't be shown again! You'll need to create a new secret if you lose it.\n    </Warning>\n</Step>\n\n<Step title=\"Note Your Credentials\">\n    From the **Overview** page of your app registration, note:\n    \n    - **Application (client) ID**: A UUID like `835f09b6-0f0f-40cc-85cb-f32c5829a149`\n    - **Directory (tenant) ID**: A UUID like `08541b6e-646d-43de-a0eb-834e6713d6d5`\n    - **Client Secret**: The value you copied in the previous step\n    \n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `AzureProvider`, which handles Azure's OAuth flow automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.azure import AzureProvider\n\n# The AzureProvider handles Azure's token format and validation\nauth_provider = AzureProvider(\n    client_id=\"835f09b6-0f0f-40cc-85cb-f32c5829a149\",  # Your Azure App Client ID\n    client_secret=\"your-client-secret\",                 # Your Azure App Client Secret\n    tenant_id=\"08541b6e-646d-43de-a0eb-834e6713d6d5\", # Your Azure Tenant ID (REQUIRED)\n    base_url=\"http://localhost:8000\",                   # Must match your App registration\n    required_scopes=[\"your-scope\"],                 # At least one scope REQUIRED - name of scope from your App\n    # identifier_uri defaults to api://{client_id}\n    # identifier_uri=\"api://your-api-id\",\n    # Optional: request additional upstream scopes in the authorize request\n    # additional_authorize_scopes=[\"User.Read\", \"offline_access\", \"openid\", \"email\"],\n    # redirect_path=\"/auth/callback\"                  # Default value, customize if needed\n    # base_authority=\"login.microsoftonline.us\"      # For Azure Government (default: login.microsoftonline.com)\n)\n\nmcp = FastMCP(name=\"Azure Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Returns information about the authenticated Azure user.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n    \n    token = get_access_token()\n    # The AzureProvider stores user data in token claims\n    return {\n        \"azure_id\": token.claims.get(\"sub\"),\n        \"email\": token.claims.get(\"email\"),\n        \"name\": token.claims.get(\"name\"),\n        \"job_title\": token.claims.get(\"job_title\"),\n        \"office_location\": token.claims.get(\"office_location\")\n    }\n```\n\n<Note>\n**Important**: The `tenant_id` parameter is **REQUIRED**. Azure no longer supports using \"common\" for new applications due to security requirements. You must use one of:\n\n- **Your specific tenant ID**: Found in Azure Portal (e.g., `08541b6e-646d-43de-a0eb-834e6713d6d5`)\n- **\"organizations\"**: For work and school accounts only\n- **\"consumers\"**: For personal Microsoft accounts only\n\nUsing your specific tenant ID is recommended for better security and control.\n</Note>\n\n<Note>\n**Important**: The `required_scopes` parameter is **REQUIRED** and must include at least one scope. Azure's OAuth API requires the `scope` parameter in all authorization requests - you cannot authenticate without specifying at least one scope. Use the unprefixed scope names from your Azure App registration (e.g., `[\"read\", \"write\"]`). These scopes must be created under **Expose an API** in your App registration.\n</Note>\n\n### Scope Handling\n\nFastMCP automatically prefixes `required_scopes` with your `identifier_uri` (e.g., `api://your-client-id`) since these are your custom API scopes. Scopes in `additional_authorize_scopes` are sent as-is since they target external resources like Microsoft Graph.\n\n**`required_scopes`** \u2014 Your custom API scopes, defined in Azure \"Expose an API\":\n\n| You write | Sent to Azure | Validated on tokens |\n|-----------|---------------|---------------------|\n| `mcp-read` | `api://xxx/mcp-read` | \u2713 |\n| `my.scope` | `api://xxx/my.scope` | \u2713 |\n| `openid` | `openid` | \u2717 (OIDC scope) |\n| `api://xxx/read` | `api://xxx/read` | \u2713 |\n\n**`additional_authorize_scopes`** \u2014 External scopes (e.g., Microsoft Graph) for server-side use:\n\n| You write | Sent to Azure | Validated on tokens |\n|-----------|---------------|---------------------|\n| `User.Read` | `User.Read` | \u2717 |\n| `Mail.Send` | `Mail.Send` | \u2717 |\n\n<Info>\n**Why aren't `additional_authorize_scopes` validated?** Azure issues separate tokens per resource. The access token FastMCP receives is for *your API*\u2014Graph scopes aren't in its `scp` claim. To call Graph APIs, your server uses the upstream Azure token in an on-behalf-of (OBO) flow.\n</Info>\n\n<Note>\nOIDC scopes (`openid`, `profile`, `email`, `offline_access`) are never prefixed and excluded from validation because Azure doesn't include them in access token `scp` claims.\n</Note>\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Azure OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Azure-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle Azure OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open Azure login in your browser\n        print(\"\u2713 Authenticated with Azure!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"get_user_info\")\n        print(f\"Azure user: {result['email']}\")\n        print(f\"Name: {result['name']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to Microsoft's authorization page\n2. Sign in with your Microsoft account (work, school, or personal based on your tenant configuration)\n3. Grant the requested permissions\n4. After authorization, you'll be redirected back\n5. The client receives the token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key` and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.azure import AzureProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = AzureProvider(\n    client_id=\"835f09b6-0f0f-40cc-85cb-f32c5829a149\",\n    client_secret=\"your-client-secret\",\n    tenant_id=\"08541b6e-646d-43de-a0eb-834e6713d6d5\",\n    base_url=\"https://your-production-domain.com\",\n    required_scopes=[\"your-scope\"],\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production Azure App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Azure provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.azure.AzureProvider` to use Azure authentication.\n</ParamField>\n</Card>\n\n### Azure-Specific Configuration\n\nThese environment variables provide default values for the Azure provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_CLIENT_ID\" required>\nYour Azure App registration Client ID (e.g., `835f09b6-0f0f-40cc-85cb-f32c5829a149`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_CLIENT_SECRET\" required>\nYour Azure App registration Client Secret\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_TENANT_ID\" required>\nYour Azure tenant ID (specific ID, \"organizations\", or \"consumers\")\n\n<Note>\nThis is **REQUIRED**. Find your tenant ID in Azure Portal under Microsoft Entra ID \u2192 Overview.\n</Note>\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your Azure App registration\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_REQUIRED_SCOPES\" required>\nComma-, space-, or JSON-separated list of required scopes for your API (at least one scope required). These are validated on tokens and used as defaults if the client does not request specific scopes. Use unprefixed scope names from your Azure App registration (e.g., `read,write`).\n\nYou can include standard OIDC scopes (`openid`, `profile`, `email`, `offline_access`) in `required_scopes`. FastMCP automatically handles them correctly: they're sent to Azure unprefixed and excluded from token validation (since Azure doesn't include OIDC scopes in access token `scp` claims).\n\n<Note>\nAzure's OAuth API requires the `scope` parameter - you must provide at least one scope.\n</Note>\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_ADDITIONAL_AUTHORIZE_SCOPES\" default=\"\">\nComma-, space-, or JSON-separated list of additional scopes to include in the authorization request without prefixing. Use this to request upstream scopes such as Microsoft Graph permissions. These are not used for token validation.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_IDENTIFIER_URI\" default=\"api://{client_id}\">\nApplication ID URI used to prefix scopes during authorization.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_AZURE_BASE_AUTHORITY\" default=\"login.microsoftonline.com\">\nAzure authority base URL. Override this to use Azure Government:\n\n- `login.microsoftonline.com` - Azure Public Cloud (default)\n- `login.microsoftonline.us` - Azure Government\n\nThis setting affects all Azure OAuth endpoints (authorization, token, issuer, JWKS).\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the Azure provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.azure.AzureProvider\n\n# Azure OAuth credentials\nFASTMCP_SERVER_AUTH_AZURE_CLIENT_ID=835f09b6-0f0f-40cc-85cb-f32c5829a149\nFASTMCP_SERVER_AUTH_AZURE_CLIENT_SECRET=your-client-secret-here\nFASTMCP_SERVER_AUTH_AZURE_TENANT_ID=08541b6e-646d-43de-a0eb-834e6713d6d5\nFASTMCP_SERVER_AUTH_AZURE_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_AZURE_REQUIRED_SCOPES=read,write\n# Optional custom API configuration\n# FASTMCP_SERVER_AUTH_AZURE_IDENTIFIER_URI=api://your-api-id\n# Request additional upstream scopes (optional)\n# FASTMCP_SERVER_AUTH_AZURE_ADDITIONAL_AUTHORIZE_SCOPES=User.Read,Mail.Read\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"Azure Secured App\")\n\n@mcp.tool\nasync def protected_tool(query: str) -> str:\n    \"\"\"A tool that requires Azure authentication to access.\"\"\"\n    # Your tool implementation here\n    return f\"Processing authenticated request: {query}\"\n```\n\n"}, {"filename": "docs/integrations/chatgpt.mdx", "content": "---\ntitle: ChatGPT \ud83e\udd1d FastMCP\nsidebarTitle: ChatGPT\ndescription: Connect FastMCP servers to ChatGPT in Chat and Deep Research modes\nicon: message-smile\ntag: NEW\n---\n\nChatGPT supports MCP servers through remote HTTP connections in two modes: **Chat mode** for interactive conversations and **Deep Research mode** for comprehensive information retrieval.\n\n<Tip>\n**Developer Mode Required for Chat Mode**: To use MCP servers in regular ChatGPT conversations, you must first enable Developer Mode in your ChatGPT settings. This feature is available for ChatGPT Pro, Team, Enterprise, and Edu users.\n</Tip>\n\n<Note>\nOpenAI's official MCP documentation and examples are built with **FastMCP v2**! Learn more from their [MCP documentation](https://platform.openai.com/docs/mcp) and [Developer Mode guide](https://platform.openai.com/docs/guides/developer-mode).\n</Note>\n\n## Build a Server\n\nFirst, let's create a simple FastMCP server:\n\n```python server.py\nfrom fastmcp import FastMCP\nimport random\n\nmcp = FastMCP(\"Demo Server\")\n\n@mcp.tool\ndef roll_dice(sides: int = 6) -> int:\n    \"\"\"Roll a dice with the specified number of sides.\"\"\"\n    return random.randint(1, sides)\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n### Deploy Your Server\n\nYour server must be accessible from the internet. For development, use `ngrok`:\n\n<CodeGroup>\n```bash Terminal 1\npython server.py\n```\n\n```bash Terminal 2\nngrok http 8000\n```\n</CodeGroup>\n\nNote your public URL (e.g., `https://abc123.ngrok.io`) for the next steps.\n\n## Chat Mode\n\nChat mode lets you use MCP tools directly in ChatGPT conversations. See [OpenAI's Developer Mode guide](https://platform.openai.com/docs/guides/developer-mode) for the latest requirements.\n\n### Add to ChatGPT\n\n#### 1. Enable Developer Mode\n\n1. Open ChatGPT and go to **Settings** \u2192 **Connectors**\n2. Under **Advanced**, toggle **Developer Mode** to enabled\n\n#### 2. Create Connector\n\n1. In **Settings** \u2192 **Connectors**, click **Create**\n2. Enter:\n   - **Name**: Your server name\n   - **Server URL**: `https://your-server.ngrok.io/mcp/`\n3. Check **I trust this provider**\n4. Add authentication if needed\n5. Click **Create**\n\n<Note>\n**Without Developer Mode**: If you don't have search/fetch tools, ChatGPT will reject the server. With Developer Mode enabled, you don't need search/fetch tools for Chat mode.\n</Note>\n\n#### 3. Use in Chat\n\n1. Start a new chat\n2. Click the **+** button \u2192 **More** \u2192 **Developer Mode**\n3. **Enable your MCP server connector** (required - the connector must be explicitly added to each chat)\n4. Now you can use your tools:\n\nExample usage:\n- \"Roll a 20-sided dice\"\n- \"Roll dice\" (uses default 6 sides)\n\n<Tip>\nThe connector must be explicitly enabled in each chat session through Developer Mode. Once added, it remains active for the entire conversation.\n</Tip>\n\n### Skip Confirmations\n\nUse `annotations={\"readOnlyHint\": True}` to skip confirmation prompts for read-only tools:\n\n```python\n@mcp.tool(annotations={\"readOnlyHint\": True})\ndef get_status() -> str:\n    \"\"\"Check system status.\"\"\"\n    return \"All systems operational\"\n\n@mcp.tool()  # No annotation - ChatGPT may ask for confirmation\ndef delete_item(id: str) -> str:\n    \"\"\"Delete an item.\"\"\"\n    return f\"Deleted {id}\"\n```\n\n## Deep Research Mode\n\nDeep Research mode provides systematic information retrieval with citations. See [OpenAI's MCP documentation](https://platform.openai.com/docs/mcp) for the latest Deep Research specifications.\n\n<Warning>\n**Search and Fetch Required**: Without Developer Mode, ChatGPT will reject any server that doesn't have both `search` and `fetch` tools. Even in Developer Mode, Deep Research only uses these two tools.\n</Warning>\n\n### Tool Implementation\n\nDeep Research tools must follow this pattern:\n\n```python\n@mcp.tool()\ndef search(query: str) -> dict:\n    \"\"\"\n    Search for records matching the query.\n    Must return {\"ids\": [list of string IDs]}\n    \"\"\"\n    # Your search logic\n    matching_ids = [\"id1\", \"id2\", \"id3\"]\n    return {\"ids\": matching_ids}\n\n@mcp.tool()\ndef fetch(id: str) -> dict:\n    \"\"\"\n    Fetch a complete record by ID.\n    Return the full record data for ChatGPT to analyze.\n    \"\"\"\n    # Your fetch logic\n    return {\n        \"id\": id,\n        \"title\": \"Record Title\",\n        \"content\": \"Full record content...\",\n        \"metadata\": {\"author\": \"Jane Doe\", \"date\": \"2024\"}\n    }\n```\n\n### Using Deep Research\n\n1. Ensure your server is added to ChatGPT's connectors (same as Chat mode)\n2. Start a new chat\n3. Click **+** \u2192 **Deep Research**\n4. Select your MCP server as a source\n5. Ask research questions\n\nChatGPT will use your `search` and `fetch` tools to find and cite relevant information.\n\n"}, {"filename": "docs/integrations/claude-code.mdx", "content": "---\ntitle: Claude Code \ud83e\udd1d FastMCP\nsidebarTitle: Claude Code\ndescription: Install and use FastMCP servers in Claude Code\nicon: message-smile\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\nimport { LocalFocusTip } from \"/snippets/local-focus.mdx\"\n\n<LocalFocusTip />\n\nClaude Code supports MCP servers through multiple transport methods including STDIO, SSE, and HTTP, allowing you to extend Claude's capabilities with custom tools, resources, and prompts from your FastMCP servers.\n\n## Requirements\n\nThis integration uses STDIO transport to run your FastMCP server locally. For remote deployments, you can run your FastMCP server with HTTP or SSE transport and configure it directly using Claude Code's built-in MCP management commands.\n\n## Create a Server\n\nThe examples in this guide will use the following simple dice-rolling server, saved as `server.py`.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n## Install the Server\n\n### FastMCP CLI\n<VersionBadge version=\"2.10.3\" />\n\nThe easiest way to install a FastMCP server in Claude Code is using the `fastmcp install claude-code` command. This automatically handles the configuration, dependency management, and calls Claude Code's built-in MCP management system.\n\n```bash\nfastmcp install claude-code server.py\n```\n\nThe install command supports the same `file.py:object` notation as the `run` command. If no object is specified, it will automatically look for a FastMCP server object named `mcp`, `server`, or `app` in your file:\n\n```bash\n# These are equivalent if your server object is named 'mcp'\nfastmcp install claude-code server.py\nfastmcp install claude-code server.py:mcp\n\n# Use explicit object name if your server has a different name\nfastmcp install claude-code server.py:my_custom_server\n```\n\nThe command will automatically configure the server with Claude Code's `claude mcp add` command.\n\n#### Dependencies\n\nFastMCP provides flexible dependency management options for your Claude Code servers:\n\n**Individual packages**: Use the `--with` flag to specify packages your server needs. You can use this flag multiple times:\n\n```bash\nfastmcp install claude-code server.py --with pandas --with requests\n```\n\n**Requirements file**: If you maintain a `requirements.txt` file with all your dependencies, use `--with-requirements` to install them:\n\n```bash\nfastmcp install claude-code server.py --with-requirements requirements.txt\n```\n\n**Editable packages**: For local packages under development, use `--with-editable` to install them in editable mode:\n\n```bash\nfastmcp install claude-code server.py --with-editable ./my-local-package\n```\n\nAlternatively, you can use a `fastmcp.json` configuration file (recommended):\n\n```json fastmcp.json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"requests\"]\n  }\n}\n```\n\n\n#### Python Version and Project Configuration\n\nControl the Python environment for your server with these options:\n\n**Python version**: Use `--python` to specify which Python version your server requires. This ensures compatibility when your server needs specific Python features:\n\n```bash\nfastmcp install claude-code server.py --python 3.11\n```\n\n**Project directory**: Use `--project` to run your server within a specific project context. This tells `uv` to use the project's configuration files and virtual environment:\n\n```bash\nfastmcp install claude-code server.py --project /path/to/my-project\n```\n\n#### Environment Variables\n\nIf your server needs environment variables (like API keys), you must include them:\n\n```bash\nfastmcp install claude-code server.py --server-name \"Weather Server\" \\\n  --env API_KEY=your-api-key \\\n  --env DEBUG=true\n```\n\nOr load them from a `.env` file:\n\n```bash\nfastmcp install claude-code server.py --server-name \"Weather Server\" --env-file .env\n```\n\n<Warning>\n**Claude Code must be installed**. The integration looks for the Claude Code CLI at the default installation location (`~/.claude/local/claude`) and uses the `claude mcp add` command to register servers.\n</Warning>\n\n### Manual Configuration\n\nFor more control over the configuration, you can manually use Claude Code's built-in MCP management commands. This gives you direct control over how your server is launched:\n\n```bash\n# Add a server with custom configuration\nclaude mcp add dice-roller -- uv run --with fastmcp fastmcp run server.py\n\n# Add with environment variables\nclaude mcp add weather-server -e API_KEY=secret -e DEBUG=true -- uv run --with fastmcp fastmcp run server.py\n\n# Add with specific scope (local, user, or project)\nclaude mcp add my-server --scope user -- uv run --with fastmcp fastmcp run server.py\n```\n\nYou can also manually specify Python versions and project directories in your Claude Code commands:\n\n```bash\n# With specific Python version\nclaude mcp add ml-server -- uv run --python 3.11 --with fastmcp fastmcp run server.py\n\n# Within a project directory\nclaude mcp add project-server -- uv run --project /path/to/project --with fastmcp fastmcp run server.py\n```\n\n## Using the Server\n\nOnce your server is installed, you can start using your FastMCP server with Claude Code.\n\nTry asking Claude something like:\n\n> \"Roll some dice for me\"\n\nClaude will automatically detect your `roll_dice` tool and use it to fulfill your request, returning something like:\n\n> I'll roll some dice for you! Here are your results: [4, 2, 6]\n> \n> You rolled three dice and got a 4, a 2, and a 6!\n\nClaude Code can now access all the tools, resources, and prompts you've defined in your FastMCP server. \n\nIf your server provides resources, you can reference them with `@` mentions using the format `@server:protocol://resource/path`. If your server provides prompts, you can use them as slash commands with `/mcp__servername__promptname`."}, {"filename": "docs/integrations/claude-desktop.mdx", "content": "---\ntitle: Claude Desktop \ud83e\udd1d FastMCP\nsidebarTitle: Claude Desktop\ndescription: Connect FastMCP servers to Claude Desktop\nicon: message-smile\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\nimport { LocalFocusTip } from \"/snippets/local-focus.mdx\"\n\n<LocalFocusTip />\n\nClaude Desktop supports MCP servers through local STDIO connections and remote servers (beta), allowing you to extend Claude's capabilities with custom tools, resources, and prompts from your FastMCP servers.\n\n<Note>\nRemote MCP server support is currently in beta and available for users on Claude Pro, Max, Team, and Enterprise plans (as of June 2025). Most users will still need to use local STDIO connections.\n</Note>\n\n<Note>\nThis guide focuses specifically on using FastMCP servers with Claude Desktop. For general Claude Desktop MCP setup and official examples, see the [official Claude Desktop quickstart guide](https://modelcontextprotocol.io/quickstart/user).\n</Note>\n\n\n## Requirements\n\nClaude Desktop traditionally requires MCP servers to run locally using STDIO transport, where your server communicates with Claude through standard input/output rather than HTTP. However, users on certain plans now have access to remote server support as well.\n\n<Tip>\nIf you don't have access to remote server support or need to connect to remote servers, you can create a **proxy server** that runs locally via STDIO and forwards requests to remote HTTP servers. See the [Proxy Servers](#proxy-servers) section below.\n</Tip>\n\n## Create a Server\n\nThe examples in this guide will use the following simple dice-rolling server, saved as `server.py`.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n## Install the Server\n\n### FastMCP CLI\n<VersionBadge version=\"2.10.3\" />\n\nThe easiest way to install a FastMCP server in Claude Desktop is using the `fastmcp install claude-desktop` command. This automatically handles the configuration and dependency management.\n\n<Tip>\nPrior to version 2.10.3, Claude Desktop could be managed by running `fastmcp install <path>` without specifying the client.\n</Tip>\n\n```bash\nfastmcp install claude-desktop server.py\n```\n\nThe install command supports the same `file.py:object` notation as the `run` command. If no object is specified, it will automatically look for a FastMCP server object named `mcp`, `server`, or `app` in your file:\n\n```bash\n# These are equivalent if your server object is named 'mcp'\nfastmcp install claude-desktop server.py\nfastmcp install claude-desktop server.py:mcp\n\n# Use explicit object name if your server has a different name\nfastmcp install claude-desktop server.py:my_custom_server\n```\n\nAfter installation, restart Claude Desktop completely. You should see a hammer icon (\ud83d\udd28) in the bottom left of the input box, indicating that MCP tools are available.\n\n#### Dependencies\n\nFastMCP provides several ways to manage your server's dependencies when installing in Claude Desktop:\n\n**Individual packages**: Use the `--with` flag to specify packages your server needs. You can use this flag multiple times:\n\n```bash\nfastmcp install claude-desktop server.py --with pandas --with requests\n```\n\n**Requirements file**: If you have a `requirements.txt` file listing all your dependencies, use `--with-requirements` to install them all at once:\n\n```bash\nfastmcp install claude-desktop server.py --with-requirements requirements.txt\n```\n\n**Editable packages**: For local packages in development, use `--with-editable` to install them in editable mode:\n\n```bash\nfastmcp install claude-desktop server.py --with-editable ./my-local-package\n```\n\nAlternatively, you can use a `fastmcp.json` configuration file (recommended):\n\n```json fastmcp.json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"requests\"]\n  }\n}\n```\n\n\n#### Python Version and Project Directory\n\nFastMCP allows you to control the Python environment for your server:\n\n**Python version**: Use `--python` to specify which Python version your server should run with. This is particularly useful when your server requires a specific Python version:\n\n```bash\nfastmcp install claude-desktop server.py --python 3.11\n```\n\n**Project directory**: Use `--project` to run your server within a specific project directory. This ensures that `uv` will discover all `pyproject.toml`, `uv.toml`, and `.python-version` files from that project:\n\n```bash\nfastmcp install claude-desktop server.py --project /path/to/my-project\n```\n\nWhen you specify a project directory, all relative paths in your server will be resolved from that directory, and the project's virtual environment will be used.\n\n#### Environment Variables\n\n<Warning>\nClaude Desktop runs servers in a completely isolated environment with no access to your shell environment or locally installed applications. You must explicitly pass any environment variables your server needs.\n</Warning>\n\nIf your server needs environment variables (like API keys), you must include them:\n\n```bash\nfastmcp install claude-desktop server.py --server-name \"Weather Server\" \\\n  --env API_KEY=your-api-key \\\n  --env DEBUG=true\n```\n\nOr load them from a `.env` file:\n\n```bash\nfastmcp install claude-desktop server.py --server-name \"Weather Server\" --env-file .env\n```\n<Warning>\n- **`uv` must be installed and available in your system PATH**. Claude Desktop runs in its own isolated environment and needs `uv` to manage dependencies.\n- **On macOS, it is recommended to install `uv` globally with Homebrew** so that Claude Desktop will detect it: `brew install uv`. Installing `uv` with other methods may not make it accessible to Claude Desktop.\n</Warning>\n\n\n### Manual Configuration\n\nFor more control over the configuration, you can manually edit Claude Desktop's configuration file. You can open the configuration file from Claude's developer settings, or find it in the following locations:\n- **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`\n- **Windows**: `%APPDATA%\\Claude\\claude_desktop_config.json`\n\nThe configuration file is a JSON object with a `mcpServers` key, which contains the configuration for each MCP server.\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"python\",\n      \"args\": [\"path/to/your/server.py\"]\n    }\n  }\n}\n```\n\nAfter updating the configuration file, restart Claude Desktop completely. Look for the hammer icon (\ud83d\udd28) to confirm your server is loaded.\n\n#### Dependencies\n\nIf your server has dependencies, you can use `uv` or another package manager to set up the environment.\n\n\nWhen manually configuring dependencies, the recommended approach is to use `uv` with FastMCP. The configuration uses `uv run` to create an isolated environment with your specified packages:\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"uv\",\n      \"args\": [\n        \"run\",\n        \"--with\", \"fastmcp\",\n        \"--with\", \"pandas\",\n        \"--with\", \"requests\", \n        \"fastmcp\",\n        \"run\",\n        \"path/to/your/server.py\"\n      ]\n    }\n  }\n}\n```\n\nYou can also manually specify Python versions and project directories in your configuration. Add `--python` to use a specific Python version, or `--project` to run within a project directory:\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"uv\",\n      \"args\": [\n        \"run\",\n        \"--python\", \"3.11\",\n        \"--project\", \"/path/to/project\",\n        \"--with\", \"fastmcp\",\n        \"fastmcp\",\n        \"run\",\n        \"path/to/your/server.py\"\n      ]\n    }\n  }\n}\n```\n\nThe order of arguments matters: Python version and project settings come before package specifications, which come before the actual command to run.\n\n<Warning>\n- **`uv` must be installed and available in your system PATH**. Claude Desktop runs in its own isolated environment and needs `uv` to manage dependencies.\n- **On macOS, it is recommended to install `uv` globally with Homebrew** so that Claude Desktop will detect it: `brew install uv`. Installing `uv` with other methods may not make it accessible to Claude Desktop.\n</Warning>\n\n#### Environment Variables\n\nYou can also specify environment variables in the configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"weather-server\": {\n      \"command\": \"python\",\n      \"args\": [\"path/to/weather_server.py\"],\n      \"env\": {\n        \"API_KEY\": \"your-api-key\",\n        \"DEBUG\": \"true\"\n      }\n    }\n  }\n}\n```\n<Warning>\nClaude Desktop runs servers in a completely isolated environment with no access to your shell environment or locally installed applications. You must explicitly pass any environment variables your server needs.\n</Warning>\n\n\n## Remote Servers\n\n\nUsers on Claude Pro, Max, Team, and Enterprise plans have first-class remote server support via integrations. For other users, or as an alternative approach, FastMCP can create a proxy server that forwards requests to a remote HTTP server. You can install the proxy server in Claude Desktop.\n\nCreate a proxy server that connects to a remote HTTP server:\n\n```python proxy_server.py\nfrom fastmcp import FastMCP\n\n# Create a proxy to a remote server\nproxy = FastMCP.as_proxy(\n    \"https://example.com/mcp/sse\", \n    name=\"Remote Server Proxy\"\n)\n\nif __name__ == \"__main__\":\n    proxy.run()  # Runs via STDIO for Claude Desktop\n```\n\n### Authentication\n\nFor authenticated remote servers, create an authenticated client following the guidance in the [client auth documentation](/clients/auth/bearer) and pass it to the proxy:\n\n```python auth_proxy_server.py {7}\nfrom fastmcp import FastMCP, Client\nfrom fastmcp.client.auth import BearerAuth\n\n# Create authenticated client\nclient = Client(\n    \"https://api.example.com/mcp/sse\",\n    auth=BearerAuth(token=\"your-access-token\")\n)\n\n# Create proxy using the authenticated client\nproxy = FastMCP.as_proxy(client, name=\"Authenticated Proxy\")\n\nif __name__ == \"__main__\":\n    proxy.run()\n```\n\n"}, {"filename": "docs/integrations/cursor.mdx", "content": "---\ntitle: Cursor \ud83e\udd1d FastMCP\nsidebarTitle: Cursor\ndescription: Install and use FastMCP servers in Cursor\nicon: message-smile\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\nimport { LocalFocusTip } from \"/snippets/local-focus.mdx\"\n\n<LocalFocusTip />\n\nCursor supports MCP servers through multiple transport methods including STDIO, SSE, and Streamable HTTP, allowing you to extend Cursor's AI assistant with custom tools, resources, and prompts from your FastMCP servers.\n\n## Requirements\n\nThis integration uses STDIO transport to run your FastMCP server locally. For remote deployments, you can run your FastMCP server with HTTP or SSE transport and configure it directly in Cursor's settings.\n\n## Create a Server\n\nThe examples in this guide will use the following simple dice-rolling server, saved as `server.py`.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n## Install the Server\n\n### FastMCP CLI\n<VersionBadge version=\"2.10.3\" />\n\nThe easiest way to install a FastMCP server in Cursor is using the `fastmcp install cursor` command. This automatically handles the configuration, dependency management, and opens Cursor with a deeplink to install the server.\n\n```bash\nfastmcp install cursor server.py\n```\n\n#### Workspace Installation\n<VersionBadge version=\"2.12.0\" />\n\nBy default, FastMCP installs servers globally for Cursor. You can also install servers to project-specific workspaces using the `--workspace` flag:\n\n```bash\n# Install to current directory's .cursor/ folder\nfastmcp install cursor server.py --workspace .\n\n# Install to specific workspace\nfastmcp install cursor server.py --workspace /path/to/project\n```\n\nThis creates a `.cursor/mcp.json` configuration file in the specified workspace directory, allowing different projects to have their own MCP server configurations.\n\nThe install command supports the same `file.py:object` notation as the `run` command. If no object is specified, it will automatically look for a FastMCP server object named `mcp`, `server`, or `app` in your file:\n\n```bash\n# These are equivalent if your server object is named 'mcp'\nfastmcp install cursor server.py\nfastmcp install cursor server.py:mcp\n\n# Use explicit object name if your server has a different name\nfastmcp install cursor server.py:my_custom_server\n```\n\nAfter running the command, Cursor will open automatically and prompt you to install the server. The command will be `uv`, which is expected as this is a Python STDIO server. Click \"Install\" to confirm:\n\n![Cursor install prompt](./cursor-install-mcp.png)\n\n#### Dependencies\n\nFastMCP offers multiple ways to manage dependencies for your Cursor servers:\n\n**Individual packages**: Use the `--with` flag to specify packages your server needs. You can use this flag multiple times:\n\n```bash\nfastmcp install cursor server.py --with pandas --with requests\n```\n\n**Requirements file**: For projects with a `requirements.txt` file, use `--with-requirements` to install all dependencies at once:\n\n```bash\nfastmcp install cursor server.py --with-requirements requirements.txt\n```\n\n**Editable packages**: When developing local packages, use `--with-editable` to install them in editable mode:\n\n```bash\nfastmcp install cursor server.py --with-editable ./my-local-package\n```\n\nAlternatively, you can use a `fastmcp.json` configuration file (recommended):\n\n```json fastmcp.json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"requests\"]\n  }\n}\n```\n\n\n#### Python Version and Project Configuration\n\nControl your server's Python environment with these options:\n\n**Python version**: Use `--python` to specify which Python version your server should use. This is essential when your server requires specific Python features:\n\n```bash\nfastmcp install cursor server.py --python 3.11\n```\n\n**Project directory**: Use `--project` to run your server within a specific project context. This ensures `uv` discovers all project configuration files and uses the correct virtual environment:\n\n```bash\nfastmcp install cursor server.py --project /path/to/my-project\n```\n\n#### Environment Variables\n\n<Warning>\nCursor runs servers in a completely isolated environment with no access to your shell environment or locally installed applications. You must explicitly pass any environment variables your server needs.\n</Warning>\n\nIf your server needs environment variables (like API keys), you must include them:\n\n```bash\nfastmcp install cursor server.py --server-name \"Weather Server\" \\\n  --env API_KEY=your-api-key \\\n  --env DEBUG=true\n```\n\nOr load them from a `.env` file:\n\n```bash\nfastmcp install cursor server.py --server-name \"Weather Server\" --env-file .env\n```\n\n<Warning>\n**`uv` must be installed and available in your system PATH**. Cursor runs in its own isolated environment and needs `uv` to manage dependencies.\n</Warning>\n\n### Generate MCP JSON\n\n<Note>\n**Use the first-class integration above for the best experience.** The MCP JSON generation is useful for advanced use cases, manual configuration, or integration with other tools.\n</Note>\n\nYou can generate MCP JSON configuration for manual use:\n\n```bash\n# Generate configuration and output to stdout\nfastmcp install mcp-json server.py --server-name \"Dice Roller\" --with pandas\n\n# Copy configuration to clipboard for easy pasting\nfastmcp install mcp-json server.py --server-name \"Dice Roller\" --copy\n```\n\nThis generates the standard `mcpServers` configuration format that can be used with any MCP-compatible client.\n\n### Manual Configuration\n\nFor more control over the configuration, you can manually edit Cursor's configuration file. The configuration file is located at:\n- **All platforms**: `~/.cursor/mcp.json`\n\nThe configuration file is a JSON object with a `mcpServers` key, which contains the configuration for each MCP server.\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"python\",\n      \"args\": [\"path/to/your/server.py\"]\n    }\n  }\n}\n```\n\nAfter updating the configuration file, your server should be available in Cursor.\n\n#### Dependencies\n\nIf your server has dependencies, you can use `uv` or another package manager to set up the environment.\n\nWhen manually configuring dependencies, the recommended approach is to use `uv` with FastMCP. The configuration should use `uv run` to create an isolated environment with your specified packages:\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"uv\",\n      \"args\": [\n        \"run\",\n        \"--with\", \"fastmcp\",\n        \"--with\", \"pandas\",\n        \"--with\", \"requests\", \n        \"fastmcp\",\n        \"run\",\n        \"path/to/your/server.py\"\n      ]\n    }\n  }\n}\n```\n\nYou can also manually specify Python versions and project directories in your configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"dice-roller\": {\n      \"command\": \"uv\",\n      \"args\": [\n        \"run\",\n        \"--python\", \"3.11\",\n        \"--project\", \"/path/to/project\",\n        \"--with\", \"fastmcp\",\n        \"fastmcp\",\n        \"run\",\n        \"path/to/your/server.py\"\n      ]\n    }\n  }\n}\n```\n\nNote that the order of arguments is important: Python version and project settings should come before package specifications.\n\n<Warning>\n**`uv` must be installed and available in your system PATH**. Cursor runs in its own isolated environment and needs `uv` to manage dependencies.\n</Warning>\n\n#### Environment Variables\n\nYou can also specify environment variables in the configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"weather-server\": {\n      \"command\": \"python\",\n      \"args\": [\"path/to/weather_server.py\"],\n      \"env\": {\n        \"API_KEY\": \"your-api-key\",\n        \"DEBUG\": \"true\"\n      }\n    }\n  }\n}\n```\n\n<Warning>\nCursor runs servers in a completely isolated environment with no access to your shell environment or locally installed applications. You must explicitly pass any environment variables your server needs.\n</Warning>\n\n## Using the Server\n\nOnce your server is installed, you can start using your FastMCP server with Cursor's AI assistant.\n\nTry asking Cursor something like:\n\n> \"Roll some dice for me\"\n\nCursor will automatically detect your `roll_dice` tool and use it to fulfill your request, returning something like:\n\n> \ud83c\udfb2 Here are your dice rolls: 4, 6, 4\n> \n> You rolled 3 dice with a total of 14! The 6 was a nice high roll there!\n\nThe AI assistant can now access all the tools, resources, and prompts you've defined in your FastMCP server.\n"}, {"filename": "docs/integrations/descope.mdx", "content": "---\ntitle: Descope \ud83e\udd1d FastMCP\nsidebarTitle: Descope\ndescription: Secure your FastMCP server with Descope\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.12.4\" />\n\nThis guide shows you how to secure your FastMCP server using [**Descope**](https://www.descope.com), a complete authentication and user management solution. This integration uses the [**Remote OAuth**](/servers/auth/remote-oauth) pattern, where Descope handles user login and your FastMCP server validates the tokens.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n\n1. To [sign up](https://www.descope.com/sign-up) for a Free Forever Descope account\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:3000`)\n\n### Step 1: Configure Descope\n\n<Steps>\n<Step title=\"Create an MCP Server\">\n    1. Go to the [MCP Servers page](https://app.descope.com/mcp-servers) of the Descope Console, and create a new MCP Server.\n    2. Give the MCP server a name and description.\n    3. Ensure that **Dynamic Client Registration (DCR)** is enabled. Then click **Create**.\n    4. Once you've created the MCP Server, note your Well-Known URL.\n    \n    \n    <Warning>\n    DCR is required for FastMCP clients to automatically register with your authentication server.\n    </Warning>\n</Step>\n\n<Step title=\"Note Your Well-Known URL\">\n    Save your Well-Known URL from [MCP Server Settings](https://app.descope.com/mcp-servers):\n    ```\n    Well-Known URL: https://.../v1/apps/agentic/P.../M.../.well-known/openid-configuration\n    ```\n</Step>\n</Steps>\n\n### Step 2: Environment Setup\n\nCreate a `.env` file with your Descope configuration:\n\n```bash\nDESCOPE_CONFIG_URL=https://.../v1/apps/agentic/P.../M.../.well-known/openid-configuration     # Your Descope Well-Known URL\nSERVER_URL=http://localhost:3000     # Your server's base URL\n```\n\n### Step 3: FastMCP Configuration\n\nCreate your FastMCP server file and use the DescopeProvider to handle all the OAuth integration automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.descope import DescopeProvider\n\n# The DescopeProvider automatically discovers Descope endpoints\n# and configures JWT token validation\nauth_provider = DescopeProvider(\n    config_url=https://.../.well-known/openid-configuration,        # Your MCP Server .well-known URL\n    base_url=SERVER_URL,                  # Your server's public URL\n)\n\n# Create FastMCP server with auth\nmcp = FastMCP(name=\"My Descope Protected Server\", auth=auth_provider)\n\n```\n\n## Testing\n\nTo test your server, you can use the `fastmcp` CLI to run it locally. Assuming you've saved the above code to `server.py` (after replacing the environment variables with your actual values!), you can run the following command:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nNow, you can use a FastMCP client to test that you can reach your server after authenticating:\n\n```python\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        assert await client.ping()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Descope provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n  <ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\n    Set to `fastmcp.server.auth.providers.descope.DescopeProvider` to use\n    Descope authentication.\n  </ParamField>\n</Card>\n\n### Descope-Specific Configuration\n\nThese environment variables provide default values for the Descope provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_DESCOPEPROVIDER_CONFIG_URL\" required>\nYour Well-Known URL from the [Descope Console](https://app.descope.com/mcp-servers)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DESCOPEPROVIDER_BASE_URL\" required>\n  Public URL of your FastMCP server (e.g., `https://your-server.com` or\n  `http://localhost:8000` for development)\n</ParamField>\n</Card>\n\nExample `.env` file:\n\n```bash\n# Use the Descope provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.descope.DescopeProvider\n\n# Descope configuration\nFASTMCP_SERVER_AUTH_DESCOPEPROVIDER_CONFIG_URL=https://.../v1/apps/agentic/P.../M.../.well-known/openid-configuration\nFASTMCP_SERVER_AUTH_DESCOPEPROVIDER_BASE_URL=https://your-server.com\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"My Descope Protected Server\")\n```\n"}, {"filename": "docs/integrations/discord.mdx", "content": "---\ntitle: Discord OAuth \ud83e\udd1d FastMCP\nsidebarTitle: Discord\ndescription: Secure your FastMCP server with Discord OAuth\nicon: discord\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.2\" />\n\nThis guide shows you how to secure your FastMCP server using **Discord OAuth**. Since Discord doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge Discord's traditional OAuth with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. A **[Discord Account](https://discord.com/)** with access to create applications\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a Discord Application\n\nCreate an application in the Discord Developer Portal to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to Discord Developer Portal\">\n    Go to the [Discord Developer Portal](https://discord.com/developers/applications).\n\n    Click **\"New Application\"** and give it a name users will recognize (e.g., \"My FastMCP Server\").\n</Step>\n\n<Step title=\"Configure OAuth2 Settings\">\n    In the left sidebar, click **\"OAuth2\"**.\n\n    In the **Redirects** section, click **\"Add Redirect\"** and enter your callback URL:\n    - For development: `http://localhost:8000/auth/callback`\n    - For production: `https://your-domain.com/auth/callback`\n\n    <Warning>\n    The redirect URL must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter. Discord allows `http://localhost` URLs for development. For production, use HTTPS.\n    </Warning>\n</Step>\n\n<Step title=\"Save Your Credentials\">\n    On the same OAuth2 page, you'll find:\n\n    - **Client ID**: A numeric string like `12345`\n    - **Client Secret**: Click \"Reset Secret\" to generate one\n\n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `DiscordProvider`, which handles Discord's OAuth flow automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.discord import DiscordProvider\n\nauth_provider = DiscordProvider(\n    client_id=\"12345\",      # Your Discord Application Client ID\n    client_secret=\"your-client-secret\",    # Your Discord OAuth Client Secret\n    base_url=\"http://localhost:8000\",      # Must match your OAuth configuration\n)\n\nmcp = FastMCP(name=\"Discord Secured App\", auth=auth_provider)\n\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Returns information about the authenticated Discord user.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n\n    token = get_access_token()\n    return {\n        \"discord_id\": token.claims.get(\"sub\"),\n        \"username\": token.claims.get(\"username\"),\n        \"avatar\": token.claims.get(\"avatar\"),\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Discord OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Discord-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        print(\"\u2713 Authenticated with Discord!\")\n\n        result = await client.call_tool(\"get_user_info\")\n        print(f\"Discord user: {result['username']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to Discord's authorization page\n2. Sign in with your Discord account and authorize the app\n3. After authorization, you'll be redirected back\n4. The client receives the token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Discord Scopes\n\nDiscord OAuth supports several scopes for accessing different types of user data:\n\n| Scope | Description |\n|-------|-------------|\n| `identify` | Access username, avatar, and discriminator (default) |\n| `email` | Access the user's email address |\n| `guilds` | Access the user's list of servers |\n| `guilds.join` | Ability to add the user to a server |\n\nTo request additional scopes:\n\n```python\nauth_provider = DiscordProvider(\n    client_id=\"...\",\n    client_secret=\"...\",\n    base_url=\"http://localhost:8000\",\n    required_scopes=[\"identify\", \"email\"],\n)\n```\n\n## Production Configuration\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key` and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.discord import DiscordProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\nauth_provider = DiscordProvider(\n    client_id=\"12345\",\n    client_secret=os.environ[\"DISCORD_CLIENT_SECRET\"],\n    base_url=\"https://your-production-domain.com\",\n\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production Discord App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Discord provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.discord.DiscordProvider` to use Discord authentication.\n</ParamField>\n</Card>\n\n### Discord-Specific Configuration\n\nThese environment variables provide default values for the Discord provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_CLIENT_ID\" required>\nYour Discord Application Client ID (e.g., `12345`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_CLIENT_SECRET\" required>\nYour Discord OAuth Client Secret\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your Discord OAuth settings\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_REQUIRED_SCOPES\" default='[\"identify\"]'>\nComma-, space-, or JSON-separated list of required Discord scopes (e.g., `identify,email` or `[\"identify\",\"email\"]`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_DISCORD_TIMEOUT_SECONDS\" default=\"10\">\nHTTP request timeout for Discord API calls\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.discord.DiscordProvider\n\nFASTMCP_SERVER_AUTH_DISCORD_CLIENT_ID=12345\nFASTMCP_SERVER_AUTH_DISCORD_CLIENT_SECRET=your-client-secret\nFASTMCP_SERVER_AUTH_DISCORD_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_DISCORD_REQUIRED_SCOPES=identify,email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Discord Secured App\")\n\n@mcp.tool\nasync def protected_tool(query: str) -> str:\n    \"\"\"A tool that requires Discord authentication to access.\"\"\"\n    return f\"Processing authenticated request: {query}\"\n```\n"}, {"filename": "docs/integrations/eunomia-authorization.mdx", "content": "---\ntitle: Eunomia Authorization \ud83e\udd1d FastMCP\nsidebarTitle: Eunomia Auth\ndescription: Add policy-based authorization to your FastMCP servers with Eunomia\nicon: shield-check\n---\n\nAdd **policy-based authorization** to your FastMCP servers with one-line code addition with the **[Eunomia][eunomia-github] authorization middleware**.\n\nControl which tools, resources and prompts MCP clients can view and execute on your server. Define dynamic JSON-based policies and obtain a comprehensive audit log of all access attempts and violations.\n\n## How it Works\n\nExploiting FastMCP's [Middleware][fastmcp-middleare], the Eunomia middleware intercepts all MCP requests to your server and automatically maps MCP methods to authorization checks.\n\n### Listing Operations\n\nThe middleware behaves as a filter for listing operations (`tools/list`, `resources/list`, `prompts/list`), hiding to the client components that are not authorized by the defined policies.\n\n```mermaid\nsequenceDiagram\n    participant MCPClient as MCP Client\n    participant EunomiaMiddleware as Eunomia Middleware\n    participant MCPServer as FastMCP Server\n    participant EunomiaServer as Eunomia Server\n\n    MCPClient->>EunomiaMiddleware: MCP Listing Request (e.g., tools/list)\n    EunomiaMiddleware->>MCPServer: MCP Listing Request\n    MCPServer-->>EunomiaMiddleware: MCP Listing Response\n    EunomiaMiddleware->>EunomiaServer: Authorization Checks\n    EunomiaServer->>EunomiaMiddleware: Authorization Decisions\n    EunomiaMiddleware-->>MCPClient: Filtered MCP Listing Response\n```\n\n### Execution Operations\n\nThe middleware behaves as a firewall for execution operations (`tools/call`, `resources/read`, `prompts/get`), blocking operations that are not authorized by the defined policies.\n\n```mermaid\nsequenceDiagram\n    participant MCPClient as MCP Client\n    participant EunomiaMiddleware as Eunomia Middleware\n    participant MCPServer as FastMCP Server\n    participant EunomiaServer as Eunomia Server\n\n    MCPClient->>EunomiaMiddleware: MCP Execution Request (e.g., tools/call)\n    EunomiaMiddleware->>EunomiaServer: Authorization Check\n    EunomiaServer->>EunomiaMiddleware: Authorization Decision\n    EunomiaMiddleware-->>MCPClient: MCP Unauthorized Error (if denied)\n    EunomiaMiddleware->>MCPServer: MCP Execution Request (if allowed)\n    MCPServer-->>EunomiaMiddleware: MCP Execution Response (if allowed)\n    EunomiaMiddleware-->>MCPClient: MCP Execution Response (if allowed)\n```\n\n## Add Authorization to Your Server\n\n<Note>\nEunomia is an AI-specific authorization server that handles policy decisions. The server runs embedded within your MCP server by default for a zero-effort configuration, but can alternatively be run remotely for centralized policy decisions.\n\n</Note>\n\n### Create a Server with Authorization\n\nFirst, install the `eunomia-mcp` package:\n\n```bash\npip install eunomia-mcp\n```\n\nThen create a FastMCP server and add the Eunomia middleware in one line:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom eunomia_mcp import create_eunomia_middleware\n\n# Create your FastMCP server\nmcp = FastMCP(\"Secure MCP Server \ud83d\udd12\")\n\n@mcp.tool()\ndef add(a: int, b: int) -> int:\n    \"\"\"Add two numbers\"\"\"\n    return a + b\n\n# Add middleware to your server\nmiddleware = create_eunomia_middleware(policy_file=\"mcp_policies.json\")\nmcp.add_middleware(middleware)\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n### Configure Access Policies\n\nUse the `eunomia-mcp` CLI in your terminal to manage your authorization policies:\n\n```bash\n# Create a default policy file\neunomia-mcp init\n\n# Or create a policy file customized for your FastMCP server\neunomia-mcp init --custom-mcp \"app.server:mcp\"\n```\n\nThis creates `mcp_policies.json` file that you can further edit to your access control needs.\n\n```bash\n# Once edited, validate your policy file\neunomia-mcp validate mcp_policies.json\n```\n\n### Run the Server\n\nStart your FastMCP server normally:\n\n```bash\npython server.py\n```\n\nThe middleware will now intercept all MCP requests and check them against your policies. Requests include agent identification through headers like `X-Agent-ID`, `X-User-ID`, `User-Agent`, or `Authorization` and an automatic mapping of MCP methods to authorization resources and actions.\n\n<Tip>\n  For detailed policy configuration, custom authentication, and remote\n  deployments, visit the [Eunomia MCP Middleware\n  repository][eunomia-mcp-github].\n</Tip>\n\n[eunomia-github]: https://github.com/whataboutyou-ai/eunomia\n[eunomia-mcp-github]: https://github.com/whataboutyou-ai/eunomia/tree/main/pkgs/extensions/mcp\n[fastmcp-middleare]: /servers/middleware\n"}, {"filename": "docs/integrations/fastapi.mdx", "content": "---\ntitle: FastAPI \ud83e\udd1d FastMCP\nsidebarTitle: FastAPI\ndescription: Integrate FastMCP with FastAPI applications\nicon: bolt\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\nFastMCP provides two powerful ways to integrate with FastAPI applications:\n\n1. **[Generate an MCP server FROM your FastAPI app](#generating-an-mcp-server)** - Convert existing API endpoints into MCP tools\n2. **[Mount an MCP server INTO your FastAPI app](#mounting-an-mcp-server)** - Add MCP functionality to your web application\n\n\n<Tip>\nGenerating MCP servers from OpenAPI is a great way to get started with FastMCP, but in practice LLMs achieve **significantly better performance** with well-designed and curated MCP servers than with auto-converted OpenAPI servers. This is especially true for complex APIs with many endpoints and parameters.\n\nWe recommend using the FastAPI integration for bootstrapping and prototyping, not for mirroring your API to LLM clients. See the post [Stop Converting Your REST APIs to MCP](https://www.jlowin.dev/blog/stop-converting-rest-apis-to-mcp) for more details.\n</Tip>\n\n\n<Note>\nFastMCP does *not* include FastAPI as a dependency; you must install it separately to use this integration.\n</Note>\n\n## Example FastAPI Application\n\nThroughout this guide, we'll use this e-commerce API as our example (click the `Copy` button to copy it for use with other code blocks):\n\n```python [expandable]\n# Copy this FastAPI server into other code blocks in this guide\n\nfrom fastapi import FastAPI, HTTPException\nfrom pydantic import BaseModel\n\n# Models\nclass Product(BaseModel):\n    name: str\n    price: float\n    category: str\n    description: str | None = None\n\nclass ProductResponse(BaseModel):\n    id: int\n    name: str\n    price: float\n    category: str\n    description: str | None = None\n\n# Create FastAPI app\napp = FastAPI(title=\"E-commerce API\", version=\"1.0.0\")\n\n# In-memory database\nproducts_db = {\n    1: ProductResponse(\n        id=1, name=\"Laptop\", price=999.99, category=\"Electronics\"\n    ),\n    2: ProductResponse(\n        id=2, name=\"Mouse\", price=29.99, category=\"Electronics\"\n    ),\n    3: ProductResponse(\n        id=3, name=\"Desk Chair\", price=299.99, category=\"Furniture\"\n    ),\n}\nnext_id = 4\n\n@app.get(\"/products\", response_model=list[ProductResponse])\ndef list_products(\n    category: str | None = None,\n    max_price: float | None = None,\n) -> list[ProductResponse]:\n    \"\"\"List all products with optional filtering.\"\"\"\n    products = list(products_db.values())\n    if category:\n        products = [p for p in products if p.category == category]\n    if max_price:\n        products = [p for p in products if p.price <= max_price]\n    return products\n\n@app.get(\"/products/{product_id}\", response_model=ProductResponse)\ndef get_product(product_id: int):\n    \"\"\"Get a specific product by ID.\"\"\"\n    if product_id not in products_db:\n        raise HTTPException(status_code=404, detail=\"Product not found\")\n    return products_db[product_id]\n\n@app.post(\"/products\", response_model=ProductResponse)\ndef create_product(product: Product):\n    \"\"\"Create a new product.\"\"\"\n    global next_id\n    product_response = ProductResponse(id=next_id, **product.model_dump())\n    products_db[next_id] = product_response\n    next_id += 1\n    return product_response\n\n@app.put(\"/products/{product_id}\", response_model=ProductResponse)\ndef update_product(product_id: int, product: Product):\n    \"\"\"Update an existing product.\"\"\"\n    if product_id not in products_db:\n        raise HTTPException(status_code=404, detail=\"Product not found\")\n    products_db[product_id] = ProductResponse(\n        id=product_id,\n        **product.model_dump(),\n    )\n    return products_db[product_id]\n\n@app.delete(\"/products/{product_id}\")\ndef delete_product(product_id: int):\n    \"\"\"Delete a product.\"\"\"\n    if product_id not in products_db:\n        raise HTTPException(status_code=404, detail=\"Product not found\")\n    del products_db[product_id]\n    return {\"message\": \"Product deleted\"}\n```\n\n<Tip>\nAll subsequent code examples in this guide assume you have the above FastAPI application code already defined. Each example builds upon this base application, `app`.\n</Tip>\n\n## Generating an MCP Server\n\n<VersionBadge version=\"2.0.0\" />\n\nOne of the most common ways to bootstrap an MCP server is to generate it from an existing FastAPI application. FastMCP will expose your FastAPI endpoints as MCP components (tools, by default) in order to expose your API to LLM clients.\n\n\n\n### Basic Conversion\n\nConvert the FastAPI app to an MCP server with a single line:\n\n```python {5}\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\n\n# Convert to MCP server\nmcp = FastMCP.from_fastapi(app=app)\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n### Adding Components\n\nYour converted MCP server is a full FastMCP instance, meaning you can add new tools, resources, and other components to it just like you would with any other FastMCP instance.\n\n```python {8-11}\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\n\n# Convert to MCP server\nmcp = FastMCP.from_fastapi(app=app)\n\n# Add a new tool\n@mcp.tool\ndef get_product(product_id: int) -> ProductResponse:\n    \"\"\"Get a product by ID.\"\"\"\n    return products_db[product_id]\n\n# Run the MCP server\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n\n\n\n\n### Interacting with the MCP Server\n\nOnce you've converted your FastAPI app to an MCP server, you can interact with it using the FastMCP client to test functionality before deploying it to an LLM-based application.\n\n```python {3, }\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\nfrom fastmcp.client import Client\nimport asyncio\n\n# Convert to MCP server\nmcp = FastMCP.from_fastapi(app=app)\n\nasync def demo():\n    async with Client(mcp) as client:\n        # List available tools\n        tools = await client.list_tools()\n        print(f\"Available tools: {[t.name for t in tools]}\")\n        \n        # Create a product\n        result = await client.call_tool(\n            \"create_product_products_post\",\n            {\n                \"name\": \"Wireless Keyboard\",\n                \"price\": 79.99,\n                \"category\": \"Electronics\",\n                \"description\": \"Bluetooth mechanical keyboard\"\n            }\n        )\n        print(f\"Created product: {result.data}\")\n        \n        # List electronics under $100\n        result = await client.call_tool(\n            \"list_products_products_get\",\n            {\"category\": \"Electronics\", \"max_price\": 100}\n        )\n        print(f\"Affordable electronics: {result.data}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(demo())\n```\n\n### Custom Route Mapping\n\nBecause FastMCP's FastAPI integration is based on its [OpenAPI integration](/integrations/openapi), you can customize how endpoints are converted to MCP components in exactly the same way. For example, here we use a `RouteMap` to map all GET requests to MCP resources, and all POST/PUT/DELETE requests to MCP tools:\n\n```python\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\n# Custom mapping rules\nmcp = FastMCP.from_fastapi(\n    app=app,\n    route_maps=[\n        # GET with path params \u2192 ResourceTemplates\n        RouteMap(\n            methods=[\"GET\"], \n            pattern=r\".*\\{.*\\}.*\", \n            mcp_type=MCPType.RESOURCE_TEMPLATE\n        ),\n        # Other GETs \u2192 Resources\n        RouteMap(\n            methods=[\"GET\"], \n            pattern=r\".*\", \n            mcp_type=MCPType.RESOURCE\n        ),\n        # POST/PUT/DELETE \u2192 Tools (default)\n    ],\n)\n\n# Now:\n# - GET /products \u2192 Resource\n# - GET /products/{id} \u2192 ResourceTemplate\n# - POST/PUT/DELETE \u2192 Tools\n```\n\n<Tip>\nTo learn more about customizing the conversion process, see the [OpenAPI Integration guide](/integrations/openapi).\n</Tip>\n\n### Authentication and Headers\n\nYou can configure headers and other client options via the `httpx_client_kwargs` parameter. For example, to add authentication to your FastAPI app, you can pass a `headers` dictionary to the `httpx_client_kwargs` parameter:\n\n```python {27-31}\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\n\n# Add authentication to your FastAPI app\nfrom fastapi import Depends, Header\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\n\nsecurity = HTTPBearer()\n\ndef verify_token(credentials: HTTPAuthorizationCredentials = Depends(security)):\n    if credentials.credentials != \"secret-token\":\n        raise HTTPException(status_code=401, detail=\"Invalid authentication\")\n    return credentials.credentials\n\n# Add a protected endpoint\n@app.get(\"/admin/stats\", dependencies=[Depends(verify_token)])\ndef get_admin_stats():\n    return {\n        \"total_products\": len(products_db),\n        \"categories\": list(set(p.category for p in products_db.values()))\n    }\n\n# Create MCP server with authentication headers\nmcp = FastMCP.from_fastapi(\n    app=app,\n    httpx_client_kwargs={\n        \"headers\": {\n            \"Authorization\": \"Bearer secret-token\",\n        }\n    }\n)\n```\n\n## Mounting an MCP Server\n\n<VersionBadge version=\"2.3.1\" />\n\nIn addition to generating servers, FastMCP can facilitate adding MCP servers to your existing FastAPI application. You can do this by mounting the MCP ASGI application.\n\n### Basic Mounting\n\nTo mount an MCP server, you can use the `http_app` method on your FastMCP instance. This will return an ASGI application that can be mounted to your FastAPI application.\n\n```python {23-30}\nfrom fastmcp import FastMCP\nfrom fastapi import FastAPI\n\n# Create MCP server\nmcp = FastMCP(\"Analytics Tools\")\n\n@mcp.tool\ndef analyze_pricing(category: str) -> dict:\n    \"\"\"Analyze pricing for a category.\"\"\"\n    products = [p for p in products_db.values() if p.category == category]\n    if not products:\n        return {\"error\": f\"No products in {category}\"}\n    \n    prices = [p.price for p in products]\n    return {\n        \"category\": category,\n        \"avg_price\": round(sum(prices) / len(prices), 2),\n        \"min\": min(prices),\n        \"max\": max(prices),\n    }\n\n# Create ASGI app from MCP server\nmcp_app = mcp.http_app(path='/mcp')\n\n# Key: Pass lifespan to FastAPI\napp = FastAPI(title=\"E-commerce API\", lifespan=mcp_app.lifespan)\n\n# Mount the MCP server\napp.mount(\"/analytics\", mcp_app)\n\n# Now: API at /products/*, MCP at /analytics/mcp/\n```\n\n## Offering an LLM-Friendly API\n\nA common pattern is to generate an MCP server from your FastAPI app and serve both interfaces from the same application. This provides an LLM-optimized interface alongside your regular API:\n\n```python\n# Assumes the FastAPI app from above is already defined\nfrom fastmcp import FastMCP\nfrom fastapi import FastAPI\n\n# 1. Generate MCP server from your API\nmcp = FastMCP.from_fastapi(app=app, name=\"E-commerce MCP\")\n\n# 2. Create the MCP's ASGI app\nmcp_app = mcp.http_app(path='/mcp')\n\n# 3. Create a new FastAPI app that combines both sets of routes\ncombined_app = FastAPI(\n    title=\"E-commerce API with MCP\",\n    routes=[\n        *mcp_app.routes,  # MCP routes\n        *app.routes,      # Original API routes\n    ],\n    lifespan=mcp_app.lifespan,\n)\n\n# Now you have:\n# - Regular API: http://localhost:8000/products\n# - LLM-friendly MCP: http://localhost:8000/mcp\n# Both served from the same FastAPI application!\n```\n\nThis approach lets you maintain a single codebase while offering both traditional REST endpoints and MCP-compatible endpoints for LLM clients.\n\n## Key Considerations\n\n### Operation IDs\n\nFastAPI operation IDs become MCP component names. Always specify meaningful operation IDs:\n\n```python\n# Good - explicit operation_id\n@app.get(\"/users/{user_id}\", operation_id=\"get_user_by_id\")\ndef get_user(user_id: int):\n    return {\"id\": user_id}\n\n# Less ideal - auto-generated name\n@app.get(\"/users/{user_id}\")\ndef get_user(user_id: int):\n    return {\"id\": user_id}\n```\n\n### Lifespan Management\n\nWhen mounting MCP servers, always pass the lifespan context:\n\n```python\n# Correct - lifespan passed\nmcp_app = mcp.http_app(path='/mcp')\napp = FastAPI(lifespan=mcp_app.lifespan)\napp.mount(\"/mcp\", mcp_app)\n\n# Incorrect - missing lifespan\napp = FastAPI()\napp.mount(\"/mcp\", mcp.http_app())  # Session manager won't initialize\n```\n\nIf you're mounting an authenticated MCP server under a path prefix, see [Mounting Authenticated Servers](/deployment/http#mounting-authenticated-servers) for important OAuth routing considerations.\n\n### CORS Middleware\n\nIf your FastAPI app uses `CORSMiddleware` and you're mounting an OAuth-protected FastMCP server, avoid adding application-wide CORS middleware. FastMCP and the MCP SDK already handle CORS for OAuth routes, and layering CORS middleware can cause conflicts (such as 404 errors on `.well-known` routes or OPTIONS requests).\n\nIf you need CORS on your own FastAPI routes, use the sub-app pattern: mount your API and FastMCP as separate apps, each with their own middleware, rather than adding top-level `CORSMiddleware` to the combined application.\n\n### Combining Lifespans\n\nIf your FastAPI app already has a lifespan (for database connections, startup tasks, etc.), you can't simply replace it with the MCP lifespan. Instead, you need to create a new lifespan function that manages both contexts. This ensures that both your app's initialization logic and the MCP server's session manager run properly:\n\n```python\nfrom contextlib import asynccontextmanager\nfrom fastapi import FastAPI\nfrom fastmcp import FastMCP\n\n# Your existing lifespan\n@asynccontextmanager\nasync def app_lifespan(app: FastAPI):\n    # Startup\n    print(\"Starting up the app...\")\n    # Initialize database, cache, etc.\n    yield\n    # Shutdown\n    print(\"Shutting down the app...\")\n\n# Create MCP server\nmcp = FastMCP(\"Tools\")\nmcp_app = mcp.http_app(path='/mcp')\n\n# Combine both lifespans\n@asynccontextmanager\nasync def combined_lifespan(app: FastAPI):\n    # Run both lifespans\n    async with app_lifespan(app):\n        async with mcp_app.lifespan(app):\n            yield\n\n# Use the combined lifespan\napp = FastAPI(lifespan=combined_lifespan)\napp.mount(\"/mcp\", mcp_app)\n```\n\nThis pattern ensures both your app's initialization logic and the MCP server's session manager are properly managed. The key is using nested `async with` statements - the inner context (MCP) will be initialized after the outer context (your app), and cleaned up before it. This maintains the correct initialization and cleanup order for all your resources.\n\n### Performance Tips\n\n1. **Use in-memory transport for testing** - Pass MCP servers directly to clients\n2. **Design purpose-built MCP tools** - Better than auto-converting complex APIs\n3. **Keep tool parameters simple** - LLMs perform better with focused interfaces\n\nFor more details on configuration options, see the [OpenAPI Integration guide](/integrations/openapi)."}, {"filename": "docs/integrations/gemini-cli.mdx", "content": "---\ntitle: Gemini CLI \ud83e\udd1d FastMCP\nsidebarTitle: Gemini CLI\ndescription: Install and use FastMCP servers in Gemini CLI\nicon: message-smile\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\nimport { LocalFocusTip } from \"/snippets/local-focus.mdx\"\n\n<LocalFocusTip />\n\nGemini CLI supports MCP servers through multiple transport methods including STDIO, SSE, and HTTP, allowing you to extend Gemini's capabilities with custom tools, resources, and prompts from your FastMCP servers.\n\n## Requirements\n\nThis integration uses STDIO transport to run your FastMCP server locally. For remote deployments, you can run your FastMCP server with HTTP or SSE transport and configure it directly using Gemini CLI's built-in MCP management commands.\n\n## Create a Server\n\nThe examples in this guide will use the following simple dice-rolling server, saved as `server.py`.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n## Install the Server\n\n### FastMCP CLI\n<VersionBadge version=\"2.13.0\" />\n\nThe easiest way to install a FastMCP server in Gemini CLI is using the `fastmcp install gemini-cli` command. This automatically handles the configuration, dependency management, and calls Gemini CLI's built-in MCP management system.\n\n```bash\nfastmcp install gemini-cli server.py\n```\n\nThe install command supports the same `file.py:object` notation as the `run` command. If no object is specified, it will automatically look for a FastMCP server object named `mcp`, `server`, or `app` in your file:\n\n```bash\n# These are equivalent if your server object is named 'mcp'\nfastmcp install gemini-cli server.py\nfastmcp install gemini-cli server.py:mcp\n\n# Use explicit object name if your server has a different name\nfastmcp install gemini-cli server.py:my_custom_server\n```\n\nThe command will automatically configure the server with Gemini CLI's `gemini mcp add` command.\n\n#### Dependencies\n\nFastMCP provides flexible dependency management options for your Gemini CLI servers:\n\n**Individual packages**: Use the `--with` flag to specify packages your server needs. You can use this flag multiple times:\n\n```bash\nfastmcp install gemini-cli server.py --with pandas --with requests\n```\n\n**Requirements file**: If you maintain a `requirements.txt` file with all your dependencies, use `--with-requirements` to install them:\n\n```bash\nfastmcp install gemini-cli server.py --with-requirements requirements.txt\n```\n\n**Editable packages**: For local packages under development, use `--with-editable` to install them in editable mode:\n\n```bash\nfastmcp install gemini-cli server.py --with-editable ./my-local-package\n```\n\nAlternatively, you can use a `fastmcp.json` configuration file (recommended):\n\n```json fastmcp.json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"requests\"]\n  }\n}\n```\n\n\n#### Python Version and Project Configuration\n\nControl the Python environment for your server with these options:\n\n**Python version**: Use `--python` to specify which Python version your server requires. This ensures compatibility when your server needs specific Python features:\n\n```bash\nfastmcp install gemini-cli server.py --python 3.11\n```\n\n**Project directory**: Use `--project` to run your server within a specific project context. This tells `uv` to use the project's configuration files and virtual environment:\n\n```bash\nfastmcp install gemini-cli server.py --project /path/to/my-project\n```\n\n#### Environment Variables\n\nIf your server needs environment variables (like API keys), you must include them:\n\n```bash\nfastmcp install gemini-cli server.py --server-name \"Weather Server\" \\\n  --env API_KEY=your-api-key \\\n  --env DEBUG=true\n```\n\nOr load them from a `.env` file:\n\n```bash\nfastmcp install gemini-cli server.py --server-name \"Weather Server\" --env-file .env\n```\n\n<Warning>\n**Gemini CLI must be installed**. The integration looks for the Gemini CLI and uses the `gemini mcp add` command to register servers.\n</Warning>\n\n### Manual Configuration\n\nFor more control over the configuration, you can manually use Gemini CLI's built-in MCP management commands. This gives you direct control over how your server is launched:\n\n```bash\n# Add a server with custom configuration\ngemini mcp add dice-roller uv -- run --with fastmcp fastmcp run server.py\n\n# Add with environment variables\ngemini mcp add weather-server -e API_KEY=secret -e DEBUG=true uv -- run --with fastmcp fastmcp run server.py\n\n# Add with specific scope (user, or project)\ngemini mcp add my-server --scope user uv -- run --with fastmcp fastmcp run server.py\n```\n\nYou can also manually specify Python versions and project directories in your Gemini CLI commands:\n\n```bash\n# With specific Python version\ngemini mcp add ml-server uv -- run --python 3.11 --with fastmcp fastmcp run server.py\n\n# Within a project directory\ngemini mcp add project-server uv -- run --project /path/to/project --with fastmcp fastmcp run server.py\n```\n\n## Using the Server\n\nOnce your server is installed, you can start using your FastMCP server with Gemini CLI.\n\nTry asking Gemini something like:\n\n> \"Roll some dice for me\"\n\nGemini will automatically detect your `roll_dice` tool and use it to fulfill your request.\n\nGemini CLI can now access all the tools and prompts you've defined in your FastMCP server. \n\nIf your server provides prompts, you can use them as slash commands with `/prompt_name`.\n"}, {"filename": "docs/integrations/gemini.mdx", "content": "---\ntitle: Gemini SDK \ud83e\udd1d FastMCP\nsidebarTitle: Gemini SDK\ndescription: Connect FastMCP servers to the Google Gemini SDK\nicon: message-code\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\nGoogle's Gemini API includes built-in support for MCP servers in their Python and JavaScript SDKs, allowing you to connect directly to MCP servers and use their tools seamlessly with Gemini models.\n\n## Gemini Python SDK\n\nGoogle's [Gemini Python SDK](https://ai.google.dev/gemini-api/docs) can use FastMCP clients directly.\n\n<Note>\nGoogle's MCP integration is currently experimental and available in the Python and JavaScript SDKs. The API automatically calls MCP tools when needed and can connect to both local and remote MCP servers.\n</Note>\n\n<Tip>\nCurrently, Gemini's MCP support only accesses **tools** from MCP servers\u2014it queries the `list_tools` endpoint and exposes those functions to the AI. Other MCP features like resources and prompts are not currently supported.\n</Tip>\n\n### Create a Server\n\nFirst, create a FastMCP server with the tools you want to expose. For this example, we'll create a server with a single tool that rolls dice.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n### Call the Server\n\n\nTo use the Gemini API with MCP, you'll need to install the Google Generative AI SDK:\n\n```bash\npip install google-genai\n```\n\nYou'll also need to authenticate with Google. You can do this by setting the `GEMINI_API_KEY` environment variable. Consult the Gemini SDK documentation for more information.\n\n```bash\nexport GEMINI_API_KEY=\"your-api-key\"\n```\n\nGemini's SDK interacts directly with the MCP client session. To call the server, you'll need to instantiate a FastMCP client, enter its connection context, and pass the client session to the Gemini SDK.\n\n```python {5, 9, 15}\nfrom fastmcp import Client\nfrom google import genai\nimport asyncio\n\nmcp_client = Client(\"server.py\")\ngemini_client = genai.Client()\n\nasync def main():    \n    async with mcp_client:\n        response = await gemini_client.aio.models.generate_content(\n            model=\"gemini-2.0-flash\",\n            contents=\"Roll 3 dice!\",\n            config=genai.types.GenerateContentConfig(\n                temperature=0,\n                tools=[mcp_client.session],  # Pass the FastMCP client session\n            ),\n        )\n        print(response.text)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nIf you run this code, you'll see output like:\n\n```text\nOkay, I rolled 3 dice and got a 5, 4, and 1.\n```\n\n### Remote & Authenticated Servers\n\nIn the above example, we connected to our local server using `stdio` transport. Because we're using a FastMCP client, you can also connect to any local or remote MCP server, using any [transport](/clients/transports) or [auth](/clients/auth) method supported by FastMCP, simply by changing the client configuration.\n\nFor example, to connect to a remote, authenticated server, you can use the following client:\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.client.auth import BearerAuth\n\nmcp_client = Client(\n    \"https://my-server.com/mcp/\",\n    auth=BearerAuth(\"<your-token>\"),\n)\n```\n\nThe rest of the code remains the same.\n\n\n"}, {"filename": "docs/integrations/github.mdx", "content": "---\ntitle: GitHub OAuth \ud83e\udd1d FastMCP\nsidebarTitle: GitHub\ndescription: Secure your FastMCP server with GitHub OAuth\nicon: github\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.0\" />\n\nThis guide shows you how to secure your FastMCP server using **GitHub OAuth**. Since GitHub doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge GitHub's traditional OAuth with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. A **[GitHub Account](https://github.com/)** with access to create OAuth Apps\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a GitHub OAuth App\n\nCreate an OAuth App in your GitHub settings to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to OAuth Apps\">\n    Go to **Settings \u2192 Developer settings \u2192 OAuth Apps** in your GitHub account, or visit [github.com/settings/developers](https://github.com/settings/developers).\n    \n    Click **\"New OAuth App\"** to create a new application.\n</Step>\n\n<Step title=\"Configure Your OAuth App\">\n    Fill in the application details:\n    \n    - **Application name**: Choose a name users will recognize (e.g., \"My FastMCP Server\")\n    - **Homepage URL**: Your application's homepage or documentation URL\n    - **Authorization callback URL**: Your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n    \n    <Warning>\n    The callback URL must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter. For local development, GitHub allows `http://localhost` URLs. For production, you must use HTTPS.\n    </Warning>\n    \n    <Tip>\n    If you want to use a custom callback path (e.g., `/auth/github/callback`), make sure to set the same path in both your GitHub OAuth App settings and the `redirect_path` parameter when configuring the GitHubProvider.\n    </Tip>\n</Step>\n\n<Step title=\"Save Your Credentials\">\n    After creating the app, you'll see:\n    \n    - **Client ID**: A public identifier like `Ov23liAbcDefGhiJkLmN`\n    - **Client Secret**: Click \"Generate a new client secret\" and save the value securely\n    \n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `GitHubProvider`, which handles GitHub's OAuth quirks automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.github import GitHubProvider\n\n# The GitHubProvider handles GitHub's token format and validation\nauth_provider = GitHubProvider(\n    client_id=\"Ov23liAbcDefGhiJkLmN\",  # Your GitHub OAuth App Client ID\n    client_secret=\"github_pat_...\",     # Your GitHub OAuth App Client Secret\n    base_url=\"http://localhost:8000\",   # Must match your OAuth App configuration\n    # redirect_path=\"/auth/callback\"   # Default value, customize if needed\n)\n\nmcp = FastMCP(name=\"GitHub Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Returns information about the authenticated GitHub user.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n    \n    token = get_access_token()\n    # The GitHubProvider stores user data in token claims\n    return {\n        \"github_user\": token.claims.get(\"login\"),\n        \"name\": token.claims.get(\"name\"),\n        \"email\": token.claims.get(\"email\")\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by GitHub OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your GitHub-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle GitHub OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open GitHub login in your browser\n        print(\"\u2713 Authenticated with GitHub!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"get_user_info\")\n        print(f\"GitHub user: {result['github_user']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to GitHub's authorization page\n2. After you authorize the app, you'll be redirected back\n3. The client receives the token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key` and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = GitHubProvider(\n    client_id=\"Ov23liAbcDefGhiJkLmN\",\n    client_secret=\"github_pat_...\",\n    base_url=\"https://your-production-domain.com\",\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production GitHub App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the GitHub provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.github.GitHubProvider` to use GitHub authentication.\n</ParamField>\n</Card>\n\n### GitHub-Specific Configuration\n\nThese environment variables provide default values for the GitHub provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID\" required>\nYour GitHub OAuth App Client ID (e.g., `Ov23liAbcDefGhiJkLmN`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET\" required>\nYour GitHub OAuth App Client Secret\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your GitHub OAuth App\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_REQUIRED_SCOPES\" default='[\"user\"]'>\nComma-, space-, or JSON-separated list of required GitHub scopes (e.g., `user repo` or `[\"user\",\"repo\"]`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GITHUB_TIMEOUT_SECONDS\" default=\"10\">\nHTTP request timeout for GitHub API calls\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the GitHub provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.github.GitHubProvider\n\n# GitHub OAuth credentials\nFASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=Ov23liAbcDefGhiJkLmN\nFASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=github_pat_...\nFASTMCP_SERVER_AUTH_GITHUB_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_GITHUB_REQUIRED_SCOPES=user,repo\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"GitHub Secured App\")\n\n@mcp.tool\nasync def list_repos() -> list[str]:\n    \"\"\"List the authenticated user's repositories.\"\"\"\n    # Your tool implementation here\n    pass\n```\n"}, {"filename": "docs/integrations/google.mdx", "content": "---\ntitle: Google OAuth \ud83e\udd1d FastMCP\nsidebarTitle: Google\ndescription: Secure your FastMCP server with Google OAuth\nicon: google\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.0\" />\n\nThis guide shows you how to secure your FastMCP server using **Google OAuth**. Since Google doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge Google's traditional OAuth with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. A **[Google Cloud Account](https://console.cloud.google.com/)** with access to create OAuth 2.0 Client IDs\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a Google OAuth 2.0 Client ID\n\nCreate an OAuth 2.0 Client ID in your Google Cloud Console to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Navigate to OAuth Consent Screen\">\n    Go to the [Google Cloud Console](https://console.cloud.google.com/apis/credentials) and select your project (or create a new one).\n    \n    First, configure the OAuth consent screen by navigating to **APIs & Services \u2192 OAuth consent screen**. Choose \"External\" for testing or \"Internal\" for G Suite organizations.\n</Step>\n\n<Step title=\"Create OAuth 2.0 Client ID\">\n    Navigate to **APIs & Services \u2192 Credentials** and click **\"+ CREATE CREDENTIALS\"** \u2192 **\"OAuth client ID\"**.\n    \n    Configure your OAuth client:\n    \n    - **Application type**: Web application\n    - **Name**: Choose a descriptive name (e.g., \"FastMCP Server\")\n    - **Authorized JavaScript origins**: Add your server's base URL (e.g., `http://localhost:8000`)\n    - **Authorized redirect URIs**: Add your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n    \n    <Warning>\n    The redirect URI must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter. For local development, Google allows `http://localhost` URLs with various ports. For production, you must use HTTPS.\n    </Warning>\n    \n    <Tip>\n    If you want to use a custom callback path (e.g., `/auth/google/callback`), make sure to set the same path in both your Google OAuth Client settings and the `redirect_path` parameter when configuring the GoogleProvider.\n    </Tip>\n</Step>\n\n<Step title=\"Save Your Credentials\">\n    After creating the client, you'll receive:\n    \n    - **Client ID**: A string ending in `.apps.googleusercontent.com`\n    - **Client Secret**: A string starting with `GOCSPX-`\n    \n    Download the JSON credentials or copy these values securely.\n    \n    <Tip>\n    Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `GoogleProvider`, which handles Google's OAuth flow automatically:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.google import GoogleProvider\n\n# The GoogleProvider handles Google's token format and validation\nauth_provider = GoogleProvider(\n    client_id=\"123456789.apps.googleusercontent.com\",  # Your Google OAuth Client ID\n    client_secret=\"GOCSPX-abc123...\",                  # Your Google OAuth Client Secret\n    base_url=\"http://localhost:8000\",                  # Must match your OAuth configuration\n    required_scopes=[                                  # Request user information\n        \"openid\",\n        \"https://www.googleapis.com/auth/userinfo.email\",\n    ],\n    # redirect_path=\"/auth/callback\"                  # Default value, customize if needed\n)\n\nmcp = FastMCP(name=\"Google Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Returns information about the authenticated Google user.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n    \n    token = get_access_token()\n    # The GoogleProvider stores user data in token claims\n    return {\n        \"google_id\": token.claims.get(\"sub\"),\n        \"email\": token.claims.get(\"email\"),\n        \"name\": token.claims.get(\"name\"),\n        \"picture\": token.claims.get(\"picture\"),\n        \"locale\": token.claims.get(\"locale\")\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Google OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Google-protected server:\n\n```python test_client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle Google OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open Google login in your browser\n        print(\"\u2713 Authenticated with Google!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"get_user_info\")\n        print(f\"Google user: {result['email']}\")\n        print(f\"Name: {result['name']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to Google's authorization page\n2. Sign in with your Google account and grant the requested permissions\n3. After authorization, you'll be redirected back\n4. The client receives the token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key` and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.google import GoogleProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = GoogleProvider(\n    client_id=\"123456789.apps.googleusercontent.com\",\n    client_secret=\"GOCSPX-abc123...\",\n    base_url=\"https://your-production-domain.com\",\n    required_scopes=[\"openid\", \"https://www.googleapis.com/auth/userinfo.email\"],\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production Google App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Google provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.google.GoogleProvider` to use Google authentication.\n</ParamField>\n</Card>\n\n### Google-Specific Configuration\n\nThese environment variables provide default values for the Google provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID\" required>\nYour Google OAuth 2.0 Client ID (e.g., `123456789.apps.googleusercontent.com`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET\" required>\nYour Google OAuth 2.0 Client Secret (e.g., `GOCSPX-abc123...`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your Google OAuth Client\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_REQUIRED_SCOPES\" default=\"[]\">\nComma-, space-, or JSON-separated list of required Google scopes (e.g., `\"openid,https://www.googleapis.com/auth/userinfo.email\"` or `[\"openid\", \"https://www.googleapis.com/auth/userinfo.email\"]`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_TIMEOUT_SECONDS\" default=\"10\">\nHTTP request timeout for Google API calls\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the Google provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.google.GoogleProvider\n\n# Google OAuth credentials\nFASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=123456789.apps.googleusercontent.com\nFASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=GOCSPX-abc123...\nFASTMCP_SERVER_AUTH_GOOGLE_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_GOOGLE_REQUIRED_SCOPES=openid,https://www.googleapis.com/auth/userinfo.email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"Google Secured App\")\n\n@mcp.tool\nasync def protected_tool(query: str) -> str:\n    \"\"\"A tool that requires Google authentication to access.\"\"\"\n    # Your tool implementation here\n    return f\"Processing authenticated request: {query}\"\n```"}, {"filename": "docs/integrations/mcp-json-configuration.mdx", "content": "---\ntitle: MCP JSON Configuration \ud83e\udd1d FastMCP\nsidebarTitle: MCP.json\ndescription: Generate standard MCP configuration files for any compatible client\nicon: brackets-curly\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.10.3\" />\n\nFastMCP can generate standard MCP JSON configuration files that work with any MCP-compatible client including Claude Desktop, VS Code, Cursor, and other applications that support the Model Context Protocol.\n\n## MCP JSON Configuration Standard\n\nThe MCP JSON configuration format is an **emergent standard** that has developed across the MCP ecosystem. This format defines how MCP clients should configure and launch MCP servers, providing a consistent way to specify server commands, arguments, and environment variables.\n\n### Configuration Structure\n\nThe standard uses a `mcpServers` object where each key represents a server name and the value contains the server's configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"server-name\": {\n      \"command\": \"executable\",\n      \"args\": [\"arg1\", \"arg2\"],\n      \"env\": {\n        \"VAR\": \"value\"\n      }\n    }\n  }\n}\n```\n\n### Server Configuration Fields\n\n#### `command` (required)\nThe executable command to run the MCP server. This should be an absolute path or a command available in the system PATH.\n\n```json\n{\n  \"command\": \"python\"\n}\n```\n\n#### `args` (optional)\nAn array of command-line arguments passed to the server executable. Arguments are passed in order.\n\n```json\n{\n  \"args\": [\"server.py\", \"--verbose\", \"--port\", \"8080\"]\n}\n```\n\n#### `env` (optional)\nAn object containing environment variables to set when launching the server. All values must be strings.\n\n```json\n{\n  \"env\": {\n    \"API_KEY\": \"secret-key\",\n    \"DEBUG\": \"true\",\n    \"PORT\": \"8080\"\n  }\n}\n```\n\n### Client Adoption\n\nThis format is widely adopted across the MCP ecosystem:\n\n- **Claude Desktop**: Uses `~/.claude/claude_desktop_config.json`\n- **Cursor**: Uses `~/.cursor/mcp.json`\n- **VS Code**: Uses workspace `.vscode/mcp.json`\n- **Other clients**: Many MCP-compatible applications follow this standard\n\n## Overview\n\n<Note>\n**For the best experience, use FastMCP's first-class integrations:** [`fastmcp install claude-code`](/integrations/claude-code), [`fastmcp install claude-desktop`](/integrations/claude-desktop), or [`fastmcp install cursor`](/integrations/cursor). Use MCP JSON generation for advanced use cases and unsupported clients.\n</Note>\n\nThe `fastmcp install mcp-json` command generates configuration in the standard `mcpServers` format used across the MCP ecosystem. This is useful when:\n\n- **Working with unsupported clients** - Any MCP client not directly integrated with FastMCP\n- **CI/CD environments** - Automated configuration generation for deployments  \n- **Configuration sharing** - Easy distribution of server setups to team members\n- **Custom tooling** - Integration with your own MCP management tools\n- **Manual setup** - When you prefer to manually configure your MCP client\n\n## Basic Usage\n\nGenerate configuration and output to stdout (useful for piping):\n\n```bash\nfastmcp install mcp-json server.py\n```\n\nThis outputs the server configuration JSON with the server name as the root key:\n\n```json\n{\n  \"My Server\": {\n    \"command\": \"uv\",\n    \"args\": [\n      \"run\",\n      \"--with\",\n      \"fastmcp\", \n      \"fastmcp\",\n      \"run\",\n      \"/absolute/path/to/server.py\"\n    ]\n  }\n}\n```\n\nTo use this in a client configuration file, add it to the `mcpServers` object in your client's configuration:\n\n```json\n{\n  \"mcpServers\": {\n    \"My Server\": {\n      \"command\": \"uv\",\n      \"args\": [\n        \"run\",\n        \"--with\",\n        \"fastmcp\", \n        \"fastmcp\",\n        \"run\",\n        \"/absolute/path/to/server.py\"\n      ]\n    }\n  }\n}\n```\n\n<Note>\nWhen using `--python`, `--project`, or `--with-requirements`, the generated configuration will include these options in the `uv run` command, ensuring your server runs with the correct Python version and dependencies.\n</Note>\n\n<Note>\nDifferent MCP clients may have specific configuration requirements or formatting needs. Always consult your client's documentation to ensure proper integration.\n</Note>\n\n## Configuration Options\n\n### Server Naming\n\n```bash\n# Use server's built-in name (from FastMCP constructor)\nfastmcp install mcp-json server.py\n\n# Override with custom name\nfastmcp install mcp-json server.py --name \"Custom Server Name\"\n```\n\n### Dependencies\n\nAdd Python packages your server needs:\n\n```bash\n# Single package\nfastmcp install mcp-json server.py --with pandas\n\n# Multiple packages  \nfastmcp install mcp-json server.py --with pandas --with requests --with httpx\n\n# Editable local package\nfastmcp install mcp-json server.py --with-editable ./my-package\n\n# From requirements file\nfastmcp install mcp-json server.py --with-requirements requirements.txt\n```\n\nYou can also use a `fastmcp.json` configuration file (recommended):\n\n```json fastmcp.json\n{\n  \"$schema\": \"https://gofastmcp.com/public/schemas/fastmcp.json/v1.json\",\n  \"source\": {\n    \"path\": \"server.py\",\n    \"entrypoint\": \"mcp\"\n  },\n  \"environment\": {\n    \"dependencies\": [\"pandas\", \"matplotlib\", \"seaborn\"]\n  }\n}\n```\n\nThen simply install with:\n```bash\nfastmcp install mcp-json fastmcp.json\n```\n\n\n### Environment Variables\n\n```bash\n# Individual environment variables\nfastmcp install mcp-json server.py \\\n  --env API_KEY=your-secret-key \\\n  --env DEBUG=true\n\n# Load from .env file\nfastmcp install mcp-json server.py --env-file .env\n```\n\n### Python Version and Project Directory\n\nSpecify Python version or run within a specific project:\n\n```bash\n# Use specific Python version\nfastmcp install mcp-json server.py --python 3.11\n\n# Run within a project directory\nfastmcp install mcp-json server.py --project /path/to/project\n```\n\n### Server Object Selection\n\nUse the same `file.py:object` notation as other FastMCP commands:\n\n```bash\n# Auto-detects server object (looks for 'mcp', 'server', or 'app')\nfastmcp install mcp-json server.py\n\n# Explicit server object\nfastmcp install mcp-json server.py:my_custom_server\n```\n\n## Clipboard Integration\n\nCopy configuration directly to your clipboard for easy pasting:\n\n```bash\nfastmcp install mcp-json server.py --copy\n```\n\n<Note>\nThe `--copy` flag requires the `pyperclip` Python package. If not installed, you'll see an error message with installation instructions.\n</Note>\n\n## Usage Examples\n\n### Basic Server\n\n```bash\nfastmcp install mcp-json dice_server.py\n```\n\nOutput:\n```json\n{\n  \"Dice Server\": {\n    \"command\": \"uv\",\n    \"args\": [\n      \"run\",\n      \"--with\",\n      \"fastmcp\",\n      \"fastmcp\", \n      \"run\",\n      \"/home/user/dice_server.py\"\n    ]\n  }\n}\n```\n\n### Production Server with Dependencies\n\n```bash\nfastmcp install mcp-json api_server.py \\\n  --name \"Production API Server\" \\\n  --with requests \\\n  --with python-dotenv \\\n  --env API_BASE_URL=https://api.example.com \\\n  --env TIMEOUT=30\n```\n\n### Advanced Configuration\n\n```bash\nfastmcp install mcp-json ml_server.py \\\n  --name \"ML Analysis Server\" \\\n  --python 3.11 \\\n  --with-requirements requirements.txt \\\n  --project /home/user/ml-project \\\n  --env GPU_DEVICE=0\n```\n\nOutput:\n```json\n{\n  \"Production API Server\": {\n    \"command\": \"uv\",\n    \"args\": [\n      \"run\",\n      \"--with\",\n      \"fastmcp\",\n      \"--with\",\n      \"python-dotenv\", \n      \"--with\",\n      \"requests\",\n      \"fastmcp\",\n      \"run\", \n      \"/home/user/api_server.py\"\n    ],\n    \"env\": {\n      \"API_BASE_URL\": \"https://api.example.com\",\n      \"TIMEOUT\": \"30\"\n    }\n  }\n}\n```\n\nThe advanced configuration example generates:\n```json\n{\n  \"ML Analysis Server\": {\n    \"command\": \"uv\",\n    \"args\": [\n      \"run\",\n      \"--python\",\n      \"3.11\",\n      \"--project\",\n      \"/home/user/ml-project\",\n      \"--with\",\n      \"fastmcp\",\n      \"--with-requirements\",\n      \"requirements.txt\",\n      \"fastmcp\",\n      \"run\",\n      \"/home/user/ml_server.py\"\n    ],\n    \"env\": {\n      \"GPU_DEVICE\": \"0\"\n    }\n  }\n}\n```\n\n### Pipeline Usage\n\nSave configuration to file:\n\n```bash\nfastmcp install mcp-json server.py > mcp-config.json\n```\n\nUse in shell scripts:\n\n```bash\n#!/bin/bash\nCONFIG=$(fastmcp install mcp-json server.py --name \"CI Server\")\necho \"$CONFIG\" | jq '.\"CI Server\".command'\n# Output: \"uv\"\n```\n\n## Integration with MCP Clients\n\nThe generated configuration works with any MCP-compatible application:\n\n### Claude Desktop\n<Note>\n**Prefer [`fastmcp install claude-desktop`](/integrations/claude-desktop)** for automatic installation. Use MCP JSON for advanced configuration needs.\n</Note>\nCopy the `mcpServers` object into `~/.claude/claude_desktop_config.json`\n\n### Cursor\n<Note>\n**Prefer [`fastmcp install cursor`](/integrations/cursor)** for automatic installation. Use MCP JSON for advanced configuration needs.\n</Note>\nAdd to `~/.cursor/mcp.json`\n\n### VS Code  \nAdd to your workspace's `.vscode/mcp.json` file\n\n### Custom Applications\nUse the JSON configuration with any application that supports the MCP protocol\n\n## Configuration Format\n\nThe generated configuration outputs a server object with the server name as the root key:\n\n```json\n{\n  \"<server-name>\": {\n    \"command\": \"<executable>\",\n    \"args\": [\"<arg1>\", \"<arg2>\", \"...\"],\n    \"env\": {\n      \"<ENV_VAR>\": \"<value>\"\n    }\n  }\n}\n```\n\nTo use this in an MCP client, add it to the client's `mcpServers` configuration object.\n\n**Fields:**\n- `command`: The executable to run (always `uv` for FastMCP servers)\n- `args`: Command-line arguments including dependencies and server path\n- `env`: Environment variables (only included if specified)\n\n<Warning>\n**All file paths in the generated configuration are absolute paths**. This ensures the configuration works regardless of the working directory when the MCP client starts the server.\n</Warning>\n\n## Requirements\n\n- **uv**: Must be installed and available in your system PATH\n- **pyperclip** (optional): Required only for `--copy` functionality\n\nInstall uv if not already available:\n\n```bash\n# macOS\nbrew install uv\n\n# Linux/Windows  \ncurl -LsSf https://astral.sh/uv/install.sh | sh\n```\n"}, {"filename": "docs/integrations/oci.mdx", "content": "---\ntitle: OCI IAM OAuth \ud83e\udd1d FastMCP\nsidebarTitle: Oracle\ndescription: Secure your FastMCP server with OCI IAM OAuth\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.0\" />\n\nThis guide shows you how to secure your FastMCP server using **OCI IAM OAuth**. Since OCI IAM doesn't support Dynamic Client Registration, this integration uses the [**OIDC Proxy**](/servers/auth/oidc-proxy) pattern to bridge OCI's traditional OAuth with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\n1. An OCI cloud Account with access to create an Integrated Application in an Identity Domain.\n2. Your FastMCP server's URL (For dev environments, it is http://localhost:8000. For PROD environments, it could be https://mcp.${DOMAIN}.com)\n\n### Step 1: Make sure client access is enabled for JWK's URL\n\n<Steps>\n<Step title=\"Navigate to OCI IAM Domain Settings\">\n\n    Login to OCI console (https://cloud.oracle.com for OCI commercial cloud).\n    From \"Identity & Security\" menu, open Domains page.\n    On the Domains list page, select the domain that you are using for MCP Authentication.\n    Open Settings tab. \n    Click on \"Edit Domain Settings\" button.\n\n    <Frame>\n        <img src=\"/integrations/images/oci/ocieditdomainsettingsbutton.png\" alt=\"OCI console showing the Edit Domain Settings button in the IAM Domain settings page\" />\n    </Frame>\n</Step>\n\n<Step title=\"Update Domain Setting\">\n\n    Enable \"Configure client access\" checkbox as shown in the screenshot.\n\n    <Frame>\n        <img src=\"/integrations/images/oci/ocieditdomainsettings.png\" alt=\"OCI IAM Domain Settings\" />\n    </Frame>\n</Step>\n</Steps>\n\n### Step 2: Create OAuth client for MCP server authentication\n\nFollow the Steps as mentioned below to create an OAuth client.\n\n<Steps>\n<Step title=\"Navigate to OCI IAM Integrated Applications\">\n\n    Login to OCI console (https://cloud.oracle.com for OCI commercial cloud).\n    From \"Identity & Security\" menu, open Domains page.\n    On the Domains list page, select the domain in which you want to create MCP server OAuth client. If you need help finding the list page for the domain, see [Listing Identity Domains.](https://docs.oracle.com/en-us/iaas/Content/Identity/domains/to-view-identity-domains.htm#view-identity-domains).\n    On the details page, select Integrated applications. A list of applications in the domain is displayed.\n</Step>\n\n<Step title=\"Add an Integrated Application\">\n\n    Select Add application.\n    In the Add application window, select Confidential Application.\n    Select Launch workflow.\n    In the Add application details page, Enter name and description as shown below.\n\n    <Frame>\n        <img src=\"/integrations/images/oci/ociaddapplication.png\" alt=\"Adding a Confidential Integrated Application in OCI IAM Domain\" />\n    </Frame>\n</Step>\n\n<Step title=\"Update OAuth Configuration for an Integrated Application\">\n\n    Once the Integrated Application is created, Click on \"OAuth configuration\" tab.\n    Click on \"Edit OAuth configuration\" button.\n    Configure the application as OAuth client by selecting \"Configure this application as a client now\" radio button.\n    Select \"Authorization code\" grant type. If you are planning to use the same OAuth client application for token exchange, select \"Client credentials\" grant type as well. In the sample, we will use the same client.\n    For Authorization grant type, select redirect URL. In most cases, this will be the MCP server URL followed by \"/oauth/callback\".\n\n    <Frame>\n        <img src=\"/integrations/images/oci/ocioauthconfiguration.png\" alt=\"OAuth Configuration for an Integrated Application in OCI IAM Domain\" />\n    </Frame>\n</Step>\n\n<Step title=\"Activate the Integrated Application\">\n\n    Click on \"Submit\" button to update OAuth configuration for the client application. \n    **Note: You don't need to do any special configuration to support PKCE for the OAuth client.**\n    Make sure to Activate the client application.\n    Note down client ID and client secret for the application. Update .env file and replace FASTMCP_SERVER_AUTH_OCI_CLIENT_ID and FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET values. \n    FASTMCP_SERVER_AUTH_OCI_IAM_GUID in the env file is the Identity domain URL that you chose for the MCP server.\n</Step>\n</Steps>\n\nThis is all you need to implement MCP server authentication against OCI IAM. However, you may want to use an authenticated user token to invoke OCI control plane APIs and propagate identity to the OCI control plane instead of using a service user account. In that case, you need to implement token exchange.\n\n### Step 3: Token Exchange Setup (Only if MCP server needs to talk to OCI Control Plane)\n\nToken exchange helps you exchange a logged-in user's OCI IAM token for an OCI control plane session token, also known as UPST (User Principal Session Token). To learn more about token exchange, refer to my [Workload Identity Federation Blog](https://www.ateam-oracle.com/post/workload-identity-federation)\n\nFor token exchange, we need to configure Identity propagation trust. The blog above discusses setting up the trust using REST APIs. However, you can also use OCI CLI. Before using the CLI command below, ensure that you have created a token exchange OAuth client. In most cases, you can use the same OAuth client that you created above. You will use the client ID of the token exchange OAuth client in the CLI command below and replace it with {FASTMCP_SERVER_AUTH_OCI_CLIENT_ID}. \n\nYou will also need to update the client secret for the token exchange OAuth client in the .env file. It is the FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET parameter. Update FASTMCP_SERVER_AUTH_OCI_IAM_GUID and FASTMCP_SERVER_AUTH_OCI_CLIENT_ID as well for the token exchange OAuth client in the .env file.\n\n```bash\noci identity-domains identity-propagation-trust create \\\n--schemas '[\"urn:ietf:params:scim:schemas:oracle:idcs:IdentityPropagationTrust\"]' \\\n--public-key-endpoint \"https://{FASTMCP_SERVER_AUTH_OCI_IAM_GUID}.identity.oraclecloud.com/admin/v1/SigningCert/jwk\" \\\n--name \"For Token Exchange\" --type \"JWT\" \\\n--issuer \"https://identity.oraclecloud.com/\" --active true \\\n--endpoint \"https://{FASTMCP_SERVER_AUTH_OCI_IAM_GUID}.identity.oracleclcoud.com\" \\\n--subject-claim-name \"sub\" --allow-impersonation false \\\n--subject-mapping-attribute \"username\" \\\n--subject-type \"User\" --client-claim-name \"iss\" \\\n--client-claim-values '[\"https://identity.oraclecloud.com/\"]' \\\n--oauth-clients '[\"{FASTMCP_SERVER_AUTH_OCI_CLIENT_ID}\"]'\n```\n\nTo exchange access token for OCI token and create a signer object, you need to add below code in MCP server. You can then use the signer object to create any OCI control plane client. \n\n```python\n\nfrom fastmcp.server.dependencies import get_access_token\nfrom fastmcp.utilities.logging import get_logger\nfrom oci.auth.signers import TokenExchangeSigner\nimport os\n\nlogger = get_logger(__name__)\n\n# Load configuration from environment\nFASTMCP_SERVER_AUTH_OCI_IAM_GUID = os.environ[\"FASTMCP_SERVER_AUTH_OCI_IAM_GUID\"]\nFASTMCP_SERVER_AUTH_OCI_CLIENT_ID = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_ID\"]\nFASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET\"]\n\n_global_token_cache = {} #In memory cache for OCI session token signer\n    \ndef get_oci_signer() -> TokenExchangeSigner:\n\n    authntoken = get_access_token()\n    tokenID = authntoken.claims.get(\"jti\")\n    token = authntoken.token\n    \n    #Check if the signer exists for the token ID in memory cache\n    cached_signer = _global_token_cache.get(tokenID)\n    logger.debug(f\"Global cached signer: {cached_signer}\")\n    if cached_signer:\n        logger.debug(f\"Using globally cached signer for token ID: {tokenID}\")\n        return cached_signer\n\n    #If the signer is not yet created for the token then create new OCI signer object\n    logger.debug(f\"Creating new signer for token ID: {tokenID}\")\n    signer = TokenExchangeSigner(\n        jwt_or_func=token,\n        oci_domain_id=FASTMCP_SERVER_AUTH_OCI_IAM_GUID.split(\".\")[0],\n        client_id=FASTMCP_SERVER_AUTH_OCI_CLIENT_ID,\n        client_secret=FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET,\n    )\n    logger.debug(f\"Signer {signer} created for token ID: {tokenID}\")\n        \n    #Cache the signer object in memory cache\n    _global_token_cache[tokenID] = signer\n    logger.debug(f\"Signer cached for token ID: {tokenID}\")\n\n    return signer\n```\n\n## Running MCP server\n\nOnce the setup is complete, to run the MCP server, run the below command.\n```bash\nfastmcp run server.py:mcp --transport http --port 8000\n```\n\nTo run MCP client, run the below command.\n```bash\npython3 client.py\n```\n\nMCP Client sample is as below.\n```python client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle OCI OAuth flows\n    async with Client(\"http://localhost:8000/mcp/\", auth=\"oauth\") as client:\n        # First-time connection will open OCI login in your browser\n        print(\"\u2713 Authenticated with OCI IAM\")\n\n        tools = await client.list_tools()\n        print(f\"\ud83d\udd27 Available tools ({len(tools)}):\")\n        for tool in tools:\n            print(f\"   - {tool.name}: {tool.description}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to OCI IAM's login page\n2. Sign in with your OCI account and grant the requested consent\n3. After authorization, you'll be redirected back to the redirect path\n4. The client receives the token and can make authenticated requests\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key`, and `client_storage`:\n\n```python server.py\n\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.oci import OCIProvider\n\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Load configuration from environment\nFASTMCP_SERVER_AUTH_OCI_CONFIG_URL = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CONFIG_URL\"]\nFASTMCP_SERVER_AUTH_OCI_CLIENT_ID = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_ID\"]\nFASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET\"]\n\n# Production setup with encrypted persistent token storage\nauth_provider = OCIProvider(\n    config_url=FASTMCP_SERVER_AUTH_OCI_CONFIG_URL,\n    client_id=FASTMCP_SERVER_AUTH_OCI_CLIENT_ID,\n    client_secret=FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET,\n    base_url=\"https://your-production-domain.com\",\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production OCI App\", auth=auth_provider)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at Rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the OCI provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.oci.OCIProvider` to use OCI IAM authentication.\n</ParamField>\n</Card>\n\n### OCI-Specific Configuration\n\nThese environment variables provide default values for the OCI IAM provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_IAM_GUID\" required>\nYour OCI Application Configuration URL (e.g., `idcs-asdascxasd11......identity.oraclecloud.com`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_CONFIG_URL\" required>\nYour OCI Application Configuration URL (e.g., `https://{FASTMCP_SERVER_AUTH_OCI_IAM_GUID}.identity.oraclecloud.com/.well-known/openid-configuration`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_CLIENT_ID\" required>\nYour OCI Application Client ID (e.g., `tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET\" required>\nYour OCI Application Client Secret (e.g., `idcsssvPYqbjemq...`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_BASE_URL\" required>\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_OCI_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your OCI IAM Integrated Application\n</ParamField>\n\n</Card>\n\nExample `.env` file:\n```bash\n# Use the OCI IAM provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.oci.OCIProvider\n\n# OCI IAM configuration and credentials\nFASTMCP_SERVER_AUTH_OCI_IAM_GUID=idcs-asaacasd1111.....\nFASTMCP_SERVER_AUTH_OCI_CONFIG_URL=https://{FASTMCP_SERVER_AUTH_OCI_IAM_GUID}.identity.oraclecloud.com/.well-known/openid-configuration\nFASTMCP_SERVER_AUTH_OCI_CLIENT_ID=<your-client-id>\nFASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET=<your-client-secret>\nFASTMCP_SERVER_AUTH_OCI_BASE_URL=https://your-server.com\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_access_token\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"OCI Secured App\")\n\n@mcp.tool\ndef whoami() -> str:\n    \"\"\"The whoami function is to test MCP server without requiring token exchange.\n    This tool can be used to test successful authentication against OCI IAM.\n    It will return logged in user's subject (username from IAM domain).\"\"\"\n    token = get_access_token()\n    user = token.claims.get(\"sub\")\n    return f\"You are User: {user}\"\n```"}, {"filename": "docs/integrations/openai.mdx", "content": "---\ntitle: OpenAI API \ud83e\udd1d FastMCP\nsidebarTitle: OpenAI API\ndescription: Connect FastMCP servers to the OpenAI API\nicon: message-code\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n\n## Responses API\n\nOpenAI's [Responses API](https://platform.openai.com/docs/api-reference/responses) supports [MCP servers](https://platform.openai.com/docs/guides/tools-remote-mcp) as remote tool sources, allowing you to extend AI capabilities with custom functions.\n\n<Note>\nThe Responses API is a distinct API from OpenAI's Completions API or Assistants API. At this time, only the Responses API supports MCP.\n</Note>\n\n<Tip>\nCurrently, the Responses API only accesses **tools** from MCP servers\u2014it queries the `list_tools` endpoint and exposes those functions to the AI agent. Other MCP features like resources and prompts are not currently supported.\n</Tip>\n\n\n### Create a Server\n\nFirst, create a FastMCP server with the tools you want to expose. For this example, we'll create a server with a single tool that rolls dice.\n\n```python server.py\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n### Deploy the Server\n\nYour server must be deployed to a public URL in order for OpenAI to access it.\n\nFor development, you can use tools like `ngrok` to temporarily expose a locally-running server to the internet. We'll do that for this example (you may need to install `ngrok` and create a free account), but you can use any other method to deploy your server.\n\nAssuming you saved the above code as `server.py`, you can run the following two commands in two separate terminals to deploy your server and expose it to the internet:\n\n<CodeGroup>\n```bash FastMCP server\npython server.py\n```\n\n```bash ngrok\nngrok http 8000\n```\n</CodeGroup>\n\n<Warning>\nThis exposes your unauthenticated server to the internet. Only run this command in a safe environment if you understand the risks.\n</Warning>\n\n### Call the Server\n\nTo use the Responses API, you'll need to install the OpenAI Python SDK (not included with FastMCP):\n\n```bash\npip install openai\n```\n\nYou'll also need to authenticate with OpenAI. You can do this by setting the `OPENAI_API_KEY` environment variable. Consult the OpenAI SDK documentation for more information.\n\n```bash\nexport OPENAI_API_KEY=\"your-api-key\"\n```\n\nHere is an example of how to call your server from Python. Note that you'll need to replace `https://your-server-url.com` with the actual URL of your server. In addition, we use `/mcp/` as the endpoint because we deployed a streamable-HTTP server with the default path; you may need to use a different endpoint if you customized your server's deployment.\n\n```python {4, 11-16}\nfrom openai import OpenAI\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\nclient = OpenAI()\n\nresp = client.responses.create(\n    model=\"gpt-4.1\",\n    tools=[\n        {\n            \"type\": \"mcp\",\n            \"server_label\": \"dice_server\",\n            \"server_url\": f\"{url}/mcp/\",\n            \"require_approval\": \"never\",\n        },\n    ],\n    input=\"Roll a few dice!\",\n)\n\nprint(resp.output_text)\n```\nIf you run this code, you'll see something like the following output:\n\n```text\nYou rolled 3 dice and got the following results: 6, 4, and 2!\n```\n\n### Authentication\n\n<VersionBadge version=\"2.6.0\" />\n\nThe Responses API can include headers to authenticate the request, which means you don't have to worry about your server being publicly accessible.\n\n#### Server Authentication\n\nThe simplest way to add authentication to the server is to use a bearer token scheme. \n\nFor this example, we'll quickly generate our own tokens with FastMCP's `RSAKeyPair` utility, but this may not be appropriate for production use. For more details, see the complete server-side [Token Verification](/servers/auth/token-verification) documentation. \n\nWe'll start by creating an RSA key pair to sign and verify tokens.\n\n```python\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n```\n\n<Warning>\nFastMCP's `RSAKeyPair` utility is for development and testing only.\n</Warning> \n\nNext, we'll create a `JWTVerifier` to authenticate the server. \n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n```\n\nHere is a complete example that you can copy/paste. For simplicity and the purposes of this example only, it will print the token to the console. **Do NOT do this in production!**\n\n```python server.py [expandable]\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\nimport random\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    print(f\"\\n---\\n\\n\ud83d\udd11 Dice Roller access token:\\n\\n{access_token}\\n\\n---\\n\")\n    mcp.run(transport=\"http\", port=8000)\n```\n\n#### Client Authentication\n\nIf you try to call the authenticated server with the same OpenAI code we wrote earlier, you'll get an error like this:\n\n```python\npythonAPIStatusError: Error code: 424 - {\n    \"error\": {\n        \"message\": \"Error retrieving tool list from MCP server: 'dice_server'. Http status code: 401 (Unauthorized)\",\n        \"type\": \"external_connector_error\",\n        \"param\": \"tools\",\n        \"code\": \"http_error\"\n    }\n}\n```\n\nAs expected, the server is rejecting the request because it's not authenticated.\n\nTo authenticate the client, you can pass the token in the `Authorization` header with the `Bearer` scheme:\n\n\n```python {4, 7, 19-21} [expandable]\nfrom openai import OpenAI\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\n# Your access token (replace with your actual token)\naccess_token = 'your-access-token'\n\nclient = OpenAI()\n\nresp = client.responses.create(\n    model=\"gpt-4.1\",\n    tools=[\n        {\n            \"type\": \"mcp\",\n            \"server_label\": \"dice_server\",\n            \"server_url\": f\"{url}/mcp/\",\n            \"require_approval\": \"never\",\n            \"headers\": {\n                \"Authorization\": f\"Bearer {access_token}\"\n            }\n        },\n    ],\n    input=\"Roll a few dice!\",\n)\n\nprint(resp.output_text)\n```\n\nYou should now see the dice roll results in the output."}, {"filename": "docs/integrations/openapi.mdx", "content": "---\ntitle: OpenAPI \ud83e\udd1d FastMCP\nsidebarTitle: OpenAPI\ndescription: Generate MCP servers from any OpenAPI specification\nicon: list-tree\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nFastMCP can automatically generate an MCP server from any OpenAPI specification, allowing AI models to interact with existing APIs through the MCP protocol. Instead of manually creating tools and resources, you provide an OpenAPI spec and FastMCP intelligently converts API endpoints into the appropriate MCP components.\n\n<Tip>\nGenerating MCP servers from OpenAPI is a great way to get started with FastMCP, but in practice LLMs achieve **significantly better performance** with well-designed and curated MCP servers than with auto-converted OpenAPI servers. This is especially true for complex APIs with many endpoints and parameters.\n\nWe recommend using the FastAPI integration for bootstrapping and prototyping, not for mirroring your API to LLM clients. See the post [Stop Converting Your REST APIs to MCP](https://www.jlowin.dev/blog/stop-converting-rest-apis-to-mcp) for more details.\n</Tip>\n\n## Create a Server\n\nTo convert an OpenAPI specification to an MCP server, use the `FastMCP.from_openapi()` class method:\n\n```python server.py\nimport httpx\nfrom fastmcp import FastMCP\n\n# Create an HTTP client for your API\nclient = httpx.AsyncClient(base_url=\"https://api.example.com\")\n\n# Load your OpenAPI spec \nopenapi_spec = httpx.get(\"https://api.example.com/openapi.json\").json()\n\n# Create the MCP server\nmcp = FastMCP.from_openapi(\n    openapi_spec=openapi_spec,\n    client=client,\n    name=\"My API Server\"\n)\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n### Authentication\n\nIf your API requires authentication, configure it on the HTTP client:\n\n```python\nimport httpx\nfrom fastmcp import FastMCP\n\n# Bearer token authentication\napi_client = httpx.AsyncClient(\n    base_url=\"https://api.example.com\",\n    headers={\"Authorization\": \"Bearer YOUR_TOKEN\"}\n)\n\n# Create MCP server with authenticated client\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec, \n    client=api_client,\n    timeout=30.0  # 30 second timeout for all requests\n)\n```\n\n## Route Mapping\n\nBy default, FastMCP converts **every endpoint** in your OpenAPI specification into an MCP **Tool**. This provides a simple, predictable starting point that ensures all your API's functionality is immediately available to the vast majority of LLM clients which only support MCP tools.\n\nWhile this is a pragmatic default for maximum compatibility, you can easily customize this behavior. Internally, FastMCP uses an ordered list of `RouteMap` objects to determine how to map OpenAPI routes to various MCP component types.\n\nEach `RouteMap` specifies a combination of methods, patterns, and tags, as well as a corresponding MCP component type. Each OpenAPI route is checked against each `RouteMap` in order, and the first one that matches every criteria is used to determine its converted MCP type. A special type, `EXCLUDE`, can be used to exclude routes from the MCP server entirely.\n\n- **Methods**: HTTP methods to match (e.g. `[\"GET\", \"POST\"]` or `\"*\"` for all)\n- **Pattern**: Regex pattern to match the route path (e.g. `r\"^/users/.*\"` or `r\".*\"` for all)\n- **Tags**: A set of OpenAPI tags that must all be present. An empty set (`{}`) means no tag filtering, so the route matches regardless of its tags.\n- **MCP type**: What MCP component type to create (`TOOL`, `RESOURCE`, `RESOURCE_TEMPLATE`, or `EXCLUDE`)\n- **MCP tags**: A set of custom tags to add to components created from matching routes\n\nHere is FastMCP's default rule:\n\n```python\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\nDEFAULT_ROUTE_MAPPINGS = [\n    # All routes become tools\n    RouteMap(mcp_type=MCPType.TOOL),\n]\n```\n\n### Custom Route Maps\n\nWhen creating your FastMCP server, you can customize routing behavior by providing your own list of `RouteMap` objects. Your custom maps are processed before the default route maps, and routes will be assigned to the first matching custom map.\n\nFor example, prior to FastMCP 2.8.0, GET requests were automatically mapped to `Resource` and `ResourceTemplate` components based on whether they had path parameters. (This was changed solely for client compatibility reasons.) You can restore this behavior by providing custom route maps:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\n# Restore pre-2.8.0 semantic mapping\nsemantic_maps = [\n    # GET requests with path parameters become ResourceTemplates\n    RouteMap(methods=[\"GET\"], pattern=r\".*\\{.*\\}.*\", mcp_type=MCPType.RESOURCE_TEMPLATE),\n    # All other GET requests become Resources\n    RouteMap(methods=[\"GET\"], pattern=r\".*\", mcp_type=MCPType.RESOURCE),\n]\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_maps=semantic_maps,\n)\n```\n\nWith these maps, `GET` requests are handled semantically, and all other methods (`POST`, `PUT`, etc.) will fall through to the default rule and become `Tool`s.\n\nHere is a more complete example that uses custom route maps to convert all `GET` endpoints under `/analytics/` to tools while excluding all admin endpoints and all routes tagged \"internal\". All other routes will be handled by the default rules:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_maps=[\n        # Analytics `GET` endpoints are tools\n        RouteMap(\n            methods=[\"GET\"], \n            pattern=r\"^/analytics/.*\", \n            mcp_type=MCPType.TOOL,\n        ),\n\n        # Exclude all admin endpoints\n        RouteMap(\n            pattern=r\"^/admin/.*\", \n            mcp_type=MCPType.EXCLUDE,\n        ),\n\n        # Exclude all routes tagged \"internal\"\n        RouteMap(\n            tags={\"internal\"},\n            mcp_type=MCPType.EXCLUDE,\n        ),\n    ],\n)\n```\n\n<Tip>\nThe default route maps are always applied after your custom maps, so you do not have to create route maps for every possible route.\n</Tip>\n\n### Excluding Routes\n\nTo exclude routes from the MCP server, use a route map to assign them to `MCPType.EXCLUDE`. \n\nYou can use this to remove sensitive or internal routes by targeting them specifically:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_maps=[\n        RouteMap(pattern=r\"^/admin/.*\", mcp_type=MCPType.EXCLUDE),\n        RouteMap(tags={\"internal\"}, mcp_type=MCPType.EXCLUDE),\n    ],\n)\n```\n\nOr you can use a catch-all rule to exclude everything that your maps don't handle explicitly:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_maps=[\n        # custom mapping logic goes here\n        # ... your specific route maps ...\n        # exclude all remaining routes\n        RouteMap(mcp_type=MCPType.EXCLUDE),\n    ],\n)\n```\n\n<Tip>\nUsing a catch-all exclusion rule will prevent the default route mappings from being applied, since it will match every remaining route. This is useful if you want to explicitly allow-list certain routes.\n</Tip>\n\n### Advanced Route Mapping\n\n<VersionBadge version=\"2.5.0\" />\n\nFor advanced use cases that require more complex logic, you can provide a `route_map_fn` callable. After the route map logic is applied, this function is called on each matched route and its assigned MCP component type. It can optionally return a different component type to override the mapped assignment. If it returns `None`, the assigned type is used.\n\nIn addition to more precise targeting of methods, patterns, and tags, this function can access any additional OpenAPI metadata about the route.\n\n<Tip>\nThe `route_map_fn` is called on all routes, even those that matched `MCPType.EXCLUDE` in your custom maps. This gives you an opportunity to customize the mapping or even override an exclusion.\n</Tip>\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType, HTTPRoute\n\ndef custom_route_mapper(route: HTTPRoute, mcp_type: MCPType) -> MCPType | None:\n    \"\"\"Advanced route type mapping.\"\"\"\n    # Convert all admin routes to tools regardless of HTTP method\n    if \"/admin/\" in route.path:\n        return MCPType.TOOL\n\n    elif \"internal\" in route.tags:\n        return MCPType.EXCLUDE\n    \n    # Convert user detail routes to templates even if they're POST\n    elif route.path.startswith(\"/users/\") and route.method == \"POST\":\n        return MCPType.RESOURCE_TEMPLATE\n    \n    # Use defaults for all other routes\n    return None\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_map_fn=custom_route_mapper,\n)\n```\n\n## Customization\n\n### Component Names\n\n<VersionBadge version=\"2.5.0\" />\n\nFastMCP automatically generates names for MCP components based on the OpenAPI specification. By default, it uses the `operationId` from your OpenAPI spec, up to the first double underscore (`__`).\n\nAll component names are automatically:\n- **Slugified**: Spaces and special characters are converted to underscores or removed\n- **Truncated**: Limited to 56 characters maximum to ensure compatibility\n- **Unique**: If multiple components have the same name, a number is automatically appended to make them unique\n\nFor more control over component names, you can provide an `mcp_names` dictionary that maps `operationId` values to your desired names. The `operationId` must be exactly as it appears in the OpenAPI spec. The provided name will always be slugified and truncated.\n\n```python\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    mcp_names={\n        \"list_users__with_pagination\": \"user_list\",\n        \"create_user__admin_required\": \"create_user\", \n        \"get_user_details__admin_required\": \"user_detail\",\n    }\n)\n```\n\nAny `operationId` not found in `mcp_names` will use the default strategy (operationId up to the first `__`).\n\n### Tags\n\n<VersionBadge version=\"2.8.0\" />\n\nFastMCP provides several ways to add tags to your MCP components, allowing you to categorize and organize them for better discoverability and filtering. Tags are combined from multiple sources to create the final set of tags on each component.\n\n#### RouteMap Tags\n\nYou can add custom tags to components created from specific routes using the `mcp_tags` parameter in `RouteMap`. These tags will be applied to all components created from routes that match that particular route map.\n\n```python\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    route_maps=[\n        # Add custom tags to all POST endpoints\n        RouteMap(\n            methods=[\"POST\"],\n            pattern=r\".*\",\n            mcp_type=MCPType.TOOL,\n            mcp_tags={\"write-operation\", \"api-mutation\"}\n        ),\n        \n        # Add different tags to detail view endpoints\n        RouteMap(\n            methods=[\"GET\"],\n            pattern=r\".*\\{.*\\}.*\",\n            mcp_type=MCPType.RESOURCE_TEMPLATE,\n            mcp_tags={\"detail-view\", \"parameterized\"}\n        ),\n        \n        # Add tags to list endpoints\n        RouteMap(\n            methods=[\"GET\"],\n            pattern=r\".*\",\n            mcp_type=MCPType.RESOURCE,\n            mcp_tags={\"list-data\", \"collection\"}\n        ),\n    ],\n)\n```\n\n#### Global Tags\n\nYou can add tags to **all** components by providing a `tags` parameter when creating your MCP server. These global tags will be applied to every component created from your OpenAPI specification.\n\n```python\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    tags={\"api-v2\", \"production\", \"external\"}\n)\n```\n\n#### OpenAPI Tags in Client Meta\n\nFastMCP automatically includes OpenAPI tags from your specification in the component's metadata. These tags are available to MCP clients through the `_meta._fastmcp.tags` field, allowing clients to filter and organize components based on the original OpenAPI tagging:\n\n<CodeGroup>\n```json {5} OpenAPI spec with tags\n{\n  \"paths\": {\n    \"/users\": {\n      \"get\": {\n        \"tags\": [\"users\", \"public\"],\n        \"operationId\": \"list_users\",\n        \"summary\": \"List all users\"\n      }\n    }\n  }\n}\n```\n```python {6-9} Access OpenAPI tags in MCP client\nasync with client:\n    tools = await client.list_tools()\n    for tool in tools:\n        if hasattr(tool, '_meta') and tool._meta:\n            # OpenAPI tags are now available in _fastmcp namespace!\n            fastmcp_meta = tool._meta.get('_fastmcp', {})\n            openapi_tags = fastmcp_meta.get('tags', [])\n            if 'users' in openapi_tags:\n                print(f\"Found user-related tool: {tool.name}\")\n```\n</CodeGroup>\n\nThis makes it easy for clients to understand and organize API endpoints based on their original OpenAPI categorization.\n\n### Advanced Customization\n\n<VersionBadge version=\"2.5.0\" />\n\nBy default, FastMCP creates MCP components using a variety of metadata from the OpenAPI spec, such as incorporating the OpenAPI description into the MCP component description.\n\nAt times you may want to modify those MCP components in a variety of ways, such as adding LLM-specific instructions or tags. For fine-grained customization, you can provide a `mcp_component_fn` when creating the MCP server. After each MCP component has been created, this function is called on it and has the opportunity to modify it in-place.\n\n<Tip>\nYour `mcp_component_fn` is expected to modify the component in-place, not to return a new component. The result of the function is ignored.\n</Tip>\n\n```python\nfrom fastmcp.server.openapi import (\n    HTTPRoute,\n    OpenAPITool,\n    OpenAPIResource,\n    OpenAPIResourceTemplate,\n)\n\ndef customize_components(\n    route: HTTPRoute, \n    component: OpenAPITool | OpenAPIResource | OpenAPIResourceTemplate,\n) -> None:\n    # Add custom tags to all components\n    component.tags.add(\"openapi\")\n    \n    # Customize based on component type\n    if isinstance(component, OpenAPITool):\n        component.description = f\"\ud83d\udd27 {component.description} (via API)\"\n    \n    if isinstance(component, OpenAPIResource):\n        component.description = f\"\ud83d\udcca {component.description}\"\n        component.tags.add(\"data\")\n\nmcp = FastMCP.from_openapi(\n    openapi_spec=spec,\n    client=client,\n    mcp_component_fn=customize_components,\n)\n```\n\n## Request Parameter Handling\n\nFastMCP intelligently handles different types of parameters in OpenAPI requests:\n\n### Query Parameters\n\nBy default, FastMCP only includes query parameters that have non-empty values. Parameters with `None` values or empty strings are automatically filtered out.\n\n```python\n# When calling this tool...\nawait client.call_tool(\"search_products\", {\n    \"category\": \"electronics\",  # \u2705 Included\n    \"min_price\": 100,           # \u2705 Included  \n    \"max_price\": None,          # \u274c Excluded\n    \"brand\": \"\",                # \u274c Excluded\n})\n\n# The HTTP request will be: GET /products?category=electronics&min_price=100\n```\n\n### Path Parameters\n\nPath parameters are typically required by REST APIs. FastMCP:\n- Filters out `None` values\n- Validates that all required path parameters are provided\n- Raises clear errors for missing required parameters\n\n```python\n# \u2705 This works\nawait client.call_tool(\"get_user\", {\"user_id\": 123})\n\n# \u274c This raises: \"Missing required path parameters: {'user_id'}\"\nawait client.call_tool(\"get_user\", {\"user_id\": None})\n```\n\n### Array Parameters\n\nFastMCP handles array parameters according to OpenAPI specifications:\n\n- **Query arrays**: Serialized based on the `explode` parameter (default: `True`)\n- **Path arrays**: Serialized as comma-separated values (OpenAPI 'simple' style)\n\n```python\n# Query array with explode=true (default)\n# ?tags=red&tags=blue&tags=green\n\n# Query array with explode=false  \n# ?tags=red,blue,green\n\n# Path array (always comma-separated)\n# /items/red,blue,green\n```\n\n### Headers\n\nHeader parameters are automatically converted to strings and included in the HTTP request."}, {"filename": "docs/integrations/permit.mdx", "content": "---\ntitle: Permit.io Authorization \ud83e\udd1d FastMCP\nsidebarTitle: Permit.io\ndescription: Add fine-grained authorization to your FastMCP servers with Permit.io\nicon: shield-check\n---\n\nAdd **policy-based authorization** to your FastMCP servers with one-line code addition with the **[Permit.io][permit-github] authorization middleware**.\n\nControl which tools, resources and prompts MCP clients can view and execute on your server. Define dynamic policies using Permit.io's powerful RBAC, ABAC, and REBAC capabilities, and obtain comprehensive audit logs of all access attempts and violations.\n\n## How it Works\n\nLeveraging FastMCP's [Middleware][fastmcp-middleware], the Permit.io middleware intercepts all MCP requests to your server and automatically maps MCP methods to authorization checks against your Permit.io policies; covering both server methods and tool execution.\n\n### Policy Mapping\n\nThe middleware automatically maps MCP methods to Permit.io resources and actions:\n\n- **MCP server methods** (e.g., `tools/list`, `resources/read`):\n  - **Resource**: `{server_name}_{component}` (e.g., `myserver_tools`)\n  - **Action**: The method verb (e.g., `list`, `read`)\n- **Tool execution** (method `tools/call`):\n  - **Resource**: `{server_name}` (e.g., `myserver`)\n  - **Action**: The tool name (e.g., `greet`)\n\n![Permit.io Policy Mapping Example](./images/permit/policy_mapping.png)\n\n*Example: In Permit.io, the 'Admin' role is granted permissions on resources and actions as mapped by the middleware. For example, 'greet', 'greet-jwt', and 'login' are actions on the 'mcp_server' resource, and 'list' is an action on the 'mcp_server_tools' resource.*\n\n> **Note:**\n> Don't forget to assign the relevant role (e.g., Admin, User) to the user authenticating to your MCP server (such as the user in the JWT) in the Permit.io Directory. Without the correct role assignment, users will not have access to the resources and actions you've configured in your policies.\n>\n> ![Permit.io Directory Role Assignment Example](./images/permit/role_assignement.png)\n>\n> *Example: In Permit.io Directory, both 'client' and 'admin' users are assigned the 'Admin' role, granting them the permissions defined in your policy mapping.*\n\nFor detailed policy mapping examples and configuration, see [Detailed Policy Mapping](https://github.com/permitio/permit-fastmcp/blob/main/docs/policy-mapping.md).\n\n### Listing Operations\n\nThe middleware behaves as a filter for listing operations (`tools/list`, `resources/list`, `prompts/list`), hiding to the client components that are not authorized by the defined policies.\n\n```mermaid\nsequenceDiagram\n    participant MCPClient as MCP Client\n    participant PermitMiddleware as Permit.io Middleware\n    participant MCPServer as FastMCP Server\n    participant PermitPDP as Permit.io PDP\n\n    MCPClient->>PermitMiddleware: MCP Listing Request (e.g., tools/list)\n    PermitMiddleware->>MCPServer: MCP Listing Request\n    MCPServer-->>PermitMiddleware: MCP Listing Response\n    PermitMiddleware->>PermitPDP: Authorization Checks\n    PermitPDP->>PermitMiddleware: Authorization Decisions\n    PermitMiddleware-->>MCPClient: Filtered MCP Listing Response\n```\n\n### Execution Operations\n\nThe middleware behaves as an enforcement point for execution operations (`tools/call`, `resources/read`, `prompts/get`), blocking operations that are not authorized by the defined policies.\n\n```mermaid\nsequenceDiagram\n    participant MCPClient as MCP Client\n    participant PermitMiddleware as Permit.io Middleware\n    participant MCPServer as FastMCP Server\n    participant PermitPDP as Permit.io PDP\n\n    MCPClient->>PermitMiddleware: MCP Execution Request (e.g., tools/call)\n    PermitMiddleware->>PermitPDP: Authorization Check\n    PermitPDP->>PermitMiddleware: Authorization Decision\n    PermitMiddleware-->>MCPClient: MCP Unauthorized Error (if denied)\n    PermitMiddleware->>MCPServer: MCP Execution Request (if allowed)\n    MCPServer-->>PermitMiddleware: MCP Execution Response (if allowed)\n    PermitMiddleware-->>MCPClient: MCP Execution Response (if allowed)\n```\n\n## Add Authorization to Your Server\n\n<Note>\nPermit.io is a cloud-native authorization service. You need a Permit.io account and a running Policy Decision Point (PDP) for the middleware to function. You can run the PDP locally with Docker or use Permit.io's cloud PDP.\n</Note>\n\n### Prerequisites\n\n1. **Permit.io Account**: Sign up at [permit.io](https://permit.io)\n2. **PDP Setup**: Run the Permit.io PDP locally or use the cloud PDP (RBAC only)\n3. **API Key**: Get your Permit.io API key from the dashboard\n\n### Run the Permit.io PDP\n\nRun the PDP locally with Docker:\n\n```bash\ndocker run -p 7766:7766 permitio/pdp:latest\n```\n\nOr use the cloud PDP URL: `https://cloudpdp.api.permit.io`\n\n### Create a Server with Authorization\n\nFirst, install the `permit-fastmcp` package:\n\n```bash\n# Using UV (recommended)\nuv add permit-fastmcp\n\n# Using pip\npip install permit-fastmcp\n```\n\nThen create a FastMCP server and add the Permit.io middleware:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom permit_fastmcp.middleware.middleware import PermitMcpMiddleware\n\nmcp = FastMCP(\"Secure FastMCP Server \ud83d\udd12\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    \"\"\"Greet a user by name\"\"\"\n    return f\"Hello, {name}!\"\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Add two numbers\"\"\"\n    return a + b\n\n# Add Permit.io authorization middleware\nmcp.add_middleware(PermitMcpMiddleware(\n    permit_pdp_url=\"http://localhost:7766\",\n    permit_api_key=\"your-permit-api-key\"\n))\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\")\n```\n\n### Configure Access Policies\n\nCreate your authorization policies in the Permit.io dashboard:\n\n1. **Create Resources**: Define resources like `mcp_server` and `mcp_server_tools`\n2. **Define Actions**: Add actions like `greet`, `add`, `list`, `read`\n3. **Create Roles**: Define roles like `Admin`, `User`, `Guest`\n4. **Assign Permissions**: Grant roles access to specific resources and actions\n5. **Assign Users**: Assign roles to users in the Permit.io Directory\n\nFor step-by-step setup instructions and troubleshooting, see [Getting Started & FAQ](https://github.com/permitio/permit-fastmcp/blob/main/docs/getting-started.md).\n\n#### Example Policy Configuration\n\nPolicies are defined in the Permit.io dashboard, but you can also use the [Permit.io Terraform provider](https://github.com/permitio/terraform-provider-permitio) to define policies in code.\n\n\n```terraform\n# Resources\nresource \"permitio_resource\" \"mcp_server\" {\n  name = \"mcp_server\"\n  key  = \"mcp_server\"\n  \n  actions = {\n    \"greet\" = { name = \"greet\" }\n    \"add\"   = { name = \"add\" }\n  }\n}\n\nresource \"permitio_resource\" \"mcp_server_tools\" {\n  name = \"mcp_server_tools\"\n  key  = \"mcp_server_tools\"\n  \n  actions = {\n    \"list\" = { name = \"list\" }\n  }\n}\n\n# Roles\nresource \"permitio_role\" \"Admin\" {\n  key         = \"Admin\"\n  name        = \"Admin\"\n  permissions = [\n    \"mcp_server:greet\",\n    \"mcp_server:add\", \n    \"mcp_server_tools:list\"\n  ]\n}\n```\n\nYou can also use the [Permit.io CLI](https://github.com/permitio/permit-cli), [API](https://api.permit.io/scalar) or [SDKs](https://github.com/permitio/permit-python) to manage policies, as well as writing policies directly in REGO (Open Policy Agent's policy language).\n\nFor complete policy examples including ABAC and RBAC configurations, see [Example Policies](https://github.com/permitio/permit-fastmcp/tree/main/docs/example_policies).\n\n### Identity Management\n\nThe middleware supports multiple identity extraction modes:\n\n- **Fixed Identity**: Use a fixed identity for all requests\n- **Header-based**: Extract identity from HTTP headers\n- **JWT-based**: Extract and verify JWT tokens\n- **Source-based**: Use the MCP context source field\n\nFor detailed identity mode configuration and environment variables, see [Identity Modes & Environment Variables](https://github.com/permitio/permit-fastmcp/blob/main/docs/identity-modes.md).\n\n#### JWT Authentication Example\n\n```python\nimport os\n\n# Configure JWT identity extraction\nos.environ[\"PERMIT_MCP_IDENTITY_MODE\"] = \"jwt\"\nos.environ[\"PERMIT_MCP_IDENTITY_JWT_SECRET\"] = \"your-jwt-secret\"\n\nmcp.add_middleware(PermitMcpMiddleware(\n    permit_pdp_url=\"http://localhost:7766\",\n    permit_api_key=\"your-permit-api-key\"\n))\n```\n\n### ABAC Policies with Tool Arguments\n\nThe middleware supports Attribute-Based Access Control (ABAC) policies that can evaluate tool arguments as attributes. Tool arguments are automatically flattened as individual attributes (e.g., `arg_name`, `arg_number`) for granular policy conditions.\n\n![ABAC Condition Example](./images/permit/abac_condition_example.png)\n\n*Example: Create dynamic resources with conditions like `resource.arg_number greater-than 10` to allow the `conditional-greet` tool only when the number argument exceeds 10.*\n\n#### Example: Conditional Access\n\nCreate a dynamic resource with conditions like `resource.arg_number greater-than 10` to allow the `conditional-greet` tool only when the number argument exceeds 10.\n\n```python\n@mcp.tool\ndef conditional_greet(name: str, number: int) -> str:\n    \"\"\"Greet a user only if number > 10\"\"\"\n    return f\"Hello, {name}! Your number is {number}\"\n```\n\n![ABAC Policy Example](./images/permit/abac_policy_example.png)\n\n*Example: The Admin role is granted access to the \"conditional-greet\" action on the \"Big-greets\" dynamic resource, while other tools like \"greet\", \"greet-jwt\", and \"login\" are granted on the base \"mcp_server\" resource.*\n\nFor comprehensive ABAC configuration and advanced policy examples, see [ABAC Policies with Tool Arguments](https://github.com/permitio/permit-fastmcp/blob/main/docs/policy-mapping.md#abac-policies-with-tool-arguments).\n\n### Run the Server\n\nStart your FastMCP server normally:\n\n```bash\npython server.py\n```\n\nThe middleware will now intercept all MCP requests and check them against your Permit.io policies. Requests include user identification through the configured identity mode and automatic mapping of MCP methods to authorization resources and actions.\n\n## Advanced Configuration\n\n### Environment Variables\n\nConfigure the middleware using environment variables:\n\n```bash\n# Permit.io configuration\nexport PERMIT_MCP_PERMIT_PDP_URL=\"http://localhost:7766\"\nexport PERMIT_MCP_PERMIT_API_KEY=\"your-api-key\"\n\n# Identity configuration\nexport PERMIT_MCP_IDENTITY_MODE=\"jwt\"\nexport PERMIT_MCP_IDENTITY_JWT_SECRET=\"your-jwt-secret\"\n\n# Method configuration\nexport PERMIT_MCP_KNOWN_METHODS='[\"tools/list\",\"tools/call\"]'\nexport PERMIT_MCP_BYPASSED_METHODS='[\"initialize\",\"ping\"]'\n\n# Logging configuration\nexport PERMIT_MCP_ENABLE_AUDIT_LOGGING=\"true\"\n```\n\nFor a complete list of all configuration options and environment variables, see [Configuration Reference](https://github.com/permitio/permit-fastmcp/blob/main/docs/configuration-reference.md).\n\n### Custom Middleware Configuration\n\n```python\nfrom permit_fastmcp.middleware.middleware import PermitMcpMiddleware\n\nmiddleware = PermitMcpMiddleware(\n    permit_pdp_url=\"http://localhost:7766\",\n    permit_api_key=\"your-api-key\",\n    enable_audit_logging=True,\n    bypass_methods=[\"initialize\", \"ping\", \"health/*\"]\n)\n\nmcp.add_middleware(middleware)\n```\n\nFor advanced configuration options and custom middleware extensions, see [Advanced Configuration](https://github.com/permitio/permit-fastmcp/blob/main/docs/advanced-configuration.md).\n\n## Example: Complete JWT Authentication Server\n\nSee the [example server](https://github.com/permitio/permit-fastmcp/blob/main/permit_fastmcp/example_server/example.py) for a full implementation with JWT-based authentication. For additional examples and usage patterns, see [Example Server](https://github.com/permitio/permit-fastmcp/blob/main/permit_fastmcp/example_server/):\n\n```python\nfrom fastmcp import FastMCP, Context\nfrom permit_fastmcp.middleware.middleware import PermitMcpMiddleware\nimport jwt\nimport datetime\n\n# Configure JWT identity extraction\nos.environ[\"PERMIT_MCP_IDENTITY_MODE\"] = \"jwt\"\nos.environ[\"PERMIT_MCP_IDENTITY_JWT_SECRET\"] = \"mysecretkey\"\n\nmcp = FastMCP(\"My MCP Server\")\n\n@mcp.tool\ndef login(username: str, password: str) -> str:\n    \"\"\"Login to get a JWT token\"\"\"\n    if username == \"admin\" and password == \"password\":\n        token = jwt.encode(\n            {\"sub\": username, \"exp\": datetime.datetime.utcnow() + datetime.timedelta(hours=1)},\n            \"mysecretkey\",\n            algorithm=\"HS256\"\n        )\n        return f\"Bearer {token}\"\n    raise Exception(\"Invalid credentials\")\n\n@mcp.tool\ndef greet_jwt(ctx: Context) -> str:\n    \"\"\"Greet a user by extracting their name from JWT\"\"\"\n    # JWT extraction handled by middleware\n    return \"Hello, authenticated user!\"\n\nmcp.add_middleware(PermitMcpMiddleware(\n    permit_pdp_url=\"http://localhost:7766\",\n    permit_api_key=\"your-permit-api-key\"\n))\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\")\n```\n\n<Tip>\n  For detailed policy configuration, custom authentication, and advanced\n  deployment patterns, visit the [Permit.io FastMCP Middleware\n  repository][permit-fastmcp-github]. For troubleshooting common issues, see [Troubleshooting](https://github.com/permitio/permit-fastmcp/blob/main/docs/troubleshooting.md).\n</Tip>\n\n\n[permit.io]: https://www.permit.io\n[permit-github]: https://github.com/permitio\n[permit-fastmcp-github]: https://github.com/permitio/permit-fastmcp\n[Agent.Security]: https://agent.security\n[fastmcp-middleware]: /servers/middleware\n"}, {"filename": "docs/integrations/scalekit.mdx", "content": "---\ntitle: Scalekit \ud83e\udd1d FastMCP\nsidebarTitle: Scalekit\ndescription: Secure your FastMCP server with Scalekit\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.0\" />\n\nInstall auth stack to your FastMCP server with [Scalekit](https://scalekit.com) using the [Remote OAuth](/servers/auth/remote-oauth) pattern: Scalekit handles user authentication, and the MCP server validates issued tokens.\n\n### Prerequisites\n\nBefore you begin\n\n1. Get a [Scalekit account](https://app.scalekit.com/) and grab your **Environment URL** from _Dashboard > Settings_ .\n2. Have your FastMCP server's base URL ready (can be localhost for development, e.g., `http://localhost:8000/`)\n\n### Step 1: Configure MCP server in Scalekit environment\n\n<Steps>\n<Step title=\"Register MCP server and set environment\">\n\nIn your Scalekit dashboard:\n    1. Open the **MCP Servers** section, then select **Create new server**\n    2. Enter server details: a name, a resource identifier, and the desired MCP client authentication settings\n    3. Save, then copy the **Resource ID** (for example, res_92015146095)\n\nIn your FastMCP project's `.env`:\n\n```sh\nSCALEKIT_ENVIRONMENT_URL=<YOUR_APP_ENVIRONMENT_URL>\nSCALEKIT_RESOURCE_ID=<YOUR_APP_RESOURCE_ID> # res_926EXAMPLE5878\nBASE_URL=http://localhost:8000/\n# Optional: additional scopes tokens must have\n# SCALEKIT_REQUIRED_SCOPES=read,write\n```\n\n</Step>\n</Steps>\n\n### Step 2: Add auth to FastMCP server\n\nCreate your FastMCP server file and use the ScalekitProvider to handle all the OAuth integration automatically:\n\n> **Warning:** The legacy `mcp_url` and `client_id` parameters are deprecated and will be removed in a future release. Use `base_url` instead of `mcp_url` and remove `client_id` from your configuration.\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.scalekit import ScalekitProvider\n\n# Discovers Scalekit endpoints and set up JWT token validation\nauth_provider = ScalekitProvider(\n    environment_url=SCALEKIT_ENVIRONMENT_URL,    # Scalekit environment URL\n    resource_id=SCALEKIT_RESOURCE_ID,            # Resource server ID\n    base_url=SERVER_URL,                         # Public MCP endpoint\n    required_scopes=[\"read\"],                    # Optional scope enforcement\n)\n\n# Create FastMCP server with auth\nmcp = FastMCP(name=\"My Scalekit Protected Server\", auth=auth_provider)\n\n@mcp.tool\ndef auth_status() -> dict:\n    \"\"\"Show Scalekit authentication status.\"\"\"\n    # Extract user claims from the JWT\n    return {\n        \"message\": \"This tool requires authentication via Scalekit\",\n        \"authenticated\": True,\n        \"provider\": \"Scalekit\"\n    }\n\n```\n\n<Tip>\nSet `required_scopes` when you need tokens to carry specific permissions. Leave it unset to allow any token issued for the resource.\n</Tip>\n\n## Testing\n\n### Start the MCP server\n\n```sh\nuv run python server.py\n```\n\nUse any MCP client (for example, mcp-inspector, Claude, VS Code, or Windsurf) to connect to the running serve. Verify that authentication succeeds and requests are authorized as expected.\n\n### Provider selection\n\nSetting this environment variable allows the Scalekit provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.scalekit.ScalekitProvider` to use Scalekit authentication.\n</ParamField>\n</Card>\n\n### Scalekit-specific configuration\n\nThese environment variables provide default values for the Scalekit provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_ENVIRONMENT_URL\" required>\nYour Scalekit environment URL from the Admin Portal (e.g., `https://your-env.scalekit.com`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_RESOURCE_ID\" required>\nYour Scalekit resource server ID from the MCP Servers section\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_BASE_URL\" required>\nPublic URL of your FastMCP server (e.g., `https://your-server.com` or `http://localhost:8000/` for development)\n</ParamField>\n\nLegacy `FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_MCP_URL` is still recognized for backward compatibility but will be removed soon-rename it to `...BASE_URL`.\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_REQUIRED_SCOPES\" default=\"[]\">\nComma-, space-, or JSON-separated list of scopes that tokens must include to access your server\n</ParamField>\n</Card>\n\nExample `.env`:\n\n```bash\n# Use the Scalekit provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.scalekit.ScalekitProvider\n\n# Scalekit configuration\nFASTMCP_SERVER_AUTH_SCALEKITPROVIDER_ENVIRONMENT_URL=https://your-env.scalekit.com\nFASTMCP_SERVER_AUTH_SCALEKITPROVIDER_RESOURCE_ID=res_456\nFASTMCP_SERVER_AUTH_SCALEKITPROVIDER_BASE_URL=https://your-server.com/\n# FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_REQUIRED_SCOPES=read,write\n# FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_MCP_URL=https://your-server.com/  # Deprecated\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"My Scalekit Protected Server\")\n\n@mcp.tool\ndef protected_action() -> str:\n    \"\"\"A tool that requires authentication.\"\"\"\n    return \"Access granted via Scalekit!\"\n```\n\n## Capabilities\n\nScalekit supports OAuth 2.1 with Dynamic Client Registration for MCP clients and enterprise SSO, and provides built\u2011in JWT validation and security controls.\n\n**OAuth 2.1/DCR**: clients self\u2011register, use PKCE, and work with the Remote OAuth pattern without pre\u2011provisioned credentials.\n\n**Validation and SSO**: tokens are verified (keys, RS256, issuer, audience, expiry), and SAML, OIDC, OAuth 2.0, ADFS, Azure AD, and Google Workspace are supported; use HTTPS in production and review auth logs as needed.\n\n## Debugging\n\nEnable detailed logging to troubleshoot authentication issues:\n\n```python\nimport logging\nlogging.basicConfig(level=logging.DEBUG)\n```\n\n### Token inspection\n\nYou can inspect JWT tokens in your tools to understand the user context:\n\n```python\nfrom fastmcp.server.context import request_ctx\nimport jwt\n\n@mcp.tool\ndef inspect_token() -> dict:\n    \"\"\"Inspect the current JWT token claims.\"\"\"\n    context = request_ctx.get()\n\n    # Extract token from Authorization header\n    if hasattr(context, 'request') and hasattr(context.request, 'headers'):\n        auth_header = context.request.headers.get('authorization', '')\n        if auth_header.startswith('Bearer '):\n            token = auth_header[7:]\n            # Decode without verification (already verified by provider)\n            claims = jwt.decode(token, options={\"verify_signature\": False})\n            return claims\n\n    return {\"error\": \"No token found\"}\n```\n"}, {"filename": "docs/integrations/supabase.mdx", "content": "---\ntitle: Supabase \ud83e\udd1d FastMCP\nsidebarTitle: Supabase\ndescription: Secure your FastMCP server with Supabase Auth\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.0\" />\n\nThis guide shows you how to secure your FastMCP server using **Supabase Auth**. This integration uses the [**Remote OAuth**](/servers/auth/remote-oauth) pattern, where Supabase handles user authentication and your FastMCP server validates the tokens.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. A **[Supabase Account](https://supabase.com/)** with a project\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Get Supabase Project URL\n\nIn your Supabase Dashboard:\n1. Go to **Project Settings**\n2. Copy your **Project URL** (e.g., `https://abc123.supabase.co`)\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `SupabaseProvider`:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.supabase import SupabaseProvider\n\n# Configure Supabase Auth\nauth = SupabaseProvider(\n    project_url=\"https://abc123.supabase.co\",\n    base_url=\"http://localhost:8000\"\n)\n\nmcp = FastMCP(\"Supabase Protected Server\", auth=auth)\n\n@mcp.tool\ndef protected_tool(message: str) -> str:\n    \"\"\"This tool requires authentication.\"\"\"\n    return f\"Authenticated user says: {message}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Supabase authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Supabase-protected server:\n\n```python client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle Supabase OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open Supabase login in your browser\n        print(\"\u2713 Authenticated with Supabase!\")\n\n        # Test the protected tool\n        result = await client.call_tool(\"protected_tool\", {\"message\": \"Hello!\"})\n        print(result)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to Supabase's authorization page\n2. After you authorize, you'll be redirected back\n3. The client receives the token and can make authenticated requests\n\n## Environment Variables\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Supabase provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.supabase.SupabaseProvider` to use Supabase authentication.\n</ParamField>\n</Card>\n\n### Supabase-Specific Configuration\n\nThese environment variables provide default values for the Supabase provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_SUPABASE_PROJECT_URL\" required>\nYour Supabase project URL (e.g., `https://abc123.supabase.co`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_SUPABASE_BASE_URL\" required>\nPublic URL of your FastMCP server (e.g., `https://your-server.com` or `http://localhost:8000` for development)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_SUPABASE_REQUIRED_SCOPES\" default=\"[]\">\nComma-, space-, or JSON-separated list of required OAuth scopes (e.g., `openid email` or `[\"openid\", \"email\"]`)\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# Use the Supabase provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.supabase.SupabaseProvider\n\n# Supabase configuration\nFASTMCP_SERVER_AUTH_SUPABASE_PROJECT_URL=https://abc123.supabase.co\nFASTMCP_SERVER_AUTH_SUPABASE_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_SUPABASE_REQUIRED_SCOPES=openid,email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"Supabase Protected Server\")\n```\n"}, {"filename": "docs/integrations/workos.mdx", "content": "---\ntitle: WorkOS \ud83e\udd1d FastMCP\nsidebarTitle: WorkOS\ndescription: Authenticate FastMCP servers with WorkOS Connect\nicon: shield-check\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.12.0\" />\n\nSecure your FastMCP server with WorkOS Connect authentication. This integration uses the OAuth Proxy pattern to handle authentication through WorkOS Connect while maintaining compatibility with MCP clients.\n\n<Note>\nThis guide covers WorkOS Connect applications. For Dynamic Client Registration (DCR) with AuthKit, see the [AuthKit integration](/integrations/authkit) instead.\n</Note>\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n1. A **[WorkOS Account](https://workos.com/)** with access to create OAuth Apps\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a WorkOS OAuth App\n\nCreate an OAuth App in your WorkOS dashboard to get the credentials needed for authentication:\n\n<Steps>\n<Step title=\"Create OAuth Application\">\nIn your WorkOS dashboard:\n1. Navigate to **Applications**\n2. Click **Create Application** \n3. Select **OAuth Application**\n4. Name your application\n</Step>\n\n<Step title=\"Get Credentials\">\nIn your OAuth application settings:\n1. Copy your **Client ID** (starts with `client_`)\n2. Click **Generate Client Secret** and save it securely\n3. Copy your **AuthKit Domain** (e.g., `https://your-app.authkit.app`)\n</Step>\n\n<Step title=\"Configure Redirect URI\">\nIn the **Redirect URIs** section:\n- Add: `http://localhost:8000/auth/callback` (for development)\n- For production, add your server's public URL + `/auth/callback`\n\n<Warning>\nThe callback URL must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter.\n</Warning>\n</Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `WorkOSProvider`:\n\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\n\n# Configure WorkOS OAuth\nauth = WorkOSProvider(\n    client_id=\"client_YOUR_CLIENT_ID\",\n    client_secret=\"YOUR_CLIENT_SECRET\",\n    authkit_domain=\"https://your-app.authkit.app\",\n    base_url=\"http://localhost:8000\",\n    required_scopes=[\"openid\", \"profile\", \"email\"]\n)\n\nmcp = FastMCP(\"WorkOS Protected Server\", auth=auth)\n\n@mcp.tool\ndef protected_tool(message: str) -> str:\n    \"\"\"This tool requires authentication.\"\"\"\n    return f\"Authenticated user says: {message}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by WorkOS OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your WorkOS-protected server:\n\n```python client.py\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():    \n    # The client will automatically handle WorkOS OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open WorkOS login in your browser\n        print(\"\u2713 Authenticated with WorkOS!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"protected_tool\", {\"message\": \"Hello!\"})\n        print(result)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n1. Your browser will open to WorkOS's authorization page\n2. After you authorize the app, you'll be redirected back\n3. The client receives the token and can make authenticated requests\n\n<Info>\nThe client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key`, and `client_storage`:\n\n```python server.py\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth = WorkOSProvider(\n    client_id=\"client_YOUR_CLIENT_ID\",\n    client_secret=\"YOUR_CLIENT_SECRET\",\n    authkit_domain=\"https://your-app.authkit.app\",\n    base_url=\"https://your-production-domain.com\",\n    required_scopes=[\"openid\", \"profile\", \"email\"],\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production WorkOS App\", auth=auth)\n```\n\n<Note>\nParameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\nFor complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the WorkOS provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\nSet to `fastmcp.server.auth.providers.workos.WorkOSProvider` to use WorkOS authentication.\n</ParamField>\n</Card>\n\n### WorkOS-Specific Configuration\n\nThese environment variables provide default values for the WorkOS provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID\" required>\nYour WorkOS OAuth App Client ID (e.g., `client_01K33Y6GGS7T3AWMPJWKW42Y3Q`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET\" required>\nYour WorkOS OAuth App Client Secret\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN\" required>\nYour WorkOS AuthKit domain (e.g., `https://your-app.authkit.app`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_BASE_URL\" default=\"http://localhost:8000\">\nPublic URL where OAuth endpoints will be accessible (includes any mount path)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_ISSUER_URL\" default=\"Uses BASE_URL\">\nIssuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_REDIRECT_PATH\" default=\"/auth/callback\">\nRedirect path configured in your WorkOS OAuth App\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES\" default=\"[]\">\nComma-, space-, or JSON-separated list of required OAuth scopes (e.g., `openid profile email` or `[\"openid\",\"profile\",\"email\"]`)\n</ParamField>\n\n<ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_TIMEOUT_SECONDS\" default=\"10\">\nHTTP request timeout for WorkOS API calls\n</ParamField>\n</Card>\n\nExample `.env` file:\n```bash\n# WorkOS OAuth credentials (always used as defaults)\nFASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID=client_01K33Y6GGS7T3AWMPJWKW42Y3Q\nFASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET=your_client_secret\nFASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN=https://your-app.authkit.app\nFASTMCP_SERVER_AUTH_WORKOS_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES=[\"openid\",\"profile\",\"email\"]\n\n# Optional: Automatically provision WorkOS auth for all servers\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.WorkOSProvider\n```\n\nWith environment variables set, you can either:\n\n**Option 1: Manual instantiation (env vars provide defaults)**\n```python server.py\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\n\n# Env vars provide default values for WorkOSProvider()\nauth = WorkOSProvider()  # Uses env var defaults\nmcp = FastMCP(name=\"WorkOS Protected Server\", auth=auth)\n```\n\n**Option 2: Automatic provisioning (requires FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.WorkOSProvider)**\n```python server.py\nfrom fastmcp import FastMCP\n\n# Auth is automatically provisioned from FASTMCP_SERVER_AUTH\nmcp = FastMCP(name=\"WorkOS Protected Server\")\n```\n\n## Configuration Options\n\n<Card>\n<ParamField path=\"client_id\" required>\nWorkOS OAuth application client ID\n</ParamField>\n\n<ParamField path=\"client_secret\" required>\nWorkOS OAuth application client secret\n</ParamField>\n\n<ParamField path=\"authkit_domain\" required>\nYour WorkOS AuthKit domain URL (e.g., `https://your-app.authkit.app`)\n</ParamField>\n\n<ParamField path=\"base_url\" required>\nYour FastMCP server's public URL\n</ParamField>\n\n<ParamField path=\"required_scopes\" default=\"[]\">\nOAuth scopes to request\n</ParamField>\n\n<ParamField path=\"redirect_path\" default=\"/auth/callback\">\nOAuth callback path\n</ParamField>\n\n<ParamField path=\"timeout_seconds\" default=\"10\">\nAPI request timeout\n</ParamField>\n</Card>"}, {"filename": "docs/patterns/cli.mdx", "content": "---\ntitle: FastMCP CLI\nsidebarTitle: CLI\ndescription: Learn how to use the FastMCP command-line interface\nicon: terminal\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n\nFastMCP provides a command-line interface (CLI) that makes it easy to run, develop, and install your MCP servers. The CLI is automatically installed when you install FastMCP.\n\n```bash\nfastmcp --help\n```\n\n## Commands Overview\n\n| Command | Purpose | Dependency Management |\n| ------- | ------- | --------------------- |\n| `run` | Run a FastMCP server directly | **Supports:** Local files, factory functions, URLs, fastmcp.json configs, MCP configs. **Deps:** Uses your local environment directly. With `--python`, `--with`, `--project`, or `--with-requirements`: Runs via `uv run` subprocess. With fastmcp.json: Automatically manages dependencies based on configuration |\n| `dev` | Run a server with the MCP Inspector for testing | **Supports:** Local files and fastmcp.json configs. **Deps:** Always runs via `uv run` subprocess (never uses your local environment); dependencies must be specified or available in a uv-managed project. With fastmcp.json: Uses configured dependencies |\n| `install` | Install a server in MCP client applications | **Supports:** Local files and fastmcp.json configs. **Deps:** Creates an isolated environment; dependencies must be explicitly specified with `--with` and/or `--with-editable`. With fastmcp.json: Uses configured dependencies |\n| `inspect` | Generate a JSON report about a FastMCP server | **Supports:** Local files and fastmcp.json configs. **Deps:** Uses your current environment; you are responsible for ensuring all dependencies are available |\n| `project prepare` | Create a persistent uv project from fastmcp.json environment config | **Supports:** fastmcp.json configs only. **Deps:** Creates a uv project directory with all dependencies pre-installed for reuse with `--project` flag |\n| `version` | Display version information | N/A |\n\n## `fastmcp run`\n\nRun a FastMCP server directly or proxy a remote server.\n\n```bash\nfastmcp run server.py\n```\n\n<Tip>\nBy default, this command runs the server directly in your current Python environment. You are responsible for ensuring all dependencies are available. When using `--python`, `--with`, `--project`, or `--with-requirements` options, it runs the server via `uv run` subprocess instead.\n</Tip>\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Transport | `--transport`, `-t` | Transport protocol to use (`stdio`, `http`, or `sse`) |\n| Host | `--host` | Host to bind to when using http transport (default: 127.0.0.1) |\n| Port | `--port`, `-p` | Port to bind to when using http transport (default: 8000) |\n| Path | `--path` | Path to bind to when using http transport (default: `/mcp/` or `/sse/` for SSE) |\n| Log Level | `--log-level`, `-l` | Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL) |\n| No Banner | `--no-banner` | Disable the startup banner display |\n| No Environment | `--skip-env` | Skip environment setup with uv (use when already in a uv environment) |\n| Python Version | `--python` | Python version to use (e.g., 3.10, 3.11) |\n| Additional Packages | `--with` | Additional packages to install (can be used multiple times) |\n| Project Directory | `--project` | Run the command within the given project directory |\n| Requirements File | `--with-requirements` | Requirements file to install dependencies from |\n\n\n### Entrypoints\n<VersionBadge version=\"2.3.5\" />\n\nThe `fastmcp run` command supports the following entrypoints:\n\n1. **[Inferred server instance](#inferred-server-instance)**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.\n2. **[Explicit server entrypoint](#explicit-server-entrypoint)**: `server.py:custom_name` - imports and uses the specified server entrypoint  \n3. **[Factory function](#factory-function)**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance\n4. **[Remote server proxy](#remote-server-proxy)**: `https://example.com/mcp-server` - connects to a remote server and creates a **local proxy server**\n5. **[FastMCP configuration file](#fastmcp-configuration)**: `fastmcp.json` - runs servers using FastMCP's declarative configuration format (auto-detects files in current directory)\n6. **MCP configuration file**: `mcp.json` - runs servers defined in a standard MCP configuration file\n\n<Warning>\nNote: When using `fastmcp run` with a local file, it **completely ignores** the `if __name__ == \"__main__\"` block. This means:\n- Any setup code in `__main__` will NOT run\n- Server configuration in `__main__` is bypassed  \n- `fastmcp run` finds your server entrypoint/factory and runs it with its own transport settings\n\nIf you need setup code to run, use the **factory pattern** instead.\n</Warning>\n\n#### Inferred Server Instance\n\nIf you provide a path to a file, `fastmcp run` will load the file and look for a FastMCP server instance stored as a variable named `mcp`, `server`, or `app`. If no such object is found, it will raise an error.\n\nFor example, if you have a file called `server.py` with the following content:\n\n```python server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")\n```\n\nYou can run it with:\n\n```bash\nfastmcp run server.py\n```\n\n#### Explicit Server Entrypoint\n\nIf your server is stored as a variable with a custom name, or you want to be explicit about which server to run, you can use the following syntax to load a specific server entrypoint:\n\n```bash\nfastmcp run server.py:custom_name\n```\n\nFor example, if you have a file called `server.py` with the following content:\n\n```python\nfrom fastmcp import FastMCP\n\nmy_server = FastMCP(\"CustomServer\")\n\n@my_server.tool\ndef hello() -> str:\n    return \"Hello from custom server!\"\n```\n\nYou can run it with:\n\n```bash\nfastmcp run server.py:my_server\n```\n\n#### Factory Function\n<VersionBadge version=\"2.11.2\" />\n\nSince `fastmcp run` ignores the `if __name__ == \"__main__\"` block, you can use a factory function to run setup code before your server starts. Factory functions are called without any arguments and must return a FastMCP server instance. Both sync and async factory functions are supported.\n\nThe syntax for using a factory function is the same as for an explicit server entrypoint: `fastmcp run server.py:factory_fn`. FastMCP will automatically detect that you have identified a function rather than a server Instance\n\nFor example, if you have a file called `server.py` with the following content:\n\n```python\nfrom fastmcp import FastMCP\n\nasync def create_server() -> FastMCP:\n    mcp = FastMCP(\"MyServer\")\n    \n    @mcp.tool\n    def add(x: int, y: int) -> int:\n        return x + y\n    \n    # Setup that runs with fastmcp run\n    tool = await mcp.get_tool(\"add\")\n    tool.disable()\n    \n    return mcp\n```\n\nYou can run it with:\n\n```bash\nfastmcp run server.py:create_server\n```\n\n#### Remote Server Proxy\n\nFastMCP run can also start a local proxy server that connects to a remote server. This is useful when you want to run a remote server locally for testing or development purposes, or to use with a client that doesn't support direct connections to remote servers.\n\nTo start a local proxy, you can use the following syntax:\n\n```bash\nfastmcp run https://example.com/mcp\n```\n\n#### FastMCP Configuration\n<VersionBadge version=\"2.11.4\" />\n\nFastMCP supports declarative configuration through `fastmcp.json` files. When you run `fastmcp run` without arguments, it automatically looks for a `fastmcp.json` file in the current directory:\n\n```bash\n# Auto-detect fastmcp.json in current directory\nfastmcp run\n\n# Or explicitly specify a configuration file\nfastmcp run my-config.fastmcp.json\n```\n\nThe configuration file handles dependencies, environment variables, and transport settings. Command-line arguments override configuration file values:\n\n```bash\n# Override port from config file\nfastmcp run fastmcp.json --port 8080\n\n# Skip environment setup when already in a uv environment\nfastmcp run fastmcp.json --skip-env\n```\n\n<Note>\nThe `--skip-env` flag is useful when:\n- You're already in an activated virtual environment\n- You're inside a Docker container with pre-installed dependencies  \n- You're in a uv-managed environment (prevents infinite recursion)\n- You want to test the server without environment setup\n</Note>\n\nSee [Server Configuration](/deployment/server-configuration) for detailed documentation on fastmcp.json.\n\n#### MCP Configuration\n\nFastMCP can also run servers defined in a standard MCP configuration file. This is useful when you want to run multiple servers from a single file, or when you want to use a client that doesn't support direct connections to remote servers.\n\nTo run a MCP configuration file, you can use the following syntax:\n\n```bash\nfastmcp run mcp.json\n```\n\nThis will run all the servers defined in the file.\n\n## `fastmcp dev`\n\nRun a MCP server with the [MCP Inspector](https://github.com/modelcontextprotocol/inspector) for testing.\n\n```bash\nfastmcp dev server.py\n```\n\n<Tip> \nThis command always runs your server via `uv run` subprocess (never your local environment) to work with the MCP Inspector. Dependencies can be:\n- Specified using `--with` and/or `--with-editable` options\n- Defined in a `fastmcp.json` configuration file\n- Available in a uv-managed project\n\nWhen using `fastmcp.json`, the dev command automatically uses the configured dependencies.\n</Tip>\n\n<Warning>\nThe `dev` command is a shortcut for testing a server over STDIO only. When the Inspector launches, you may need to:\n1. Select \"STDIO\" from the transport dropdown\n2. Connect manually\n\nThis command does not support HTTP testing. To test a server over Streamable HTTP or SSE:\n1. Start your server manually with the appropriate transport using either the command line:\n   ```bash\n   fastmcp run server.py --transport http\n   ```\n   or by setting the transport in your code:\n   ```bash\n   python server.py  # Assuming your __main__ block sets Streamable HTTP transport\n   ```\n2. Open the MCP Inspector separately and connect to your running server\n</Warning>\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Editable Package | `--with-editable`, `-e` | Directory containing pyproject.toml to install in editable mode |\n| Additional Packages | `--with` | Additional packages to install (can be used multiple times) |\n| Inspector Version | `--inspector-version` | Version of the MCP Inspector to use |\n| UI Port | `--ui-port` | Port for the MCP Inspector UI |\n| Server Port | `--server-port` | Port for the MCP Inspector Proxy server |\n| Python Version | `--python` | Python version to use (e.g., 3.10, 3.11) |\n| Project Directory | `--project` | Run the command within the given project directory |\n| Requirements File | `--with-requirements` | Requirements file to install dependencies from |\n\n### Entrypoints\n\nThe `dev` command supports local FastMCP server files and configuration:\n\n1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.\n2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint  \n3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance\n4. **FastMCP configuration**: `fastmcp.json` - uses FastMCP's declarative configuration (auto-detects in current directory)\n\n<Warning>\nThe `dev` command **only supports local files and fastmcp.json** - no URLs, remote servers, or standard MCP configuration files.\n</Warning>\n\n**Examples**\n\n```bash\n# Run dev server with editable mode and additional packages\nfastmcp dev server.py -e . --with pandas --with matplotlib\n\n# Run dev server with fastmcp.json configuration (auto-detects)\nfastmcp dev\n\n# Run dev server with explicit fastmcp.json file\nfastmcp dev dev.fastmcp.json\n\n# Run dev server with specific Python version\nfastmcp dev server.py --python 3.11\n\n# Run dev server with requirements file\nfastmcp dev server.py --with-requirements requirements.txt\n\n# Run dev server within a specific project directory\nfastmcp dev server.py --project /path/to/project\n```\n\n## `fastmcp install`\n<VersionBadge version=\"2.10.3\" />\n\nInstall a MCP server in MCP client applications. FastMCP currently supports the following clients:\n\n- **Claude Code** - Installs via Claude Code's built-in MCP management system\n- **Claude Desktop** - Installs via direct configuration file modification\n- **Cursor** - Installs via deeplink that opens Cursor for user confirmation\n- **MCP JSON** - Generates standard MCP JSON configuration for manual use\n\n```bash\nfastmcp install claude-code server.py\nfastmcp install claude-desktop server.py\nfastmcp install cursor server.py\nfastmcp install mcp-json server.py\n```\n\nNote that for security reasons, MCP clients usually run every server in a completely isolated environment. Therefore, all dependencies must be explicitly specified using the `--with` and/or `--with-editable` options (following `uv` conventions) or by attaching them to your server in code via the `dependencies` parameter. You should not assume that the MCP server will have access to your local environment.\n\n<Warning>\n**`uv` must be installed and available in your system PATH**. Both Claude Desktop and Cursor run in isolated environments and need `uv` to manage dependencies. On macOS, install `uv` globally with Homebrew for Claude Desktop compatibility: `brew install uv`.\n</Warning>\n\n<Note>\n**Python Version Considerations**: The install commands now support the `--python` option to specify a Python version directly. You can also use `--project` to run within a specific project directory or `--with-requirements` to install dependencies from a requirements file.\n</Note>\n\n<Tip>\n**FastMCP `install` commands focus on local server files with STDIO transport.** For remote servers running with HTTP or SSE transport, use your client's native configuration - FastMCP's value is simplifying the complex local setup with dependencies and `uv` commands.\n</Tip>\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Server Name | `--server-name`, `-n` | Custom name for the server (defaults to server's name attribute or file name) |\n| Editable Package | `--with-editable`, `-e` | Directory containing pyproject.toml to install in editable mode |\n| Additional Packages | `--with` | Additional packages to install (can be used multiple times) |\n| Environment Variables | `--env` | Environment variables in KEY=VALUE format (can be used multiple times) |\n| Environment File | `--env-file`, `-f` | Load environment variables from a .env file |\n| Python Version | `--python` | Python version to use (e.g., 3.10, 3.11) |\n| Project Directory | `--project` | Run the command within the given project directory |\n| Requirements File | `--with-requirements` | Requirements file to install dependencies from |\n\n### Entrypoints\n\nThe `install` command supports local FastMCP server files and configuration:\n\n1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.\n2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint  \n3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance\n4. **FastMCP configuration**: `fastmcp.json` - uses FastMCP's declarative configuration with dependencies and settings\n\n<Note>\nFactory functions are particularly useful for install commands since they allow setup code to run that would otherwise be ignored when the MCP client runs your server. When using fastmcp.json, dependencies are automatically handled.\n</Note>\n\n<Warning>\nThe `install` command **only supports local files and fastmcp.json** - no URLs, remote servers, or standard MCP configuration files. For remote servers, use your MCP client's native configuration.\n</Warning>\n\n**Examples**\n\n```bash\n# Auto-detects server entrypoint (looks for 'mcp', 'server', or 'app')\nfastmcp install claude-desktop server.py\n\n# Install with fastmcp.json configuration (auto-detects)\nfastmcp install claude-desktop\n\n# Install with explicit fastmcp.json file\nfastmcp install claude-desktop my-config.fastmcp.json\n\n# Uses specific server entrypoint\nfastmcp install claude-desktop server.py:my_server\n\n# With custom name and dependencies\nfastmcp install claude-desktop server.py:my_server --server-name \"My Analysis Server\" --with pandas\n\n# Install in Claude Code with environment variables\nfastmcp install claude-code server.py --env API_KEY=secret --env DEBUG=true\n\n# Install in Cursor with environment variables\nfastmcp install cursor server.py --env API_KEY=secret --env DEBUG=true\n\n# Install with environment file\nfastmcp install cursor server.py --env-file .env\n\n# Install with specific Python version\nfastmcp install claude-desktop server.py --python 3.11\n\n# Install with requirements file\nfastmcp install claude-code server.py --with-requirements requirements.txt\n\n# Install within a project directory\nfastmcp install cursor server.py --project /path/to/project\n\n# Generate MCP JSON configuration\nfastmcp install mcp-json server.py --name \"My Server\" --with pandas\n\n# Copy JSON configuration to clipboard\nfastmcp install mcp-json server.py --copy\n```\n\n### MCP JSON Generation\n\nThe `mcp-json` subcommand generates standard MCP JSON configuration that can be used with any MCP-compatible client. This is useful when:\n\n- Working with MCP clients not directly supported by FastMCP\n- Creating configuration for CI/CD environments  \n- Sharing server configurations with others\n- Integration with custom tooling\n\nThe generated JSON follows the standard MCP server configuration format used by Claude Desktop, VS Code, Cursor, and other MCP clients, with the server name as the root key:\n\n```json\n{\n  \"server-name\": {\n    \"command\": \"uv\",\n    \"args\": [\n      \"run\",\n      \"--with\",\n      \"fastmcp\",\n      \"fastmcp\",\n      \"run\",\n      \"/path/to/server.py\"\n    ],\n    \"env\": {\n      \"API_KEY\": \"value\"\n    }\n  }\n}\n```\n\n<Note>\nTo use this configuration with your MCP client, you'll typically need to add it to the client's `mcpServers` object. Consult your client's documentation for any specific configuration requirements or formatting needs.\n</Note>\n\n**Options specific to mcp-json:**\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Copy to Clipboard | `--copy` | Copy configuration to clipboard instead of printing to stdout |\n\n## `fastmcp inspect`\n\n<VersionBadge version=\"2.9.0\" />\n\nInspect a FastMCP server to view summary information or generate a detailed JSON report.\n\n```bash\n# Show text summary\nfastmcp inspect server.py\n\n# Output FastMCP JSON to stdout\nfastmcp inspect server.py --format fastmcp\n\n# Save MCP JSON to file (format required with -o)\nfastmcp inspect server.py --format mcp -o manifest.json\n```\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Format | `--format`, `-f` | Output format: `fastmcp` (FastMCP-specific) or `mcp` (MCP protocol). Required when using `-o` |\n| Output File | `--output`, `-o` | Save JSON report to file instead of stdout. Requires `--format` |\n\n### Output Formats\n\n#### FastMCP Format (`--format fastmcp`)\nThe default and most comprehensive format, includes all FastMCP-specific metadata:\n- Server name, instructions, and version\n- FastMCP version and MCP version\n- Tool tags and enabled status\n- Output schemas for tools\n- Annotations and custom metadata\n- Uses snake_case field names\n- **Use this for**: Complete server introspection and debugging FastMCP servers\n\n#### MCP Protocol Format (`--format mcp`)\nShows exactly what MCP clients will see via the protocol:\n- Only includes standard MCP protocol fields\n- Matches output from `client.list_tools()`, `client.list_prompts()`, etc.\n- Uses camelCase field names (e.g., `inputSchema`)\n- Excludes FastMCP-specific fields like tags and enabled status\n- **Use this for**: Debugging client visibility and ensuring MCP compatibility\n\n### Entrypoints\n\nThe `inspect` command supports local FastMCP server files and configuration:\n\n1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.\n2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint  \n3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance\n4. **FastMCP configuration**: `fastmcp.json` - inspects servers defined with FastMCP's declarative configuration\n\n<Warning>\nThe `inspect` command **only supports local files and fastmcp.json** - no URLs, remote servers, or standard MCP configuration files.\n</Warning>\n\n### Examples\n\n```bash\n# Show text summary (no JSON output)\nfastmcp inspect server.py\n# Output: \n# Server: MyServer\n# Instructions: A helpful MCP server\n# Version: 1.0.0\n#\n# Components:\n#   Tools: 5\n#   Prompts: 2\n#   Resources: 3\n#   Templates: 1\n#\n# Environment:\n#   FastMCP: 2.0.0\n#   MCP: 1.0.0\n#\n# Use --format [fastmcp|mcp] for complete JSON output\n\n# Output FastMCP format to stdout\nfastmcp inspect server.py --format fastmcp\n\n# Specify server entrypoint\nfastmcp inspect server.py:my_server\n\n# Output MCP protocol format to stdout\nfastmcp inspect server.py --format mcp\n\n# Save to file (format required)\nfastmcp inspect server.py --format fastmcp -o server-manifest.json\n\n# Save MCP format with custom server object\nfastmcp inspect server.py:my_server --format mcp -o mcp-manifest.json\n\n# Error: format required with output file\nfastmcp inspect server.py -o output.json\n# Error: --format is required when using -o/--output\n```\n\n## `fastmcp project prepare`\n\nCreate a persistent uv project directory from a fastmcp.json file's environment configuration. This allows you to pre-install all dependencies once and reuse them with the `--project` flag.\n\n```bash\nfastmcp project prepare fastmcp.json --output-dir ./env\n```\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Output Directory | `--output-dir` | **Required.** Directory where the persistent uv project will be created |\n\n### Usage Pattern\n\n```bash\n# Step 1: Prepare the environment (installs dependencies)\nfastmcp project prepare fastmcp.json --output-dir ./my-env\n\n# Step 2: Run using the prepared environment (fast, no dependency installation)\nfastmcp run fastmcp.json --project ./my-env\n```\n\nThe prepare command creates a uv project with:\n- A `pyproject.toml` containing all dependencies from the fastmcp.json\n- A `.venv` with all packages pre-installed\n- A `uv.lock` file for reproducible environments\n\nThis is useful when you want to separate environment setup from server execution, such as in deployment scenarios where dependencies are installed once and the server is run multiple times.\n\n## `fastmcp version`\n\nDisplay version information about FastMCP and related components.\n\n```bash\nfastmcp version\n```\n\n### Options\n\n| Option | Flag | Description |\n| ------ | ---- | ----------- |\n| Copy to Clipboard | `--copy` | Copy version information to clipboard |\n"}, {"filename": "docs/patterns/contrib.mdx", "content": "---\ntitle: \"Contrib Modules\"\ndescription: \"Community-contributed modules extending FastMCP\"\nicon: \"cubes\"\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.2.1\" />\n\nFastMCP includes a `contrib` package that holds community-contributed modules. These modules extend FastMCP's functionality but aren't officially maintained by the core team.\n\nContrib modules provide additional features, integrations, or patterns that complement the core FastMCP library. They offer a way for the community to share useful extensions while keeping the core library focused and maintainable.\n\nThe available modules can be viewed in the [contrib directory](https://github.com/jlowin/fastmcp/tree/main/src/fastmcp/contrib).\n\n## Usage\n\nTo use a contrib module, import it from the `fastmcp.contrib` package:\n\n```python\nfrom fastmcp.contrib import my_module\n```\n\n## Important Considerations\n\n- **Stability**: Modules in `contrib` may have different testing requirements or stability guarantees compared to the core library.\n- **Compatibility**: Changes to core FastMCP might break modules in `contrib` without explicit warnings in the main changelog.\n- **Dependencies**: Contrib modules may have additional dependencies not required by the core library. These dependencies are typically documented in the module's README or separate requirements files.\n\n## Contributing\n\nWe welcome contributions to the `contrib` package! If you have a module that extends FastMCP in a useful way, consider contributing it:\n\n1. Create a new directory in `src/fastmcp/contrib/` for your module\n3. Add proper tests for your module in `tests/contrib/`\n2. Include comprehensive documentation in a README.md file, including usage and examples, as well as any additional dependencies or installation instructions\n5. Submit a pull request\n\nThe ideal contrib module:\n- Solves a specific use case or integration need\n- Follows FastMCP coding standards\n- Includes thorough documentation and examples\n- Has comprehensive tests\n- Specifies any additional dependencies\n"}, {"filename": "docs/patterns/decorating-methods.mdx", "content": "---\ntitle: Decorating Methods\nsidebarTitle: Decorating Methods\ndescription: Properly use instance methods, class methods, and static methods with FastMCP decorators.\nicon: at\n---\n\nFastMCP's decorator system is designed to work with functions, but you may see unexpected behavior if you try to decorate an instance or class method. This guide explains the correct approach for using methods with all FastMCP decorators (`@tool`, `@resource`, and `@prompt`).\n\n## Why Are Methods Hard?\n\nWhen you apply a FastMCP decorator like `@tool`, `@resource`, or `@prompt` to a method, the decorator captures the function at decoration time. For instance methods and class methods, this poses a challenge because:\n\n1. For instance methods: The decorator gets the unbound method before any instance exists\n2. For class methods: The decorator gets the function before it's bound to the class\n\nThis means directly decorating these methods doesn't work as expected. In practice, the LLM would see parameters like `self` or `cls` that it cannot provide values for.\n\nAdditionally, **FastMCP decorators return objects (Tool, Resource, or Prompt instances) rather than the original function**. This means that when you decorate a method directly, the method becomes the returned object and is no longer callable by your code:\n\n<Warning>\n**Don't do this!**\n\nThe method will no longer be callable from Python, and the tool won't be callable by LLMs.\n\n```python\n\nfrom fastmcp import FastMCP\nmcp = FastMCP()\n\nclass MyClass:\n    @mcp.tool\n    def my_method(self, x: int) -> int:\n        return x * 2\n\nobj = MyClass()\nobj.my_method(5)  # Fails - my_method is a Tool, not a function\n```\n</Warning>\n\nThis is another important reason to register methods functionally after defining the class.\n\n## Recommended Patterns\n\n### Instance Methods\n\n<Warning>\n**Don't do this!**\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    @mcp.tool  # This won't work correctly\n    def add(self, x, y):\n        return x + y\n```\n</Warning>\nWhen the decorator is applied this way, it captures the unbound method. When the LLM later tries to use this component, it will see `self` as a required parameter, but it won't know what to provide for it, causing errors or unexpected behavior.\n\n<Check>\n**Do this instead**:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    def add(self, x, y):\n        return x + y\n\n# Create an instance first, then register the bound methods\nobj = MyClass()\nmcp.tool(obj.add)\n\n# Now you can call it without 'self' showing up as a parameter\nawait mcp._mcp_call_tool('add', {'x': 1, 'y': 2})  # Returns 3\n```\n</Check>\n\nThis approach works because:\n1. You first create an instance of the class (`obj`)\n2. When you access the method through the instance (`obj.add`), Python creates a bound method where `self` is already set to that instance\n3. When you register this bound method, the system sees a callable that only expects the appropriate parameters, not `self`\n\n### Class Methods\n\nThe behavior of decorating class methods depends on the order of decorators:\n\n<Warning>\n**Don't do this** (decorator order matters):\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    @classmethod\n    @mcp.tool  # This won't work but won't raise an error\n    def from_string_v1(cls, s):\n        return cls(s)\n    \n    @mcp.tool\n    @classmethod  # This will raise a helpful ValueError\n    def from_string_v2(cls, s):\n        return cls(s)\n```\n</Warning>\n\n- If `@classmethod` comes first, then `@mcp.tool`: No error is raised, but it won't work correctly\n- If `@mcp.tool` comes first, then `@classmethod`: FastMCP will detect this and raise a helpful `ValueError` with guidance\n\n<Check>\n**Do this instead**:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    @classmethod\n    def from_string(cls, s):\n        return cls(s)\n\n# Register the class method after the class is defined\nmcp.tool(MyClass.from_string)\n```\n</Check>\n\nThis works because:\n1. The `@classmethod` decorator is applied properly during class definition\n2. When you access `MyClass.from_string`, Python provides a special method object that automatically binds the class to the `cls` parameter\n3. When registered, only the appropriate parameters are exposed to the LLM, hiding the implementation detail of the `cls` parameter\n\n### Static Methods\n\nStatic methods \"work\" with FastMCP decorators, but this is not recommended because the FastMCP decorator will not return a callable method. Therefore, you should register static methods the same way as other methods.\n\n<Warning>\n**This is not recommended, though it will work.**\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    @mcp.tool\n    @staticmethod\n    def utility(x, y):\n        return x + y\n```\n</Warning>\n\nThis works because `@staticmethod` converts the method to a regular function, which the FastMCP decorator can then properly process. However, this is not recommended because the FastMCP decorator will not return a callable staticmethod. Therefore, you should register static methods the same way as other methods.\n\n<Check>\n**Prefer this pattern:**\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass MyClass:\n    @staticmethod\n    def utility(x, y):\n        return x + y\n\n# This also works\nmcp.tool(MyClass.utility)\n```\n</Check>\n\n## Additional Patterns\n\n### Creating Components at Class Initialization\n\nYou can automatically register instance methods when creating an object:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\nclass ComponentProvider:\n    def __init__(self, mcp_instance):\n        # Register methods\n        mcp_instance.tool(self.tool_method)\n        mcp_instance.resource(\"resource://data\")(self.resource_method)\n    \n    def tool_method(self, x):\n        return x * 2\n    \n    def resource_method(self):\n        return \"Resource data\"\n\n# The methods are automatically registered when creating the instance\nprovider = ComponentProvider(mcp)\n```\n\nThis pattern is useful when:\n- You want to encapsulate registration logic within the class itself\n- You have multiple related components that should be registered together\n- You want to ensure that methods are always properly registered when creating an instance\n\nThe class automatically registers its methods during initialization, ensuring they're properly bound to the instance before registration.\n\n## Summary\n\nThe current behavior of FastMCP decorators with methods is:\n\n- **Static methods**: Can be decorated directly and work perfectly with all FastMCP decorators\n- **Class methods**: Cannot be decorated directly and will raise a helpful `ValueError` with guidance\n- **Instance methods**: Should be registered after creating an instance using the decorator calls\n\nFor class and instance methods, you should register them after creating the instance or class to ensure proper method binding. This ensures that the methods are properly bound before being registered.\n\n\nUnderstanding these patterns allows you to effectively organize your components into classes while maintaining proper method binding, giving you the benefits of object-oriented design without sacrificing the simplicity of FastMCP's decorator system.\n"}, {"filename": "docs/patterns/testing.mdx", "content": "---\ntitle: Testing your FastMCP Server\nsidebarTitle: Testing\ndescription: How to test your FastMCP server.\nicon: vial\n---\n\nThe best way to ensure a reliable and maintainable FastMCP Server is to test it! The FastMCP Client combined with Pytest provides a simple and powerful way to test your FastMCP servers.\n\n## Prerequisites\n\nTesting FastMCP servers requires `pytest-asyncio` to handle async test functions and fixtures. Install it as a development dependency:\n\n```bash\npip install pytest-asyncio\n```\n\nWe recommend configuring pytest to automatically handle async tests by setting the asyncio mode to `auto` in your `pyproject.toml`:\n\n```toml\n[tool.pytest.ini_options]\nasyncio_mode = \"auto\"\n```\n\nThis eliminates the need to decorate every async test with `@pytest.mark.asyncio`.\n\n## Testing with Pytest Fixtures\n\nUsing Pytest Fixtures, you can wrap your FastMCP Server in a Client instance that makes interacting with your server fast and easy. This is especially useful when building your own MCP Servers and enables a tight development loop by allowing you to avoid using a separate tool like MCP Inspector during development:\n\n```python\nimport pytest\nfrom fastmcp.client import Client\nfrom fastmcp.client.transports import FastMCPTransport\n\nfrom my_project.main import mcp\n\n@pytest.fixture\nasync def main_mcp_client():\n    async with Client(transport=mcp) as mcp_client:\n        yield mcp_client\n\nasync def test_list_tools(main_mcp_client: Client[FastMCPTransport]):\n    list_tools = await main_mcp_client.list_tools()\n\n    assert len(list_tools) == 5\n```\n\nWe recommend the [inline-snapshot library](https://github.com/15r10nk/inline-snapshot) for asserting complex data structures coming from your MCP Server. This library allows you to write tests that are easy to read and understand, and are also easy to update when the data structure changes. \n\n```python\nfrom inline_snapshot import snapshot\n\nasync def test_list_tools(main_mcp_client: Client[FastMCPTransport]):\n    list_tools = await main_mcp_client.list_tools()\n\n    assert list_tools == snapshot()\n```\n\nSimply run `pytest --inline-snapshot=fix,create` to fill in the `snapshot()` with actual data.\n\n<Tip>\nFor values that change you can leverage the [dirty-equals](https://github.com/samuelcolvin/dirty-equals) library to perform flexible equality assertions on dynamic or non-deterministic values.\n</Tip>\n\nUsing the pytest `parametrize` decorator, you can easily test your tools with a wide variety of inputs.\n\n```python\nimport pytest\nfrom my_project.main import mcp\n\nfrom fastmcp.client import Client\nfrom fastmcp.client.transports import FastMCPTransport\n@pytest.fixture\nasync def main_mcp_client():\n    async with Client(mcp) as client:\n        yield client\n\n\n@pytest.mark.parametrize(\n    \"first_number, second_number, expected\",\n    [\n        (1, 2, 3),\n        (2, 3, 5),\n        (3, 4, 7),\n    ],\n)\nasync def test_add(\n    first_number: int,\n    second_number: int,\n    expected: int,\n    main_mcp_client: Client[FastMCPTransport],\n):\n    result = await main_mcp_client.call_tool(\n        name=\"add\", arguments={\"x\": first_number, \"y\": second_number}\n    )\n    assert result.data is not None\n    assert isinstance(result.data, int)\n    assert result.data == expected\n```\n\n<Tip>\nThe [FastMCP Repository contains thousands of tests](https://github.com/jlowin/fastmcp/tree/main/tests) for the FastMCP Client and Server. Everything from connecting to remote MCP servers, to testing tools, resources, and prompts is covered, take a look for inspiration!\n</Tip>"}, {"filename": "docs/patterns/tool-transformation.mdx", "content": "---\ntitle: Tool Transformation\nsidebarTitle: Tool Transformation\ndescription: Create enhanced tool variants with modified schemas, argument mappings, and custom behavior.\nicon: wand-magic-sparkles\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.8.0\" />\n\nTool transformation allows you to create new, enhanced tools from existing ones. This powerful feature enables you to adapt tools for different contexts, simplify complex interfaces, or add custom logic without duplicating code.\n\n## Why Transform Tools?\n\nOften, an existing tool is *almost* perfect for your use case, but it might have:\n- A confusing description (or no description at all).\n- Argument names or descriptions that are not intuitive for an LLM (e.g., `q` instead of `query`).\n- Unnecessary parameters that you want to hide from the LLM.\n- A need for input validation before the original tool is called.\n- A need to modify or format the tool's output.\n\nInstead of rewriting the tool from scratch, you can **transform** it to fit your needs.\n\n## Basic Transformation\n\nThe primary way to create a transformed tool is with the `Tool.from_tool()` class method. At its simplest, you can use it to change a tool's top-level metadata like its `name`, `description`, or `tags`.\n\nIn the following simple example, we take a generic `search` tool and adjust its name and description to help an LLM client better understand its purpose.\n\n```python {13-21}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\n\nmcp = FastMCP()\n\n# The original, generic tool\n@mcp.tool\ndef search(query: str, category: str = \"all\") -> list[dict]:\n    \"\"\"Searches for items in the database.\"\"\"\n    return database.search(query, category)\n\n# Create a more domain-specific version by changing its metadata\nproduct_search_tool = Tool.from_tool(\n    search,\n    name=\"find_products\",\n    description=\"\"\"\n        Search for products in the e-commerce catalog. \n        Use this when customers ask about finding specific items, \n        checking availability, or browsing product categories.\n        \"\"\",\n)\n\nmcp.add_tool(product_search_tool)\n```\n\n<Tip>\nWhen you transform a tool, the original tool remains registered on the server. To avoid confusing an LLM with two similar tools, you can disable the original one:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\n\nmcp = FastMCP()\n\n# The original, generic tool\n@mcp.tool\ndef search(query: str, category: str = \"all\") -> list[dict]:\n    ...\n\n# Create a more domain-specific version\nproduct_search_tool = Tool.from_tool(search, ...)\nmcp.add_tool(product_search_tool)\n\n# Disable the original tool\nsearch.disable()\n```\n</Tip>\n\nNow, clients see a tool named `find_products` with a clear, domain-specific purpose and relevant tags, even though it still uses the original generic `search` function's logic.\n\n### Parameters\n\nThe `Tool.from_tool()` class method is the primary way to create a transformed tool. It takes the following parameters:\n\n- `tool`: The tool to transform. This is the only required argument.\n- `name`: An optional name for the new tool.\n- `description`: An optional description for the new tool.\n- `transform_args`: A dictionary of `ArgTransform` objects, one for each argument you want to modify.\n- `transform_fn`: An optional function that will be called instead of the parent tool's logic.\n- `output_schema`: Control output schema and structured outputs (see [Output Schema Control](#output-schema-control)).\n- `tags`: An optional set of tags for the new tool.\n- `annotations`: An optional set of `ToolAnnotations` for the new tool.\n- `serializer`: An optional function that will be called to serialize the result of the new tool.\n- `meta`: Control meta information for the tool. Use `None` to remove meta, any dict to set meta, or leave unset to inherit from parent.\n\nThe result is a new `TransformedTool` object that wraps the parent tool and applies the transformations you specify. You can add this tool to your MCP server using its `add_tool()` method.\n\n\n\n## Modifying Arguments\n\nTo modify a tool's parameters, provide a dictionary of `ArgTransform` objects to the `transform_args` parameter of `Tool.from_tool()`. Each key is the name of the *original* argument you want to modify.\n\n<Tip>\nYou only need to provide a `transform_args` entry for arguments you want to modify. All other arguments will be passed through unchanged.\n</Tip>\n\n### The ArgTransform Class\n\nTo modify an argument, you need to create an `ArgTransform` object. This object has the following parameters:\n\n- `name`: The new name for the argument.\n- `description`: The new description for the argument.\n- `default`: The new default value for the argument.\n- `default_factory`: A function that will be called to generate a default value for the argument. This is useful for arguments that need to be generated for each tool call, such as timestamps or unique IDs.\n- `hide`: Whether to hide the argument from the LLM.\n- `required`: Whether the argument is required, usually used to make an optional argument be required instead.\n- `type`: The new type for the argument.\n\n<Tip>\nCertain combinations of parameters are not allowed. For example, you can only use `default_factory` with `hide=True`, because dynamic defaults cannot be represented in a JSON schema for the client. You can only set required=True for arguments that do not declare a default value.\n</Tip>\n\n\n### Descriptions\n\nBy far the most common reason to transform a tool, after its own description, is to improve its argument descriptions. A good description is crucial for helping an LLM understand how to use a parameter correctly. This is especially important when wrapping tools from external APIs, whose argument descriptions may be missing or written for developers, not LLMs.\n\nIn this example, we add a helpful description to the `user_id` argument:\n\n```python {16-19}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP()\n\n@mcp.tool\ndef find_user(user_id: str):\n    \"\"\"Finds a user by their ID.\"\"\"\n    ...\n\nnew_tool = Tool.from_tool(\n    find_user,\n    transform_args={\n        \"user_id\": ArgTransform(\n            description=(\n                \"The unique identifier for the user, \"\n                \"usually in the format 'usr-xxxxxxxx'.\"\n            )\n        )\n    }\n)\n```\n\n### Names\n\nAt times, you may want to rename an argument to make it more intuitive for an LLM. \n\nFor example, in the following example, we take a generic `q` argument and expand it to `search_query`:\n\n```python {15}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP()\n\n@mcp.tool\ndef search(q: str):\n    \"\"\"Searches for items in the database.\"\"\"\n    return database.search(q)\n\nnew_tool = Tool.from_tool(\n    search,\n    transform_args={\n        \"q\": ArgTransform(name=\"search_query\")\n    }\n)\n```\n\n### Default Values\n\nYou can update the default value for any argument using the `default` parameter. Here, we change the default value of the `y` argument to 10:\n\n```python{15}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP()\n\n@mcp.tool\ndef add(x: int, y: int) -> int:\n    \"\"\"Adds two numbers.\"\"\"\n    return x + y\n\nnew_tool = Tool.from_tool(\n    add,\n    transform_args={\n        \"y\": ArgTransform(default=10)\n    }\n)\n```\n\nDefault values are especially useful in combination with hidden arguments.\n\n### Hiding Arguments\n\nSometimes a tool requires arguments that shouldn't be exposed to the LLM, such as API keys, configuration flags, or internal IDs. You can hide these parameters using `hide=True`. Note that you can only hide arguments that have a default value (or for which you provide a new default), because the LLM can't provide a value at call time.\n\n<Tip>\nTo pass a constant value to the parent tool, combine `hide=True` with `default=<value>`.\n</Tip>\n\n```python {19-20}\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP()\n\n@mcp.tool\ndef send_email(to: str, subject: str, body: str, api_key: str):\n    \"\"\"Sends an email.\"\"\"\n    ...\n    \n# Create a simplified version that hides the API key\nnew_tool = Tool.from_tool(\n    send_email,\n    name=\"send_notification\",\n    transform_args={\n        \"api_key\": ArgTransform(\n            hide=True, \n            default=os.environ.get(\"EMAIL_API_KEY\"),\n        )\n    }\n)\n```\nThe LLM now only sees the `to`, `subject`, and `body` parameters. The `api_key` is supplied automatically from an environment variable.\n\nFor values that must be generated for each tool call (like timestamps or unique IDs), use `default_factory`, which is called with no arguments every time the tool is called. For example,\n\n```python {3-4}\ntransform_args = {\n    'timestamp': ArgTransform(\n        hide=True,\n        default_factory=lambda: datetime.now(),\n    )\n}\n```\n\n<Warning>\n`default_factory` can only be used with `hide=True`. This is because visible parameters need static defaults that can be represented in a JSON schema for the client.\n</Warning>\n\n### Meta Information\n\n<VersionBadge version=\"2.11.0\" />\n\nYou can control meta information on transformed tools using the `meta` parameter. Meta information is additional data about the tool that doesn't affect its functionality but can be used by clients for categorization, routing, or other purposes.\n\n```python {15-17}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\n\nmcp = FastMCP()\n\n@mcp.tool\ndef analyze_data(data: str) -> dict:\n    \"\"\"Analyzes the provided data.\"\"\"\n    return {\"result\": f\"Analysis of {data}\"}\n\n# Add custom meta information\nenhanced_tool = Tool.from_tool(\n    analyze_data,\n    name=\"enhanced_analyzer\",\n    meta={\n        \"category\": \"analytics\",\n        \"priority\": \"high\",\n        \"requires_auth\": True\n    }\n)\n\nmcp.add_tool(enhanced_tool)\n```\n\nYou can also remove meta information entirely:\n\n```python {6}\n# Remove meta information from parent tool\nsimplified_tool = Tool.from_tool(\n    analyze_data,\n    name=\"simple_analyzer\", \n    meta=None  # Removes any meta information\n)\n```\n\nIf you don't specify the `meta` parameter, the transformed tool inherits the parent tool's meta information.\n\n### Required Values\n\nIn rare cases where you want to make an optional argument required, you can set `required=True`. This has no effect if the argument was already required.\n\n```python {3}\ntransform_args = {\n    'user_id': ArgTransform(\n        required=True,\n    )\n}\n```\n\n## Modifying Tool Behavior\n\n<Warning>\nWith great power comes great responsibility. Modifying tool behavior is a very advanced feature.\n</Warning>\n\nIn addition to changing a tool's schema, advanced users can also modify its behavior. This is useful for adding validation logic, or for post-processing the tool's output.\n\nThe `from_tool()` method takes a `transform_fn` parameter, which is an async function that replaces the parent tool's logic and gives you complete control over the tool's execution.\n\n### The Transform Function\n\nThe `transform_fn` is an async function that **completely replaces** the parent tool's logic. \n\nCritically, the transform function's arguments are used to determine the new tool's final schema. Any arguments that are not already present in the parent tool schema OR the `transform_args` will be added to the new tool's schema. Note that when `transform_args` and your function have the same argument name, the `transform_args` metadata will take precedence, if provided.\n\n```python\nasync def my_custom_logic(user_input: str, max_length: int = 100) -> str:\n    # Your custom logic here - this completely replaces the parent tool\n    return f\"Custom result for: {user_input[:max_length]}\"\n\nTool.from_tool(transform_fn=my_custom_logic)\n```\n\n<Tip>\nThe name / docstring of the `transform_fn` are ignored. Only its arguments are used to determine the final schema.\n</Tip>\n\n### Calling the Parent Tool\n\nMost of the time, you don't want to completely replace the parent tool's behavior. Instead, you want to add validation, modify inputs, or post-process outputs while still leveraging the parent tool's core functionality. For this, FastMCP provides the special `forward()` and `forward_raw()` functions.\n\nBoth `forward()` and `forward_raw()` are async functions that let you call the parent tool from within your `transform_fn`:\n\n- **`forward()`** (recommended): Automatically handles argument mapping based on your `ArgTransform` configurations. Call it with the transformed argument names.\n- **`forward_raw()`**: Bypasses all transformation and calls the parent tool directly with its original argument names. This is rarely needed unless you're doing complex argument manipulation, perhaps without `arg_transforms`.\n\nThe most common transformation pattern is to validate (potentially renamed) arguments before calling the parent tool. Here's an example that validates that `x` and `y` are positive before calling the parent tool:\n<Tabs>\n<Tab title=\"Using forward()\">\n\nIn the simplest case, your parent tool and your transform function have the same arguments. You can call `forward()` with the same argument names as the parent tool:\n\n```python {15}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import forward\n\nmcp = FastMCP()\n\n@mcp.tool\ndef add(x: int, y: int) -> int:\n    \"\"\"Adds two numbers.\"\"\"\n    return x + y\n\nasync def ensure_positive(x: int, y: int) -> int:\n    if x <= 0 or y <= 0:\n        raise ValueError(\"x and y must be positive\")\n    return await forward(x=x, y=y)\n\nnew_tool = Tool.from_tool(\n    add,\n    transform_fn=ensure_positive,\n)\n\nmcp.add_tool(new_tool)\n```\n</Tab>\n<Tab title=\"Using forward() with renamed args\">\n\nWhen your transformed tool has different argument names than the parent tool, you can call `forward()` with the renamed arguments and it will automatically map the arguments to the parent tool's arguments:\n\n```python {15, 20-23}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import forward\n\nmcp = FastMCP()\n\n@mcp.tool\ndef add(x: int, y: int) -> int:\n    \"\"\"Adds two numbers.\"\"\"\n    return x + y\n\nasync def ensure_positive(a: int, b: int) -> int:\n    if a <= 0 or b <= 0:\n        raise ValueError(\"a and b must be positive\")\n    return await forward(a=a, b=b)\n\nnew_tool = Tool.from_tool(\n    add,\n    transform_fn=ensure_positive,\n    transform_args={\n        \"x\": ArgTransform(name=\"a\"),\n        \"y\": ArgTransform(name=\"b\"),\n    }\n)\n\nmcp.add_tool(new_tool)\n```\n</Tab>\n<Tab title=\"Using forward_raw()\">\nFinally, you can use `forward_raw()` to bypass all argument mapping and call the parent tool directly with its original argument names.\n\n```python {15, 20-23}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import forward\n\nmcp = FastMCP()\n\n@mcp.tool\ndef add(x: int, y: int) -> int:\n    \"\"\"Adds two numbers.\"\"\"\n    return x + y\n\nasync def ensure_positive(a: int, b: int) -> int:\n    if a <= 0 or b <= 0:\n        raise ValueError(\"a and b must be positive\")\n    return await forward_raw(x=a, y=b)\n\nnew_tool = Tool.from_tool(\n    add,\n    transform_fn=ensure_positive,\n    transform_args={\n        \"x\": ArgTransform(name=\"a\"),\n        \"y\": ArgTransform(name=\"b\"),\n    }\n)\n\nmcp.add_tool(new_tool)\n```\n</Tab>\n</Tabs>\n\n### Passing Arguments with **kwargs\n\nIf your `transform_fn` includes `**kwargs` in its signature, it will receive **all arguments from the parent tool after `ArgTransform` configurations have been applied**. This is powerful for creating flexible validation functions that don't require you to add every argument to the function signature.\n\nIn the following example, we wrap a parent tool that accepts two arguments `x` and `y`. These are renamed to `a` and `b` in the transformed tool, and the transform only validates `a`, passing the other argument through as `**kwargs`.\n\n```python {12, 15}\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import forward, ArgTransform\n\nmcp = FastMCP()\n\n@mcp.tool\ndef add(x: int, y: int) -> int:\n    \"\"\"Adds two numbers.\"\"\"\n    return x + y\n\nasync def ensure_a_positive(a: int, **kwargs) -> int:\n    if a <= 0:\n        raise ValueError(\"a must be positive\")\n    return await forward(a=a, **kwargs)\n\nnew_tool = Tool.from_tool(\n    add,\n    transform_fn=ensure_a_positive,\n    transform_args={\n        \"x\": ArgTransform(name=\"a\"),\n        \"y\": ArgTransform(name=\"b\"),\n    }\n)\n\nmcp.add_tool(new_tool)\n```\n\n<Tip>\nIn the above example, `**kwargs` receives the renamed argument `b`, not the original argument `y`. It is therefore recommended to use with `forward()`, not `forward_raw()`.\n</Tip>\n\n## Modifying MCP Tools with MCPConfig\n\nWhen running MCP Servers under FastMCP with `MCPConfig`, you can also apply a subset of tool transformations\ndirectly in the MCPConfig json file.\n\n```json\n{\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": {\n                \"weather_get_forecast\": {\n                    \"name\": \"miami_weather\",\n                    \"description\": \"Get the weather for Miami\",\n                    \"meta\": {\n                        \"category\": \"weather\",\n                        \"location\": \"miami\"\n                    },\n                    \"arguments\": {\n                        \"city\": {\n                            \"name\": \"city\",\n                            \"default\": \"Miami\",\n                            \"hide\": True,\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nThe `tools` section is a dictionary of tool names to tool configurations. Each tool configuration is a\ndictionary of tool properties.\n\nSee the [MCPConfigTransport](/clients/transports#tool-transformation-with-fastmcp-and-mcpconfig) documentation for more details.\n\n\n## Output Schema Control\n\n<VersionBadge version=\"2.10.0\" />\n\nTransformed tools inherit output schemas from their parent by default, but you can control this behavior:\n\n**Inherit from Parent (Default)**\n```python\nTool.from_tool(parent_tool, name=\"renamed_tool\")\n```\nThe transformed tool automatically uses the parent tool's output schema and structured output behavior.\n\n**Custom Output Schema**\n```python\nTool.from_tool(parent_tool, output_schema={\n    \"type\": \"object\", \n    \"properties\": {\"status\": {\"type\": \"string\"}}\n})\n```\nProvide your own schema that differs from the parent. The tool must return data matching this schema.\n\n**Remove Output Schema**\n```python\nTool.from_tool(parent_tool, output_schema=None)\n```\nRemoves the output schema declaration. Automatic structured content still works for object-like returns (dict, dataclass, Pydantic models) but primitive types won't be structured.\n\n**Full Control with Transform Functions**\n```python\nasync def custom_output(**kwargs) -> ToolResult:\n    result = await forward(**kwargs)\n    return ToolResult(content=[...], structured_content={...})\n\nTool.from_tool(parent_tool, transform_fn=custom_output)\n```\nUse a transform function returning `ToolResult` for complete control over both content blocks and structured outputs.\n\n## Common Patterns\n\nTool transformation is a flexible feature that supports many powerful patterns. Here are a few common use cases to give you ideas.\n\n### Exposing Client Methods as Tools\n\nA powerful use case for tool transformation is exposing methods from existing Python clients (GitHub clients, API clients, database clients, etc.) directly as MCP tools. This pattern eliminates boilerplate wrapper functions and treats tools as annotations around client methods.\n\n**Without Tool Transformation**, you typically create wrapper functions that duplicate annotations:\n\n```python\nasync def get_repository(\n    owner: Annotated[str, \"The owner of the repository.\"],\n    repo: Annotated[str, \"The name of the repository.\"],\n) -> Repository:\n    \"\"\"Get basic information about a GitHub repository.\"\"\"\n    return await github_client.get_repository(owner=owner, repo=repo)\n```\n\n**With Tool Transformation**, you can wrap the client method directly:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP(\"GitHub Tools\")\n\n# Wrap a client method directly as a tool\nget_repo_tool = Tool.from_tool(\n    tool=Tool.from_function(fn=github_client.get_repository),\n    description=\"Get basic information about a GitHub repository.\",\n    transform_args={\n        \"owner\": ArgTransform(description=\"The owner of the repository.\"),\n        \"repo\": ArgTransform(description=\"The name of the repository.\"),\n    }\n)\n\nmcp.add_tool(get_repo_tool)\n```\n\nThis pattern keeps the implementation in your client and treats the tool as an annotation layer, avoiding duplicate code.\n\n#### Hiding Client-Specific Arguments\n\nClient methods often have internal parameters (debug flags, auth tokens, rate limit settings) that shouldn't be exposed to LLMs. Use `hide=True` with a default value to handle these automatically:\n\n```python\nget_issues_tool = Tool.from_tool(\n    tool=Tool.from_function(fn=github_client.get_issues),\n    description=\"Get issues from a GitHub repository.\",\n    transform_args={\n        \"owner\": ArgTransform(description=\"The owner of the repository.\"),\n        \"repo\": ArgTransform(description=\"The name of the repository.\"),\n        \"limit\": ArgTransform(description=\"Maximum number of issues to return.\"),\n        # Hide internal parameters\n        \"include_debug_info\": ArgTransform(hide=True, default=False),\n        \"error_on_not_found\": ArgTransform(hide=True, default=True),\n    }\n)\n\nmcp.add_tool(get_issues_tool)\n```\n\nThe LLM only sees `owner`, `repo`, and `limit`. Internal parameters are supplied automatically.\n\n#### Reusable Argument Patterns\n\nWhen wrapping multiple client methods, you can define reusable argument transformations. This scales well for larger tool sets and keeps annotations consistent:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.tools import Tool\nfrom fastmcp.tools.tool_transform import ArgTransform\n\nmcp = FastMCP(\"GitHub Tools\")\n\n# Define reusable argument patterns\nOWNER_ARG = ArgTransform(description=\"The repository owner.\")\nREPO_ARG = ArgTransform(description=\"The repository name.\")\nLIMIT_ARG = ArgTransform(description=\"Maximum number of items to return.\")\nHIDE_ERROR = ArgTransform(hide=True, default=True)\n\ndef create_github_tools(client):\n    \"\"\"Create tools from GitHub client methods with shared argument patterns.\"\"\"\n\n    owner_repo_args = {\n        \"owner\": OWNER_ARG,\n        \"repo\": REPO_ARG,\n    }\n\n    error_args = {\n        \"error_on_not_found\": HIDE_ERROR,\n    }\n\n    return [\n        Tool.from_tool(\n            tool=Tool.from_function(fn=client.get_repository),\n            description=\"Get basic information about a GitHub repository.\",\n            transform_args={**owner_repo_args, **error_args}\n        ),\n        Tool.from_tool(\n            tool=Tool.from_function(fn=client.get_issue),\n            description=\"Get a specific issue from a repository.\",\n            transform_args={\n                **owner_repo_args,\n                \"issue_number\": ArgTransform(description=\"The issue number.\"),\n                \"limit_comments\": LIMIT_ARG,\n                **error_args,\n            }\n        ),\n        Tool.from_tool(\n            tool=Tool.from_function(fn=client.get_pull_request),\n            description=\"Get a specific pull request from a repository.\",\n            transform_args={\n                **owner_repo_args,\n                \"pull_request_number\": ArgTransform(description=\"The PR number.\"),\n                \"limit_comments\": LIMIT_ARG,\n                **error_args,\n            }\n        ),\n    ]\n\n# Add all tools to the server\nfor tool in create_github_tools(github_client):\n    mcp.add_tool(tool)\n```\n\nThis pattern provides several benefits:\n\n- **No duplicate implementation**: Logic stays in the client\n- **Consistent annotations**: Reusable argument patterns ensure consistency\n- **Easy maintenance**: Update the client, not wrapper functions\n- **Scalable**: Easily add new tools by wrapping additional client methods\n\n### Adapting Remote or Generated Tools\nThis is one of the most common reasons to use tool transformation. Tools from remote MCP servers (via a [proxy](/servers/proxy)) or generated from an [OpenAPI spec](/integrations/openapi) are often too generic for direct use by an LLM. You can use transformation to create a simpler, more intuitive version for your specific needs.\n\n### Chaining Transformations\nYou can chain transformations by using an already transformed tool as the parent for a new transformation. This lets you build up complex behaviors in layers, for example, first renaming arguments, and then adding validation logic to the renamed tool.\n\n### Context-Aware Tool Factories\nYou can write functions that act as \"factories,\" generating specialized versions of a tool for different contexts. For example, you could create a `get_my_data` tool that is specific to the currently logged-in user by hiding the `user_id` parameter and providing it automatically.\n"}, {"filename": "docs/python-sdk/fastmcp-cli-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.cli`\n\n\nFastMCP CLI package.\n"}, {"filename": "docs/python-sdk/fastmcp-cli-cli.mdx", "content": "---\ntitle: cli\nsidebarTitle: cli\n---\n\n# `fastmcp.cli.cli`\n\n\nFastMCP CLI tools using Cyclopts.\n\n## Functions\n\n### `with_argv` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L66\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwith_argv(args: list[str] | None)\n```\n\n\nTemporarily replace sys.argv if args provided.\n\nThis context manager is used at the CLI boundary to inject\nserver arguments when needed, without mutating sys.argv deep\nin the source loading logic.\n\nArgs are provided without the script name, so we preserve sys.argv[0]\nand replace the rest.\n\n\n### `version` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nversion()\n```\n\n\nDisplay version information and platform details.\n\n\n### `dev` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndev(server_spec: str | None = None) -> None\n```\n\n\nRun an MCP server with the MCP Inspector for development.\n\n**Args:**\n- `server_spec`: Python file to run, optionally with \\:object suffix, or None to auto-detect fastmcp.json\n\n\n### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L287\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(server_spec: str | None = None, *server_args: str) -> None\n```\n\n\nRun an MCP server or connect to a remote one.\n\nThe server can be specified in several ways:\n1. Module approach: \"server.py\" - runs the module directly, looking for an object named 'mcp', 'server', or 'app'\n2. Import approach: \"server.py:app\" - imports and runs the specified server object\n3. URL approach: \"http://server-url\" - connects to a remote server and creates a proxy\n4. MCPConfig file: \"mcp.json\" - runs as a proxy server for the MCP Servers in the MCPConfig file\n5. FastMCP config: \"fastmcp.json\" - runs server using FastMCP configuration\n6. No argument: looks for fastmcp.json in current directory\n\nServer arguments can be passed after -- :\nfastmcp run server.py -- --config config.json --debug\n\n**Args:**\n- `server_spec`: Python file, object specification (file\\:obj), config file, URL, or None to auto-detect\n\n\n### `inspect` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L521\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninspect(server_spec: str | None = None) -> None\n```\n\n\nInspect an MCP server and display information or generate a JSON report.\n\nThis command analyzes an MCP server. Without flags, it displays a text summary.\nUse --format to output complete JSON data.\n\n**Examples:**\n\n# Show text summary\nfastmcp inspect server.py\n\n# Output FastMCP format JSON to stdout\nfastmcp inspect server.py --format fastmcp\n\n# Save MCP protocol format to file (format required with -o)\nfastmcp inspect server.py --format mcp -o manifest.json\n\n# Inspect from fastmcp.json configuration\nfastmcp inspect fastmcp.json\nfastmcp inspect  # auto-detect fastmcp.json\n\n**Args:**\n- `server_spec`: Python file to inspect, optionally with \\:object suffix, or fastmcp.json\n\n\n### `prepare` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/cli.py#L766\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare(config_path: Annotated[str | None, cyclopts.Parameter(help='Path to fastmcp.json configuration file')] = None, output_dir: Annotated[str | None, cyclopts.Parameter(help='Directory to create the persistent environment in')] = None, skip_source: Annotated[bool, cyclopts.Parameter(help='Skip source preparation (e.g., git clone)')] = False) -> None\n```\n\n\nPrepare a FastMCP project by creating a persistent uv environment.\n\nThis command creates a persistent uv project with all dependencies installed:\n- Creates a pyproject.toml with dependencies from the config\n- Installs all Python packages into a .venv\n- Prepares the source (git clone, download, etc.) unless --skip-source\n\nAfter running this command, you can use:\nfastmcp run &lt;config&gt; --project &lt;output-dir&gt;\n\nThis is useful for:\n- CI/CD pipelines with separate build and run stages\n- Docker images where you prepare during build\n- Production deployments where you want fast startup times\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.cli.install`\n\n\nInstall subcommands for FastMCP CLI using Cyclopts.\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-claude_code.mdx", "content": "---\ntitle: claude_code\nsidebarTitle: claude_code\n---\n\n# `fastmcp.cli.install.claude_code`\n\n\nClaude Code integration for FastMCP install using Cyclopts.\n\n## Functions\n\n### `find_claude_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_code.py#L20\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfind_claude_command() -> str | None\n```\n\n\nFind the Claude Code CLI command.\n\nChecks common installation locations since 'claude' is often a shell alias\nthat doesn't work with subprocess calls.\n\n\n### `check_claude_code_available` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_code.py#L68\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncheck_claude_code_available() -> bool\n```\n\n\nCheck if Claude Code CLI is available.\n\n\n### `install_claude_code` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_code.py#L73\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_claude_code(file: Path, server_object: str | None, name: str) -> bool\n```\n\n\nInstall FastMCP server in Claude Code.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in Claude Code\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n\n**Returns:**\n- True if installation was successful, False otherwise\n\n\n### `claude_code_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_code.py#L153\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclaude_code_command(server_spec: str) -> None\n```\n\n\nInstall an MCP server in Claude Code.\n\n**Args:**\n- `server_spec`: Python file to install, optionally with \\:object suffix\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-claude_desktop.mdx", "content": "---\ntitle: claude_desktop\nsidebarTitle: claude_desktop\n---\n\n# `fastmcp.cli.install.claude_desktop`\n\n\nClaude Desktop integration for FastMCP install using Cyclopts.\n\n## Functions\n\n### `get_claude_config_path` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_desktop.py#L20\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_claude_config_path() -> Path | None\n```\n\n\nGet the Claude config directory based on platform.\n\n\n### `install_claude_desktop` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_desktop.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_claude_desktop(file: Path, server_object: str | None, name: str) -> bool\n```\n\n\nInstall FastMCP server in Claude Desktop.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in Claude's config\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n\n**Returns:**\n- True if installation was successful, False otherwise\n\n\n### `claude_desktop_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/claude_desktop.py#L125\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclaude_desktop_command(server_spec: str) -> None\n```\n\n\nInstall an MCP server in Claude Desktop.\n\n**Args:**\n- `server_spec`: Python file to install, optionally with \\:object suffix\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-cursor.mdx", "content": "---\ntitle: cursor\nsidebarTitle: cursor\n---\n\n# `fastmcp.cli.install.cursor`\n\n\nCursor integration for FastMCP install using Cyclopts.\n\n## Functions\n\n### `generate_cursor_deeplink` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/cursor.py#L23\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_cursor_deeplink(server_name: str, server_config: StdioMCPServer) -> str\n```\n\n\nGenerate a Cursor deeplink for installing the MCP server.\n\n**Args:**\n- `server_name`: Name of the server\n- `server_config`: Server configuration\n\n**Returns:**\n- Deeplink URL that can be clicked to install the server\n\n\n### `open_deeplink` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/cursor.py#L48\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nopen_deeplink(deeplink: str) -> bool\n```\n\n\nAttempt to open a deeplink URL using the system's default handler.\n\n**Args:**\n- `deeplink`: The deeplink URL to open\n\n**Returns:**\n- True if the command succeeded, False otherwise\n\n\n### `install_cursor_workspace` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/cursor.py#L74\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_cursor_workspace(file: Path, server_object: str | None, name: str, workspace_path: Path) -> bool\n```\n\n\nInstall FastMCP server to workspace-specific Cursor configuration.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in Cursor\n- `workspace_path`: Path to the workspace directory\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n\n**Returns:**\n- True if installation was successful, False otherwise\n\n\n### `install_cursor` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/cursor.py#L155\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_cursor(file: Path, server_object: str | None, name: str) -> bool\n```\n\n\nInstall FastMCP server in Cursor.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in Cursor\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n- `workspace`: Optional workspace directory for project-specific installation\n\n**Returns:**\n- True if installation was successful, False otherwise\n\n\n### `cursor_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/cursor.py#L240\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncursor_command(server_spec: str) -> None\n```\n\n\nInstall an MCP server in Cursor.\n\n**Args:**\n- `server_spec`: Python file to install, optionally with \\:object suffix\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-gemini_cli.mdx", "content": "---\ntitle: gemini_cli\nsidebarTitle: gemini_cli\n---\n\n# `fastmcp.cli.install.gemini_cli`\n\n\nGemini CLI integration for FastMCP install using Cyclopts.\n\n## Functions\n\n### `find_gemini_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/gemini_cli.py#L20\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfind_gemini_command() -> str | None\n```\n\n\nFind the Gemini CLI command.\n\n\n### `check_gemini_cli_available` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/gemini_cli.py#L64\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncheck_gemini_cli_available() -> bool\n```\n\n\nCheck if Gemini CLI is available.\n\n\n### `install_gemini_cli` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/gemini_cli.py#L69\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_gemini_cli(file: Path, server_object: str | None, name: str) -> bool\n```\n\n\nInstall FastMCP server in Gemini CLI.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in Gemini CLI\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n\n**Returns:**\n- True if installation was successful, False otherwise\n\n\n### `gemini_cli_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/gemini_cli.py#L150\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngemini_cli_command(server_spec: str) -> None\n```\n\n\nInstall an MCP server in Gemini CLI.\n\n**Args:**\n- `server_spec`: Python file to install, optionally with \\:object suffix\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-mcp_json.mdx", "content": "---\ntitle: mcp_json\nsidebarTitle: mcp_json\n---\n\n# `fastmcp.cli.install.mcp_json`\n\n\nMCP configuration JSON generation for FastMCP install using Cyclopts.\n\n## Functions\n\n### `install_mcp_json` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/mcp_json.py#L20\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstall_mcp_json(file: Path, server_object: str | None, name: str) -> bool\n```\n\n\nGenerate MCP configuration JSON for manual installation.\n\n**Args:**\n- `file`: Path to the server file\n- `server_object`: Optional server object name (for \\:object suffix)\n- `name`: Name for the server in MCP config\n- `with_editable`: Optional list of directories to install in editable mode\n- `with_packages`: Optional list of additional packages to install\n- `env_vars`: Optional dictionary of environment variables\n- `copy`: If True, copy to clipboard instead of printing to stdout\n- `python_version`: Optional Python version to use\n- `with_requirements`: Optional requirements file to install from\n- `project`: Optional project directory to run within\n\n**Returns:**\n- True if generation was successful, False otherwise\n\n\n### `mcp_json_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/mcp_json.py#L98\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmcp_json_command(server_spec: str) -> None\n```\n\n\nGenerate MCP configuration JSON for manual installation.\n\n**Args:**\n- `server_spec`: Python file to install, optionally with \\:object suffix\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-install-shared.mdx", "content": "---\ntitle: shared\nsidebarTitle: shared\n---\n\n# `fastmcp.cli.install.shared`\n\n\nShared utilities for install commands.\n\n## Functions\n\n### `parse_env_var` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/shared.py#L18\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_env_var(env_var: str) -> tuple[str, str]\n```\n\n\nParse environment variable string in format KEY=VALUE.\n\n\n### `process_common_args` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/install/shared.py#L29\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprocess_common_args(server_spec: str, server_name: str | None, with_packages: list[str] | None, env_vars: list[str] | None, env_file: Path | None) -> tuple[Path, str | None, str, list[str], dict[str, str] | None]\n```\n\n\nProcess common arguments shared by all install commands.\n\nHandles both fastmcp.json config files and traditional file.py:object syntax.\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-run.mdx", "content": "---\ntitle: run\nsidebarTitle: run\n---\n\n# `fastmcp.cli.run`\n\n\nFastMCP run command implementation with enhanced type hints.\n\n## Functions\n\n### `is_url` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L25\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_url(path: str) -> bool\n```\n\n\nCheck if a string is a URL.\n\n\n### `create_client_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L31\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_client_server(url: str) -> Any\n```\n\n\nCreate a FastMCP server from a client URL.\n\n**Args:**\n- `url`: The URL to connect to\n\n**Returns:**\n- A FastMCP server instance\n\n\n### `create_mcp_config_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L51\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_mcp_config_server(mcp_config_path: Path) -> FastMCP[None]\n```\n\n\nCreate a FastMCP server from a MCPConfig.\n\n\n### `load_mcp_server_config` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L62\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_mcp_server_config(config_path: Path) -> MCPServerConfig\n```\n\n\nLoad a FastMCP configuration from a fastmcp.json file.\n\n**Args:**\n- `config_path`: Path to fastmcp.json file\n\n**Returns:**\n- MCPServerConfig object\n\n\n### `run_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L79\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_command(server_spec: str, transport: TransportType | None = None, host: str | None = None, port: int | None = None, path: str | None = None, log_level: LogLevelType | None = None, server_args: list[str] | None = None, show_banner: bool = True, use_direct_import: bool = False, skip_source: bool = False) -> None\n```\n\n\nRun a MCP server or connect to a remote one.\n\n**Args:**\n- `server_spec`: Python file, object specification (file\\:obj), config file, or URL\n- `transport`: Transport protocol to use\n- `host`: Host to bind to when using http transport\n- `port`: Port to bind to when using http transport\n- `path`: Path to bind to when using http transport\n- `log_level`: Log level\n- `server_args`: Additional arguments to pass to the server\n- `show_banner`: Whether to show the server banner\n- `use_direct_import`: Whether to use direct import instead of subprocess\n- `skip_source`: Whether to skip source preparation step\n\n\n### `run_v1_server_async` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/run.py#L200\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_v1_server_async(server: FastMCP1x, host: str | None = None, port: int | None = None, transport: TransportType | None = None) -> None\n```\n\n\nRun a FastMCP 1.x server using async methods.\n\n**Args:**\n- `server`: FastMCP 1.x server instance\n- `host`: Host to bind to\n- `port`: Port to bind to\n- `transport`: Transport protocol to use\n\n"}, {"filename": "docs/python-sdk/fastmcp-cli-tasks.mdx", "content": "---\ntitle: tasks\nsidebarTitle: tasks\n---\n\n# `fastmcp.cli.tasks`\n\n\nFastMCP tasks CLI for Docket task management.\n\n## Functions\n\n### `check_distributed_backend` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/tasks.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncheck_distributed_backend() -> None\n```\n\n\nCheck if Docket is configured with a distributed backend.\n\nThe CLI worker runs as a separate process, so it needs Redis/Valkey\nto coordinate with the main server process.\n\n**Raises:**\n- `SystemExit`: If using memory\\:// URL\n\n\n### `worker` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/cli/tasks.py#L61\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nworker(server_spec: Annotated[str | None, cyclopts.Parameter(help='Python file to run, optionally with :object suffix, or None to auto-detect fastmcp.json')] = None) -> None\n```\n\n\nStart an additional worker to process background tasks.\n\nConnects to your Docket backend and processes tasks in parallel with\nany other running workers. Configure via environment variables\n(FASTMCP_DOCKET_*).\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.client`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-client-auth-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.client.auth`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-client-auth-bearer.mdx", "content": "---\ntitle: bearer\nsidebarTitle: bearer\n---\n\n# `fastmcp.client.auth.bearer`\n\n## Classes\n\n### `BearerAuth` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/bearer.py#L11\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `auth_flow` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/bearer.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nauth_flow(self, request)\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-auth-oauth.mdx", "content": "---\ntitle: oauth\nsidebarTitle: oauth\n---\n\n# `fastmcp.client.auth.oauth`\n\n## Functions\n\n### `check_if_auth_required` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncheck_if_auth_required(mcp_url: str, httpx_kwargs: dict[str, Any] | None = None) -> bool\n```\n\n\nCheck if the MCP endpoint requires authentication by making a test request.\n\n**Returns:**\n- True if auth appears to be required, False otherwise\n\n\n## Classes\n\n### `ClientNotFoundError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L36\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRaised when OAuth client credentials are not found on the server.\n\n\n### `TokenStorageAdapter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L70\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `clear` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L98\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclear(self) -> None\n```\n\n#### `get_tokens` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L103\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tokens(self) -> OAuthToken | None\n```\n\n#### `set_tokens` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L107\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_tokens(self, tokens: OAuthToken) -> None\n```\n\n#### `get_client_info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L115\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_client_info(self) -> OAuthClientInformationFull | None\n```\n\n#### `set_client_info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L121\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_client_info(self, client_info: OAuthClientInformationFull) -> None\n```\n\n### `OAuth` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L134\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth client provider for MCP servers with browser-based authentication.\n\nThis class provides OAuth authentication for FastMCP clients by opening\na browser for user authorization and running a local callback server.\n\n\n**Methods:**\n\n#### `redirect_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L229\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nredirect_handler(self, authorization_url: str) -> None\n```\n\nOpen browser for authorization, with pre-flight check for invalid client.\n\n\n#### `callback_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L250\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncallback_handler(self) -> tuple[str, str | None]\n```\n\nHandle OAuth callback and return (auth_code, state).\n\n\n#### `async_auth_flow` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/auth/oauth.py#L289\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nasync_auth_flow(self, request: httpx.Request) -> AsyncGenerator[httpx.Request, httpx.Response]\n```\n\nHTTPX auth flow with automatic retry on stale cached credentials.\n\nIf the OAuth flow fails due to invalid/stale client credentials,\nclears the cache and retries once with fresh registration.\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-client.mdx", "content": "---\ntitle: client\nsidebarTitle: client\n---\n\n# `fastmcp.client.client`\n\n## Classes\n\n### `ClientSessionState` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nHolds all session-related state for a Client instance.\n\nThis allows clean separation of configuration (which is copied) from\nsession state (which should be fresh for each new client instance).\n\n\n### `CallToolResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L117\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nParsed result from a tool call.\n\n\n### `Client` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMCP client that delegates connection management to a Transport instance.\n\nThe Client class is responsible for MCP protocol logic, while the Transport\nhandles connection establishment and management. Client provides methods for\nworking with resources, prompts, tools and other MCP capabilities.\n\nThis client supports reentrant context managers (multiple concurrent\n`async with client:` blocks) using reference counting and background session\nmanagement. This allows efficient session reuse in any scenario with\nnested or concurrent client usage.\n\nMCP SDK 1.10 introduced automatic list_tools() calls during call_tool()\nexecution. This created a race condition where events could be reset while\nother tasks were waiting on them, causing deadlocks. The issue was exposed\nin proxy scenarios but affects any reentrant usage.\n\nThe solution uses reference counting to track active context managers,\na background task to manage the session lifecycle, events to coordinate\nbetween tasks, and ensures all session state changes happen within a lock.\nEvents are only created when needed, never reset outside locks.\n\nThis design prevents race conditions where tasks wait on events that get\nreplaced by other tasks, ensuring reliable coordination in concurrent scenarios.\n\n**Args:**\n- `transport`: \nConnection source specification, which can be\\:\n\n    - ClientTransport\\: Direct transport instance\n    - FastMCP\\: In-process FastMCP server\n    - AnyUrl or str\\: URL to connect to\n    - Path\\: File path for local socket\n    - MCPConfig\\: MCP server configuration\n    - dict\\: Transport configuration\n- `roots`: Optional RootsList or RootsHandler for filesystem access\n- `sampling_handler`: Optional handler for sampling requests\n- `log_handler`: Optional handler for log messages\n- `message_handler`: Optional handler for protocol messages\n- `progress_handler`: Optional handler for progress notifications\n- `timeout`: Optional timeout for requests (seconds or timedelta)\n- `init_timeout`: Optional timeout for initial connection (seconds or timedelta).\nSet to 0 to disable. If None, uses the value in the FastMCP global settings.\n\n**Examples:**\n\n```python\n# Connect to FastMCP server\nclient = Client(\"http://localhost:8080\")\n\nasync with client:\n    # List available resources\n    resources = await client.list_resources()\n\n    # Call a tool\n    result = await client.call_tool(\"my_tool\", {\"param\": \"value\"})\n```\n\n\n**Methods:**\n\n#### `session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L349\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsession(self) -> ClientSession\n```\n\nGet the current active session. Raises RuntimeError if not connected.\n\n\n#### `initialize_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L359\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninitialize_result(self) -> mcp.types.InitializeResult | None\n```\n\nGet the result of the initialization request.\n\n\n#### `set_roots` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L363\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_roots(self, roots: RootsList | RootsHandler) -> None\n```\n\nSet the roots for the client. This does not automatically call `send_roots_list_changed`.\n\n\n#### `set_sampling_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L367\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_sampling_callback(self, sampling_callback: SamplingHandler, sampling_capabilities: mcp.types.SamplingCapability | None = None) -> None\n```\n\nSet the sampling callback for the client.\n\n\n#### `set_elicitation_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L383\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_elicitation_callback(self, elicitation_callback: ElicitationHandler) -> None\n```\n\nSet the elicitation callback for the client.\n\n\n#### `is_connected` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L391\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_connected(self) -> bool\n```\n\nCheck if the client is currently connected.\n\n\n#### `new` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L395\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nnew(self) -> Client[ClientTransportT]\n```\n\nCreate a new client instance with the same configuration but fresh session state.\n\nThis creates a new client with the same transport, handlers, and configuration,\nbut with no active session. Useful for creating independent sessions that don't\nshare state with the original client.\n\n**Returns:**\n- A new Client instance with the same configuration but disconnected state.\n\n\n#### `initialize` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L440\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninitialize(self, timeout: datetime.timedelta | float | int | None = None) -> mcp.types.InitializeResult\n```\n\nSend an initialize request to the server.\n\nThis method performs the MCP initialization handshake with the server,\nexchanging capabilities and server information. It is idempotent - calling\nit multiple times returns the cached result from the first call.\n\nThe initialization happens automatically when entering the client context\nmanager unless `auto_initialize=False` was set during client construction.\nManual calls to this method are only needed when auto-initialization is disabled.\n\n**Args:**\n- `timeout`: Optional timeout for the initialization request (seconds or timedelta).\nIf None, uses the client's init_timeout setting.\n\n**Returns:**\n- The server's initialization response containing server info,\ncapabilities, protocol version, and optional instructions.\n\n**Raises:**\n- `RuntimeError`: If the client is not connected or initialization times out.\n\n\n#### `close` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L680\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose(self)\n```\n\n#### `ping` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L686\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nping(self) -> bool\n```\n\nSend a ping request.\n\n\n#### `cancel` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L691\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncancel(self, request_id: str | int, reason: str | None = None) -> None\n```\n\nSend a cancellation notification for an in-progress request.\n\n\n#### `progress` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L708\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprogress(self, progress_token: str | int, progress: float, total: float | None = None, message: str | None = None) -> None\n```\n\nSend a progress notification.\n\n\n#### `set_logging_level` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L720\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_logging_level(self, level: mcp.types.LoggingLevel) -> None\n```\n\nSend a logging/setLevel request.\n\n\n#### `send_roots_list_changed` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L724\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsend_roots_list_changed(self) -> None\n```\n\nSend a roots/list_changed notification.\n\n\n#### `list_resources_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L730\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources_mcp(self) -> mcp.types.ListResourcesResult\n```\n\nSend a resources/list request and return the complete MCP protocol result.\n\n**Returns:**\n- mcp.types.ListResourcesResult: The complete response object from the protocol,\ncontaining the list of resources and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L746\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> list[mcp.types.Resource]\n```\n\nRetrieve a list of resources available on the server.\n\n**Returns:**\n- list\\[mcp.types.Resource]: A list of Resource objects.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_resource_templates_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L759\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates_mcp(self) -> mcp.types.ListResourceTemplatesResult\n```\n\nSend a resources/listResourceTemplates request and return the complete MCP protocol result.\n\n**Returns:**\n- mcp.types.ListResourceTemplatesResult: The complete response object from the protocol,\ncontaining the list of resource templates and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L777\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> list[mcp.types.ResourceTemplate]\n```\n\nRetrieve a list of resource templates available on the server.\n\n**Returns:**\n- list\\[mcp.types.ResourceTemplate]: A list of ResourceTemplate objects.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `read_resource_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L792\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource_mcp(self, uri: AnyUrl | str, meta: dict[str, Any] | None = None) -> mcp.types.ReadResourceResult\n```\n\nSend a resources/read request and return the complete MCP protocol result.\n\n**Args:**\n- `uri`: The URI of the resource to read. Can be a string or an AnyUrl object.\n- `meta`: Request metadata (e.g., for SEP-1686 tasks). Defaults to None.\n\n**Returns:**\n- mcp.types.ReadResourceResult: The complete response object from the protocol,\ncontaining the resource contents and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L834\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource(self, uri: AnyUrl | str) -> list[mcp.types.TextResourceContents | mcp.types.BlobResourceContents]\n```\n\n#### `read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L842\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource(self, uri: AnyUrl | str) -> ResourceTask\n```\n\n#### `read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L851\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource(self, uri: AnyUrl | str) -> list[mcp.types.TextResourceContents | mcp.types.BlobResourceContents] | ResourceTask\n```\n\nRead the contents of a resource or resolved template.\n\n**Args:**\n- `uri`: The URI of the resource to read. Can be a string or an AnyUrl object.\n- `task`: If True, execute as background task (SEP-1686). Defaults to False.\n- `task_id`: Optional client-provided task ID (auto-generated if not provided).\n- `ttl`: Time to keep results available in milliseconds (default 60s).\n\n**Returns:**\n- list\\[mcp.types.TextResourceContents | mcp.types.BlobResourceContents] | ResourceTask:\nA list of content objects if task=False, or a ResourceTask object if task=True.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_prompts_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L964\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts_mcp(self) -> mcp.types.ListPromptsResult\n```\n\nSend a prompts/list request and return the complete MCP protocol result.\n\n**Returns:**\n- mcp.types.ListPromptsResult: The complete response object from the protocol,\ncontaining the list of prompts and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L980\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> list[mcp.types.Prompt]\n```\n\nRetrieve a list of prompts available on the server.\n\n**Returns:**\n- list\\[mcp.types.Prompt]: A list of Prompt objects.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `get_prompt_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L994\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt_mcp(self, name: str, arguments: dict[str, Any] | None = None, meta: dict[str, Any] | None = None) -> mcp.types.GetPromptResult\n```\n\nSend a prompts/get request and return the complete MCP protocol result.\n\n**Args:**\n- `name`: The name of the prompt to retrieve.\n- `arguments`: Arguments to pass to the prompt. Defaults to None.\n- `meta`: Request metadata (e.g., for SEP-1686 tasks). Defaults to None.\n\n**Returns:**\n- mcp.types.GetPromptResult: The complete response object from the protocol,\ncontaining the prompt messages and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1053\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str, arguments: dict[str, Any] | None = None) -> mcp.types.GetPromptResult\n```\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1062\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str, arguments: dict[str, Any] | None = None) -> PromptTask\n```\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1072\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str, arguments: dict[str, Any] | None = None) -> mcp.types.GetPromptResult | PromptTask\n```\n\nRetrieve a rendered prompt message list from the server.\n\n**Args:**\n- `name`: The name of the prompt to retrieve.\n- `arguments`: Arguments to pass to the prompt. Defaults to None.\n- `task`: If True, execute as background task (SEP-1686). Defaults to False.\n- `task_id`: Optional client-provided task ID (auto-generated if not provided).\n- `ttl`: Time to keep results available in milliseconds (default 60s).\n\n**Returns:**\n- mcp.types.GetPromptResult | PromptTask: The complete response object if task=False,\nor a PromptTask object if task=True.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `complete_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1174\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncomplete_mcp(self, ref: mcp.types.ResourceTemplateReference | mcp.types.PromptReference, argument: dict[str, str], context_arguments: dict[str, Any] | None = None) -> mcp.types.CompleteResult\n```\n\nSend a completion request and return the complete MCP protocol result.\n\n**Args:**\n- `ref`: The reference to complete.\n- `argument`: Arguments to pass to the completion request.\n- `context_arguments`: Optional context arguments to\ninclude with the completion request. Defaults to None.\n\n**Returns:**\n- mcp.types.CompleteResult: The complete response object from the protocol,\ncontaining the completion and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `complete` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1203\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncomplete(self, ref: mcp.types.ResourceTemplateReference | mcp.types.PromptReference, argument: dict[str, str], context_arguments: dict[str, Any] | None = None) -> mcp.types.Completion\n```\n\nSend a completion request to the server.\n\n**Args:**\n- `ref`: The reference to complete.\n- `argument`: Arguments to pass to the completion request.\n- `context_arguments`: Optional context arguments to\ninclude with the completion request. Defaults to None.\n\n**Returns:**\n- mcp.types.Completion: The completion object.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_tools_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1231\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools_mcp(self) -> mcp.types.ListToolsResult\n```\n\nSend a tools/list request and return the complete MCP protocol result.\n\n**Returns:**\n- mcp.types.ListToolsResult: The complete response object from the protocol,\ncontaining the list of tools and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1247\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> list[mcp.types.Tool]\n```\n\nRetrieve a list of tools available on the server.\n\n**Returns:**\n- list\\[mcp.types.Tool]: A list of Tool objects.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `call_tool_mcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1262\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncall_tool_mcp(self, name: str, arguments: dict[str, Any], progress_handler: ProgressHandler | None = None, timeout: datetime.timedelta | float | int | None = None, meta: dict[str, Any] | None = None) -> mcp.types.CallToolResult\n```\n\nSend a tools/call request and return the complete MCP protocol result.\n\nThis method returns the raw CallToolResult object, which includes an isError flag\nand other metadata. It does not raise an exception if the tool call results in an error.\n\n**Args:**\n- `name`: The name of the tool to call.\n- `arguments`: Arguments to pass to the tool.\n- `timeout`: The timeout for the tool call. Defaults to None.\n- `progress_handler`: The progress handler to use for the tool call. Defaults to None.\n- `meta`: Additional metadata to include with the request.\nThis is useful for passing contextual information (like user IDs, trace IDs, or preferences)\nthat shouldn't be tool arguments but may influence server-side processing. The server\ncan access this via `context.request_context.meta`. Defaults to None.\n\n**Returns:**\n- mcp.types.CallToolResult: The complete response object from the protocol,\ncontaining the tool result and any additional metadata.\n\n**Raises:**\n- `RuntimeError`: If called while the client is not connected.\n- `McpError`: If the tool call requests results in a TimeoutError | JSONRPCError\n\n\n#### `call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1356\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncall_tool(self, name: str, arguments: dict[str, Any] | None = None) -> CallToolResult\n```\n\n#### `call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1369\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncall_tool(self, name: str, arguments: dict[str, Any] | None = None) -> ToolTask\n```\n\n#### `call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1383\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncall_tool(self, name: str, arguments: dict[str, Any] | None = None) -> CallToolResult | ToolTask\n```\n\nCall a tool on the server.\n\nUnlike call_tool_mcp, this method raises a ToolError if the tool call results in an error.\n\n**Args:**\n- `name`: The name of the tool to call.\n- `arguments`: Arguments to pass to the tool. Defaults to None.\n- `timeout`: The timeout for the tool call. Defaults to None.\n- `progress_handler`: The progress handler to use for the tool call. Defaults to None.\n- `raise_on_error`: Whether to raise an exception if the tool call results in an error. Defaults to True.\n- `meta`: Additional metadata to include with the request.\nThis is useful for passing contextual information (like user IDs, trace IDs, or preferences)\nthat shouldn't be tool arguments but may influence server-side processing. The server\ncan access this via `context.request_context.meta`. Defaults to None.\n- `task`: If True, execute as background task (SEP-1686). Defaults to False.\n- `task_id`: Optional client-provided task ID (auto-generated if not provided).\n- `ttl`: Time to keep results available in milliseconds (default 60s).\n\n**Returns:**\n- CallToolResult | ToolTask: The content returned by the tool if task=False,\nor a ToolTask object if task=True. If the tool returns structured\noutputs, they are returned as a dataclass (if an output schema\nis available) or a dictionary; otherwise, a list of content\nblocks is returned. Note: to receive both structured and\nunstructured outputs, use call_tool_mcp instead and access the\nraw result object.\n\n**Raises:**\n- `ToolError`: If the tool call results in an error.\n- `McpError`: If the tool call request results in a TimeoutError | JSONRPCError\n- `RuntimeError`: If called while the client is not connected.\n\n\n#### `get_task_status` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1503\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_task_status(self, task_id: str) -> GetTaskResult\n```\n\nQuery the status of a background task.\n\nSends a 'tasks/get' MCP protocol request over the existing transport.\n\n**Args:**\n- `task_id`: The task ID returned from call_tool_as_task\n\n**Returns:**\n- Status information including taskId, status, pollInterval, etc.\n\n**Raises:**\n- `RuntimeError`: If client not connected\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `get_task_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1524\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_task_result(self, task_id: str) -> Any\n```\n\nRetrieve the raw result of a completed background task.\n\nSends a 'tasks/result' MCP protocol request over the existing transport.\nReturns the raw result - callers should parse it appropriately.\n\n**Args:**\n- `task_id`: The task ID returned from call_tool_as_task\n\n**Returns:**\n- The raw result (could be tool, prompt, or resource result)\n\n**Raises:**\n- `RuntimeError`: If client not connected, task not found, or task failed\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `list_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1551\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tasks(self, cursor: str | None = None, limit: int = 50) -> dict[str, Any]\n```\n\nList background tasks.\n\nSends a 'tasks/list' MCP protocol request to the server. If the server\nreturns an empty list (indicating client-side tracking), falls back to\nquerying status for locally tracked task IDs.\n\n**Args:**\n- `cursor`: Optional pagination cursor\n- `limit`: Maximum number of tasks to return (default 50)\n\n**Returns:**\n- Response with structure:\n- tasks: List of task status dicts with taskId, status, etc.\n- nextCursor: Optional cursor for next page\n\n**Raises:**\n- `RuntimeError`: If client not connected\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `cancel_task` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1599\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncancel_task(self, task_id: str) -> mcp.types.CancelTaskResult\n```\n\nCancel a task, transitioning it to cancelled state.\n\nSends a 'tasks/cancel' MCP protocol request. Task will halt execution\nand transition to cancelled state.\n\n**Args:**\n- `task_id`: The task ID to cancel\n\n**Returns:**\n- The task status showing cancelled state\n\n**Raises:**\n- `RuntimeError`: If task doesn't exist\n- `McpError`: If the request results in a TimeoutError | JSONRPCError\n\n\n#### `generate_name` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/client.py#L1622\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_name(cls, name: str | None = None) -> str\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-elicitation.mdx", "content": "---\ntitle: elicitation\nsidebarTitle: elicitation\n---\n\n# `fastmcp.client.elicitation`\n\n## Functions\n\n### `create_elicitation_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/elicitation.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_elicitation_callback(elicitation_handler: ElicitationHandler) -> ElicitationFnT\n```\n\n## Classes\n\n### `ElicitResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/elicitation.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n"}, {"filename": "docs/python-sdk/fastmcp-client-logging.mdx", "content": "---\ntitle: logging\nsidebarTitle: logging\n---\n\n# `fastmcp.client.logging`\n\n## Functions\n\n### `default_log_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/logging.py#L17\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_log_handler(message: LogMessage) -> None\n```\n\n\nDefault handler that properly routes server log messages to appropriate log levels.\n\n\n### `create_log_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/logging.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_log_callback(handler: LogHandler | None = None) -> LoggingFnT\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-messages.mdx", "content": "---\ntitle: messages\nsidebarTitle: messages\n---\n\n# `fastmcp.client.messages`\n\n## Classes\n\n### `MessageHandler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L16\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nThis class is used to handle MCP messages sent to the client. It is used to handle all messages,\nrequests, notifications, and exceptions. Users can override any of the hooks\n\n\n**Methods:**\n\n#### `dispatch` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L30\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndispatch(self, message: Message) -> None\n```\n\n#### `on_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L76\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_message(self, message: Message) -> None\n```\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L79\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, message: RequestResponder[mcp.types.ServerRequest, mcp.types.ClientResult]) -> None\n```\n\n#### `on_ping` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L84\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_ping(self, message: mcp.types.PingRequest) -> None\n```\n\n#### `on_list_roots` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L87\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_roots(self, message: mcp.types.ListRootsRequest) -> None\n```\n\n#### `on_create_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L90\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_create_message(self, message: mcp.types.CreateMessageRequest) -> None\n```\n\n#### `on_notification` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L93\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_notification(self, message: mcp.types.ServerNotification) -> None\n```\n\n#### `on_exception` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L96\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_exception(self, message: Exception) -> None\n```\n\n#### `on_progress` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L99\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_progress(self, message: mcp.types.ProgressNotification) -> None\n```\n\n#### `on_logging_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L102\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_logging_message(self, message: mcp.types.LoggingMessageNotification) -> None\n```\n\n#### `on_tool_list_changed` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L107\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_tool_list_changed(self, message: mcp.types.ToolListChangedNotification) -> None\n```\n\n#### `on_resource_list_changed` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L112\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_resource_list_changed(self, message: mcp.types.ResourceListChangedNotification) -> None\n```\n\n#### `on_prompt_list_changed` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L117\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_prompt_list_changed(self, message: mcp.types.PromptListChangedNotification) -> None\n```\n\n#### `on_resource_updated` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L122\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_resource_updated(self, message: mcp.types.ResourceUpdatedNotification) -> None\n```\n\n#### `on_cancelled` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/messages.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_cancelled(self, message: mcp.types.CancelledNotification) -> None\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-oauth_callback.mdx", "content": "---\ntitle: oauth_callback\nsidebarTitle: oauth_callback\n---\n\n# `fastmcp.client.oauth_callback`\n\n\n\nOAuth callback server for handling authorization code flows.\n\nThis module provides a reusable callback server that can handle OAuth redirects\nand display styled responses to users.\n\n\n## Functions\n\n### `create_callback_html` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_callback_html(message: str, is_success: bool = True, title: str = 'FastMCP OAuth', server_url: str | None = None) -> str\n```\n\n\nCreate a styled HTML response for OAuth callbacks.\n\n\n### `create_oauth_callback_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L103\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_oauth_callback_server(port: int, callback_path: str = '/callback', server_url: str | None = None, result_container: OAuthCallbackResult | None = None, result_ready: anyio.Event | None = None) -> Server\n```\n\n\nCreate an OAuth callback server.\n\n**Args:**\n- `port`: The port to run the server on\n- `callback_path`: The path to listen for OAuth redirects on\n- `server_url`: Optional server URL to display in success messages\n- `result_container`: Optional container to store callback results\n- `result_ready`: Optional event to signal when callback is received\n\n**Returns:**\n- Configured uvicorn Server instance (not yet running)\n\n\n## Classes\n\n### `CallbackResponse` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L80\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `from_dict` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L87\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_dict(cls, data: dict[str, str]) -> CallbackResponse\n```\n\n#### `to_dict` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L90\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_dict(self) -> dict[str, str]\n```\n\n### `OAuthCallbackResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/oauth_callback.py#L95\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nContainer for OAuth callback results, used with anyio.Event for async coordination.\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-progress.mdx", "content": "---\ntitle: progress\nsidebarTitle: progress\n---\n\n# `fastmcp.client.progress`\n\n## Functions\n\n### `default_progress_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/progress.py#L12\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_progress_handler(progress: float, total: float | None, message: str | None) -> None\n```\n\n\nDefault handler for progress notifications.\n\nLogs progress updates at debug level, properly handling missing total or message values.\n\n**Args:**\n- `progress`: Current progress value\n- `total`: Optional total expected value\n- `message`: Optional status message\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-roots.mdx", "content": "---\ntitle: roots\nsidebarTitle: roots\n---\n\n# `fastmcp.client.roots`\n\n## Functions\n\n### `convert_roots_list` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/roots.py#L19\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_roots_list(roots: RootsList) -> list[mcp.types.Root]\n```\n\n### `create_roots_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/roots.py#L33\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_roots_callback(handler: RootsList | RootsHandler) -> ListRootsFnT\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-sampling-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.client.sampling`\n\n## Functions\n\n### `create_sampling_callback` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/sampling/__init__.py#L44\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_sampling_callback(sampling_handler: SamplingHandler) -> SamplingFnT\n```\n"}, {"filename": "docs/python-sdk/fastmcp-client-sampling-handlers-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.client.sampling.handlers`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-client-sampling-handlers-anthropic.mdx", "content": "---\ntitle: anthropic\nsidebarTitle: anthropic\n---\n\n# `fastmcp.client.sampling.handlers.anthropic`\n\n\nAnthropic sampling handler for FastMCP.\n\n## Classes\n\n### `AnthropicSamplingHandler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/sampling/handlers/anthropic.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSampling handler that uses the Anthropic API.\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-sampling-handlers-openai.mdx", "content": "---\ntitle: openai\nsidebarTitle: openai\n---\n\n# `fastmcp.client.sampling.handlers.openai`\n\n\nOpenAI sampling handler for FastMCP.\n\n## Classes\n\n### `OpenAISamplingHandler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/sampling/handlers/openai.py#L45\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSampling handler that uses the OpenAI API.\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-tasks.mdx", "content": "---\ntitle: tasks\nsidebarTitle: tasks\n---\n\n# `fastmcp.client.tasks`\n\n\nSEP-1686 client Task classes.\n\n## Classes\n\n### `TaskNotificationHandler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMessageHandler that routes task status notifications to Task objects.\n\n\n**Methods:**\n\n#### `dispatch` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L33\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndispatch(self, message: Message) -> None\n```\n\nDispatch messages, including task status notifications.\n\n\n### `Task` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAbstract base class for MCP background tasks (SEP-1686).\n\nProvides a uniform API whether the server accepts background execution\nor executes synchronously (graceful degradation per SEP-1686).\n\n\n**Methods:**\n\n#### `task_id` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L105\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntask_id(self) -> str\n```\n\nGet the task ID.\n\n\n#### `returned_immediately` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L110\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nreturned_immediately(self) -> bool\n```\n\nCheck if server executed the task immediately.\n\n**Returns:**\n- True if server executed synchronously (graceful degradation or no task support)\n- False if server accepted background execution\n\n\n#### `on_status_change` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L145\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_status_change(self, callback: Callable[[GetTaskResult], None | Awaitable[None]]) -> None\n```\n\nRegister callback for status change notifications.\n\nThe callback will be invoked when a notifications/tasks/status is received\nfor this task (optional server feature per SEP-1686 lines 436-444).\n\nSupports both sync and async callbacks (auto-detected).\n\n**Args:**\n- `callback`: Function to call with GetTaskResult when status changes.\n     Can return None (sync) or Awaitable[None] (async).\n\n\n#### `status` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L171\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nstatus(self) -> GetTaskResult\n```\n\nGet current task status.\n\nIf server executed immediately, returns synthetic completed status.\nOtherwise queries the server for current status.\n\n\n#### `result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L202\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresult(self) -> TaskResultT\n```\n\nWait for and return the task result.\n\nMust be implemented by subclasses to return the appropriate result type.\n\n\n#### `wait` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L209\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwait(self) -> GetTaskResult\n```\n\nWait for task to reach a specific state or complete.\n\nUses event-based waiting when notifications are available (fast),\nwith fallback to polling (reliable). Optimally wakes up immediately\non status changes when server sends notifications/tasks/status.\n\n**Args:**\n- `state`: Desired state ('submitted', 'working', 'completed', 'failed').\n   If None, waits for any terminal state (completed/failed)\n- `timeout`: Maximum time to wait in seconds\n\n**Returns:**\n- Final task status\n\n**Raises:**\n- `TimeoutError`: If desired state not reached within timeout\n\n\n#### `cancel` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L272\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncancel(self) -> None\n```\n\nCancel this task, transitioning it to cancelled state.\n\nSends a tasks/cancel protocol request. The server will attempt to halt\nexecution and move the task to cancelled state.\n\nNote: If server executed immediately (graceful degradation), this is a no-op\nas there's no server-side task to cancel.\n\n\n### `ToolTask` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L294\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents a tool call that may execute in background or immediately.\n\nProvides a uniform API whether the server accepts background execution\nor executes synchronously (graceful degradation per SEP-1686).\n\n\n**Methods:**\n\n#### `result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L336\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresult(self) -> CallToolResult\n```\n\nWait for and return the tool result.\n\nIf server executed immediately, returns the immediate result.\nOtherwise waits for background task to complete and retrieves result.\n\n**Returns:**\n- The parsed tool result (same as call_tool returns)\n\n\n### `PromptTask` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L396\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents a prompt call that may execute in background or immediately.\n\nProvides a uniform API whether the server accepts background execution\nor executes synchronously (graceful degradation per SEP-1686).\n\n\n**Methods:**\n\n#### `result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L427\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresult(self) -> mcp.types.GetPromptResult\n```\n\nWait for and return the prompt result.\n\nIf server executed immediately, returns the immediate result.\nOtherwise waits for background task to complete and retrieves result.\n\n**Returns:**\n- The prompt result with messages and description\n\n\n### `ResourceTask` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L461\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents a resource read that may execute in background or immediately.\n\nProvides a uniform API whether the server accepts background execution\nor executes synchronously (graceful degradation per SEP-1686).\n\n\n**Methods:**\n\n#### `result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/tasks.py#L497\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresult(self) -> list[mcp.types.TextResourceContents | mcp.types.BlobResourceContents]\n```\n\nWait for and return the resource contents.\n\nIf server executed immediately, returns the immediate result.\nOtherwise waits for background task to complete and retrieves result.\n\n**Returns:**\n- list\\[ReadResourceContents]: The resource contents\n\n"}, {"filename": "docs/python-sdk/fastmcp-client-transports.mdx", "content": "---\ntitle: transports\nsidebarTitle: transports\n---\n\n# `fastmcp.client.transports`\n\n## Functions\n\n### `infer_transport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L1077\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninfer_transport(transport: ClientTransport | FastMCP | FastMCP1Server | AnyUrl | Path | MCPConfig | dict[str, Any] | str) -> ClientTransport\n```\n\n\nInfer the appropriate transport type from the given transport argument.\n\nThis function attempts to infer the correct transport type from the provided\nargument, handling various input types and converting them to the appropriate\nClientTransport subclass.\n\nThe function supports these input types:\n- ClientTransport: Used directly without modification\n- FastMCP or FastMCP1Server: Creates an in-memory FastMCPTransport\n- Path or str (file path): Creates PythonStdioTransport (.py) or NodeStdioTransport (.js)\n- AnyUrl or str (URL): Creates StreamableHttpTransport (default) or SSETransport (for /sse endpoints)\n- MCPConfig or dict: Creates MCPConfigTransport, potentially connecting to multiple servers\n\nFor HTTP URLs, they are assumed to be Streamable HTTP URLs unless they end in `/sse`.\n\nFor MCPConfig with multiple servers, a composite client is created where each server\nis mounted with its name as prefix. This allows accessing tools and resources from multiple\nservers through a single unified client interface, using naming patterns like\n`servername_toolname` for tools and `protocol://servername/path` for resources.\nIf the MCPConfig contains only one server, a direct connection is established without prefixing.\n\n**Examples:**\n\n```python\n# Connect to a local Python script\ntransport = infer_transport(\"my_script.py\")\n\n# Connect to a remote server via HTTP\ntransport = infer_transport(\"http://example.com/mcp\")\n\n# Connect to multiple servers using MCPConfig\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\"url\": \"http://weather.example.com/mcp\"},\n        \"calendar\": {\"url\": \"http://calendar.example.com/mcp\"}\n    }\n}\ntransport = infer_transport(config)\n```\n\n\n## Classes\n\n### `SessionKwargs` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L64\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nKeyword arguments for the MCP ClientSession constructor.\n\n\n### `ClientTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAbstract base class for different MCP client transport mechanisms.\n\nA Transport is responsible for establishing and managing connections\nto an MCP server, and providing a ClientSession within an async context.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L88\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\nEstablishes a connection and yields an active ClientSession.\n\nThe ClientSession is *not* expected to be initialized in this context manager.\n\nThe session is guaranteed to be valid only within the scope of the\nasync context manager. Connection setup and teardown are handled\nwithin this context.\n\n**Args:**\n- `**session_kwargs`: Keyword arguments to pass to the ClientSession\n              constructor (e.g., callbacks, timeouts).\n\n\n#### `close` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L114\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose(self)\n```\n\nClose the transport.\n\n\n### `WSTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L122\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport implementation that connects to an MCP server via WebSockets.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L140\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n### `SSETransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L161\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport implementation that connects to an MCP server via Server-Sent Events.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L197\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n### `StreamableHttpTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L231\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport implementation that connects to an MCP server via Streamable HTTP Requests.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L279\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n#### `get_session_id` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L319\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_session_id(self) -> str | None\n```\n\n#### `close` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L327\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose(self)\n```\n\n### `StdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L335\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase transport for connecting to an MCP server via subprocess with stdio.\n\nThis is a base class that can be subclassed for specific command-based\ntransports like Python, Node, Uvx, etc.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L385\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n#### `connect` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L397\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect(self, **session_kwargs: Unpack[SessionKwargs]) -> ClientSession | None\n```\n\n#### `disconnect` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L433\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndisconnect(self)\n```\n\n#### `close` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L448\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose(self)\n```\n\n### `PythonStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L518\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running Python scripts.\n\n\n### `FastMCPStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L571\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running FastMCP servers using the FastMCP CLI.\n\n\n### `NodeStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L600\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running Node.js scripts.\n\n\n### `UvStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L653\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running commands via the uv tool.\n\n\n### `UvxStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L732\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running commands via the uvx tool.\n\n\n### `NpxStdioTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L797\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for running commands via the npx tool.\n\n\n### `FastMCPTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L859\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nIn-memory transport for FastMCP servers.\n\nThis transport connects directly to a FastMCP server instance in the same\nPython process. It works with both FastMCP 2.x servers and FastMCP 1.0\nservers from the low-level MCP SDK. This is particularly useful for unit\ntests or scenarios where client and server run in the same runtime.\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L878\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n### `MCPConfigTransport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L943\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTransport for connecting to one or more MCP servers defined in an MCPConfig.\n\nThis transport provides a unified interface to multiple MCP servers defined in an MCPConfig\nobject or dictionary matching the MCPConfig schema. It supports two key scenarios:\n\n1. If the MCPConfig contains exactly one server, it creates a direct transport to that server.\n2. If the MCPConfig contains multiple servers, it creates a composite client by mounting\n   all servers on a single FastMCP instance, with each server's name, by default, used as its mounting prefix.\n\nIn the multi-server case, tools are accessible with the prefix pattern `{server_name}_{tool_name}`\nand resources with the pattern `protocol://{server_name}/path/to/resource`.\n\nThis is particularly useful for creating clients that need to interact with multiple specialized\nMCP servers through a single interface, simplifying client code.\n\n**Examples:**\n\n```python\nfrom fastmcp import Client\nfrom fastmcp.utilities.mcp_config import MCPConfig\n\n# Create a config with multiple servers\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather-api.example.com/mcp\",\n            \"transport\": \"http\"\n        },\n        \"calendar\": {\n            \"url\": \"https://calendar-api.example.com/mcp\",\n            \"transport\": \"http\"\n        }\n    }\n}\n\n# Create a client with the config\nclient = Client(config)\n\nasync with client:\n    # Access tools with prefixes\n    weather = await client.call_tool(\"weather_get_forecast\", {\"city\": \"London\"})\n    events = await client.call_tool(\"calendar_list_events\", {\"date\": \"2023-06-01\"})\n\n    # Access resources with prefixed URIs\n    icons = await client.read_resource(\"weather://weather/icons/sunny\")\n```\n\n\n**Methods:**\n\n#### `connect_session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L1025\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconnect_session(self, **session_kwargs: Unpack[SessionKwargs]) -> AsyncIterator[ClientSession]\n```\n\n#### `close` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/client/transports.py#L1031\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose(self)\n```\n"}, {"filename": "docs/python-sdk/fastmcp-dependencies.mdx", "content": "---\ntitle: dependencies\nsidebarTitle: dependencies\n---\n\n# `fastmcp.dependencies`\n\n\nDependency injection exports for FastMCP.\n\nThis module re-exports dependency injection symbols from Docket and FastMCP\nto provide a clean, centralized import location for all dependency-related\nfunctionality.\n\n"}, {"filename": "docs/python-sdk/fastmcp-exceptions.mdx", "content": "---\ntitle: exceptions\nsidebarTitle: exceptions\n---\n\n# `fastmcp.exceptions`\n\n\nCustom exceptions for FastMCP.\n\n## Classes\n\n### `FastMCPError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L6\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase error for FastMCP.\n\n\n### `ValidationError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L10\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError in validating parameters or return values.\n\n\n### `ResourceError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L14\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError in resource operations.\n\n\n### `ToolError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L18\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError in tool operations.\n\n\n### `PromptError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError in prompt operations.\n\n\n### `InvalidSignature` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInvalid signature for use with FastMCP.\n\n\n### `ClientError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L30\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError in client operations.\n\n\n### `NotFoundError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nObject not found.\n\n\n### `DisabledError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/exceptions.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nObject is disabled.\n\n"}, {"filename": "docs/python-sdk/fastmcp-mcp_config.mdx", "content": "---\ntitle: mcp_config\nsidebarTitle: mcp_config\n---\n\n# `fastmcp.mcp_config`\n\n\nCanonical MCP Configuration Format.\n\nThis module defines the standard configuration format for Model Context Protocol (MCP) servers.\nIt provides a client-agnostic, extensible format that can be used across all MCP implementations.\n\nThe configuration format supports both stdio and remote (HTTP/SSE) transports, with comprehensive\nfield definitions for server metadata, authentication, and execution parameters.\n\nExample configuration:\n```json\n{\n    \"mcpServers\": {\n        \"my-server\": {\n            \"command\": \"npx\",\n            \"args\": [\"-y\", \"@my/mcp-server\"],\n            \"env\": {\"API_KEY\": \"secret\"},\n            \"timeout\": 30000,\n            \"description\": \"My MCP server\"\n        }\n    }\n}\n```\n\n\n## Functions\n\n### `infer_transport_type_from_url` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L56\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninfer_transport_type_from_url(url: str | AnyUrl) -> Literal['http', 'sse']\n```\n\n\nInfer the appropriate transport type from the given URL.\n\n\n### `update_config_file` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L312\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nupdate_config_file(file_path: Path, server_name: str, server_config: CanonicalMCPServerTypes) -> None\n```\n\n\nUpdate an MCP configuration file from a server object, preserving existing fields.\n\nThis is used for updating the mcpServer configurations of third-party tools so we do not\nworry about transforming server objects here.\n\n\n## Classes\n\n### `StdioMCPServer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L126\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMCP server configuration for stdio transport.\n\nThis is the canonical configuration format for MCP servers using stdio transport.\n\n\n**Methods:**\n\n#### `to_transport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L156\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_transport(self) -> StdioTransport\n```\n\n### `TransformingStdioMCPServer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L167\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA Stdio server with tool transforms.\n\n\n### `RemoteMCPServer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L171\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMCP server configuration for HTTP/SSE transport.\n\nThis is the canonical configuration format for MCP servers using remote transports.\n\n\n**Methods:**\n\n#### `to_transport` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L207\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_transport(self) -> StreamableHttpTransport | SSETransport\n```\n\n### `TransformingRemoteMCPServer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L232\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA Remote server with tool transforms.\n\n\n### `MCPConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L243\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA configuration object for MCP Servers that conforms to the canonical MCP configuration format\nwhile adding additional fields for enabling FastMCP-specific features like tool transformations\nand filtering by tags.\n\nFor an MCPConfig that is strictly canonical, see the `CanonicalMCPConfig` class.\n\n\n**Methods:**\n\n#### `wrap_servers_at_root` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L257\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap_servers_at_root(cls, values: dict[str, Any]) -> dict[str, Any]\n```\n\nIf there's no mcpServers key but there are server configs at root, wrap them.\n\n\n#### `add_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L270\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_server(self, name: str, server: MCPServerTypes) -> None\n```\n\nAdd or update a server in the configuration.\n\n\n#### `from_dict` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L275\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_dict(cls, config: dict[str, Any]) -> Self\n```\n\nParse MCP configuration from dictionary format.\n\n\n#### `to_dict` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L279\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_dict(self) -> dict[str, Any]\n```\n\nConvert MCPConfig to dictionary format, preserving all fields.\n\n\n#### `write_to_file` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L283\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrite_to_file(self, file_path: Path) -> None\n```\n\nWrite configuration to JSON file.\n\n\n#### `from_file` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L289\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_file(cls, file_path: Path) -> Self\n```\n\nLoad configuration from JSON file.\n\n\n### `CanonicalMCPConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L297\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nCanonical MCP configuration format.\n\nThis defines the standard configuration format for Model Context Protocol servers.\nThe format is designed to be client-agnostic and extensible for future use cases.\n\n\n**Methods:**\n\n#### `add_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/mcp_config.py#L307\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_server(self, name: str, server: CanonicalMCPServerTypes) -> None\n```\n\nAdd or update a server in the configuration.\n\n"}, {"filename": "docs/python-sdk/fastmcp-prompts-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.prompts`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-prompts-prompt.mdx", "content": "---\ntitle: prompt\nsidebarTitle: prompt\n---\n\n# `fastmcp.prompts.prompt`\n\n\nBase classes for FastMCP prompts.\n\n## Functions\n\n### `Message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nMessage(content: str | ContentBlock, role: Role | None = None, **kwargs: Any) -> PromptMessage\n```\n\n\nA user-friendly constructor for PromptMessage.\n\n\n## Classes\n\n### `PromptArgument` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L61\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAn argument that can be passed to a prompt.\n\n\n### `PromptResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L73\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nCanonical result type for prompt rendering.\n\nThis is the internal type that all prompt renders return. It wraps the\nmessages with optional description and metadata.\n\n\n**Methods:**\n\n#### `from_value` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_value(cls, value: list[PromptMessage] | PromptResult, description: str | None = None, meta: dict[str, Any] | None = None) -> PromptResult\n```\n\nConvert various types to PromptResult.\n\n\n#### `to_mcp_prompt_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L109\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_prompt_result(self) -> GetPromptResult\n```\n\nConvert to MCP GetPromptResult.\n\n\n### `Prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L118\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA prompt template that can be rendered with parameters.\n\n\n**Methods:**\n\n#### `to_mcp_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_prompt(self, **overrides: Any) -> SDKPrompt\n```\n\nConvert the prompt to an MCP prompt.\n\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L155\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(fn: Callable[..., _PromptFnReturn | Awaitable[_PromptFnReturn]], name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, tags: set[str] | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionPrompt\n```\n\nCreate a Prompt from a function.\n\nThe function can return:\n- A string (converted to a message)\n- A Message object\n- A dict (converted to a message)\n- A sequence of any of the above\n\n\n#### `render` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L184\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrender(self, arguments: dict[str, Any] | None = None) -> list[PromptMessage] | PromptResult\n```\n\nRender the prompt with arguments.\n\nThis method is not implemented in the base Prompt class and must be\nimplemented by subclasses. The preferred return type is PromptResult,\nbut list\\[PromptMessage] is still supported for backwards compatibility.\n\n\n#### `convert_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L196\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_result(self, raw_value: Any) -> PromptResult\n```\n\nConvert a raw return value to PromptResult.\n\nHandles PromptResult passthrough and converts raw values to messages.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L279\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this prompt with docket for background execution.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L285\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, arguments: dict[str, Any] | None, **kwargs: Any) -> Execution\n```\n\nSchedule this prompt for background execution via docket.\n\n**Args:**\n- `docket`: The Docket instance\n- `arguments`: Prompt arguments\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n### `FunctionPrompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L309\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA prompt that is a function.\n\n\n**Methods:**\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L315\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., _PromptFnReturn | Awaitable[_PromptFnReturn]], name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, tags: set[str] | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionPrompt\n```\n\nCreate a Prompt from a function.\n\nThe function can return:\n- A string (converted to a message)\n- A Message object\n- A dict (converted to a message)\n- A sequence of any of the above\n\n\n#### `render` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L467\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrender(self, arguments: dict[str, Any] | None = None) -> PromptResult\n```\n\nRender the prompt with arguments.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L498\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this prompt with docket for background execution.\n\nFunctionPrompt registers the underlying function, which has the user's\nDepends parameters for docket to resolve.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/prompts/prompt.py#L508\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, arguments: dict[str, Any] | None, **kwargs: Any) -> Execution\n```\n\nSchedule this prompt for background execution via docket.\n\nFunctionPrompt splats the arguments dict since .fn expects **kwargs.\n\n**Args:**\n- `docket`: The Docket instance\n- `arguments`: Prompt arguments\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n"}, {"filename": "docs/python-sdk/fastmcp-resources-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.resources`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-resources-resource.mdx", "content": "---\ntitle: resource\nsidebarTitle: resource\n---\n\n# `fastmcp.resources.resource`\n\n\nBase classes and interfaces for FastMCP resources.\n\n## Classes\n\n### `ResourceContent` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L39\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nCanonical wrapper for resource content.\n\nThis is the internal representation for all resource reads. Users can\nreturn ResourceContent directly for full control, or return simpler types\n(str, bytes, dict) which will be automatically converted.\n\n\n**Methods:**\n\n#### `from_value` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L69\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_value(cls, value: Any, mime_type: str | None = None, meta: dict[str, Any] | None = None) -> ResourceContent\n```\n\nConvert any value to ResourceContent, handling serialization.\n\n**Args:**\n- `value`: The value to convert. Can be\\:\n- ResourceContent\\: returned as-is (meta param ignored)\n- str\\: text content\n- bytes\\: binary content\n- other\\: serialized to JSON string\n- `mime_type`: Optional MIME type override. If not provided\\:\n- str \u2192 \"text/plain\"\n- bytes \u2192 \"application/octet-stream\"\n- other \u2192 \"application/json\"\n- `meta`: Optional metadata (ignored if value is already ResourceContent)\n\n**Returns:**\n- ResourceContent instance\n\n\n#### `to_mcp_resource_contents` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L110\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_resource_contents(self, uri: AnyUrl | str) -> mcp.types.TextResourceContents | mcp.types.BlobResourceContents\n```\n\nConvert to MCP resource contents type.\n\n**Args:**\n- `uri`: The URI of the resource (required by MCP types)\n\n**Returns:**\n- TextResourceContents for str content, BlobResourceContents for bytes\n\n\n### `Resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L137\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for all resources.\n\n\n**Methods:**\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L158\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(fn: Callable[..., Any], uri: str | AnyUrl, name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, mime_type: str | None = None, tags: set[str] | None = None, annotations: Annotations | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionResource\n```\n\n#### `set_default_mime_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L187\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_default_mime_type(cls, mime_type: str | None) -> str\n```\n\nSet default MIME type if not provided.\n\n\n#### `set_default_name` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L194\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_default_name(self) -> Self\n```\n\nSet default name from URI if not provided.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L204\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> str | bytes | ResourceContent\n```\n\nRead the resource content.\n\nThis method must be implemented by subclasses. For backwards compatibility,\nsubclasses can return str, bytes, or ResourceContent. However, returning\nstr or bytes is deprecated - new code should return ResourceContent.\n\n**Returns:**\n- str | bytes | ResourceContent: The resource content. Returning str\n- or bytes is deprecated; prefer ResourceContent for full control\n- over MIME type and metadata.\n\n\n#### `convert_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L218\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_result(self, raw_value: Any) -> ResourceContent\n```\n\nConvert a raw return value to ResourceContent.\n\nHandles ResourceContent passthrough and converts raw values using mime_type.\n\n\n#### `to_mcp_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L261\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_resource(self, **overrides: Any) -> SDKResource\n```\n\nConvert the resource to an SDKResource.\n\n\n#### `key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L286\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nkey(self) -> str\n```\n\nThe globally unique lookup key for this resource.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L290\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this resource with docket for background execution.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L296\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, **kwargs: Any) -> Execution\n```\n\nSchedule this resource for background execution via docket.\n\n**Args:**\n- `docket`: The Docket instance\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n### `FunctionResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L318\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that defers data loading by wrapping a function.\n\nThe function is only called when the resource is read, allowing for lazy loading\nof potentially expensive data. This is particularly useful when listing resources,\nas the function won't be called until the resource is actually accessed.\n\nThe function can return:\n- str for text content (default)\n- bytes for binary content\n- other types will be converted to JSON\n\n\n**Methods:**\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L334\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., Any], uri: str | AnyUrl, name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, mime_type: str | None = None, tags: set[str] | None = None, annotations: Annotations | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionResource\n```\n\nCreate a FunctionResource from a function.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L380\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> str | bytes | ResourceContent\n```\n\nRead the resource by calling the wrapped function.\n\n**Returns:**\n- str | bytes | ResourceContent: The resource content. If the user's\n- function returns str, bytes, dict, etc., it will be wrapped\n- in ResourceContent. Nested Resource reads may return raw types.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/resource.py#L400\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this resource with docket for background execution.\n\nFunctionResource registers the underlying function, which has the user's\nDepends parameters for docket to resolve.\n\n"}, {"filename": "docs/python-sdk/fastmcp-resources-template.mdx", "content": "---\ntitle: template\nsidebarTitle: template\n---\n\n# `fastmcp.resources.template`\n\n\nResource template functionality.\n\n## Functions\n\n### `extract_query_params` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L32\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nextract_query_params(uri_template: str) -> set[str]\n```\n\n\nExtract query parameter names from RFC 6570 `{?param1,param2}` syntax.\n\n\n### `build_regex` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nbuild_regex(template: str) -> re.Pattern\n```\n\n\nBuild regex pattern for URI template, handling RFC 6570 syntax.\n\nSupports:\n- `{var}` - simple path parameter\n- `{var*}` - wildcard path parameter (captures multiple segments)\n- `{?var1,var2}` - query parameters (ignored in path matching)\n\n\n### `match_uri_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L66\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmatch_uri_template(uri: str, uri_template: str) -> dict[str, str] | None\n```\n\n\nMatch URI against template and extract both path and query parameters.\n\nSupports RFC 6570 URI templates:\n- Path params: `{var}`, `{var*}`\n- Query params: `{?var1,var2}`\n\n\n## Classes\n\n### `ResourceTemplate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L97\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA template for dynamically creating resources.\n\n\n**Methods:**\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L119\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(fn: Callable[..., Any], uri_template: str, name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, mime_type: str | None = None, tags: set[str] | None = None, annotations: Annotations | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionResourceTemplate\n```\n\n#### `set_default_mime_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L148\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_default_mime_type(cls, mime_type: str | None) -> str\n```\n\nSet default MIME type if not provided.\n\n\n#### `matches` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L154\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmatches(self, uri: str) -> dict[str, Any] | None\n```\n\nCheck if URI matches template and extract parameters.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L158\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self, arguments: dict[str, Any]) -> str | bytes\n```\n\nRead the resource content.\n\n\n#### `convert_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L164\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_result(self, raw_value: Any) -> ResourceContent\n```\n\nConvert a raw return value to ResourceContent.\n\nHandles ResourceContent passthrough and converts raw values using mime_type.\n\n\n#### `create_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L205\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_resource(self, uri: str, params: dict[str, Any]) -> Resource\n```\n\nCreate a resource from the template with the given parameters.\n\nThe base implementation does not support background tasks.\nUse FunctionResourceTemplate for task support.\n\n\n#### `to_mcp_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L216\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_template(self, **overrides: Any) -> SDKResourceTemplate\n```\n\nConvert the resource template to an SDKResourceTemplate.\n\n\n#### `from_mcp_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L238\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_mcp_template(cls, mcp_template: SDKResourceTemplate) -> ResourceTemplate\n```\n\nCreates a FastMCP ResourceTemplate from a raw MCP ResourceTemplate object.\n\n\n#### `key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L251\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nkey(self) -> str\n```\n\nThe globally unique lookup key for this template.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L255\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this template with docket for background execution.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L261\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, params: dict[str, Any], **kwargs: Any) -> Execution\n```\n\nSchedule this template for background execution via docket.\n\n**Args:**\n- `docket`: The Docket instance\n- `params`: Template parameters\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n### `FunctionResourceTemplate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L285\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA template for dynamically creating resources.\n\n\n**Methods:**\n\n#### `create_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L315\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_resource(self, uri: str, params: dict[str, Any]) -> Resource\n```\n\nCreate a resource from the template with the given parameters.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L333\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self, arguments: dict[str, Any]) -> str | bytes\n```\n\nRead the resource content.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L364\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this template with docket for background execution.\n\nFunctionResourceTemplate registers the underlying function, which has the\nuser's Depends parameters for docket to resolve.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L374\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, params: dict[str, Any], **kwargs: Any) -> Execution\n```\n\nSchedule this template for background execution via docket.\n\nFunctionResourceTemplate splats the params dict since .fn expects **kwargs.\n\n**Args:**\n- `docket`: The Docket instance\n- `params`: Template parameters\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/template.py#L400\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., Any], uri_template: str, name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, mime_type: str | None = None, tags: set[str] | None = None, annotations: Annotations | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionResourceTemplate\n```\n\nCreate a template from a function.\n\n"}, {"filename": "docs/python-sdk/fastmcp-resources-types.mdx", "content": "---\ntitle: types\nsidebarTitle: types\n---\n\n# `fastmcp.resources.types`\n\n\nConcrete resource implementations.\n\n## Classes\n\n### `TextResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L21\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that reads from a string.\n\n\n**Methods:**\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the text content.\n\n\n### `BinaryResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L31\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that reads from bytes.\n\n\n**Methods:**\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L36\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the binary content.\n\n\n### `FileResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L41\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that reads from a file.\n\nSet is_binary=True to read file as binary data instead of text.\n\n\n**Methods:**\n\n#### `validate_absolute_path` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L63\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_absolute_path(cls, path: Path) -> Path\n```\n\nEnsure path is absolute.\n\n\n#### `set_binary_from_mime_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L71\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_binary_from_mime_type(cls, is_binary: bool, info: ValidationInfo) -> bool\n```\n\nSet is_binary based on mime_type if not explicitly set.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L79\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the file content.\n\n\n### `HttpResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L91\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that reads from an HTTP endpoint.\n\n\n**Methods:**\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the HTTP content.\n\n\n### `DirectoryResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L108\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA resource that lists files in a directory.\n\n\n**Methods:**\n\n#### `validate_absolute_path` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L128\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_absolute_path(cls, path: Path) -> Path\n```\n\nEnsure path is absolute.\n\n\n#### `list_files` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L134\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_files(self) -> list[Path]\n```\n\nList files in the directory.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/resources/types.py#L150\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the directory listing.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.auth`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-auth.mdx", "content": "---\ntitle: auth\nsidebarTitle: auth\n---\n\n# `fastmcp.server.auth.auth`\n\n## Classes\n\n### `AccessToken` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L43\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAccessToken that includes all JWT claims.\n\n\n### `TokenHandler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L49\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTokenHandler that returns OAuth 2.1 compliant error responses.\n\nThe MCP SDK returns `unauthorized_client` for client authentication failures.\nHowever, per RFC 6749 Section 5.2, authentication failures should return\n`invalid_client` with HTTP 401, not `unauthorized_client`.\n\nThis distinction matters: `unauthorized_client` means \"client exists but\ncan't do this\", while `invalid_client` means \"client doesn't exist or\ncredentials are wrong\". Claude's OAuth client uses this to decide whether\nto re-register.\n\nThis handler transforms 401 responses with `unauthorized_client` to use\n`invalid_client` instead, making the error semantics correct per OAuth spec.\n\n\n**Methods:**\n\n#### `handle` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nhandle(self, request: Any)\n```\n\nWrap SDK handle() and transform auth error responses.\n\n\n### `AuthProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L91\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for all FastMCP authentication providers.\n\nThis class provides a unified interface for all authentication providers,\nwhether they are simple token verifiers or full OAuth authorization servers.\nAll providers must be able to verify tokens and can optionally provide\ncustom authentication routes.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L118\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\nAll auth providers must implement token verification.\n\n**Args:**\n- `token`: The token string to validate\n\n**Returns:**\n- AccessToken object if valid, None if invalid or expired\n\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L131\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet all routes for this authentication provider.\n\nThis includes both well-known discovery routes and operational routes.\nEach provider is responsible for creating whatever routes it needs:\n- TokenVerifier: typically no routes (default implementation)\n- RemoteAuthProvider: protected resource metadata routes\n- OAuthProvider: full OAuth authorization server routes\n- Custom providers: whatever routes they need\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata, but the\nprovider does not create the actual MCP endpoint route.\n\n**Returns:**\n- List of all routes for this provider (excluding the MCP endpoint itself)\n\n\n#### `get_well_known_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L154\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_well_known_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet well-known discovery routes for this authentication provider.\n\nThis is a utility method that filters get_routes() to return only\nwell-known discovery routes (those starting with /.well-known/).\n\nWell-known routes provide OAuth metadata and discovery endpoints that\nclients use to discover authentication capabilities. These routes should\nbe mounted at the root level of the application to comply with RFC 8414\nand RFC 9728.\n\nCommon well-known routes:\n- /.well-known/oauth-authorization-server (authorization server metadata)\n- /.well-known/oauth-protected-resource/* (protected resource metadata)\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to construct path-scoped well-known URLs.\n\n**Returns:**\n- List of well-known discovery routes (typically mounted at root level)\n\n\n#### `get_middleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L186\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_middleware(self) -> list\n```\n\nGet HTTP application-level middleware for this auth provider.\n\n**Returns:**\n- List of Starlette Middleware instances to apply to the HTTP app\n\n\n### `TokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L220\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for token verifiers (Resource Servers).\n\nThis class provides token verification capability without OAuth server functionality.\nToken verifiers typically don't provide authentication routes by default.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L241\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\n\n### `RemoteAuthProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L246\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAuthentication provider for resource servers that verify tokens from known authorization servers.\n\nThis provider composes a TokenVerifier with authorization server metadata to create\nstandardized OAuth 2.0 Protected Resource endpoints (RFC 9728). Perfect for:\n- JWT verification with known issuers\n- Remote token introspection services\n- Any resource server that knows where its tokens come from\n\nUse this when you have token verification logic and want to advertise\nthe authorization servers that issue valid tokens.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L287\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify token using the configured token verifier.\n\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L291\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet routes for this provider.\n\nCreates protected resource metadata routes (RFC 9728).\n\n\n### `OAuthProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L319\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth Authorization Server provider.\n\nThis class provides full OAuth server functionality including client registration,\nauthorization flows, token issuance, and token verification.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L382\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\nThis method implements the TokenVerifier protocol by delegating\nto our existing load_access_token method.\n\n**Args:**\n- `token`: The token string to validate\n\n**Returns:**\n- AccessToken object if valid, None if invalid or expired\n\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L397\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth authorization server routes and optional protected resource routes.\n\nThis method creates the full set of OAuth routes including:\n- Standard OAuth authorization server routes (/.well-known/oauth-authorization-server, /authorize, /token, etc.)\n- Optional protected resource routes\n\n**Returns:**\n- List of OAuth routes\n\n\n#### `get_well_known_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L477\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_well_known_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet well-known discovery routes with RFC 8414 path-aware support.\n\nOverrides the base implementation to support path-aware authorization\nserver metadata discovery per RFC 8414. If issuer_url has a path component,\nthe authorization server metadata route is adjusted to include that path.\n\nFor example, if issuer_url is \"http://example.com/api\", the discovery\nendpoint will be at \"/.well-known/oauth-authorization-server/api\" instead\nof just \"/.well-known/oauth-authorization-server\".\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\n\n**Returns:**\n- List of well-known discovery routes\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-jwt_issuer.mdx", "content": "---\ntitle: jwt_issuer\nsidebarTitle: jwt_issuer\n---\n\n# `fastmcp.server.auth.jwt_issuer`\n\n\nJWT token issuance and verification for FastMCP OAuth Proxy.\n\nThis module implements the token factory pattern for OAuth proxies, where the proxy\nissues its own JWT tokens to clients instead of forwarding upstream provider tokens.\nThis maintains proper OAuth 2.0 token audience boundaries.\n\n\n## Functions\n\n### `derive_jwt_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L37\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nderive_jwt_key() -> bytes\n```\n\n\nDerive JWT signing key from a high-entropy or low-entropy key material and server salt.\n\n\n## Classes\n\n### `JWTIssuer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L74\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nIssues and validates FastMCP-signed JWT tokens using HS256.\n\nThis issuer creates JWT tokens for MCP clients with proper audience claims,\nmaintaining OAuth 2.0 token boundaries. Tokens are signed with HS256 using\na key derived from the upstream client secret.\n\n\n**Methods:**\n\n#### `issue_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nissue_access_token(self, client_id: str, scopes: list[str], jti: str, expires_in: int = 3600) -> str\n```\n\nIssue a minimal FastMCP access token.\n\nFastMCP tokens are reference tokens containing only the minimal claims\nneeded for validation and lookup. The JTI maps to the upstream token\nwhich contains actual user identity and authorization data.\n\n**Args:**\n- `client_id`: MCP client ID\n- `scopes`: Token scopes\n- `jti`: Unique token identifier (maps to upstream token)\n- `expires_in`: Token lifetime in seconds\n\n**Returns:**\n- Signed JWT token\n\n\n#### `issue_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L147\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nissue_refresh_token(self, client_id: str, scopes: list[str], jti: str, expires_in: int) -> str\n```\n\nIssue a minimal FastMCP refresh token.\n\nFastMCP refresh tokens are reference tokens containing only the minimal\nclaims needed for validation and lookup. The JTI maps to the upstream\ntoken which contains actual user identity and authorization data.\n\n**Args:**\n- `client_id`: MCP client ID\n- `scopes`: Token scopes\n- `jti`: Unique token identifier (maps to upstream token)\n- `expires_in`: Token lifetime in seconds (should match upstream refresh expiry)\n\n**Returns:**\n- Signed JWT token\n\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L195\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> dict[str, Any]\n```\n\nVerify and decode a FastMCP token.\n\nValidates JWT signature, expiration, issuer, and audience.\n\n**Args:**\n- `token`: JWT token to verify\n\n**Returns:**\n- Decoded token payload\n\n**Raises:**\n- `JoseError`: If token is invalid, expired, or has wrong claims\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-middleware.mdx", "content": "---\ntitle: middleware\nsidebarTitle: middleware\n---\n\n# `fastmcp.server.auth.middleware`\n\n\nEnhanced authentication middleware with better error messages.\n\nThis module provides enhanced versions of MCP SDK authentication middleware\nthat return more helpful error messages for developers troubleshooting\nauthentication issues.\n\n\n## Classes\n\n### `RequireAuthMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/middleware.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nEnhanced authentication middleware with detailed error messages.\n\nExtends the SDK's RequireAuthMiddleware to provide more actionable\nerror messages when authentication fails. This helps developers\nunderstand what went wrong and how to fix it.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-oauth_proxy.mdx", "content": "---\ntitle: oauth_proxy\nsidebarTitle: oauth_proxy\n---\n\n# `fastmcp.server.auth.oauth_proxy`\n\n\nOAuth Proxy Provider for FastMCP.\n\nThis provider acts as a transparent proxy to an upstream OAuth Authorization Server,\nhandling Dynamic Client Registration locally while forwarding all other OAuth flows.\nThis enables authentication with upstream providers that don't support DCR or have\nrestricted client registration policies.\n\nKey features:\n- Proxies authorization and token endpoints to upstream server\n- Implements local Dynamic Client Registration with fixed upstream credentials\n- Validates tokens using upstream JWKS\n- Maintains minimal local state for bookkeeping\n- Enhanced logging with request correlation\n\nThis implementation is based on the OAuth 2.1 specification and is designed for\nproduction use with enterprise identity providers.\n\n\n## Functions\n\n### `create_consent_html` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L257\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_consent_html(client_id: str, redirect_uri: str, scopes: list[str], txn_id: str, csrf_token: str, client_name: str | None = None, title: str = 'Application Access Request', server_name: str | None = None, server_icon_url: str | None = None, server_website_url: str | None = None, client_website_url: str | None = None, csp_policy: str | None = None) -> str\n```\n\n\nCreate a styled HTML consent page for OAuth authorization requests.\n\n**Args:**\n- `csp_policy`: Content Security Policy override.\nIf None, uses the built-in CSP policy with appropriate directives.\nIf empty string \"\", disables CSP entirely (no meta tag is rendered).\nIf a non-empty string, uses that as the CSP policy value.\n\n\n### `create_error_html` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L427\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_error_html(error_title: str, error_message: str, error_details: dict[str, str] | None = None, server_name: str | None = None, server_icon_url: str | None = None) -> str\n```\n\n\nCreate a styled HTML error page for OAuth errors.\n\n**Args:**\n- `error_title`: The error title (e.g., \"OAuth Error\", \"Authorization Failed\")\n- `error_message`: The main error message to display\n- `error_details`: Optional dictionary of error details to show (e.g., `{\"Error Code\"\\: \"invalid_client\"}`)\n- `server_name`: Optional server name to display\n- `server_icon_url`: Optional URL to server icon/logo\n\n**Returns:**\n- Complete HTML page as a string\n\n\n## Classes\n\n### `OAuthTransaction` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L107\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth transaction state for consent flow.\n\nStored server-side to track active authorization flows with client context.\nIncludes CSRF tokens for consent protection per MCP security best practices.\n\n\n### `ClientCode` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L128\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nClient authorization code with PKCE and upstream tokens.\n\nStored server-side after upstream IdP callback. Contains the upstream\ntokens bound to the client's PKCE challenge for secure token exchange.\n\n\n### `UpstreamTokenSet` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L146\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nStored upstream OAuth tokens from identity provider.\n\nThese tokens are obtained from the upstream provider (Google, GitHub, etc.)\nand stored in plaintext within this model. Encryption is handled transparently\nat the storage layer via FernetEncryptionWrapper. Tokens are never exposed to MCP clients.\n\n\n### `JTIMapping` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L168\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMaps FastMCP token JTI to upstream token ID.\n\nThis allows stateless JWT validation while still being able to look up\nthe corresponding upstream token when tools need to access upstream APIs.\n\n\n### `RefreshTokenMetadata` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L180\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMetadata for a refresh token, stored keyed by token hash.\n\nWe store only metadata (not the token itself) for security - if storage\nis compromised, attackers get hashes they can't reverse into usable tokens.\n\n\n### `ProxyDCRClient` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L202\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nClient for DCR proxy with configurable redirect URI validation.\n\nThis special client class is critical for the OAuth proxy to work correctly\nwith Dynamic Client Registration (DCR). Here's why it exists:\n\nProblem:\n--------\nWhen MCP clients use OAuth, they dynamically register with random localhost\nports (e.g., http://localhost:55454/callback). The OAuth proxy needs to:\n1. Accept these dynamic redirect URIs from clients based on configured patterns\n2. Use its own fixed redirect URI with the upstream provider (Google, GitHub, etc.)\n3. Forward the authorization code back to the client's dynamic URI\n\nSolution:\n---------\nThis class validates redirect URIs against configurable patterns,\nwhile the proxy internally uses its own fixed redirect URI with the upstream\nprovider. This allows the flow to work even when clients reconnect with\ndifferent ports or when tokens are cached.\n\nWithout proper validation, clients could get \"Redirect URI not registered\" errors\nwhen trying to authenticate with cached tokens, or security vulnerabilities could\narise from accepting arbitrary redirect URIs.\n\n\n**Methods:**\n\n#### `validate_redirect_uri` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L231\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_redirect_uri(self, redirect_uri: AnyUrl | None) -> AnyUrl\n```\n\nValidate redirect URI against allowed patterns.\n\nSince we're acting as a proxy and clients register dynamically,\nwe validate their redirect URIs against configurable patterns.\nThis is essential for cached token scenarios where the client may\nreconnect with a different port.\n\n\n### `OAuthProxy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L515\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth provider that presents a DCR-compliant interface while proxying to non-DCR IDPs.\n\nPurpose\n-------\nMCP clients expect OAuth providers to support Dynamic Client Registration (DCR),\nwhere clients can register themselves dynamically and receive unique credentials.\nMost enterprise IDPs (Google, GitHub, Azure AD, etc.) don't support DCR and require\npre-registered OAuth applications with fixed credentials.\n\nThis proxy bridges that gap by:\n- Presenting a full DCR-compliant OAuth interface to MCP clients\n- Translating DCR registration requests to use pre-configured upstream credentials\n- Proxying all OAuth flows to the upstream IDP with appropriate translations\n- Managing the state and security requirements of both protocols\n\nArchitecture Overview\n--------------------\nThe proxy maintains a single OAuth app registration with the upstream provider\nwhile allowing unlimited MCP clients to register and authenticate dynamically.\nIt implements the complete OAuth 2.1 + DCR specification for clients while\ntranslating to whatever OAuth variant the upstream provider requires.\n\nKey Translation Challenges Solved\n---------------------------------\n1. Dynamic Client Registration:\n   - MCP clients expect to register dynamically and get unique credentials\n   - Upstream IDPs require pre-registered apps with fixed credentials\n   - Solution: Accept DCR requests, return shared upstream credentials\n\n2. Dynamic Redirect URIs:\n   - MCP clients use random localhost ports that change between sessions\n   - Upstream IDPs require fixed, pre-registered redirect URIs\n   - Solution: Use proxy's fixed callback URL with upstream, forward to client's dynamic URI\n\n3. Authorization Code Mapping:\n   - Upstream returns codes for the proxy's redirect URI\n   - Clients expect codes for their own redirect URIs\n   - Solution: Exchange upstream code server-side, issue new code to client\n\n4. State Parameter Collision:\n   - Both client and proxy need to maintain state through the flow\n   - Only one state parameter available in OAuth\n   - Solution: Use transaction ID as state with upstream, preserve client's state\n\n5. Token Management:\n   - Clients may expect different token formats/claims than upstream provides\n   - Need to track tokens for revocation and refresh\n   - Solution: Store token relationships, forward upstream tokens transparently\n\nOAuth Flow Implementation\n------------------------\n1. Client Registration (DCR):\n   - Accept any client registration request\n   - Store ProxyDCRClient that accepts dynamic redirect URIs\n\n2. Authorization:\n   - Store transaction mapping client details to proxy flow\n   - Redirect to upstream with proxy's fixed redirect URI\n   - Use transaction ID as state parameter with upstream\n\n3. Upstream Callback:\n   - Exchange upstream authorization code for tokens (server-side)\n   - Generate new authorization code bound to client's PKCE challenge\n   - Redirect to client's original dynamic redirect URI\n\n4. Token Exchange:\n   - Validate client's code and PKCE verifier\n   - Return previously obtained upstream tokens\n   - Clean up one-time use authorization code\n\n5. Token Refresh:\n   - Forward refresh requests to upstream using authlib\n   - Handle token rotation if upstream issues new refresh token\n   - Update local token mappings\n\nState Management\n---------------\nThe proxy maintains minimal but crucial state via pluggable storage (client_storage):\n- _oauth_transactions: Active authorization flows with client context\n- _client_codes: Authorization codes with PKCE challenges and upstream tokens\n- _jti_mapping_store: Maps FastMCP token JTIs to upstream token IDs\n- _refresh_token_store: Refresh token metadata (keyed by token hash)\n\nAll state is stored in the configured client_storage backend (Redis, disk, etc.)\nenabling horizontal scaling across multiple instances.\n\nSecurity Considerations\n----------------------\n- Refresh tokens stored by hash only (defense in depth if storage compromised)\n- PKCE enforced end-to-end (client to proxy, proxy to upstream)\n- Authorization codes are single-use with short expiry\n- Transaction IDs are cryptographically random\n- All state is cleaned up after use to prevent replay\n- Token validation delegates to upstream provider\n\nProvider Compatibility\n---------------------\nWorks with any OAuth 2.0 provider that supports:\n- Authorization code flow\n- Fixed redirect URI (configured in provider's app settings)\n- Standard token endpoint\n\nHandles provider-specific requirements:\n- Google: Ensures minimum scope requirements\n- GitHub: Compatible with OAuth Apps and GitHub Apps\n- Azure AD: Handles tenant-specific endpoints\n- Generic: Works with any spec-compliant provider\n\n\n**Methods:**\n\n#### `get_client` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L924\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_client(self, client_id: str) -> OAuthClientInformationFull | None\n```\n\nGet client information by ID. This is generally the random ID\nprovided to the DCR client during registration, not the upstream client ID.\n\nFor unregistered clients, returns None (which will raise an error in the SDK).\n\n\n#### `register_client` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L940\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_client(self, client_info: OAuthClientInformationFull) -> None\n```\n\nRegister a client locally\n\nWhen a client registers, we create a ProxyDCRClient that is more\nforgiving about validating redirect URIs, since the DCR client's\nredirect URI will likely be localhost or unknown to the proxied IDP. The\nproxied IDP only knows about this server's fixed redirect URI.\n\n\n#### `authorize` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L993\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nauthorize(self, client: OAuthClientInformationFull, params: AuthorizationParams) -> str\n```\n\nStart OAuth transaction and route through consent interstitial.\n\nFlow:\n1. Store transaction with client details and PKCE (if forwarding)\n2. Return local /consent URL; browser visits consent first\n3. Consent handler redirects to upstream IdP if approved/already approved\n\nIf consent is disabled (require_authorization_consent=False), skip the consent screen\nand redirect directly to the upstream IdP.\n\n\n#### `load_authorization_code` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1073\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_authorization_code(self, client: OAuthClientInformationFull, authorization_code: str) -> AuthorizationCode | None\n```\n\nLoad authorization code for validation.\n\nLook up our client code and return authorization code object\nwith PKCE challenge for validation.\n\n\n#### `exchange_authorization_code` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1121\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nexchange_authorization_code(self, client: OAuthClientInformationFull, authorization_code: AuthorizationCode) -> OAuthToken\n```\n\nExchange authorization code for FastMCP-issued tokens.\n\nImplements the token factory pattern:\n1. Retrieves upstream tokens from stored authorization code\n2. Extracts user identity from upstream token\n3. Encrypts and stores upstream tokens\n4. Issues FastMCP-signed JWT tokens\n5. Returns FastMCP tokens (NOT upstream tokens)\n\nPKCE validation is handled by the MCP framework before this method is called.\n\n\n#### `load_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1308\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_refresh_token(self, client: OAuthClientInformationFull, refresh_token: str) -> RefreshToken | None\n```\n\nLoad refresh token metadata from distributed storage.\n\nLooks up by token hash and reconstructs the RefreshToken object.\nValidates that the token belongs to the requesting client.\n\n\n#### `exchange_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1337\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nexchange_refresh_token(self, client: OAuthClientInformationFull, refresh_token: RefreshToken, scopes: list[str]) -> OAuthToken\n```\n\nExchange FastMCP refresh token for new FastMCP access token.\n\nImplements two-tier refresh:\n1. Verify FastMCP refresh token\n2. Look up upstream token via JTI mapping\n3. Refresh upstream token with upstream provider\n4. Update stored upstream token\n5. Issue new FastMCP access token\n6. Keep same FastMCP refresh token (unless upstream rotates)\n\n\n#### `load_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1546\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_access_token(self, token: str) -> AccessToken | None\n```\n\nValidate FastMCP JWT by swapping for upstream token.\n\nThis implements the token swap pattern:\n1. Verify FastMCP JWT signature (proves it's our token)\n2. Look up upstream token via JTI mapping\n3. Decrypt upstream token\n4. Validate upstream token with provider (GitHub API, JWT validation, etc.)\n5. Return upstream validation result\n\nThe FastMCP JWT is a reference token - all authorization data comes\nfrom validating the upstream token via the TokenVerifier.\n\n\n#### `revoke_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1602\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrevoke_token(self, token: AccessToken | RefreshToken) -> None\n```\n\nRevoke token locally and with upstream server if supported.\n\nFor refresh tokens, removes from local storage by hash.\nFor all tokens, attempts upstream revocation if endpoint is configured.\nAccess token JTI mappings expire via TTL.\n\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oauth_proxy.py#L1635\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth routes with custom handlers for better error UX.\n\nThis method creates standard OAuth routes and replaces:\n- /authorize endpoint: Enhanced error responses for unregistered clients\n- /token endpoint: OAuth 2.1 compliant error codes\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-oidc_proxy.mdx", "content": "---\ntitle: oidc_proxy\nsidebarTitle: oidc_proxy\n---\n\n# `fastmcp.server.auth.oidc_proxy`\n\n\nOIDC Proxy Provider for FastMCP.\n\nThis provider acts as a transparent proxy to an upstream OIDC compliant Authorization\nServer. It leverages the OAuthProxy class to handle Dynamic Client Registration and\nforwarding of all OAuth flows.\n\nThis implementation is based on:\n    OpenID Connect Discovery 1.0 - https://openid.net/specs/openid-connect-discovery-1_0.html\n    OAuth 2.0 Authorization Server Metadata - https://datatracker.ietf.org/doc/html/rfc8414\n\n\n## Classes\n\n### `OIDCConfiguration` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oidc_proxy.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOIDC Configuration.\n\n\n**Methods:**\n\n#### `get_oidc_configuration` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oidc_proxy.py#L142\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_oidc_configuration(cls, config_url: AnyHttpUrl) -> Self\n```\n\nGet the OIDC configuration for the specified config URL.\n\n**Args:**\n- `config_url`: The OIDC config URL\n- `strict`: The strict flag for the configuration\n- `timeout_seconds`: HTTP request timeout in seconds\n\n\n### `OIDCProxy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oidc_proxy.py#L172\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth provider that wraps OAuthProxy to provide configuration via an OIDC configuration URL.\n\nThis provider makes it easier to add OAuth protection for any upstream provider\nthat is OIDC compliant.\n\n\n**Methods:**\n\n#### `get_oidc_configuration` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oidc_proxy.py#L380\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_oidc_configuration(self, config_url: AnyHttpUrl, strict: bool | None, timeout_seconds: int | None) -> OIDCConfiguration\n```\n\nGets the OIDC configuration for the specified configuration URL.\n\n**Args:**\n- `config_url`: The OIDC configuration URL\n- `strict`: The strict flag for the configuration\n- `timeout_seconds`: HTTP request timeout in seconds\n\n\n#### `get_token_verifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/oidc_proxy.py#L397\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_token_verifier(self) -> TokenVerifier\n```\n\nCreates the token verifier for the specified OIDC configuration and arguments.\n\n**Args:**\n- `algorithm`: Optional token verifier algorithm\n- `audience`: Optional token verifier audience\n- `required_scopes`: Optional token verifier required_scopes\n- `timeout_seconds`: HTTP request timeout in seconds\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.auth.providers`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-auth0.mdx", "content": "---\ntitle: auth0\nsidebarTitle: auth0\n---\n\n# `fastmcp.server.auth.providers.auth0`\n\n\nAuth0 OAuth provider for FastMCP.\n\nThis module provides a complete Auth0 integration that's ready to use with\njust the configuration URL, client ID, client secret, audience, and base URL.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.auth0 import Auth0Provider\n\n    # Simple Auth0 OAuth protection\n    auth = Auth0Provider(\n        config_url=\"https://auth0.config.url\",\n        client_id=\"your-auth0-client-id\",\n        client_secret=\"your-auth0-client-secret\",\n        audience=\"your-auth0-api-audience\",\n        base_url=\"http://localhost:8000\",\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `Auth0ProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/auth0.py#L37\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for Auth0 OIDC provider.\n\n\n### `Auth0Provider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/auth0.py#L63\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAn Auth0 provider implementation for FastMCP.\n\nThis provider is a complete Auth0 integration that's ready to use with\njust the configuration URL, client ID, client secret, audience, and base URL.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-aws.mdx", "content": "---\ntitle: aws\nsidebarTitle: aws\n---\n\n# `fastmcp.server.auth.providers.aws`\n\n\nAWS Cognito OAuth provider for FastMCP.\n\nThis module provides a complete AWS Cognito OAuth integration that's ready to use\nwith a user pool ID, domain prefix, client ID and client secret. It handles all\nthe complexity of AWS Cognito's OAuth flow, token validation, and user management.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.aws_cognito import AWSCognitoProvider\n\n    # Simple AWS Cognito OAuth protection\n    auth = AWSCognitoProvider(\n        user_pool_id=\"your-user-pool-id\",\n        aws_region=\"eu-central-1\",\n        client_id=\"your-cognito-client-id\",\n        client_secret=\"your-cognito-client-secret\"\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `AWSCognitoProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/aws.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for AWS Cognito OAuth provider.\n\n\n### `AWSCognitoTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/aws.py#L68\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier that filters claims to Cognito-specific subset.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/aws.py#L71\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify token and filter claims to Cognito-specific subset.\n\n\n### `AWSCognitoProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/aws.py#L95\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nComplete AWS Cognito OAuth provider for FastMCP.\n\nThis provider makes it trivial to add AWS Cognito OAuth protection to any\nFastMCP server using OIDC Discovery. Just provide your Cognito User Pool details,\nclient credentials, and a base URL, and you're ready to go.\n\nFeatures:\n- Automatic OIDC Discovery from AWS Cognito User Pool\n- Automatic JWT token validation via Cognito's public keys\n- Cognito-specific claim filtering (sub, username, cognito:groups)\n- Support for Cognito User Pools\n\n\n**Methods:**\n\n#### `get_token_verifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/aws.py#L245\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_token_verifier(self) -> TokenVerifier\n```\n\nCreates a Cognito-specific token verifier with claim filtering.\n\n**Args:**\n- `algorithm`: Optional token verifier algorithm\n- `audience`: Optional token verifier audience\n- `required_scopes`: Optional token verifier required_scopes\n- `timeout_seconds`: HTTP request timeout in seconds\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-azure.mdx", "content": "---\ntitle: azure\nsidebarTitle: azure\n---\n\n# `fastmcp.server.auth.providers.azure`\n\n\nAzure (Microsoft Entra) OAuth provider for FastMCP.\n\nThis provider implements Azure/Microsoft Entra ID OAuth authentication\nusing the OAuth Proxy pattern for non-DCR OAuth flows.\n\n\n## Classes\n\n### `AzureProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/azure.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for Azure OAuth provider.\n\n\n### `AzureProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/azure.py#L67\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAzure (Microsoft Entra) OAuth provider for FastMCP.\n\nThis provider implements Azure/Microsoft Entra ID authentication using the\nOAuth Proxy pattern. It supports both organizational accounts and personal\nMicrosoft accounts depending on the tenant configuration.\n\nScope Handling:\n- required_scopes: Provide unprefixed scope names (e.g., [\"read\", \"write\"])\n  \u2192 Automatically prefixed with identifier_uri during initialization\n  \u2192 Validated on all tokens and advertised to MCP clients\n- additional_authorize_scopes: Provide full format (e.g., [\"User.Read\"])\n  \u2192 NOT prefixed, NOT validated, NOT advertised to clients\n  \u2192 Used to request Microsoft Graph or other upstream API permissions\n\nFeatures:\n- OAuth proxy to Azure/Microsoft identity platform\n- JWT validation using tenant issuer and JWKS\n- Supports tenant configurations: specific tenant ID, \"organizations\", or \"consumers\"\n- Custom API scopes and Microsoft Graph scopes in a single provider\n\nSetup:\n1. Create an App registration in Azure Portal\n2. Configure Web platform redirect URI: http://localhost:8000/auth/callback (or your custom path)\n3. Add an Application ID URI under \"Expose an API\" (defaults to api://{client_id})\n4. Add custom scopes (e.g., \"read\", \"write\") under \"Expose an API\"\n5. Set access token version to 2 in the App manifest: \"requestedAccessTokenVersion\": 2\n6. Create a client secret\n7. Get Application (client) ID, Directory (tenant) ID, and client secret\n\n\n**Methods:**\n\n#### `authorize` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/azure.py#L317\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nauthorize(self, client: OAuthClientInformationFull, params: AuthorizationParams) -> str\n```\n\nStart OAuth transaction and redirect to Azure AD.\n\nOverride parent's authorize method to filter out the 'resource' parameter\nwhich is not supported by Azure AD v2.0 endpoints. The v2.0 endpoints use\nscopes to determine the resource/audience instead of a separate parameter.\n\n**Args:**\n- `client`: OAuth client information\n- `params`: Authorization parameters from the client\n\n**Returns:**\n- Authorization URL to redirect the user to Azure AD\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-debug.mdx", "content": "---\ntitle: debug\nsidebarTitle: debug\n---\n\n# `fastmcp.server.auth.providers.debug`\n\n\nDebug token verifier for testing and special cases.\n\nThis module provides a flexible token verifier that delegates validation\nto a custom callable. Useful for testing, development, or scenarios where\nstandard verification isn't possible (like opaque tokens without introspection).\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.debug import DebugTokenVerifier\n\n    # Accept all tokens (default - useful for testing)\n    auth = DebugTokenVerifier()\n\n    # Custom sync validation logic\n    auth = DebugTokenVerifier(validate=lambda token: token.startswith(\"valid-\"))\n\n    # Custom async validation logic\n    async def check_cache(token: str) -> bool:\n        return await redis.exists(f\"token:{token}\")\n\n    auth = DebugTokenVerifier(validate=check_cache)\n\n    mcp = FastMCP(\"My Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `DebugTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/debug.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier with custom validation logic.\n\nThis verifier delegates token validation to a user-provided callable.\nBy default, it accepts all non-empty tokens (useful for testing).\n\nUse cases:\n- Testing: Accept any token without real verification\n- Development: Custom validation logic for prototyping\n- Opaque tokens: When you have tokens with no introspection endpoint\n\nWARNING: This bypasses standard security checks. Only use in controlled\nenvironments or when you understand the security implications.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/debug.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify token using custom validation logic.\n\n**Args:**\n- `token`: The token string to validate\n\n**Returns:**\n- AccessToken if validation succeeds, None otherwise\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-descope.mdx", "content": "---\ntitle: descope\nsidebarTitle: descope\n---\n\n# `fastmcp.server.auth.providers.descope`\n\n\nDescope authentication provider for FastMCP.\n\nThis module provides DescopeProvider - a complete authentication solution that integrates\nwith Descope's OAuth 2.1 and OpenID Connect services, supporting Dynamic Client Registration (DCR)\nfor seamless MCP client authentication.\n\n\n## Classes\n\n### `DescopeProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/descope.py#L28\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `DescopeProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/descope.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nDescope metadata provider for DCR (Dynamic Client Registration).\n\nThis provider implements Descope integration using metadata forwarding.\nThis is the recommended approach for Descope DCR\nas it allows Descope to handle the OAuth flow directly while FastMCP acts\nas a resource server.\n\nIMPORTANT SETUP REQUIREMENTS:\n\n1. Create an MCP Server in Descope Console:\n   - Go to the [MCP Servers page](https://app.descope.com/mcp-servers) of the Descope Console\n   - Create a new MCP Server\n   - Ensure that **Dynamic Client Registration (DCR)** is enabled\n   - Note your Well-Known URL\n\n2. Note your Well-Known URL:\n   - Save your Well-Known URL from [MCP Server Settings](https://app.descope.com/mcp-servers)\n   - Format: ``https://.../v1/apps/agentic/P.../M.../.well-known/openid-configuration``\n\nFor detailed setup instructions, see:\nhttps://docs.descope.com/identity-federation/inbound-apps/creating-inbound-apps#method-2-dynamic-client-registration-dcr\n\n\n**Methods:**\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/descope.py#L185\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth routes including Descope authorization server metadata forwarding.\n\nThis returns the standard protected resource routes plus an authorization server\nmetadata endpoint that forwards Descope's OAuth metadata to clients.\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-discord.mdx", "content": "---\ntitle: discord\nsidebarTitle: discord\n---\n\n# `fastmcp.server.auth.providers.discord`\n\n\nDiscord OAuth provider for FastMCP.\n\nThis module provides a complete Discord OAuth integration that's ready to use\nwith just a client ID and client secret. It handles all the complexity of\nDiscord's OAuth flow, token validation, and user management.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.discord import DiscordProvider\n\n    # Simple Discord OAuth protection\n    auth = DiscordProvider(\n        client_id=\"your-discord-client-id\",\n        client_secret=\"your-discord-client-secret\"\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `DiscordProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/discord.py#L43\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for Discord OAuth provider.\n\n\n### `DiscordTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/discord.py#L68\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier for Discord OAuth tokens.\n\nDiscord OAuth tokens are opaque (not JWTs), so we verify them\nby calling Discord's tokeninfo API to check if they're valid and get user info.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/discord.py#L90\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify Discord OAuth token by calling Discord's tokeninfo API.\n\n\n### `DiscordProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/discord.py#L172\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nComplete Discord OAuth provider for FastMCP.\n\nThis provider makes it trivial to add Discord OAuth protection to any\nFastMCP server. Just provide your Discord OAuth app credentials and\na base URL, and you're ready to go.\n\nFeatures:\n- Transparent OAuth proxy to Discord\n- Automatic token validation via Discord's API\n- User information extraction from Discord APIs\n- Minimal configuration required\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-github.mdx", "content": "---\ntitle: github\nsidebarTitle: github\n---\n\n# `fastmcp.server.auth.providers.github`\n\n\nGitHub OAuth provider for FastMCP.\n\nThis module provides a complete GitHub OAuth integration that's ready to use\nwith just a client ID and client secret. It handles all the complexity of\nGitHub's OAuth flow, token validation, and user management.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.github import GitHubProvider\n\n    # Simple GitHub OAuth protection\n    auth = GitHubProvider(\n        client_id=\"your-github-client-id\",\n        client_secret=\"your-github-client-secret\"\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `GitHubProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/github.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for GitHub OAuth provider.\n\n\n### `GitHubTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/github.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier for GitHub OAuth tokens.\n\nGitHub OAuth tokens are opaque (not JWTs), so we verify them\nby calling GitHub's API to check if they're valid and get user info.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/github.py#L87\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify GitHub OAuth token by calling GitHub API.\n\n\n### `GitHubProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/github.py#L170\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nComplete GitHub OAuth provider for FastMCP.\n\nThis provider makes it trivial to add GitHub OAuth protection to any\nFastMCP server. Just provide your GitHub OAuth app credentials and\na base URL, and you're ready to go.\n\nFeatures:\n- Transparent OAuth proxy to GitHub\n- Automatic token validation via GitHub API\n- User information extraction\n- Minimal configuration required\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-google.mdx", "content": "---\ntitle: google\nsidebarTitle: google\n---\n\n# `fastmcp.server.auth.providers.google`\n\n\nGoogle OAuth provider for FastMCP.\n\nThis module provides a complete Google OAuth integration that's ready to use\nwith just a client ID and client secret. It handles all the complexity of\nGoogle's OAuth flow, token validation, and user management.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.google import GoogleProvider\n\n    # Simple Google OAuth protection\n    auth = GoogleProvider(\n        client_id=\"your-google-client-id.apps.googleusercontent.com\",\n        client_secret=\"your-google-client-secret\"\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `GoogleProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/google.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for Google OAuth provider.\n\n\n### `GoogleTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/google.py#L67\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier for Google OAuth tokens.\n\nGoogle OAuth tokens are opaque (not JWTs), so we verify them\nby calling Google's tokeninfo API to check if they're valid and get user info.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/google.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify Google OAuth token by calling Google's tokeninfo API.\n\n\n### `GoogleProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/google.py#L186\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nComplete Google OAuth provider for FastMCP.\n\nThis provider makes it trivial to add Google OAuth protection to any\nFastMCP server. Just provide your Google OAuth app credentials and\na base URL, and you're ready to go.\n\nFeatures:\n- Transparent OAuth proxy to Google\n- Automatic token validation via Google's tokeninfo API\n- User information extraction from Google APIs\n- Minimal configuration required\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-in_memory.mdx", "content": "---\ntitle: in_memory\nsidebarTitle: in_memory\n---\n\n# `fastmcp.server.auth.providers.in_memory`\n\n## Classes\n\n### `InMemoryOAuthProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L31\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAn in-memory OAuth provider for testing purposes.\nIt simulates the OAuth 2.1 flow locally without external calls.\n\n\n**Methods:**\n\n#### `get_client` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_client(self, client_id: str) -> OAuthClientInformationFull | None\n```\n\n#### `register_client` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L68\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_client(self, client_info: OAuthClientInformationFull) -> None\n```\n\n#### `authorize` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L92\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nauthorize(self, client: OAuthClientInformationFull, params: AuthorizationParams) -> str\n```\n\nSimulates user authorization and generates an authorization code.\nReturns a redirect URI with the code and state.\n\n\n#### `load_authorization_code` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L149\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_authorization_code(self, client: OAuthClientInformationFull, authorization_code: str) -> AuthorizationCode | None\n```\n\n#### `exchange_authorization_code` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L162\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nexchange_authorization_code(self, client: OAuthClientInformationFull, authorization_code: AuthorizationCode) -> OAuthToken\n```\n\n#### `load_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L215\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_refresh_token(self, client: OAuthClientInformationFull, refresh_token: str) -> RefreshToken | None\n```\n\n#### `exchange_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L230\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nexchange_refresh_token(self, client: OAuthClientInformationFull, refresh_token: RefreshToken, scopes: list[str]) -> OAuthToken\n```\n\n#### `load_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L287\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_access_token(self, token: str) -> AccessToken | None\n```\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L298\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\nThis method implements the TokenVerifier protocol by delegating\nto our existing load_access_token method.\n\n**Args:**\n- `token`: The token string to validate\n\n**Returns:**\n- AccessToken object if valid, None if invalid or expired\n\n\n#### `revoke_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/in_memory.py#L355\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrevoke_token(self, token: AccessToken | RefreshToken) -> None\n```\n\nRevokes an access or refresh token and its counterpart.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-introspection.mdx", "content": "---\ntitle: introspection\nsidebarTitle: introspection\n---\n\n# `fastmcp.server.auth.providers.introspection`\n\n\nOAuth 2.0 Token Introspection (RFC 7662) provider for FastMCP.\n\nThis module provides token verification for opaque tokens using the OAuth 2.0\nToken Introspection protocol defined in RFC 7662. It allows FastMCP servers to\nvalidate tokens issued by authorization servers that don't use JWT format.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.introspection import IntrospectionTokenVerifier\n\n    # Verify opaque tokens via RFC 7662 introspection\n    verifier = IntrospectionTokenVerifier(\n        introspection_url=\"https://auth.example.com/oauth/introspect\",\n        client_id=\"your-client-id\",\n        client_secret=\"your-client-secret\",\n        required_scopes=[\"read\", \"write\"]\n    )\n\n    mcp = FastMCP(\"My Protected Server\", auth=verifier)\n    ```\n\n\n## Classes\n\n### `IntrospectionTokenVerifierSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/introspection.py#L43\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for OAuth 2.0 Token Introspection verification.\n\n\n### `IntrospectionTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/introspection.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth 2.0 Token Introspection verifier (RFC 7662).\n\nThis verifier validates opaque tokens by calling an OAuth 2.0 token introspection\nendpoint. Unlike JWT verification which is stateless, token introspection requires\na network call to the authorization server for each token validation.\n\nThe verifier authenticates to the introspection endpoint using HTTP Basic Auth\nwith the provided client_id and client_secret, as specified in RFC 7662.\n\nUse this when:\n- Your authorization server issues opaque (non-JWT) tokens\n- You need to validate tokens from Auth0, Okta, Keycloak, or other OAuth servers\n- Your tokens require real-time revocation checking\n- Your authorization server supports RFC 7662 introspection\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/introspection.py#L184\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token using OAuth 2.0 Token Introspection (RFC 7662).\n\nThis method makes a POST request to the introspection endpoint with the token,\nauthenticated using HTTP Basic Auth with the client credentials.\n\n**Args:**\n- `token`: The opaque token string to validate\n\n**Returns:**\n- AccessToken object if valid and active, None if invalid, inactive, or expired\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-jwt.mdx", "content": "---\ntitle: jwt\nsidebarTitle: jwt\n---\n\n# `fastmcp.server.auth.providers.jwt`\n\n\nTokenVerifier implementations for FastMCP.\n\n## Classes\n\n### `JWKData` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nJSON Web Key data structure.\n\n\n### `JWKSData` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nJSON Web Key Set data structure.\n\n\n### `RSAKeyPair` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRSA key pair for JWT testing.\n\n\n**Methods:**\n\n#### `generate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L54\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate(cls) -> RSAKeyPair\n```\n\nGenerate an RSA key pair for testing.\n\n**Returns:**\n- Generated key pair\n\n\n#### `create_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_token(self, subject: str = 'fastmcp-user', issuer: str = 'https://fastmcp.example.com', audience: str | list[str] | None = None, scopes: list[str] | None = None, expires_in_seconds: int = 3600, additional_claims: dict[str, Any] | None = None, kid: str | None = None) -> str\n```\n\nGenerate a test JWT token for testing purposes.\n\n**Args:**\n- `subject`: Subject claim (usually user ID)\n- `issuer`: Issuer claim\n- `audience`: Audience claim - can be a string or list of strings (optional)\n- `scopes`: List of scopes to include\n- `expires_in_seconds`: Token expiration time in seconds\n- `additional_claims`: Any additional claims to include\n- `kid`: Key ID to include in header\n\n\n### `JWTVerifierSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L142\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for JWT token verification.\n\n\n### `JWTVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L165\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nJWT token verifier supporting both asymmetric (RSA/ECDSA) and symmetric (HMAC) algorithms.\n\nThis verifier validates JWT tokens using various signing algorithms:\n- **Asymmetric algorithms** (RS256/384/512, ES256/384/512, PS256/384/512):\n  Uses public/private key pairs. Ideal for external clients and services where\n  only the authorization server has the private key.\n- **Symmetric algorithms** (HS256/384/512): Uses a shared secret for both\n  signing and verification. Perfect for internal microservices and trusted\n  environments where the secret can be securely shared.\n\nUse this when:\n- You have JWT tokens issued by an external service (asymmetric)\n- You need JWKS support for automatic key rotation (asymmetric)\n- You have internal microservices sharing a secret key (symmetric)\n- Your tokens contain standard OAuth scopes and claims\n\n\n**Methods:**\n\n#### `load_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L367\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_access_token(self, token: str) -> AccessToken | None\n```\n\nValidate a JWT bearer token and return an AccessToken when the token is valid.\n\n**Args:**\n- `token`: The JWT bearer token string to validate.\n\n**Returns:**\n- AccessToken | None: An AccessToken populated from token claims if the token is valid; `None` if the token is expired, has an invalid signature or format, fails issuer/audience/scope validation, or any other validation error occurs.\n\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L485\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\nThis method implements the TokenVerifier protocol by delegating\nto our existing load_access_token method.\n\n**Args:**\n- `token`: The JWT token string to validate\n\n**Returns:**\n- AccessToken object if valid, None if invalid or expired\n\n\n### `StaticTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L501\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSimple static token verifier for testing and development.\n\nThis verifier validates tokens against a predefined dictionary of valid token\nstrings and their associated claims. When a token string matches a key in the\ndictionary, the verifier returns the corresponding claims as if the token was\nvalidated by a real authorization server.\n\nUse this when:\n- You're developing or testing locally without a real OAuth server\n- You need predictable tokens for automated testing\n- You want to simulate different users/scopes without complex setup\n- You're prototyping and need simple API key-style authentication\n\nWARNING: Never use this in production - tokens are stored in plain text!\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L535\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify token against static token dictionary.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-oci.mdx", "content": "---\ntitle: oci\nsidebarTitle: oci\n---\n\n# `fastmcp.server.auth.providers.oci`\n\n\nOCI OIDC provider for FastMCP.\n\nThe pull request for the provider is submitted to fastmcp.\n\nThis module provides OIDC Implementation to integrate MCP servers with OCI.\nYou only need OCI Identity Domain's discovery URL, client ID, client secret, and base URL.\n\nPost Authentication, you get OCI IAM domain access token. That is not authorized to invoke OCI control plane.\nYou need to exchange the IAM domain access token for OCI UPST token to invoke OCI control plane APIs.\nThe sample code below has get_oci_signer function that returns OCI TokenExchangeSigner object.\nYou can use the signer object to create OCI service object.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.auth.providers.oci import OCIProvider\n    from fastmcp.server.dependencies import get_access_token\n    from fastmcp.utilities.logging import get_logger\n\n    import os\n\n    # Load configuration from environment\n    FASTMCP_SERVER_AUTH_OCI_CONFIG_URL = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CONFIG_URL\"]\n    FASTMCP_SERVER_AUTH_OCI_CLIENT_ID = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_ID\"]\n    FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET = os.environ[\"FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET\"]\n    FASTMCP_SERVER_AUTH_OCI_IAM_GUID = os.environ[\"FASTMCP_SERVER_AUTH_OCI_IAM_GUID\"]\n\n    import oci\n    from oci.auth.signers import TokenExchangeSigner\n\n    logger = get_logger(__name__)\n\n    # Simple OCI OIDC protection\n    auth = OCIProvider(\n        config_url=FASTMCP_SERVER_AUTH_OCI_CONFIG_URL, #config URL is the OCI IAM Domain OIDC discovery URL.\n        client_id=FASTMCP_SERVER_AUTH_OCI_CLIENT_ID, #This is same as the client ID configured for the OCI IAM Domain Integrated Application\n        client_secret=FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET, #This is same as the client secret configured for the OCI IAM Domain Integrated Application\n        required_scopes=[\"openid\", \"profile\", \"email\"],\n        redirect_path=\"/auth/callback\",\n        base_url=\"http://localhost:8000\",\n    )\n\n    # NOTE: For production use, replace this with a thread-safe cache implementation\n    # such as threading.Lock-protected dict or a proper caching library\n    _global_token_cache = {} #In memory cache for OCI session token signer\n\n    def get_oci_signer() -> TokenExchangeSigner:\n\n        authntoken = get_access_token()\n        tokenID = authntoken.claims.get(\"jti\")\n        token = authntoken.token\n\n        #Check if the signer exists for the token ID in memory cache\n        cached_signer = _global_token_cache.get(tokenID)\n        logger.debug(f\"Global cached signer: {cached_signer}\")\n        if cached_signer:\n            logger.debug(f\"Using globally cached signer for token ID: {tokenID}\")\n            return cached_signer\n\n        #If the signer is not yet created for the token then create new OCI signer object\n        logger.debug(f\"Creating new signer for token ID: {tokenID}\")\n        signer = TokenExchangeSigner(\n            jwt_or_func=token,\n            oci_domain_id=FASTMCP_SERVER_AUTH_OCI_IAM_GUID.split(\".\")[0],   #This is same as IAM GUID configured for the OCI IAM Domain\n            client_id=FASTMCP_SERVER_AUTH_OCI_CLIENT_ID, #This is same as the client ID configured for the OCI IAM Domain Integrated Application\n            client_secret=FASTMCP_SERVER_AUTH_OCI_CLIENT_SECRET #This is same as the client secret configured for the OCI IAM Domain Integrated Application\n        )\n        logger.debug(f\"Signer {signer} created for token ID: {tokenID}\")\n\n        #Cache the signer object in memory cache\n        _global_token_cache[tokenID] = signer\n        logger.debug(f\"Signer cached for token ID: {tokenID}\")\n\n        return signer\n\n    mcp = FastMCP(\"My Protected Server\", auth=auth)\n    ```\n\n\n## Classes\n\n### `OCIProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/oci.py#L93\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for OCI IAM domain OIDC provider.\n\n\n### `OCIProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/oci.py#L119\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAn OCI IAM Domain provider implementation for FastMCP.\n\nThis provider is a complete OCI integration that's ready to use with\njust the configuration URL, client ID, client secret, and base URL.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-scalekit.mdx", "content": "---\ntitle: scalekit\nsidebarTitle: scalekit\n---\n\n# `fastmcp.server.auth.providers.scalekit`\n\n\nScalekit authentication provider for FastMCP.\n\nThis module provides ScalekitProvider - a complete authentication solution that integrates\nwith Scalekit's OAuth 2.1 and OpenID Connect services, supporting Resource Server\nauthentication for seamless MCP client authentication.\n\n\n## Classes\n\n### `ScalekitProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/scalekit.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `ScalekitProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/scalekit.py#L55\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nScalekit resource server provider for OAuth 2.1 authentication.\n\nThis provider implements Scalekit integration using resource server pattern.\nFastMCP acts as a protected resource server that validates access tokens issued\nby Scalekit's authorization server.\n\nIMPORTANT SETUP REQUIREMENTS:\n\n1. Create an MCP Server in Scalekit Dashboard:\n   - Go to your [Scalekit Dashboard](https://app.scalekit.com/)\n   - Navigate to MCP Servers section\n   - Register a new MCP Server with appropriate scopes\n   - Ensure the Resource Identifier matches exactly what you configure as MCP URL\n   - Note the Resource ID\n\n2. Environment Configuration:\n   - Set SCALEKIT_ENVIRONMENT_URL (e.g., https://your-env.scalekit.com)\n   - Set SCALEKIT_RESOURCE_ID from your created resource\n   - Set BASE_URL to your FastMCP server's public URL\n\nFor detailed setup instructions, see:\nhttps://docs.scalekit.com/mcp/overview/\n\n\n**Methods:**\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/scalekit.py#L182\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth routes including Scalekit authorization server metadata forwarding.\n\nThis returns the standard protected resource routes plus an authorization server\nmetadata endpoint that forwards Scalekit's OAuth metadata to clients.\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-supabase.mdx", "content": "---\ntitle: supabase\nsidebarTitle: supabase\n---\n\n# `fastmcp.server.auth.providers.supabase`\n\n\nSupabase authentication provider for FastMCP.\n\nThis module provides SupabaseProvider - a complete authentication solution that integrates\nwith Supabase Auth's JWT verification, supporting Dynamic Client Registration (DCR)\nfor seamless MCP client authentication.\n\n\n## Classes\n\n### `SupabaseProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/supabase.py#L28\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `SupabaseProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/supabase.py#L46\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSupabase metadata provider for DCR (Dynamic Client Registration).\n\nThis provider implements Supabase Auth integration using metadata forwarding.\nThis approach allows Supabase to handle the OAuth flow directly while FastMCP acts\nas a resource server, verifying JWTs issued by Supabase Auth.\n\nIMPORTANT SETUP REQUIREMENTS:\n\n1. Supabase Project Setup:\n   - Create a Supabase project at https://supabase.com\n   - Note your project URL (e.g., \"https://abc123.supabase.co\")\n   - Configure your JWT algorithm in Supabase Auth settings (HS256, RS256, or ES256)\n   - Asymmetric keys (RS256/ES256) are recommended for production\n\n2. JWT Verification:\n   - FastMCP verifies JWTs using the JWKS endpoint at {project_url}/auth/v1/.well-known/jwks.json\n   - JWTs are issued by {project_url}/auth/v1\n   - Tokens are cached for up to 10 minutes by Supabase's edge servers\n   - Algorithm must match your Supabase Auth configuration\n\n3. Authorization:\n   - Supabase uses Row Level Security (RLS) policies for database authorization\n   - OAuth-level scopes are an upcoming feature in Supabase Auth\n   - Both approaches will be supported once scope handling is available\n\nFor detailed setup instructions, see:\nhttps://supabase.com/docs/guides/auth/jwts\n\n\n**Methods:**\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/supabase.py#L144\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth routes including Supabase authorization server metadata forwarding.\n\nThis returns the standard protected resource routes plus an authorization server\nmetadata endpoint that forwards Supabase's OAuth metadata to clients.\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-providers-workos.mdx", "content": "---\ntitle: workos\nsidebarTitle: workos\n---\n\n# `fastmcp.server.auth.providers.workos`\n\n\nWorkOS authentication providers for FastMCP.\n\nThis module provides two WorkOS authentication strategies:\n\n1. WorkOSProvider - OAuth proxy for WorkOS Connect applications (non-DCR)\n2. AuthKitProvider - DCR-compliant provider for WorkOS AuthKit\n\nChoose based on your WorkOS setup and authentication requirements.\n\n\n## Classes\n\n### `WorkOSProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L31\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSettings for WorkOS OAuth provider.\n\n\n### `WorkOSTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L57\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken verifier for WorkOS OAuth tokens.\n\nWorkOS AuthKit tokens are opaque, so we verify them by calling\nthe /oauth2/userinfo endpoint to check validity and get user info.\n\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L82\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify WorkOS OAuth token by calling userinfo endpoint.\n\n\n### `WorkOSProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L129\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nComplete WorkOS OAuth provider for FastMCP.\n\nThis provider implements WorkOS AuthKit OAuth using the OAuth Proxy pattern.\nIt provides OAuth2 authentication for users through WorkOS Connect applications.\n\nFeatures:\n- Transparent OAuth proxy to WorkOS AuthKit\n- Automatic token validation via userinfo endpoint\n- User information extraction from ID tokens\n- Support for standard OAuth scopes (openid, profile, email)\n\nSetup Requirements:\n1. Create a WorkOS Connect application in your dashboard\n2. Note your AuthKit domain (e.g., \"https://your-app.authkit.app\")\n3. Configure redirect URI as: http://localhost:8000/auth/callback\n4. Note your Client ID and Client Secret\n\n\n### `AuthKitProviderSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L287\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `AuthKitProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L304\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAuthKit metadata provider for DCR (Dynamic Client Registration).\n\nThis provider implements AuthKit integration using metadata forwarding\ninstead of OAuth proxying. This is the recommended approach for WorkOS DCR\nas it allows WorkOS to handle the OAuth flow directly while FastMCP acts\nas a resource server.\n\nIMPORTANT SETUP REQUIREMENTS:\n\n1. Enable Dynamic Client Registration in WorkOS Dashboard:\n   - Go to Applications \u2192 Configuration\n   - Toggle \"Dynamic Client Registration\" to enabled\n\n2. Configure your FastMCP server URL as a callback:\n   - Add your server URL to the Redirects tab in WorkOS dashboard\n   - Example: https://your-fastmcp-server.com/oauth2/callback\n\nFor detailed setup instructions, see:\nhttps://workos.com/docs/authkit/mcp/integrating/token-verification\n\n\n**Methods:**\n\n#### `get_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/workos.py#L387\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_routes(self, mcp_path: str | None = None) -> list[Route]\n```\n\nGet OAuth routes including AuthKit authorization server metadata forwarding.\n\nThis returns the standard protected resource routes plus an authorization server\nmetadata endpoint that forwards AuthKit's OAuth metadata to clients.\n\n**Args:**\n- `mcp_path`: The path where the MCP endpoint is mounted (e.g., \"/mcp\")\nThis is used to advertise the resource URL in metadata.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-auth-redirect_validation.mdx", "content": "---\ntitle: redirect_validation\nsidebarTitle: redirect_validation\n---\n\n# `fastmcp.server.auth.redirect_validation`\n\n\nUtilities for validating client redirect URIs in OAuth flows.\n\n## Functions\n\n### `matches_allowed_pattern` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/redirect_validation.py#L8\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmatches_allowed_pattern(uri: str, pattern: str) -> bool\n```\n\n\nCheck if a URI matches an allowed pattern with wildcard support.\n\nPatterns support * wildcard matching:\n- http://localhost:* matches any localhost port\n- http://127.0.0.1:* matches any 127.0.0.1 port\n- https://*.example.com/* matches any subdomain of example.com\n- https://app.example.com/auth/* matches any path under /auth/\n\n**Args:**\n- `uri`: The redirect URI to validate\n- `pattern`: The allowed pattern (may contain wildcards)\n\n**Returns:**\n- True if the URI matches the pattern\n\n\n### `validate_redirect_uri` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/redirect_validation.py#L28\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_redirect_uri(redirect_uri: str | AnyUrl | None, allowed_patterns: list[str] | None) -> bool\n```\n\n\nValidate a redirect URI against allowed patterns.\n\n**Args:**\n- `redirect_uri`: The redirect URI to validate\n- `allowed_patterns`: List of allowed patterns. If None, all URIs are allowed (for DCR compatibility).\n             If empty list, no URIs are allowed.\n             To restrict to localhost only, explicitly pass DEFAULT_LOCALHOST_PATTERNS.\n\n**Returns:**\n- True if the redirect URI is allowed\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-context.mdx", "content": "---\ntitle: context\nsidebarTitle: context\n---\n\n# `fastmcp.server.context`\n\n## Functions\n\n### `set_context` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L106\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_context(context: Context) -> Generator[Context, None, None]\n```\n\n## Classes\n\n### `LogData` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L82\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nData object for passing log arguments to client-side handlers.\n\nThis provides an interface to match the Python standard library logging,\nfor compatibility with structured logging.\n\n\n### `Context` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L115\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nContext object providing access to MCP capabilities.\n\nThis provides a cleaner interface to MCP's RequestContext functionality.\nIt gets injected into tool and resource functions that request it via type hints.\n\nTo use context in a tool function, add a parameter with the Context type annotation:\n\n```python\n@server.tool\nasync def my_tool(x: int, ctx: Context) -> str:\n    # Log messages to the client\n    await ctx.info(f\"Processing {x}\")\n    await ctx.debug(\"Debug info\")\n    await ctx.warning(\"Warning message\")\n    await ctx.error(\"Error message\")\n\n    # Report progress\n    await ctx.report_progress(50, 100, \"Processing\")\n\n    # Access resources\n    data = await ctx.read_resource(\"resource://data\")\n\n    # Get request info\n    request_id = ctx.request_id\n    client_id = ctx.client_id\n\n    # Manage state across the request\n    ctx.set_state(\"key\", \"value\")\n    value = ctx.get_state(\"key\")\n\n    return str(x)\n```\n\nState Management:\nContext objects maintain a state dictionary that can be used to store and share\ndata across middleware and tool calls within a request. When a new context\nis created (nested contexts), it inherits a copy of its parent's state, ensuring\nthat modifications in child contexts don't affect parent contexts.\n\nThe context parameter name can be anything as long as it's annotated with Context.\nThe context is optional - tools that don't need it can omit the parameter.\n\n\n**Methods:**\n\n#### `fastmcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L169\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfastmcp(self) -> FastMCP\n```\n\nGet the FastMCP instance.\n\n\n#### `request_context` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L223\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrequest_context(self) -> RequestContext[ServerSession, Any, Request] | None\n```\n\nAccess to the underlying request context.\n\nReturns None when the MCP session has not been established yet.\nReturns the full RequestContext once the MCP session is available.\n\nFor HTTP request access in middleware, use `get_http_request()` from fastmcp.server.dependencies,\nwhich works whether or not the MCP session is available.\n\nExample in middleware:\n```python\nasync def on_request(self, context, call_next):\n    ctx = context.fastmcp_context\n    if ctx.request_context:\n        # MCP session available - can access session_id, request_id, etc.\n        session_id = ctx.session_id\n    else:\n        # MCP session not available yet - use HTTP helpers\n        from fastmcp.server.dependencies import get_http_request\n        request = get_http_request()\n    return await call_next(context)\n```\n\n\n#### `report_progress` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L251\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nreport_progress(self, progress: float, total: float | None = None, message: str | None = None) -> None\n```\n\nReport progress for the current operation.\n\n**Args:**\n- `progress`: Current progress value e.g. 24\n- `total`: Optional total value e.g. 100\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L278\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> list[SDKResource]\n```\n\nList all available resources from the server.\n\n**Returns:**\n- List of Resource objects available on the server\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L286\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> list[SDKPrompt]\n```\n\nList all available prompts from the server.\n\n**Returns:**\n- List of Prompt objects available on the server\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L294\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str, arguments: dict[str, Any] | None = None) -> GetPromptResult\n```\n\nGet a prompt by name with optional arguments.\n\n**Args:**\n- `name`: The name of the prompt to get\n- `arguments`: Optional arguments to pass to the prompt\n\n**Returns:**\n- The prompt result\n\n\n#### `read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L308\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource(self, uri: str | AnyUrl) -> list[ResourceContent]\n```\n\nRead a resource by URI.\n\n**Args:**\n- `uri`: Resource URI to read\n\n**Returns:**\n- List of ResourceContent objects\n\n\n#### `log` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L320\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlog(self, message: str, level: LoggingLevel | None = None, logger_name: str | None = None, extra: Mapping[str, Any] | None = None) -> None\n```\n\nSend a log message to the client.\n\nMessages sent to Clients are also logged to the `fastmcp.server.context.to_client` logger with a level of `DEBUG`.\n\n**Args:**\n- `message`: Log message\n- `level`: Optional log level. One of \"debug\", \"info\", \"notice\", \"warning\", \"error\", \"critical\",\n\"alert\", or \"emergency\". Default is \"info\".\n- `logger_name`: Optional logger name\n- `extra`: Optional mapping for additional arguments\n\n\n#### `client_id` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L349\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclient_id(self) -> str | None\n```\n\nGet the client ID if available.\n\n\n#### `request_id` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L358\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrequest_id(self) -> str\n```\n\nGet the unique ID for this request.\n\nRaises RuntimeError if MCP request context is not available.\n\n\n#### `session_id` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L371\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsession_id(self) -> str\n```\n\nGet the MCP session ID for ALL transports.\n\nReturns the session ID that can be used as a key for session-based\ndata storage (e.g., Redis) to share data between tool calls within\nthe same client session.\n\n**Returns:**\n- The session ID for StreamableHTTP transports, or a generated ID\n- for other transports.\n\n\n#### `session` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L423\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsession(self) -> ServerSession\n```\n\nAccess to the underlying session for advanced usage.\n\nRaises RuntimeError if MCP request context is not available.\n\n\n#### `debug` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L436\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndebug(self, message: str, logger_name: str | None = None, extra: Mapping[str, Any] | None = None) -> None\n```\n\nSend a `DEBUG`-level message to the connected MCP Client.\n\nMessages sent to Clients are also logged to the `fastmcp.server.context.to_client` logger with a level of `DEBUG`.\n\n\n#### `info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L452\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninfo(self, message: str, logger_name: str | None = None, extra: Mapping[str, Any] | None = None) -> None\n```\n\nSend a `INFO`-level message to the connected MCP Client.\n\nMessages sent to Clients are also logged to the `fastmcp.server.context.to_client` logger with a level of `DEBUG`.\n\n\n#### `warning` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L468\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwarning(self, message: str, logger_name: str | None = None, extra: Mapping[str, Any] | None = None) -> None\n```\n\nSend a `WARNING`-level message to the connected MCP Client.\n\nMessages sent to Clients are also logged to the `fastmcp.server.context.to_client` logger with a level of `DEBUG`.\n\n\n#### `error` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L484\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nerror(self, message: str, logger_name: str | None = None, extra: Mapping[str, Any] | None = None) -> None\n```\n\nSend a `ERROR`-level message to the connected MCP Client.\n\nMessages sent to Clients are also logged to the `fastmcp.server.context.to_client` logger with a level of `DEBUG`.\n\n\n#### `list_roots` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L500\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_roots(self) -> list[Root]\n```\n\nList the roots available to the server, as indicated by the client.\n\n\n#### `send_notification` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L505\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsend_notification(self, notification: mcp.types.ServerNotificationType) -> None\n```\n\nSend a notification to the client immediately.\n\nUse this in async code when you want the notification sent right away.\nFor sync code, use send_notification_sync() which queues the notification\nfor the background flusher.\n\n**Args:**\n- `notification`: An MCP notification instance (e.g., ToolListChangedNotification())\n\n\n#### `send_notification_sync` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L519\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsend_notification_sync(self, notification: mcp.types.ServerNotificationType) -> None\n```\n\nQueue a notification to be sent by the background flusher.\n\nUse this in sync code when you can't await. The notification will be\nsent within ~1 second by the background flusher.\n\n**Args:**\n- `notification`: An MCP notification instance (e.g., ToolListChangedNotification())\n\n\n#### `close_sse_stream` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L532\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclose_sse_stream(self) -> None\n```\n\nClose the current response stream to trigger client reconnection.\n\nWhen using StreamableHTTP transport with an EventStore configured, this\nmethod gracefully closes the HTTP connection for the current request.\nThe client will automatically reconnect (after `retry_interval` milliseconds)\nand resume receiving events from where it left off via the EventStore.\n\nThis is useful for long-running operations to avoid load balancer timeouts.\nInstead of holding a connection open for minutes, you can periodically close\nand let the client reconnect.\n\n\n#### `sample_step` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L571\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsample_step(self, messages: str | Sequence[str | SamplingMessage]) -> SampleStep\n```\n\nMake a single LLM sampling call.\n\nThis is a stateless function that makes exactly one LLM call and optionally\nexecutes any requested tools. Use this for fine-grained control over the\nsampling loop.\n\n**Args:**\n- `messages`: The message(s) to send. Can be a string, list of strings,\nor list of SamplingMessage objects.\n- `system_prompt`: Optional system prompt for the LLM.\n- `temperature`: Optional sampling temperature.\n- `max_tokens`: Maximum tokens to generate. Defaults to 512.\n- `model_preferences`: Optional model preferences.\n- `tools`: Optional list of tools the LLM can use.\n- `tool_choice`: Tool choice mode (\"auto\", \"required\", or \"none\").\n- `execute_tools`: If True (default), execute tool calls and append results\nto history. If False, return immediately with tool_calls available\nin the step for manual execution.\n- `mask_error_details`: If True, mask detailed error messages from tool\nexecution. When None (default), uses the global settings value.\nTools can raise ToolError to bypass masking.\n\n**Returns:**\n- SampleStep containing:\n- - .response: The raw LLM response\n- - .history: Messages including input, assistant response, and tool results\n- - .is_tool_use: True if the LLM requested tool execution\n- - .tool_calls: List of tool calls (if any)\n- - .text: The text content (if any)\n\n\n#### `sample` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L724\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsample(self, messages: str | Sequence[str | SamplingMessage]) -> SamplingResult[ResultT]\n```\n\nOverload: With result_type, returns SamplingResult[ResultT].\n\n\n#### `sample` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L739\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsample(self, messages: str | Sequence[str | SamplingMessage]) -> SamplingResult[str]\n```\n\nOverload: Without result_type, returns SamplingResult[str].\n\n\n#### `sample` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L753\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsample(self, messages: str | Sequence[str | SamplingMessage]) -> SamplingResult[ResultT] | SamplingResult[str]\n```\n\nSend a sampling request to the client and await the response.\n\nThis method runs to completion automatically. When tools are provided,\nit executes a tool loop: if the LLM returns a tool use request, the tools\nare executed and the results are sent back to the LLM. This continues\nuntil the LLM provides a final text response.\n\nWhen result_type is specified, a synthetic `final_response` tool is\ncreated. The LLM calls this tool to provide the structured response,\nwhich is validated against the result_type and returned as `.result`.\n\nFor fine-grained control over the sampling loop, use sample_step() instead.\n\n**Args:**\n- `messages`: The message(s) to send. Can be a string, list of strings,\nor list of SamplingMessage objects.\n- `system_prompt`: Optional system prompt for the LLM.\n- `temperature`: Optional sampling temperature.\n- `max_tokens`: Maximum tokens to generate. Defaults to 512.\n- `model_preferences`: Optional model preferences.\n- `tools`: Optional list of tools the LLM can use. Accepts plain\nfunctions or SamplingTools.\n- `result_type`: Optional type for structured output. When specified,\na synthetic `final_response` tool is created and the LLM's\nresponse is validated against this type.\n- `mask_error_details`: If True, mask detailed error messages from tool\nexecution. When None (default), uses the global settings value.\nTools can raise ToolError to bypass masking.\n\n**Returns:**\n- SamplingResult[T] containing:\n- - .text: The text representation (raw text or JSON for structured)\n- - .result: The typed result (str for text, parsed object for structured)\n- - .history: All messages exchanged during sampling\n\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L910\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: None) -> AcceptedElicitation[dict[str, Any]] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L922\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: type[T]) -> AcceptedElicitation[T] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L932\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: list[str]) -> AcceptedElicitation[str] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L942\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: dict[str, dict[str, str]]) -> AcceptedElicitation[str] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L952\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: list[list[str]]) -> AcceptedElicitation[list[str]] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L964\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: list[dict[str, dict[str, str]]]) -> AcceptedElicitation[list[str]] | DeclinedElicitation | CancelledElicitation\n```\n\n#### `elicit` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L976\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nelicit(self, message: str, response_type: type[T] | list[str] | dict[str, dict[str, str]] | list[list[str]] | list[dict[str, dict[str, str]]] | None = None) -> AcceptedElicitation[T] | AcceptedElicitation[dict[str, Any]] | AcceptedElicitation[str] | AcceptedElicitation[list[str]] | DeclinedElicitation | CancelledElicitation\n```\n\nSend an elicitation request to the client and await the response.\n\nCall this method at any time to request additional information from\nthe user through the client. The client must support elicitation,\nor the request will error.\n\nNote that the MCP protocol only supports simple object schemas with\nprimitive types. You can provide a dataclass, TypedDict, or BaseModel to\ncomply. If you provide a primitive type, an object schema with a single\n\"value\" field will be generated for the MCP interaction and\nautomatically deconstructed into the primitive type upon response.\n\nIf the response_type is None, the generated schema will be that of an\nempty object in order to comply with the MCP protocol requirements.\nClients must send an empty object (\"{}\")in response.\n\n**Args:**\n- `message`: A human-readable message explaining what information is needed\n- `response_type`: The type of the response, which should be a primitive\ntype or dataclass or BaseModel. If it is a primitive type, an\nobject schema with a single \"value\" field will be generated.\n\n\n#### `set_state` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L1033\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_state(self, key: str, value: Any) -> None\n```\n\nSet a value in the context state.\n\n\n#### `get_state` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/context.py#L1037\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_state(self, key: str) -> Any\n```\n\nGet a value from the context state. Returns None if the key is not found.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-dependencies.mdx", "content": "---\ntitle: dependencies\nsidebarTitle: dependencies\n---\n\n# `fastmcp.server.dependencies`\n\n## Functions\n\n### `without_injected_parameters` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L97\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwithout_injected_parameters(fn: Callable[..., Any]) -> Callable[..., Any]\n```\n\n\nCreate a wrapper function without injected parameters.\n\nReturns a wrapper that excludes Context and Docket dependency parameters,\nmaking it safe to use with Pydantic TypeAdapter for schema generation and\nvalidation. The wrapper internally handles all dependency resolution and\nContext injection when called.\n\n**Args:**\n- `fn`: Original function with Context and/or dependencies\n\n**Returns:**\n- Async wrapper function without injected parameters\n\n\n### `resolve_dependencies` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L224\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresolve_dependencies(fn: Callable[..., Any], arguments: dict[str, Any]) -> AsyncGenerator[dict[str, Any], None]\n```\n\n\nResolve dependencies and inject Context for a FastMCP function.\n\nThis function:\n1. Filters out any dependency parameter names from user arguments (security)\n2. Resolves Docket dependencies\n3. Injects Context if needed\n4. Merges everything together\n\nThe filtering prevents external callers from overriding injected parameters by\nproviding values for dependency parameter names. This is a security feature.\n\n**Args:**\n- `fn`: The function to resolve dependencies for\n- `arguments`: User arguments (may contain keys that match dependency names,\n      which will be filtered out)\n\n\n### `get_context` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L271\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_context() -> Context\n```\n\n### `get_task_metadata` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L280\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_task_metadata() -> dict[str, Any] | None\n```\n\n\nGet the current task metadata from the context.\n\n**Returns:**\n- The task metadata dict if this is a background task request,\n- or None if this is a normal execution.\n\n\n### `CurrentContext` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L297\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nCurrentContext() -> Context\n```\n\n\nGet the current FastMCP Context instance.\n\nThis dependency provides access to the active FastMCP Context for the\ncurrent MCP operation (tool/resource/prompt call).\n\n**Returns:**\n- A dependency that resolves to the active Context instance\n\n**Raises:**\n- `RuntimeError`: If no active context found (during resolution)\n\n\n### `CurrentDocket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L337\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nCurrentDocket() -> Docket\n```\n\n\nGet the current Docket instance managed by FastMCP.\n\nThis dependency provides access to the Docket instance that FastMCP\nautomatically creates for background task scheduling.\n\n**Returns:**\n- A dependency that resolves to the active Docket instance\n\n**Raises:**\n- `RuntimeError`: If not within a FastMCP server context\n\n\n### `CurrentWorker` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L376\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nCurrentWorker() -> Worker\n```\n\n\nGet the current Docket Worker instance managed by FastMCP.\n\nThis dependency provides access to the Worker instance that FastMCP\nautomatically creates for background task processing.\n\n**Returns:**\n- A dependency that resolves to the active Worker instance\n\n**Raises:**\n- `RuntimeError`: If not within a FastMCP server context\n\n\n### `CurrentFastMCP` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L489\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nCurrentFastMCP()\n```\n\n\nGet the current FastMCP server instance.\n\nThis dependency provides access to the active FastMCP server.\n\n**Returns:**\n- A dependency that resolves to the active FastMCP server\n\n**Raises:**\n- `RuntimeError`: If no server in context (during resolution)\n\n\n### `get_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L514\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_server()\n```\n\n\nGet the current FastMCP server instance directly.\n\n**Returns:**\n- The active FastMCP server\n\n**Raises:**\n- `RuntimeError`: If no server in context\n\n\n### `get_http_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L533\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_http_request() -> Request\n```\n\n### `get_http_headers` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L549\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_http_headers(include_all: bool = False) -> dict[str, str]\n```\n\n\nExtract headers from the current HTTP request if available.\n\nNever raises an exception, even if there is no active HTTP request (in which case\nan empty dict is returned).\n\nBy default, strips problematic headers like `content-length` that cause issues if forwarded to downstream clients.\nIf `include_all` is True, all headers are returned.\n\n\n### `get_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L595\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_access_token() -> AccessToken | None\n```\n\n\nGet the FastMCP access token from the current context.\n\nThis function first tries to get the token from the current HTTP request's scope,\nwhich is more reliable for long-lived connections where the SDK's auth_context_var\nmay become stale after token refresh. Falls back to the SDK's context var if no\nrequest is available.\n\n**Returns:**\n- The access token if an authenticated user is available, None otherwise.\n\n\n## Classes\n\n### `InMemoryProgress` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L400\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nIn-memory progress tracker for immediate tool execution.\n\nProvides the same interface as Progress but stores state in memory\ninstead of Redis. Useful for testing and immediate execution where\nprogress doesn't need to be observable across processes.\n\n\n**Methods:**\n\n#### `current` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L418\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncurrent(self) -> int | None\n```\n\n#### `total` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L422\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntotal(self) -> int\n```\n\n#### `message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L426\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmessage(self) -> str | None\n```\n\n#### `set_total` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L429\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_total(self, total: int) -> None\n```\n\nSet the total/target value for progress tracking.\n\n\n#### `increment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L435\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nincrement(self, amount: int = 1) -> None\n```\n\nAtomically increment the current progress value.\n\n\n#### `set_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L444\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_message(self, message: str | None) -> None\n```\n\nUpdate the progress status message.\n\n\n### `Progress` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/dependencies.py#L449\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nFastMCP Progress dependency that works in both server and worker contexts.\n\nExtends Docket's Progress to handle two execution modes:\n- In Docket worker: Uses the execution's progress (standard Docket behavior)\n- In FastMCP server: Uses in-memory progress (not observable remotely)\n\nThis allows tools to use Progress() regardless of whether they're called\nimmediately or as background tasks.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-elicitation.mdx", "content": "---\ntitle: elicitation\nsidebarTitle: elicitation\n---\n\n# `fastmcp.server.elicitation`\n\n## Functions\n\n### `parse_elicit_response_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L132\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_elicit_response_type(response_type: Any) -> ElicitConfig\n```\n\n\nParse response_type into schema and handling configuration.\n\nSupports multiple syntaxes:\n- None: Empty object schema, expect empty response\n- dict: {\"low\": {\"title\": \"...\"}} -> single-select titled enum\n- list patterns:\n    - [[\"a\", \"b\"]] -> multi-select untitled\n    - [{\"low\": {...}}] -> multi-select titled\n    - [\"a\", \"b\"] -> single-select untitled\n- list\\[X] type annotation: multi-select with type\n- Scalar types (bool, int, float, str, Literal, Enum): single value\n- Other types (dataclass, BaseModel): use directly\n\n\n### `handle_elicit_accept` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L263\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nhandle_elicit_accept(config: ElicitConfig, content: Any) -> AcceptedElicitation[Any]\n```\n\n\nHandle an accepted elicitation response.\n\n**Args:**\n- `config`: The elicitation configuration from parse_elicit_response_type\n- `content`: The response content from the client\n\n**Returns:**\n- AcceptedElicitation with the extracted/validated data\n\n\n### `get_elicitation_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L318\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_elicitation_schema(response_type: type[T]) -> dict[str, Any]\n```\n\n\nGet the schema for an elicitation response.\n\n**Args:**\n- `response_type`: The type of the response\n\n\n### `validate_elicitation_json_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L337\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_elicitation_json_schema(schema: dict[str, Any]) -> None\n```\n\n\nValidate that a JSON schema follows MCP elicitation requirements.\n\nThis ensures the schema is compatible with MCP elicitation requirements:\n- Must be an object schema\n- Must only contain primitive field types (string, number, integer, boolean)\n- Must be flat (no nested objects or arrays of objects)\n- Allows const fields (for Literal types) and enum fields (for Enum types)\n- Only primitive types and their nullable variants are allowed\n\n**Args:**\n- `schema`: The JSON schema to validate\n\n**Raises:**\n- `TypeError`: If the schema doesn't meet MCP elicitation requirements\n\n\n## Classes\n\n### `ElicitationJsonSchema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L36\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nCustom JSON schema generator for MCP elicitation that always inlines enums.\n\nMCP elicitation requires inline enum schemas without $ref/$defs references.\nThis generator ensures enums are always generated inline for compatibility.\nOptionally adds enumNames for better UI display when available.\n\n\n**Methods:**\n\n#### `generate_inner` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L44\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_inner(self, schema: core_schema.CoreSchema) -> JsonSchemaValue\n```\n\nOverride to prevent ref generation for enums and handle list schemas.\n\n\n#### `list_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L57\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_schema(self, schema: core_schema.ListSchema) -> JsonSchemaValue\n```\n\nGenerate schema for list types, detecting enum items for multi-select.\n\n\n#### `enum_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L94\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nenum_schema(self, schema: core_schema.EnumSchema) -> JsonSchemaValue\n```\n\nGenerate inline enum schema.\n\nAlways generates enum pattern: {\"enum\": [value, ...]}\nTitled enums are handled separately via dict-based syntax in ctx.elicit().\n\n\n### `AcceptedElicitation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L105\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResult when user accepts the elicitation.\n\n\n### `ScalarElicitationType` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L113\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `ElicitConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/elicitation.py#L118\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for an elicitation request.\n\n**Attributes:**\n- `schema`: The JSON schema to send to the client\n- `response_type`: The type to validate responses with (None for raw schemas)\n- `is_raw`: True if schema was built directly (extract \"value\" from response)\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-event_store.mdx", "content": "---\ntitle: event_store\nsidebarTitle: event_store\n---\n\n# `fastmcp.server.event_store`\n\n\nEventStore implementation backed by AsyncKeyValue.\n\nThis module provides an EventStore implementation that enables SSE polling/resumability\nfor Streamable HTTP transports. Events are stored using the key_value package's\nAsyncKeyValue protocol, allowing users to configure any compatible backend\n(in-memory, Redis, etc.) following the same pattern as ResponseCachingMiddleware.\n\n\n## Classes\n\n### `EventEntry` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/event_store.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nStored event entry.\n\n\n### `StreamEventList` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/event_store.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nList of event IDs for a stream.\n\n\n### `EventStore` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/event_store.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nEventStore implementation backed by AsyncKeyValue.\n\nEnables SSE polling/resumability by storing events that can be replayed\nwhen clients reconnect. Works with any AsyncKeyValue backend (memory, Redis, etc.)\nfollowing the same pattern as ResponseCachingMiddleware and OAuthProxy.\n\n**Args:**\n- `storage`: AsyncKeyValue backend. Defaults to MemoryStore.\n- `max_events_per_stream`: Maximum events to retain per stream. Default 100.\n- `ttl`: Event TTL in seconds. Default 3600 (1 hour). Set to None for no expiration.\n\n\n**Methods:**\n\n#### `store_event` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/event_store.py#L94\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nstore_event(self, stream_id: StreamId, message: JSONRPCMessage | None) -> EventId\n```\n\nStore an event and return its ID.\n\n**Args:**\n- `stream_id`: ID of the stream the event belongs to\n- `message`: The JSON-RPC message to store, or None for priming events\n\n**Returns:**\n- The generated event ID for the stored event\n\n\n#### `replay_events_after` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/event_store.py#L135\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nreplay_events_after(self, last_event_id: EventId, send_callback: EventCallback) -> StreamId | None\n```\n\nReplay events that occurred after the specified event ID.\n\n**Args:**\n- `last_event_id`: The ID of the last event the client received\n- `send_callback`: A callback function to send events to the client\n\n**Returns:**\n- The stream ID of the replayed events, or None if the event ID was not found\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-http.mdx", "content": "---\ntitle: http\nsidebarTitle: http\n---\n\n# `fastmcp.server.http`\n\n## Functions\n\n### `set_http_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L78\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_http_request(request: Request) -> Generator[Request, None, None]\n```\n\n### `create_base_app` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L102\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_base_app(routes: list[BaseRoute], middleware: list[Middleware], debug: bool = False, lifespan: Callable | None = None) -> StarletteWithLifespan\n```\n\n\nCreate a base Starlette app with common middleware and routes.\n\n**Args:**\n- `routes`: List of routes to include in the app\n- `middleware`: List of middleware to include in the app\n- `debug`: Whether to enable debug mode\n- `lifespan`: Optional lifespan manager for the app\n\n**Returns:**\n- A Starlette application\n\n\n### `create_sse_app` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L131\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_sse_app(server: FastMCP[LifespanResultT], message_path: str, sse_path: str, auth: AuthProvider | None = None, debug: bool = False, routes: list[BaseRoute] | None = None, middleware: list[Middleware] | None = None) -> StarletteWithLifespan\n```\n\n\nReturn an instance of the SSE server app.\n\n**Args:**\n- `server`: The FastMCP server instance\n- `message_path`: Path for SSE messages\n- `sse_path`: Path for SSE connections\n- `auth`: Optional authentication provider (AuthProvider)\n- `debug`: Whether to enable debug mode\n- `routes`: Optional list of custom routes\n- `middleware`: Optional list of middleware\n\nReturns:\n    A Starlette application with RequestContextMiddleware\n\n\n### `create_streamable_http_app` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L262\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_streamable_http_app(server: FastMCP[LifespanResultT], streamable_http_path: str, event_store: EventStore | None = None, retry_interval: int | None = None, auth: AuthProvider | None = None, json_response: bool = False, stateless_http: bool = False, debug: bool = False, routes: list[BaseRoute] | None = None, middleware: list[Middleware] | None = None) -> StarletteWithLifespan\n```\n\n\nReturn an instance of the StreamableHTTP server app.\n\n**Args:**\n- `server`: The FastMCP server instance\n- `streamable_http_path`: Path for StreamableHTTP connections\n- `event_store`: Optional event store for SSE polling/resumability\n- `retry_interval`: Optional retry interval in milliseconds for SSE polling.\nControls how quickly clients should reconnect after server-initiated\ndisconnections. Requires event_store to be set. Defaults to SDK default.\n- `auth`: Optional authentication provider (AuthProvider)\n- `json_response`: Whether to use JSON response format\n- `stateless_http`: Whether to use stateless mode (new transport per request)\n- `debug`: Whether to enable debug mode\n- `routes`: Optional list of custom routes\n- `middleware`: Optional list of middleware\n\n**Returns:**\n- A Starlette application with StreamableHTTP support\n\n\n## Classes\n\n### `StreamableHTTPASGIApp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L33\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nASGI application wrapper for Streamable HTTP server transport.\n\n\n### `StarletteWithLifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L71\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `lifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L73\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlifespan(self) -> Lifespan[Starlette]\n```\n\n### `RequestContextMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/http.py#L86\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that stores each request in a ContextVar\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-low_level.mdx", "content": "---\ntitle: low_level\nsidebarTitle: low_level\n---\n\n# `fastmcp.server.low_level`\n\n## Classes\n\n### `MiddlewareServerSession` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L33\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nServerSession that routes initialization requests through FastMCP middleware.\n\n\n**Methods:**\n\n#### `fastmcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L43\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfastmcp(self) -> FastMCP\n```\n\nGet the FastMCP instance.\n\n\n### `LowLevelServer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L130\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `fastmcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L144\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfastmcp(self) -> FastMCP\n```\n\nGet the FastMCP instance.\n\n\n#### `create_initialization_options` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L151\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_initialization_options(self, notification_options: NotificationOptions | None = None, experimental_capabilities: dict[str, dict[str, Any]] | None = None, **kwargs: Any) -> InitializationOptions\n```\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/low_level.py#L166\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, read_stream: MemoryObjectReceiveStream[SessionMessage | Exception], write_stream: MemoryObjectSendStream[SessionMessage], initialization_options: InitializationOptions, raise_exceptions: bool = False, stateless: bool = False)\n```\n\nOverrides the run method to use the MiddlewareServerSession.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.middleware`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-caching.mdx", "content": "---\ntitle: caching\nsidebarTitle: caching\n---\n\n# `fastmcp.server.middleware.caching`\n\n\nA middleware for response caching.\n\n## Classes\n\n### `CachableReadResourceContents` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L37\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA wrapper for ResourceContent that can be cached.\n\n\n**Methods:**\n\n#### `get_size` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L44\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_size(self) -> int\n```\n\n#### `get_sizes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L48\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_sizes(cls, values: Sequence[Self]) -> int\n```\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L52\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, values: Sequence[ResourceContent]) -> list[Self]\n```\n\n#### `unwrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L59\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nunwrap(cls, values: Sequence[Self]) -> list[ResourceContent]\n```\n\n### `CachableToolResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L68\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L74\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, value: ToolResult) -> Self\n```\n\n#### `unwrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L81\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nunwrap(self) -> ToolResult\n```\n\n### `SharedMethodSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nShared config for a cache method.\n\n\n### `ListToolsSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L96\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Tool-related caching.\n\n\n### `ListResourcesSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Resource-related caching.\n\n\n### `ListPromptsSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L104\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Prompt-related caching.\n\n\n### `CallToolSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L108\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Tool-related caching.\n\n\n### `ReadResourceSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L115\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Resource-related caching.\n\n\n### `GetPromptSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L119\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration options for Prompt-related caching.\n\n\n### `ResponseCachingStatistics` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L123\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `ResponseCachingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L132\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nThe response caching middleware offers a simple way to cache responses to mcp methods. The Middleware\nsupports cache invalidation via notifications from the server. The Middleware implements TTL-based caching\nbut cache implementations may offer additional features like LRU eviction, size limits, and more.\n\nWhen items are retrieved from the cache they will no longer be the original objects, but rather no-op objects\nthis means that response caching may not be compatible with other middleware that expects original subclasses.\n\nNotes:\n- Caches `tools/call`, `resources/read`, `prompts/get`, `tools/list`, `resources/list`, and `prompts/list` requests.\n- Cache keys are derived from method name and arguments.\n\n\n**Methods:**\n\n#### `on_list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L238\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_tools(self, context: MiddlewareContext[mcp.types.ListToolsRequest], call_next: CallNext[mcp.types.ListToolsRequest, Sequence[Tool]]) -> Sequence[Tool]\n```\n\nList tools from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `on_list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L277\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_resources(self, context: MiddlewareContext[mcp.types.ListResourcesRequest], call_next: CallNext[mcp.types.ListResourcesRequest, Sequence[Resource]]) -> Sequence[Resource]\n```\n\nList resources from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `on_list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L316\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_prompts(self, context: MiddlewareContext[mcp.types.ListPromptsRequest], call_next: CallNext[mcp.types.ListPromptsRequest, Sequence[Prompt]]) -> Sequence[Prompt]\n```\n\nList prompts from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `on_call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L353\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_call_tool(self, context: MiddlewareContext[mcp.types.CallToolRequestParams], call_next: CallNext[mcp.types.CallToolRequestParams, ToolResult]) -> ToolResult\n```\n\nCall a tool from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `on_read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L386\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_read_resource(self, context: MiddlewareContext[mcp.types.ReadResourceRequestParams], call_next: CallNext[mcp.types.ReadResourceRequestParams, Sequence[ResourceContent]]) -> Sequence[ResourceContent]\n```\n\nRead a resource from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `on_get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L416\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_get_prompt(self, context: MiddlewareContext[mcp.types.GetPromptRequestParams], call_next: CallNext[mcp.types.GetPromptRequestParams, PromptResult]) -> PromptResult\n```\n\nGet a prompt from the cache, if caching is enabled, and the result is in the cache. Otherwise,\notherwise call the next middleware and store the result in the cache if caching is enabled.\n\n\n#### `statistics` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/caching.py#L454\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nstatistics(self) -> ResponseCachingStatistics\n```\n\nGet the statistics for the cache.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-error_handling.mdx", "content": "---\ntitle: error_handling\nsidebarTitle: error_handling\n---\n\n# `fastmcp.server.middleware.error_handling`\n\n\nError handling middleware for consistent error responses and tracking.\n\n## Classes\n\n### `ErrorHandlingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/error_handling.py#L18\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that provides consistent error handling and logging.\n\nCatches exceptions, logs them appropriately, and converts them to\nproper MCP error responses. Also tracks error patterns for monitoring.\n\n\n**Methods:**\n\n#### `on_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/error_handling.py#L114\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_message(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nHandle errors for all messages.\n\n\n#### `get_error_stats` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/error_handling.py#L125\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_error_stats(self) -> dict[str, int]\n```\n\nGet error statistics for monitoring.\n\n\n### `RetryMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/error_handling.py#L130\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that implements automatic retry logic for failed requests.\n\nRetries requests that fail with transient errors, using exponential\nbackoff to avoid overwhelming the server or external dependencies.\n\n\n**Methods:**\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/error_handling.py#L186\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nImplement retry logic for requests.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-logging.mdx", "content": "---\ntitle: logging\nsidebarTitle: logging\n---\n\n# `fastmcp.server.middleware.logging`\n\n\nComprehensive logging middleware for FastMCP servers.\n\n## Functions\n\n### `default_serializer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/logging.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_serializer(data: Any) -> str\n```\n\n\nThe default serializer for Payloads in the logging middleware.\n\n\n## Classes\n\n### `BaseLoggingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/logging.py#L20\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for logging middleware.\n\n\n**Methods:**\n\n#### `on_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/logging.py#L124\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_message(self, context: MiddlewareContext[Any], call_next: CallNext[Any, Any]) -> Any\n```\n\nLog messages for configured methods.\n\n\n### `LoggingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/logging.py#L148\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that provides comprehensive request and response logging.\n\nLogs all MCP messages with configurable detail levels. Useful for debugging,\nmonitoring, and understanding server usage patterns.\n\n\n### `StructuredLoggingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/logging.py#L203\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that provides structured JSON logging for better log analysis.\n\nOutputs structured logs that are easier to parse and analyze with log\naggregation tools like ELK stack, Splunk, or cloud logging services.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-middleware.mdx", "content": "---\ntitle: middleware\nsidebarTitle: middleware\n---\n\n# `fastmcp.server.middleware.middleware`\n\n## Functions\n\n### `make_middleware_wrapper` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L66\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmake_middleware_wrapper(middleware: Middleware, call_next: CallNext[T, R]) -> CallNext[T, R]\n```\n\n\nCreate a wrapper that applies a single middleware to a context. The\nclosure bakes in the middleware and call_next function, so it can be\npassed to other functions that expect a call_next function.\n\n\n## Classes\n\n### `CallNext` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `MiddlewareContext` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nUnified context for all middleware operations.\n\n\n**Methods:**\n\n#### `copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L62\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncopy(self, **kwargs: Any) -> MiddlewareContext[T]\n```\n\n### `Middleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L79\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for FastMCP middleware with dispatching hooks.\n\n\n**Methods:**\n\n#### `on_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L128\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_message(self, context: MiddlewareContext[Any], call_next: CallNext[Any, Any]) -> Any\n```\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L135\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, context: MiddlewareContext[mt.Request[Any, Any]], call_next: CallNext[mt.Request[Any, Any], Any]) -> Any\n```\n\n#### `on_notification` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L142\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_notification(self, context: MiddlewareContext[mt.Notification[Any, Any]], call_next: CallNext[mt.Notification[Any, Any], Any]) -> Any\n```\n\n#### `on_initialize` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L149\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_initialize(self, context: MiddlewareContext[mt.InitializeRequest], call_next: CallNext[mt.InitializeRequest, mt.InitializeResult | None]) -> mt.InitializeResult | None\n```\n\n#### `on_call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L156\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_call_tool(self, context: MiddlewareContext[mt.CallToolRequestParams], call_next: CallNext[mt.CallToolRequestParams, ToolResult]) -> ToolResult\n```\n\n#### `on_read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L163\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_read_resource(self, context: MiddlewareContext[mt.ReadResourceRequestParams], call_next: CallNext[mt.ReadResourceRequestParams, Sequence[ResourceContent]]) -> Sequence[ResourceContent]\n```\n\n#### `on_get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L170\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_get_prompt(self, context: MiddlewareContext[mt.GetPromptRequestParams], call_next: CallNext[mt.GetPromptRequestParams, PromptResult]) -> PromptResult\n```\n\n#### `on_list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L177\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_tools(self, context: MiddlewareContext[mt.ListToolsRequest], call_next: CallNext[mt.ListToolsRequest, Sequence[Tool]]) -> Sequence[Tool]\n```\n\n#### `on_list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L184\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_resources(self, context: MiddlewareContext[mt.ListResourcesRequest], call_next: CallNext[mt.ListResourcesRequest, Sequence[Resource]]) -> Sequence[Resource]\n```\n\n#### `on_list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L191\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_resource_templates(self, context: MiddlewareContext[mt.ListResourceTemplatesRequest], call_next: CallNext[mt.ListResourceTemplatesRequest, Sequence[ResourceTemplate]]) -> Sequence[ResourceTemplate]\n```\n\n#### `on_list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/middleware.py#L200\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_prompts(self, context: MiddlewareContext[mt.ListPromptsRequest], call_next: CallNext[mt.ListPromptsRequest, Sequence[Prompt]]) -> Sequence[Prompt]\n```\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-rate_limiting.mdx", "content": "---\ntitle: rate_limiting\nsidebarTitle: rate_limiting\n---\n\n# `fastmcp.server.middleware.rate_limiting`\n\n\nRate limiting middleware for protecting FastMCP servers from abuse.\n\n## Classes\n\n### `RateLimitError` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nError raised when rate limit is exceeded.\n\n\n### `TokenBucketRateLimiter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nToken bucket implementation for rate limiting.\n\n\n**Methods:**\n\n#### `consume` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconsume(self, tokens: int = 1) -> bool\n```\n\nTry to consume tokens from the bucket.\n\n**Args:**\n- `tokens`: Number of tokens to consume\n\n**Returns:**\n- True if tokens were available and consumed, False otherwise\n\n\n### `SlidingWindowRateLimiter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L61\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSliding window rate limiter implementation.\n\n\n**Methods:**\n\n#### `is_allowed` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L76\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_allowed(self) -> bool\n```\n\nCheck if a request is allowed.\n\n\n### `RateLimitingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L92\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that implements rate limiting to prevent server abuse.\n\nUses a token bucket algorithm by default, allowing for burst traffic\nwhile maintaining a sustainable long-term rate.\n\n\n**Methods:**\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L152\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nApply rate limiting to requests.\n\n\n### `SlidingWindowRateLimitingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L170\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that implements sliding window rate limiting.\n\nUses a sliding window approach which provides more precise rate limiting\nbut uses more memory to track individual request timestamps.\n\n\n**Methods:**\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/rate_limiting.py#L219\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nApply sliding window rate limiting to requests.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-timing.mdx", "content": "---\ntitle: timing\nsidebarTitle: timing\n---\n\n# `fastmcp.server.middleware.timing`\n\n\nTiming middleware for measuring and logging request performance.\n\n## Classes\n\n### `TimingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L10\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMiddleware that logs the execution time of requests.\n\nOnly measures and logs timing for request messages (not notifications).\nProvides insights into performance characteristics of your MCP server.\n\n\n**Methods:**\n\n#### `on_request` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L39\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_request(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime request execution and log the results.\n\n\n### `DetailedTimingMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L60\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nEnhanced timing middleware with per-operation breakdowns.\n\nProvides detailed timing information for different types of MCP operations,\nallowing you to identify performance bottlenecks in specific operations.\n\n\n**Methods:**\n\n#### `on_call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L111\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_call_tool(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime tool execution.\n\n\n#### `on_read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L118\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_read_resource(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime resource reading.\n\n\n#### `on_get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_get_prompt(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime prompt retrieval.\n\n\n#### `on_list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L134\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_tools(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime tool listing.\n\n\n#### `on_list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L140\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_resources(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime resource listing.\n\n\n#### `on_list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L146\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_resource_templates(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime resource template listing.\n\n\n#### `on_list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/timing.py#L152\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_prompts(self, context: MiddlewareContext, call_next: CallNext) -> Any\n```\n\nTime prompt listing.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-middleware-tool_injection.mdx", "content": "---\ntitle: tool_injection\nsidebarTitle: tool_injection\n---\n\n# `fastmcp.server.middleware.tool_injection`\n\n\nA middleware for injecting tools into the MCP server context.\n\n## Functions\n\n### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L54\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(context: Context) -> list[Prompt]\n```\n\n\nList prompts available on the server.\n\n\n### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L64\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(context: Context, name: Annotated[str, 'The name of the prompt to render.'], arguments: Annotated[dict[str, Any] | None, 'The arguments to pass to the prompt.'] = None) -> mcp.types.GetPromptResult\n```\n\n\nRender a prompt available on the server.\n\n\n### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L88\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(context: Context) -> list[mcp.types.Resource]\n```\n\n\nList resources available on the server.\n\n\n### `read_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L98\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread_resource(context: Context, uri: Annotated[AnyUrl | str, 'The URI of the resource to read.']) -> list[ResourceContent]\n```\n\n\nRead a resource available on the server.\n\n\n## Classes\n\n### `ToolInjectionMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L21\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA middleware for injecting tools into the context.\n\n\n**Methods:**\n\n#### `on_list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L32\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_list_tools(self, context: MiddlewareContext[mcp.types.ListToolsRequest], call_next: CallNext[mcp.types.ListToolsRequest, Sequence[Tool]]) -> Sequence[Tool]\n```\n\nInject tools into the response.\n\n\n#### `on_call_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L41\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\non_call_tool(self, context: MiddlewareContext[mcp.types.CallToolRequestParams], call_next: CallNext[mcp.types.CallToolRequestParams, ToolResult]) -> ToolResult\n```\n\nIntercept tool calls to injected tools.\n\n\n### `PromptToolMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L80\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA middleware for injecting prompts as tools into the context.\n\n\n### `ResourceToolMiddleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/middleware/tool_injection.py#L111\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA middleware for injecting resources as tools into the context.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-openapi-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.openapi`\n\n\nOpenAPI server implementation for FastMCP.\n\n.. deprecated::\n    This module is deprecated. Import from fastmcp.server.providers.openapi instead.\n\nThe recommended approach is to use OpenAPIProvider with FastMCP:\n\n    from fastmcp import FastMCP\n    from fastmcp.server.providers.openapi import OpenAPIProvider\n    import httpx\n\n    client = httpx.AsyncClient(base_url=\"https://api.example.com\")\n    provider = OpenAPIProvider(openapi_spec=spec, client=client)\n\n    mcp = FastMCP(\"My API Server\")\n    mcp.add_provider(provider)\n\nFastMCPOpenAPI is still available but deprecated.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-openapi-components.mdx", "content": "---\ntitle: components\nsidebarTitle: components\n---\n\n# `fastmcp.server.openapi.components`\n\n\nOpenAPI component implementations - backwards compatibility stub.\n\nThis module is deprecated. Import from fastmcp.server.providers.openapi instead.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-openapi-routing.mdx", "content": "---\ntitle: routing\nsidebarTitle: routing\n---\n\n# `fastmcp.server.openapi.routing`\n\n\nRoute mapping logic for OpenAPI operations.\n\n.. deprecated::\n    This module is deprecated. Import from fastmcp.server.providers.openapi instead.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-openapi-server.mdx", "content": "---\ntitle: server\nsidebarTitle: server\n---\n\n# `fastmcp.server.openapi.server`\n\n\nFastMCPOpenAPI - backwards compatibility wrapper.\n\nThis class is deprecated. Use FastMCP with OpenAPIProvider instead:\n\n    from fastmcp import FastMCP\n    from fastmcp.server.providers.openapi import OpenAPIProvider\n    import httpx\n\n    client = httpx.AsyncClient(base_url=\"https://api.example.com\")\n    provider = OpenAPIProvider(openapi_spec=spec, client=client)\n    mcp = FastMCP(\"My API Server\", providers=[provider])\n\n\n## Classes\n\n### `FastMCPOpenAPI` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/openapi/server.py#L30\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nFastMCP server implementation that creates components from an OpenAPI schema.\n\n.. deprecated::\n    Use FastMCP with OpenAPIProvider instead. This class will be\n    removed in a future version.\n\nExample (deprecated):\n    ```python\n    from fastmcp.server.openapi import FastMCPOpenAPI\n    import httpx\n\n    server = FastMCPOpenAPI(\n        openapi_spec=spec,\n        client=httpx.AsyncClient(),\n    )\n    ```\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.providers`\n\n\nProviders for dynamic MCP components.\n\nThis module provides the `Provider` abstraction for providing tools,\nresources, and prompts dynamically at runtime.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.providers import Provider\n    from fastmcp.tools import Tool\n\n    class DatabaseProvider(Provider):\n        def __init__(self, db_url: str):\n            self.db = Database(db_url)\n\n        async def list_tools(self) -> list[Tool]:\n            rows = await self.db.fetch(\"SELECT * FROM tools\")\n            return [self._make_tool(row) for row in rows]\n\n        async def get_tool(self, name: str) -> Tool | None:\n            row = await self.db.fetchone(\"SELECT * FROM tools WHERE name = ?\", name)\n            return self._make_tool(row) if row else None\n\n    mcp = FastMCP(\"Server\", providers=[DatabaseProvider(db_url)])\n    ```\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-base.mdx", "content": "---\ntitle: base\nsidebarTitle: base\n---\n\n# `fastmcp.server.providers.base`\n\n\nBase Provider class for dynamic MCP components.\n\nThis module provides the `Provider` abstraction for providing tools,\nresources, and prompts dynamically at runtime.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.providers import Provider\n    from fastmcp.tools import Tool\n\n    class DatabaseProvider(Provider):\n        def __init__(self, db_url: str):\n            super().__init__()\n            self.db = Database(db_url)\n\n        async def list_tools(self) -> list[Tool]:\n            rows = await self.db.fetch(\"SELECT * FROM tools\")\n            return [self._make_tool(row) for row in rows]\n\n        async def get_tool(self, name: str) -> Tool | None:\n            row = await self.db.fetchone(\"SELECT * FROM tools WHERE name = ?\", name)\n            return self._make_tool(row) if row else None\n\n    mcp = FastMCP(\"Server\", providers=[DatabaseProvider(db_url)])\n    ```\n\n\n## Classes\n\n### `Provider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for dynamic component providers.\n\nSubclass and override whichever methods you need. Default implementations\nreturn empty lists / None, so you only need to implement what your provider\nsupports.\n\n\n**Methods:**\n\n#### `with_transforms` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L63\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwith_transforms(self) -> Provider\n```\n\nApply transformations to this provider's components.\n\nReturns a TransformingProvider that wraps this provider and applies\nthe specified transformations. Can be chained - each call creates a\nnew wrapper that composes with the previous.\n\n**Args:**\n- `namespace`: Prefix for tools/prompts (\"namespace_name\"), path segment\nfor resources (\"protocol\\://namespace/path\").\n- `tool_renames`: Map of original_name \u2192 final_name. Tools in this map\nuse the specified name instead of namespace prefixing.\n\n**Returns:**\n- A TransformingProvider wrapping this provider.\n\n\n#### `with_namespace` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L114\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwith_namespace(self, namespace: str) -> Provider\n```\n\nShorthand for with_transforms(namespace=...).\n\n**Args:**\n- `namespace`: The namespace to apply.\n\n**Returns:**\n- A TransformingProvider wrapping this provider.\n\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L131\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nReturn all available tools.\n\nOverride to provide tools dynamically.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L138\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool | None\n```\n\nGet a specific tool by name.\n\nDefault implementation lists all tools and finds by name.\nOverride for more efficient single-tool lookup.\n\n**Returns:**\n- The Tool if found, or None to continue searching other providers.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L150\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nReturn all available resources.\n\nOverride to provide resources dynamically.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L157\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource | None\n```\n\nGet a specific resource by URI.\n\nDefault implementation lists all resources and finds by URI.\nOverride for more efficient single-resource lookup.\n\n**Returns:**\n- The Resource if found, or None to continue searching other providers.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L169\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nReturn all available resource templates.\n\nOverride to provide resource templates dynamically.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L176\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate | None\n```\n\nGet a resource template that matches the given URI.\n\nDefault implementation lists all templates and finds one whose pattern\nmatches the URI.\nOverride for more efficient lookup.\n\n**Returns:**\n- The ResourceTemplate if a matching one is found, or None to continue searching.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L192\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nReturn all available prompts.\n\nOverride to provide prompts dynamically.\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L199\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str) -> Prompt | None\n```\n\nGet a specific prompt by name.\n\nDefault implementation lists all prompts and finds by name.\nOverride for more efficient single-prompt lookup.\n\n**Returns:**\n- The Prompt if found, or None to continue searching other providers.\n\n\n#### `get_component` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L211\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_component(self, key: str) -> Tool | Resource | ResourceTemplate | Prompt | None\n```\n\nGet a component by its prefixed key.\n\n**Args:**\n- `key`: The prefixed key (e.g., \"tool\\:name\", \"resource\\:uri\", \"template\\:uri\").\n\n**Returns:**\n- The component if found, or None to continue searching other providers.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L241\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nReturn components that should be registered as background tasks.\n\nOverride to customize which components are task-eligible.\nDefault calls list_* methods and filters for function-based components\nwith task_config.mode != 'forbidden'.\n\nUsed by the server during startup to register functions with Docket.\n\n\n#### `lifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L283\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlifespan(self) -> AsyncIterator[None]\n```\n\nUser-overridable lifespan for custom setup and teardown.\n\nOverride this method to perform provider-specific initialization\nlike opening database connections, setting up external resources,\nor other state management needed for the provider's lifetime.\n\nThe lifespan scope matches the server's lifespan - code before yield\nruns at startup, code after yield runs at shutdown.\n\n\n#### `enable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L312\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nenable(self) -> None\n```\n\nEnable components by removing from blocklist, or set allowlist with only=True.\n\n**Args:**\n- `keys`: Keys to enable (e.g., \"tool\\:my_tool\").\n- `tags`: Tags to enable - components with these tags will be enabled.\n- `only`: If True, switches to allowlist mode - ONLY show these keys/tags.\n\n\n#### `disable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/base.py#L328\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndisable(self) -> None\n```\n\nDisable components by adding to the blocklist.\n\n**Args:**\n- `keys`: Keys to disable (e.g., \"tool\\:my_tool\").\n- `tags`: Tags to disable - components with these tags will be disabled.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-fastmcp_provider.mdx", "content": "---\ntitle: fastmcp_provider\nsidebarTitle: fastmcp_provider\n---\n\n# `fastmcp.server.providers.fastmcp_provider`\n\n\nFastMCPProvider for wrapping FastMCP servers as providers.\n\nThis module provides the `FastMCPProvider` class that wraps a FastMCP server\nand exposes its components through the Provider interface.\n\nIt also provides FastMCPProvider* component classes that delegate execution to\nthe wrapped server's middleware, ensuring middleware runs when components are\nexecuted.\n\n\n## Classes\n\n### `FastMCPProviderTool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L51\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTool that delegates execution to a wrapped server's middleware.\n\nWhen `run()` is called, this tool invokes the wrapped server's\n`_call_tool_middleware()` method, ensuring the server's middleware\nchain is executed.\n\n\n**Methods:**\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L73\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, server: Any, tool: Tool) -> FastMCPProviderTool\n```\n\nWrap a Tool to delegate execution to the server's middleware.\n\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L97\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any]) -> ToolResult | mcp.types.CreateTaskResult\n```\n\nDelegate to child server's middleware chain.\n\nThis runs BEFORE any backgrounding decision - the actual underlying\ntool will check contextvars and submit to Docket if appropriate.\n\n\n### `FastMCPProviderResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L108\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResource that delegates reading to a wrapped server's middleware.\n\nWhen `read()` is called, this resource invokes the wrapped server's\n`_read_resource_middleware()` method, ensuring the server's middleware\nchain is executed.\n\n\n**Methods:**\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L130\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, server: Any, resource: Resource) -> FastMCPProviderResource\n```\n\nWrap a Resource to delegate reading to the server's middleware.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L152\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent | mcp.types.CreateTaskResult\n```\n\nDelegate to child server's middleware.\n\nWhen called from a Docket worker (background task), there's no FastMCP\ncontext set up, so we create one for the child server.\n\nNote: The _docket_fn_key contextvar is intentionally NOT updated here.\nThe parent set it to the full namespaced key (e.g., data://c/gc/value)\nwhich is what the function is registered under in Docket. All provider\nlayers pass this through unchanged so the eventual resource._read()\nuses the correct Docket lookup key.\n\n\n### `FastMCPProviderPrompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L185\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nPrompt that delegates rendering to a wrapped server's middleware.\n\nWhen `render()` is called, this prompt invokes the wrapped server's\n`_get_prompt_content_middleware()` method, ensuring the server's middleware\nchain is executed.\n\n\n**Methods:**\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L207\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, server: Any, prompt: Prompt) -> FastMCPProviderPrompt\n```\n\nWrap a Prompt to delegate rendering to the server's middleware.\n\n\n#### `render` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L229\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrender(self, arguments: dict[str, Any] | None = None) -> PromptResult | mcp.types.CreateTaskResult\n```\n\nDelegate to child server's middleware.\n\nWhen called from a Docket worker (background task), there's no FastMCP\ncontext set up, so we create one for the child server.\n\nNote: The _docket_fn_key contextvar is intentionally NOT updated here.\nThe parent set it to the full namespaced name (e.g., c_gc_greet) which\nis what the function is registered under in Docket. All provider layers\npass this through unchanged so the eventual prompt._render() uses the\ncorrect Docket lookup key.\n\n\n### `FastMCPProviderResourceTemplate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L266\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResource template that creates FastMCPProviderResources.\n\nWhen `create_resource()` is called, this template creates a\nFastMCPProviderResource that will invoke the wrapped server's middleware\nwhen read.\n\n\n**Methods:**\n\n#### `wrap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L288\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwrap(cls, server: Any, template: ResourceTemplate) -> FastMCPProviderResourceTemplate\n```\n\nWrap a ResourceTemplate to create FastMCPProviderResources.\n\n\n#### `create_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L305\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_resource(self, uri: str, params: dict[str, Any]) -> Resource\n```\n\nCreate a FastMCPProviderResource for the given URI.\n\nThe `uri` is the external/transformed URI (e.g., with namespace prefix).\nWe use `_original_uri_template` with `params` to construct the internal\nURI that the nested server understands.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L374\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self, arguments: dict[str, Any]) -> str | bytes\n```\n\nRead the resource content for background task execution.\n\nCreates a resource from this template and reads its content.\nThis method is called by Docket during background task execution.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L401\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nNo-op: the child's actual template is registered via get_tasks().\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L404\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, params: dict[str, Any], **kwargs: Any) -> Execution\n```\n\nSchedule this template for background execution via docket.\n\nThe child's FunctionResourceTemplate.fn is registered (via get_tasks),\nand it expects splatted **kwargs, so we splat params here.\n\n\n### `FastMCPProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L429\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nProvider that wraps a FastMCP server.\n\nThis provider enables mounting one FastMCP server onto another, exposing\nthe mounted server's tools, resources, and prompts through the parent\nserver.\n\nComponents returned by this provider are wrapped in FastMCPProvider*\nclasses that delegate execution to the wrapped server's middleware chain.\nThis ensures middleware runs when components are executed.\n\n\n**Methods:**\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L477\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nList all tools from the mounted server as FastMCPProviderTools.\n\nCalls the nested server's middleware to list tools, then wraps\neach tool as a FastMCPProviderTool that delegates execution to the\nnested server's middleware.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L487\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool | None\n```\n\nGet a tool by name as a FastMCPProviderTool.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L496\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nList all resources from the mounted server as FastMCPProviderResources.\n\nCalls the nested server's middleware to list resources, then wraps\neach resource as a FastMCPProviderResource that delegates reading to the\nnested server's middleware.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L506\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource | None\n```\n\nGet a concrete resource by URI as a FastMCPProviderResource.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L515\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nList all resource templates from the mounted server.\n\nReturns FastMCPProviderResourceTemplate instances that create\nFastMCPProviderResources when materialized.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L526\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate | None\n```\n\nGet a resource template that matches the given URI.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L538\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nList all prompts from the mounted server as FastMCPProviderPrompts.\n\nReturns FastMCPProviderPrompt instances that delegate rendering to the\nwrapped server's middleware.\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L547\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str) -> Prompt | None\n```\n\nGet a prompt by name as a FastMCPProviderPrompt.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L556\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nReturn task-eligible components from the mounted server.\n\nReturns the child's ACTUAL components (not wrapped) so their actual\nfunctions get registered with Docket. TransformingProvider.get_tasks()\nhandles namespace transformation of keys.\n\nIterates through all providers in the wrapped server (including its\nLocalProvider) to collect task-eligible components.\n\n\n#### `lifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/fastmcp_provider.py#L576\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlifespan(self) -> AsyncIterator[None]\n```\n\nStart the mounted server's user lifespan.\n\nThis starts only the wrapped server's user-defined lifespan, NOT its\nfull _lifespan_manager() (which includes Docket). The parent server's\nDocket handles all background tasks.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-local_provider.mdx", "content": "---\ntitle: local_provider\nsidebarTitle: local_provider\n---\n\n# `fastmcp.server.providers.local_provider`\n\n\nLocalProvider for locally-defined MCP components.\n\nThis module provides the `LocalProvider` class that manages tools, resources,\ntemplates, and prompts registered via decorators or direct methods.\n\nLocalProvider can be used standalone and attached to multiple servers:\n\n```python\nfrom fastmcp.server.providers import LocalProvider\n\n# Create a reusable provider with tools\nprovider = LocalProvider()\n\n@provider.tool\ndef greet(name: str) -> str:\n    return f\"Hello, {name}!\"\n\n# Attach to any server\nfrom fastmcp import FastMCP\nserver1 = FastMCP(\"Server1\", providers=[provider])\nserver2 = FastMCP(\"Server2\", providers=[provider])\n```\n\n\n## Classes\n\n### `LocalProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L59\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nProvider for locally-defined components.\n\nSupports decorator-based registration (`@provider.tool`, `@provider.resource`,\n`@provider.prompt`) and direct object registration methods.\n\nWhen used standalone, LocalProvider uses default settings. When attached\nto a FastMCP server via the server's decorators, server-level settings\nlike `_tool_serializer` and `_support_tasks_by_default` are injected.\n\n\n**Methods:**\n\n#### `add_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L182\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_tool(self, tool: Tool) -> Tool\n```\n\nAdd a tool to this provider's storage.\n\n\n#### `remove_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L186\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_tool(self, name: str) -> None\n```\n\nRemove a tool from this provider's storage.\n\n\n#### `add_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L190\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_resource(self, resource: Resource) -> Resource\n```\n\nAdd a resource to this provider's storage.\n\n\n#### `remove_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L194\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_resource(self, uri: str) -> None\n```\n\nRemove a resource from this provider's storage.\n\n\n#### `add_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L198\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_template(self, template: ResourceTemplate) -> ResourceTemplate\n```\n\nAdd a resource template to this provider's storage.\n\n\n#### `remove_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L202\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_template(self, uri_template: str) -> None\n```\n\nRemove a resource template from this provider's storage.\n\n\n#### `add_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L206\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_prompt(self, prompt: Prompt) -> Prompt\n```\n\nAdd a prompt to this provider's storage.\n\n\n#### `remove_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L210\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_prompt(self, name: str) -> None\n```\n\nRemove a prompt from this provider's storage.\n\n\n#### `add_tool_transformation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L218\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_tool_transformation(self, tool_name: str, transformation: ToolTransformConfig) -> None\n```\n\nAdd a tool transformation.\n\n**Args:**\n- `tool_name`: The name of the tool to transform.\n- `transformation`: The transformation configuration.\n\n\n#### `get_tool_transformation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L229\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool_transformation(self, tool_name: str) -> ToolTransformConfig | None\n```\n\nGet a tool transformation.\n\n**Args:**\n- `tool_name`: The name of the tool.\n\n**Returns:**\n- The transformation config, or None if not found.\n\n\n#### `remove_tool_transformation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L240\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_tool_transformation(self, tool_name: str) -> None\n```\n\nRemove a tool transformation.\n\n**Args:**\n- `tool_name`: The name of the tool.\n\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L253\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nReturn all visible tools with transformations applied.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L262\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool | None\n```\n\nGet a tool by name, with transformations applied.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L267\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nReturn all visible resources.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L275\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource | None\n```\n\nGet a resource by URI if visible.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L282\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nReturn all visible resource templates.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L290\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate | None\n```\n\nGet a resource template that matches the given URI if visible.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L301\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nReturn all visible prompts.\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L309\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str) -> Prompt | None\n```\n\nGet a prompt by name if visible.\n\n\n#### `get_component` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L316\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_component(self, key: str) -> Tool | Resource | ResourceTemplate | Prompt | None\n```\n\nGet a component by its prefixed key.\n\nEfficient O(1) lookup in the unified components dict.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L332\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nReturn components eligible for background task execution.\n\nReturns components that have task_config.mode != 'forbidden'.\nThis includes both FunctionTool/Resource/Prompt instances created via\ndecorators and custom Tool/Resource/Prompt subclasses.\n\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L346\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: AnyFunction) -> FunctionTool\n```\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L365\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: str | None = None) -> Callable[[AnyFunction], FunctionTool]\n```\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L383\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: str | AnyFunction | None = None) -> Callable[[AnyFunction], FunctionTool] | FunctionTool | partial[Callable[[AnyFunction], FunctionTool] | FunctionTool]\n```\n\nDecorator to register a tool.\n\nThis decorator supports multiple calling patterns:\n- @provider.tool (without parentheses)\n- @provider.tool() (with empty parentheses)\n- @provider.tool(\"custom_name\") (with name as first argument)\n- @provider.tool(name=\"custom_name\") (with name as keyword argument)\n- provider.tool(function, name=\"custom_name\") (direct function call)\n\n**Args:**\n- `name_or_fn`: Either a function (when used as @tool), a string name, or None\n- `name`: Optional name for the tool (keyword-only, alternative to name_or_fn)\n- `title`: Optional title for the tool\n- `description`: Optional description of what the tool does\n- `icons`: Optional icons for the tool\n- `tags`: Optional set of tags for categorizing the tool\n- `output_schema`: Optional JSON schema for the tool's output\n- `annotations`: Optional annotations about the tool's behavior\n- `exclude_args`: Optional list of argument names to exclude from the tool schema\n- `meta`: Optional meta information about the tool\n- `enabled`: Whether the tool is enabled (default True). If False, adds to blocklist.\n- `task`: Optional task configuration for background execution\n- `serializer`: Optional serializer for the tool result\n\n**Returns:**\n- The registered FunctionTool or a decorator function.\n\n\n#### `resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L523\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresource(self, uri: str) -> Callable[[AnyFunction], Resource | ResourceTemplate]\n```\n\nDecorator to register a function as a resource.\n\nIf the URI contains parameters (e.g. \"resource://{param}\") or the function\nhas parameters, it will be registered as a template resource.\n\n**Args:**\n- `uri`: URI for the resource (e.g. \"resource\\://my-resource\" or \"resource\\://{param}\")\n- `name`: Optional name for the resource\n- `title`: Optional title for the resource\n- `description`: Optional description of the resource\n- `icons`: Optional icons for the resource\n- `mime_type`: Optional MIME type for the resource\n- `tags`: Optional set of tags for categorizing the resource\n- `enabled`: Whether the resource is enabled (default True). If False, adds to blocklist.\n- `annotations`: Optional annotations about the resource's behavior\n- `meta`: Optional meta information about the resource\n- `task`: Optional task configuration for background execution\n\n**Returns:**\n- A decorator function.\n\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L653\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: AnyFunction) -> FunctionPrompt\n```\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L668\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: str | None = None) -> Callable[[AnyFunction], FunctionPrompt]\n```\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/local_provider.py#L682\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: str | AnyFunction | None = None) -> Callable[[AnyFunction], FunctionPrompt] | FunctionPrompt | partial[Callable[[AnyFunction], FunctionPrompt] | FunctionPrompt]\n```\n\nDecorator to register a prompt.\n\nThis decorator supports multiple calling patterns:\n- @provider.prompt (without parentheses)\n- @provider.prompt() (with empty parentheses)\n- @provider.prompt(\"custom_name\") (with name as first argument)\n- @provider.prompt(name=\"custom_name\") (with name as keyword argument)\n- provider.prompt(function, name=\"custom_name\") (direct function call)\n\n**Args:**\n- `name_or_fn`: Either a function (when used as @prompt), a string name, or None\n- `name`: Optional name for the prompt (keyword-only, alternative to name_or_fn)\n- `title`: Optional title for the prompt\n- `description`: Optional description of what the prompt does\n- `icons`: Optional icons for the prompt\n- `tags`: Optional set of tags for categorizing the prompt\n- `enabled`: Whether the prompt is enabled (default True). If False, adds to blocklist.\n- `meta`: Optional meta information about the prompt\n- `task`: Optional task configuration for background execution\n\n**Returns:**\n- The registered FunctionPrompt or a decorator function.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-openapi-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.providers.openapi`\n\n\nOpenAPI provider for FastMCP.\n\nThis module provides OpenAPI integration for FastMCP through the Provider pattern.\n\nExample:\n    ```python\n    from fastmcp import FastMCP\n    from fastmcp.server.providers.openapi import OpenAPIProvider\n    import httpx\n\n    client = httpx.AsyncClient(base_url=\"https://api.example.com\")\n    provider = OpenAPIProvider(openapi_spec=spec, client=client)\n    mcp = FastMCP(\"API Server\", providers=[provider])\n    ```\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-openapi-components.mdx", "content": "---\ntitle: components\nsidebarTitle: components\n---\n\n# `fastmcp.server.providers.openapi.components`\n\n\nOpenAPI component classes: Tool, Resource, and ResourceTemplate.\n\n## Classes\n\n### `OpenAPITool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L57\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nTool implementation for OpenAPI endpoints.\n\n\n**Methods:**\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L93\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any]) -> ToolResult\n```\n\nExecute the HTTP request using RequestDirector.\n\n\n### `OpenAPIResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L156\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResource implementation for OpenAPI endpoints.\n\n\n**Methods:**\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L188\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nFetch the resource data by making an HTTP request.\n\n\n### `OpenAPIResourceTemplate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L258\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResource template implementation for OpenAPI endpoints.\n\n\n**Methods:**\n\n#### `create_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/components.py#L290\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_resource(self, uri: str, params: dict[str, Any], context: Context | None = None) -> Resource\n```\n\nCreate a resource with the given parameters.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-openapi-provider.mdx", "content": "---\ntitle: provider\nsidebarTitle: provider\n---\n\n# `fastmcp.server.providers.openapi.provider`\n\n\nOpenAPIProvider for creating MCP components from OpenAPI specifications.\n\n## Classes\n\n### `OpenAPIProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nProvider that creates MCP components from an OpenAPI specification.\n\nComponents are created eagerly during initialization by parsing the OpenAPI\nspec. Each component makes HTTP calls to the described API endpoints.\n\n\n**Methods:**\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L351\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nReturn all tools created from the OpenAPI spec.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L355\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool | None\n```\n\nGet a tool by name.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L359\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nReturn all resources created from the OpenAPI spec.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L363\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource | None\n```\n\nGet a resource by URI.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L367\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nReturn all resource templates created from the OpenAPI spec.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L371\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate | None\n```\n\nGet a resource template that matches the given URI.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L378\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nReturn empty list - OpenAPI doesn't create prompts.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/provider.py#L382\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nReturn empty list - OpenAPI components don't support tasks.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-openapi-routing.mdx", "content": "---\ntitle: routing\nsidebarTitle: routing\n---\n\n# `fastmcp.server.providers.openapi.routing`\n\n\nRoute mapping logic for OpenAPI operations.\n\n## Classes\n\n### `MCPType` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/routing.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nType of FastMCP component to create from a route.\n\n\n### `RouteMap` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/openapi/routing.py#L59\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nMapping configuration for HTTP routes to FastMCP component types.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-proxy.mdx", "content": "---\ntitle: proxy\nsidebarTitle: proxy\n---\n\n# `fastmcp.server.providers.proxy`\n\n\nProxyProvider for proxying to remote MCP servers.\n\nThis module provides the `ProxyProvider` class that proxies components from\na remote MCP server via a client factory. It also provides proxy component\nclasses that forward execution to remote servers.\n\n\n## Functions\n\n### `default_proxy_roots_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L608\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_proxy_roots_handler(context: RequestContext[ClientSession, LifespanContextT]) -> RootsList\n```\n\n\nForward list roots request from remote server to proxy's connected clients.\n\n\n### `default_proxy_sampling_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L616\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_proxy_sampling_handler(messages: list[mcp.types.SamplingMessage], params: mcp.types.CreateMessageRequestParams, context: RequestContext[ClientSession, LifespanContextT]) -> mcp.types.CreateMessageResult\n```\n\n\nForward sampling request from remote server to proxy's connected clients.\n\n\n### `default_proxy_elicitation_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L639\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_proxy_elicitation_handler(message: str, response_type: type, params: mcp.types.ElicitRequestParams, context: RequestContext[ClientSession, LifespanContextT]) -> ElicitResult\n```\n\n\nForward elicitation request from remote server to proxy's connected clients.\n\n\n### `default_proxy_log_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L661\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_proxy_log_handler(message: LogMessage) -> None\n```\n\n\nForward log notification from remote server to proxy's connected clients.\n\n\n### `default_proxy_progress_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L669\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_proxy_progress_handler(progress: float, total: float | None, message: str | None) -> None\n```\n\n\nForward progress notification from remote server to proxy's connected clients.\n\n\n## Classes\n\n### `ProxyTool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L67\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA Tool that represents and executes a tool on a remote server.\n\n\n**Methods:**\n\n#### `model_copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L84\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmodel_copy(self, **kwargs: Any) -> ProxyTool\n```\n\nOverride to preserve _backend_name when name changes.\n\n\n#### `from_mcp_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L94\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_mcp_tool(cls, client_factory: ClientFactoryT, mcp_tool: mcp.types.Tool) -> ProxyTool\n```\n\nFactory method to create a ProxyTool from a raw MCP tool schema.\n\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L111\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any], context: Context | None = None) -> ToolResult\n```\n\nExecutes the tool by making a call through the client.\n\n\n### `ProxyResource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L153\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA Resource that represents and reads a resource from a remote server.\n\n\n**Methods:**\n\n#### `model_copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L178\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmodel_copy(self, **kwargs: Any) -> ProxyResource\n```\n\nOverride to preserve _backend_uri when uri changes.\n\n\n#### `from_mcp_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L188\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_mcp_resource(cls, client_factory: ClientFactoryT, mcp_resource: mcp.types.Resource) -> ProxyResource\n```\n\nFactory method to create a ProxyResource from a raw MCP resource schema.\n\n\n#### `read` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L208\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nread(self) -> ResourceContent\n```\n\nRead the resource content from the remote server.\n\n\n### `ProxyTemplate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L237\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA ResourceTemplate that represents and creates resources from a remote server template.\n\n\n**Methods:**\n\n#### `model_copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L254\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmodel_copy(self, **kwargs: Any) -> ProxyTemplate\n```\n\nOverride to preserve _backend_uri_template when uri_template changes.\n\n\n#### `from_mcp_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L264\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_mcp_template(cls, client_factory: ClientFactoryT, mcp_template: mcp.types.ResourceTemplate) -> ProxyTemplate\n```\n\nFactory method to create a ProxyTemplate from a raw MCP template schema.\n\n\n#### `create_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L283\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_resource(self, uri: str, params: dict[str, Any], context: Context | None = None) -> ProxyResource\n```\n\nCreate a resource from the template by calling the remote server.\n\n\n### `ProxyPrompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L334\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA Prompt that represents and renders a prompt from a remote server.\n\n\n**Methods:**\n\n#### `model_copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L351\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmodel_copy(self, **kwargs: Any) -> ProxyPrompt\n```\n\nOverride to preserve _backend_name when name changes.\n\n\n#### `from_mcp_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L361\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_mcp_prompt(cls, client_factory: ClientFactoryT, mcp_prompt: mcp.types.Prompt) -> ProxyPrompt\n```\n\nFactory method to create a ProxyPrompt from a raw MCP prompt schema.\n\n\n#### `render` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L385\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrender(self, arguments: dict[str, Any]) -> PromptResult\n```\n\nRender the prompt by making a call through the client.\n\n\n### `ProxyProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L404\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nProvider that proxies to a remote MCP server via a client factory.\n\nThis provider fetches components from a remote server and returns Proxy*\ncomponent instances that forward execution to the remote server.\n\nAll components returned by this provider have task_config.mode=\"forbidden\"\nbecause tasks cannot be executed through a proxy.\n\n\n**Methods:**\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L458\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nList all tools from the remote server.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L483\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nList all resources from the remote server.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L502\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nList all resource templates from the remote server.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L521\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nList all prompts from the remote server.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L540\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nReturn empty list since proxy components don't support tasks.\n\nOverride the base implementation to avoid calling list_tools() during\nserver lifespan initialization, which would open the client before any\ncontext is set. All Proxy* components have task_config.mode=\"forbidden\".\n\n\n### `FastMCPProxy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L558\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA FastMCP server that acts as a proxy to a remote MCP-compliant server.\n\nThis is a convenience wrapper that creates a FastMCP server with a\nProxyProvider. For more control, use FastMCP with add_provider(ProxyProvider(...)).\n\n\n### `ProxyClient` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L679\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA proxy client that forwards advanced interactions between a remote MCP server and the proxy's connected clients.\n\nSupports forwarding roots, sampling, elicitation, logging, and progress.\n\n\n### `StatefulProxyClient` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L716\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA proxy client that provides a stateful client factory for the proxy server.\n\nThe stateful proxy client bound its copy to the server session.\nAnd it will be disconnected when the session is exited.\n\nThis is useful to proxy a stateful mcp server such as the Playwright MCP server.\nNote that it is essential to ensure that the proxy server itself is also stateful.\n\n\n**Methods:**\n\n#### `clear` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L736\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclear(self)\n```\n\nClear all cached clients and force disconnect them.\n\n\n#### `new_stateful` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/proxy.py#L742\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nnew_stateful(self) -> Client[ClientTransportT]\n```\n\nCreate a new stateful proxy client instance with the same configuration.\n\nUse this method as the client factory for stateful proxy server.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-providers-transforming.mdx", "content": "---\ntitle: transforming\nsidebarTitle: transforming\n---\n\n# `fastmcp.server.providers.transforming`\n\n\nTransformingProvider for applying component transformations.\n\nThis module provides the `TransformingProvider` class that wraps any Provider\nand applies transformations like namespace prefixes and tool renames.\n\n\n## Classes\n\n### `TransformingProvider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L29\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nWraps any provider and applies component transformations.\n\nUsers typically use `provider.with_transforms()` rather than instantiating\nthis class directly. Multiple `.with_transforms()` calls stack - each\ncreates a new wrapper that composes with the previous.\n\n\n**Methods:**\n\n#### `list_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L169\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_tools(self) -> Sequence[Tool]\n```\n\nList tools with transformations applied.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L177\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool | None\n```\n\nGet tool by transformed name.\n\n\n#### `list_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L191\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resources(self) -> Sequence[Resource]\n```\n\nList resources with URI transformations applied.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L199\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource | None\n```\n\nGet resource by transformed URI.\n\n\n#### `list_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L213\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_resource_templates(self) -> Sequence[ResourceTemplate]\n```\n\nList resource templates with URI transformations applied.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L223\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate | None\n```\n\nGet resource template by transformed URI.\n\n\n#### `list_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L241\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlist_prompts(self) -> Sequence[Prompt]\n```\n\nList prompts with transformations applied.\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L249\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str) -> Prompt | None\n```\n\nGet prompt by transformed name.\n\n\n#### `get_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L263\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tasks(self) -> Sequence[FastMCPComponent]\n```\n\nGet tasks with transformations applied to all components.\n\n\n#### `lifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/providers/transforming.py#L304\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlifespan(self) -> AsyncIterator[None]\n```\n\nDelegate lifespan to wrapped provider.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-proxy.mdx", "content": "---\ntitle: proxy\nsidebarTitle: proxy\n---\n\n# `fastmcp.server.proxy`\n\n\nBackwards compatibility - import from fastmcp.server.providers.proxy instead.\n\nThis module re-exports all proxy-related classes from their new location\nat fastmcp.server.providers.proxy. Direct imports from this module are\ndeprecated and will be removed in a future version.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-sampling-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.sampling`\n\n\nSampling module for FastMCP servers.\n"}, {"filename": "docs/python-sdk/fastmcp-server-sampling-run.mdx", "content": "---\ntitle: run\nsidebarTitle: run\n---\n\n# `fastmcp.server.sampling.run`\n\n\nSampling types and helper functions for FastMCP servers.\n\n## Functions\n\n### `determine_handler_mode` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L118\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndetermine_handler_mode(context: Context, needs_tools: bool) -> bool\n```\n\n\nDetermine whether to use fallback handler or client for sampling.\n\n**Args:**\n- `context`: The MCP context.\n- `needs_tools`: Whether the sampling request requires tool support.\n\n**Returns:**\n- True if fallback handler should be used, False to use client.\n\n**Raises:**\n- `ValueError`: If client lacks required capability and no fallback configured.\n\n\n### `call_sampling_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L177\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncall_sampling_handler(context: Context, messages: list[SamplingMessage]) -> CreateMessageResult | CreateMessageResultWithTools\n```\n\n\nMake LLM call using the fallback handler.\n\nNote: This function expects the caller (sample_step) to have validated that\nsampling_handler is set via determine_handler_mode(). The checks below are\nsafeguards against internal misuse.\n\n\n### `execute_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L228\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nexecute_tools(tool_calls: list[ToolUseContent], tool_map: dict[str, SamplingTool], mask_error_details: bool = False) -> list[ToolResultContent]\n```\n\n\nExecute tool calls and return results.\n\n**Args:**\n- `tool_calls`: List of tool use requests from the LLM.\n- `tool_map`: Mapping from tool name to SamplingTool.\n- `mask_error_details`: If True, mask detailed error messages from tool execution.\nWhen masked, only generic error messages are returned to the LLM.\nTools can explicitly raise ToolError to bypass masking when they want\nto provide specific error messages to the LLM.\n\n**Returns:**\n- List of tool result content blocks.\n\n\n## Classes\n\n### `SamplingResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResult of a sampling operation.\n\n**Attributes:**\n- `text`: The text representation of the result (raw text or JSON for structured).\n- `result`: The typed result (str for text, parsed object for structured output).\n- `history`: All messages exchanged during sampling.\n\n\n### `SampleStep` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L55\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nResult of a single sampling call.\n\nRepresents what the LLM returned in this step plus the message history.\n\n\n**Methods:**\n\n#### `is_tool_use` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_tool_use(self) -> bool\n```\n\nTrue if the LLM is requesting tool execution.\n\n\n#### `text` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L72\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntext(self) -> str | None\n```\n\nExtract text from the response, if available.\n\n\n#### `tool_calls` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/run.py#L85\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool_calls(self) -> list[ToolUseContent]\n```\n\nGet the list of tool calls from the response.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-sampling-sampling_tool.mdx", "content": "---\ntitle: sampling_tool\nsidebarTitle: sampling_tool\n---\n\n# `fastmcp.server.sampling.sampling_tool`\n\n\nSamplingTool for use during LLM sampling requests.\n\n## Classes\n\n### `SamplingTool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/sampling_tool.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA tool that can be used during LLM sampling.\n\nSamplingTools bundle a tool's schema (name, description, parameters) with\nan executor function, enabling servers to execute agentic workflows where\nthe LLM can request tool calls during sampling.\n\nIn most cases, pass functions directly to ctx.sample():\n\n    def search(query: str) -> str:\n        '''Search the web.'''\n        return web_search(query)\n\n    result = await context.sample(\n        messages=\"Find info about Python\",\n        tools=[search],  # Plain functions work directly\n    )\n\nCreate a SamplingTool explicitly when you need custom name/description:\n\n    tool = SamplingTool.from_function(search, name=\"web_search\")\n\n\n**Methods:**\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/sampling_tool.py#L45\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any] | None = None) -> Any\n```\n\nExecute the tool with the given arguments.\n\n**Args:**\n- `arguments`: Dictionary of arguments to pass to the tool function.\n\n**Returns:**\n- The result of executing the tool function.\n\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/sampling/sampling_tool.py#L75\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., Any]) -> SamplingTool\n```\n\nCreate a SamplingTool from a function.\n\nThe function's signature is analyzed to generate a JSON schema for\nthe tool's parameters. Type hints are used to determine parameter types.\n\n**Args:**\n- `fn`: The function to create a tool from.\n- `name`: Optional name override. Defaults to the function's name.\n- `description`: Optional description override. Defaults to the function's docstring.\n\n**Returns:**\n- A SamplingTool wrapping the function.\n\n**Raises:**\n- `ValueError`: If the function is a lambda without a name override.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-server.mdx", "content": "---\ntitle: server\nsidebarTitle: server\n---\n\n# `fastmcp.server.server`\n\n\nFastMCP - A more ergonomic interface for MCP servers.\n\n## Functions\n\n### `default_lifespan` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L157\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_lifespan(server: FastMCP[LifespanResultT]) -> AsyncIterator[Any]\n```\n\n\nDefault lifespan context manager that does nothing.\n\n**Args:**\n- `server`: The server instance this lifespan is managing\n\n**Returns:**\n- An empty dictionary as the lifespan result.\n\n\n## Classes\n\n### `FastMCP` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L193\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `settings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L408\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsettings(self) -> Settings\n```\n\n#### `name` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L419\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nname(self) -> str\n```\n\n#### `instructions` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L423\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstructions(self) -> str | None\n```\n\n#### `instructions` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L427\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninstructions(self, value: str | None) -> None\n```\n\n#### `version` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L431\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nversion(self) -> str | None\n```\n\n#### `website_url` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L435\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nwebsite_url(self) -> str | None\n```\n\n#### `icons` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L439\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nicons(self) -> list[mcp.types.Icon]\n```\n\n#### `docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L446\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndocket(self) -> Docket | None\n```\n\nGet the Docket instance if Docket support is enabled.\n\nReturns None if Docket is not enabled or server hasn't been started yet.\n\n\n#### `run_async` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L553\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_async(self, transport: Transport | None = None, show_banner: bool = True, **transport_kwargs: Any) -> None\n```\n\nRun the FastMCP server asynchronously.\n\n**Args:**\n- `transport`: Transport protocol to use (\"stdio\", \"sse\", or \"streamable-http\")\n\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L583\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, transport: Transport | None = None, show_banner: bool = True, **transport_kwargs: Any) -> None\n```\n\nRun the FastMCP server. Note this is a synchronous function.\n\n**Args:**\n- `transport`: Transport protocol to use (\"http\", \"stdio\", \"sse\", or \"streamable-http\")\n\n\n#### `add_middleware` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L702\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_middleware(self, middleware: Middleware) -> None\n```\n\n#### `add_provider` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L705\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_provider(self, provider: Provider) -> None\n```\n\nAdd a provider for dynamic tools, resources, and prompts.\n\nProviders are queried in registration order. The first provider to return\na non-None result wins. Static components (registered via decorators)\nalways take precedence over providers.\n\n**Args:**\n- `provider`: A Provider instance that will provide components dynamically.\n\n\n#### `enable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L721\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nenable(self) -> None\n```\n\nEnable components by removing from blocklist, or set allowlist with only=True.\n\n**Args:**\n- `keys`: Keys to enable (e.g., ``\"tool\\:my_tool\"``).\n- `tags`: Tags to enable - components with these tags will be enabled.\n- `only`: If True, switches to allowlist mode - ONLY show these keys/tags.\nThis clears existing allowlists and sets default visibility to False.\n\n\n#### `disable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L756\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndisable(self) -> None\n```\n\nDisable components by adding to the blocklist.\n\n**Args:**\n- `keys`: Keys to disable (e.g., ``\"tool\\:my_tool\"``).\n- `tags`: Tags to disable - components with these tags will be disabled.\n\n\n#### `get_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L789\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tools(self) -> dict[str, Tool]\n```\n\nGet all enabled tools from providers, indexed by name.\n\nIterates through all providers (LocalProvider first) and collects tools.\nFirst provider wins for duplicate names. Filters by server blocklist.\n\n\n#### `get_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L812\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_tool(self, name: str) -> Tool\n```\n\nGet an enabled tool by name.\n\nIterates through all providers (LocalProvider first) to find the tool.\nFirst provider wins. Returns only if enabled.\n\n\n#### `get_resources` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L859\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resources(self) -> dict[str, Resource]\n```\n\nGet all enabled resources from providers, indexed by URI.\n\nIterates through all providers (LocalProvider first) and collects resources.\nFirst provider wins for duplicate URIs. Filters by server blocklist.\n\n\n#### `get_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L885\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource(self, uri: str) -> Resource\n```\n\nGet an enabled resource by URI.\n\nIterates through all providers (LocalProvider first) to find the resource.\nFirst provider wins. Returns only if enabled.\n\n\n#### `get_resource_templates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L901\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_templates(self) -> dict[str, ResourceTemplate]\n```\n\nGet all enabled resource templates from providers, indexed by uri_template.\n\nIterates through all providers (LocalProvider first) and collects templates.\nFirst provider wins for duplicate uri_templates. Filters by server blocklist.\n\n\n#### `get_resource_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L927\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_resource_template(self, uri: str) -> ResourceTemplate\n```\n\nGet an enabled resource template that matches the given URI.\n\nIterates through all providers (LocalProvider first) to find the template.\nFirst provider wins. Returns only if enabled.\n\n\n#### `get_prompts` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L943\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompts(self) -> dict[str, Prompt]\n```\n\nGet all enabled prompts from providers, indexed by name.\n\nIterates through all providers (LocalProvider first) and collects prompts.\nFirst provider wins for duplicate names. Filters by server blocklist.\n\n\n#### `get_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L968\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_prompt(self, name: str) -> Prompt\n```\n\nGet an enabled prompt by name.\n\nIterates through all providers (LocalProvider first) to find the prompt.\nFirst provider wins. Returns only if enabled.\n\n\n#### `get_component` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L984\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_component(self, key: str) -> Tool | Resource | ResourceTemplate | Prompt\n```\n\nGet a component by its prefixed key.\n\nIterates through all providers (LocalProvider first) to find the component.\nFirst provider wins.\n\n**Args:**\n- `key`: The prefixed key (e.g., \"tool\\:name\", \"resource\\:uri\", \"template\\:uri\").\n\n**Returns:**\n- The component if found.\n\n**Raises:**\n- `NotFoundError`: If no component is found with the given key.\n\n\n#### `custom_route` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1011\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncustom_route(self, path: str, methods: list[str], name: str | None = None, include_in_schema: bool = True) -> Callable[[Callable[[Request], Awaitable[Response]]], Callable[[Request], Awaitable[Response]]]\n```\n\nDecorator to register a custom HTTP route on the FastMCP server.\n\nAllows adding arbitrary HTTP endpoints outside the standard MCP protocol,\nwhich can be useful for OAuth callbacks, health checks, or admin APIs.\nThe handler function must be an async function that accepts a Starlette\nRequest and returns a Response.\n\n**Args:**\n- `path`: URL path for the route (e.g., \"/auth/callback\")\n- `methods`: List of HTTP methods to support (e.g., [\"GET\", \"POST\"])\n- `name`: Optional name for the route (to reference this route with\nStarlette's reverse URL lookup feature)\n- `include_in_schema`: Whether to include in OpenAPI schema, defaults to True\n\n\n#### `add_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1797\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_tool(self, tool: Tool) -> Tool\n```\n\nAdd a tool to the server.\n\nThe tool function can optionally request a Context object by adding a parameter\nwith the Context type annotation. See the @tool decorator for examples.\n\n**Args:**\n- `tool`: The Tool instance to register\n\n**Returns:**\n- The tool instance that was added to the server.\n\n\n#### `remove_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1811\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_tool(self, name: str) -> None\n```\n\nRemove a tool from the server.\n\n**Args:**\n- `name`: The name of the tool to remove\n\n**Raises:**\n- `NotFoundError`: If the tool is not found\n\n\n#### `add_tool_transformation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1825\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_tool_transformation(self, tool_name: str, transformation: ToolTransformConfig) -> None\n```\n\nAdd a tool transformation.\n\n\n#### `remove_tool_transformation` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1831\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nremove_tool_transformation(self, tool_name: str) -> None\n```\n\nRemove a tool transformation.\n\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1836\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: AnyFunction) -> FunctionTool\n```\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1853\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: str | None = None) -> Callable[[AnyFunction], FunctionTool]\n```\n\n#### `tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1869\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntool(self, name_or_fn: str | AnyFunction | None = None) -> Callable[[AnyFunction], FunctionTool] | FunctionTool | partial[Callable[[AnyFunction], FunctionTool] | FunctionTool]\n```\n\nDecorator to register a tool.\n\nTools can optionally request a Context object by adding a parameter with the\nContext type annotation. The context provides access to MCP capabilities like\nlogging, progress reporting, and resource access.\n\nThis decorator supports multiple calling patterns:\n- @server.tool (without parentheses)\n- @server.tool (with empty parentheses)\n- @server.tool(\"custom_name\") (with name as first argument)\n- @server.tool(name=\"custom_name\") (with name as keyword argument)\n- server.tool(function, name=\"custom_name\") (direct function call)\n\n**Args:**\n- `name_or_fn`: Either a function (when used as @tool), a string name, or None\n- `name`: Optional name for the tool (keyword-only, alternative to name_or_fn)\n- `description`: Optional description of what the tool does\n- `tags`: Optional set of tags for categorizing the tool\n- `output_schema`: Optional JSON schema for the tool's output\n- `annotations`: Optional annotations about the tool's behavior\n- `exclude_args`: Optional list of argument names to exclude from the tool schema.\nDeprecated\\: Use `Depends()` for dependency injection instead.\n- `meta`: Optional meta information about the tool\n\n**Examples:**\n\nRegister a tool with a custom name:\n```python\n@server.tool\ndef my_tool(x: int) -> str:\n    return str(x)\n\n# Register a tool with a custom name\n@server.tool\ndef my_tool(x: int) -> str:\n    return str(x)\n\n@server.tool(\"custom_name\")\ndef my_tool(x: int) -> str:\n    return str(x)\n\n@server.tool(name=\"custom_name\")\ndef my_tool(x: int) -> str:\n    return str(x)\n\n# Direct function call\nserver.tool(my_function, name=\"custom_name\")\n```\n\n\n#### `add_resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1954\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_resource(self, resource: Resource) -> Resource\n```\n\nAdd a resource to the server.\n\n**Args:**\n- `resource`: A Resource instance to add\n\n**Returns:**\n- The resource instance that was added to the server.\n\n\n#### `add_template` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1965\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_template(self, template: ResourceTemplate) -> ResourceTemplate\n```\n\nAdd a resource template to the server.\n\n**Args:**\n- `template`: A ResourceTemplate instance to add\n\n**Returns:**\n- The template instance that was added to the server.\n\n\n#### `resource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L1976\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nresource(self, uri: str) -> Callable[[AnyFunction], Resource | ResourceTemplate]\n```\n\nDecorator to register a function as a resource.\n\nThe function will be called when the resource is read to generate its content.\nThe function can return:\n- str for text content\n- bytes for binary content\n- other types will be converted to JSON\n\nResources can optionally request a Context object by adding a parameter with the\nContext type annotation. The context provides access to MCP capabilities like\nlogging, progress reporting, and session information.\n\nIf the URI contains parameters (e.g. \"resource://{param}\") or the function\nhas parameters, it will be registered as a template resource.\n\n**Args:**\n- `uri`: URI for the resource (e.g. \"resource\\://my-resource\" or \"resource\\://{param}\")\n- `name`: Optional name for the resource\n- `description`: Optional description of the resource\n- `mime_type`: Optional MIME type for the resource\n- `tags`: Optional set of tags for categorizing the resource\n- `annotations`: Optional annotations about the resource's behavior\n- `meta`: Optional meta information about the resource\n\n**Examples:**\n\nRegister a resource with a custom name:\n```python\n@server.resource(\"resource://my-resource\")\ndef get_data() -> str:\n    return \"Hello, world!\"\n\n@server.resource(\"resource://my-resource\")\nasync get_data() -> str:\n    data = await fetch_data()\n    return f\"Hello, world! {data}\"\n\n@server.resource(\"resource://{city}/weather\")\ndef get_weather(city: str) -> str:\n    return f\"Weather for {city}\"\n\n@server.resource(\"resource://{city}/weather\")\nasync def get_weather_with_context(city: str, ctx: Context) -> str:\n    await ctx.info(f\"Fetching weather for {city}\")\n    return f\"Weather for {city}\"\n\n@server.resource(\"resource://{city}/weather\")\nasync def get_weather(city: str) -> str:\n    data = await fetch_weather(city)\n    return f\"Weather for {city}: {data}\"\n```\n\n\n#### `add_prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2060\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_prompt(self, prompt: Prompt) -> Prompt\n```\n\nAdd a prompt to the server.\n\n**Args:**\n- `prompt`: A Prompt instance to add\n\n**Returns:**\n- The prompt instance that was added to the server.\n\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2072\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: AnyFunction) -> FunctionPrompt\n```\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2086\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: str | None = None) -> Callable[[AnyFunction], FunctionPrompt]\n```\n\n#### `prompt` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2099\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprompt(self, name_or_fn: str | AnyFunction | None = None) -> Callable[[AnyFunction], FunctionPrompt] | FunctionPrompt | partial[Callable[[AnyFunction], FunctionPrompt] | FunctionPrompt]\n```\n\nDecorator to register a prompt.\n\n        Prompts can optionally request a Context object by adding a parameter with the\n        Context type annotation. The context provides access to MCP capabilities like\n        logging, progress reporting, and session information.\n\n        This decorator supports multiple calling patterns:\n        - @server.prompt (without parentheses)\n        - @server.prompt() (with empty parentheses)\n        - @server.prompt(\"custom_name\") (with name as first argument)\n        - @server.prompt(name=\"custom_name\") (with name as keyword argument)\n        - server.prompt(function, name=\"custom_name\") (direct function call)\n\n        Args:\n            name_or_fn: Either a function (when used as @prompt), a string name, or None\n            name: Optional name for the prompt (keyword-only, alternative to name_or_fn)\n            description: Optional description of what the prompt does\n            tags: Optional set of tags for categorizing the prompt\n            meta: Optional meta information about the prompt\n\n        Examples:\n\n            ```python\n            @server.prompt\n            def analyze_table(table_name: str) -> list[Message]:\n                schema = read_table_schema(table_name)\n                return [\n                    {\n                        \"role\": \"user\",\n                        \"content\": f\"Analyze this schema:\n{schema}\"\n                    }\n                ]\n\n            @server.prompt()\n            async def analyze_with_context(table_name: str, ctx: Context) -> list[Message]:\n                await ctx.info(f\"Analyzing table {table_name}\")\n                schema = read_table_schema(table_name)\n                return [\n                    {\n                        \"role\": \"user\",\n                        \"content\": f\"Analyze this schema:\n{schema}\"\n                    }\n                ]\n\n            @server.prompt(\"custom_name\")\n            async def analyze_file(path: str) -> list[Message]:\n                content = await read_file(path)\n                return [\n                    {\n                        \"role\": \"user\",\n                        \"content\": {\n                            \"type\": \"resource\",\n                            \"resource\": {\n                                \"uri\": f\"file://{path}\",\n                                \"text\": content\n                            }\n                        }\n                    }\n                ]\n\n            @server.prompt(name=\"custom_name\")\n            def another_prompt(data: str) -> list[Message]:\n                return [{\"role\": \"user\", \"content\": data}]\n\n            # Direct function call\n            server.prompt(my_function, name=\"custom_name\")\n            ```\n\n\n#### `run_stdio_async` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2195\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_stdio_async(self, show_banner: bool = True, log_level: str | None = None) -> None\n```\n\nRun the server using stdio transport.\n\n**Args:**\n- `show_banner`: Whether to display the server banner\n- `log_level`: Log level for the server\n\n\n#### `run_http_async` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2232\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_http_async(self, show_banner: bool = True, transport: Literal['http', 'streamable-http', 'sse'] = 'http', host: str | None = None, port: int | None = None, log_level: str | None = None, path: str | None = None, uvicorn_config: dict[str, Any] | None = None, middleware: list[ASGIMiddleware] | None = None, json_response: bool | None = None, stateless_http: bool | None = None) -> None\n```\n\nRun the server using HTTP transport.\n\n**Args:**\n- `transport`: Transport protocol to use - either \"streamable-http\" (default) or \"sse\"\n- `host`: Host address to bind to (defaults to settings.host)\n- `port`: Port to bind to (defaults to settings.port)\n- `log_level`: Log level for the server (defaults to settings.log_level)\n- `path`: Path for the endpoint (defaults to settings.streamable_http_path or settings.sse_path)\n- `uvicorn_config`: Additional configuration for the Uvicorn server\n- `middleware`: A list of middleware to apply to the app\n- `json_response`: Whether to use JSON response format (defaults to settings.json_response)\n- `stateless_http`: Whether to use stateless HTTP (defaults to settings.stateless_http)\n\n\n#### `http_app` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2311\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nhttp_app(self, path: str | None = None, middleware: list[ASGIMiddleware] | None = None, json_response: bool | None = None, stateless_http: bool | None = None, transport: Literal['http', 'streamable-http', 'sse'] = 'http', event_store: EventStore | None = None, retry_interval: int | None = None) -> StarletteWithLifespan\n```\n\nCreate a Starlette app using the specified HTTP transport.\n\n**Args:**\n- `path`: The path for the HTTP endpoint\n- `middleware`: A list of middleware to apply to the app\n- `json_response`: Whether to use JSON response format\n- `stateless_http`: Whether to use stateless mode (new transport per request)\n- `transport`: Transport protocol to use - \"http\", \"streamable-http\", or \"sse\"\n- `event_store`: Optional event store for SSE polling/resumability. When set,\nenables clients to reconnect and resume receiving events after\nserver-initiated disconnections. Only used with streamable-http transport.\n- `retry_interval`: Optional retry interval in milliseconds for SSE polling.\nControls how quickly clients should reconnect after server-initiated\ndisconnections. Requires event_store to be set. Only used with\nstreamable-http transport.\n\n**Returns:**\n- A Starlette application configured with the specified transport\n\n\n#### `mount` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2372\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmount(self, server: FastMCP[LifespanResultT], namespace: str | None = None, as_proxy: bool | None = None, tool_names: dict[str, str] | None = None, prefix: str | None = None) -> None\n```\n\nMount another FastMCP server on this server with an optional namespace.\n\nUnlike importing (with import_server), mounting establishes a dynamic connection\nbetween servers. When a client interacts with a mounted server's objects through\nthe parent server, requests are forwarded to the mounted server in real-time.\nThis means changes to the mounted server are immediately reflected when accessed\nthrough the parent.\n\nWhen a server is mounted with a namespace:\n- Tools from the mounted server are accessible with namespaced names.\n  Example: If server has a tool named \"get_weather\", it will be available as \"namespace_get_weather\".\n- Resources are accessible with namespaced URIs.\n  Example: If server has a resource with URI \"weather://forecast\", it will be available as\n  \"weather://namespace/forecast\".\n- Templates are accessible with namespaced URI templates.\n  Example: If server has a template with URI \"weather://location/{id}\", it will be available\n  as \"weather://namespace/location/{id}\".\n- Prompts are accessible with namespaced names.\n  Example: If server has a prompt named \"weather_prompt\", it will be available as\n  \"namespace_weather_prompt\".\n\nWhen a server is mounted without a namespace (namespace=None), its tools, resources, templates,\nand prompts are accessible with their original names. Multiple servers can be mounted\nwithout namespaces, and they will be tried in order until a match is found.\n\nThe mounted server's lifespan is executed when the parent server starts, and its\nmiddleware chain is invoked for all operations (tool calls, resource reads, prompts).\n\n**Args:**\n- `server`: The FastMCP server to mount.\n- `namespace`: Optional namespace to use for the mounted server's objects. If None,\nthe server's objects are accessible with their original names.\n- `as_proxy`: Deprecated. Mounted servers now always have their lifespan and\nmiddleware invoked. To create a proxy server, use FastMCP.as_proxy()\nexplicitly before mounting.\n- `tool_names`: Optional mapping of original tool names to custom names. Use this\nto override namespaced names. Keys are the original tool names from the\nmounted server.\n- `prefix`: Deprecated. Use namespace instead.\n\n\n#### `import_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2459\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nimport_server(self, server: FastMCP[LifespanResultT], prefix: str | None = None) -> None\n```\n\nImport the MCP objects from another FastMCP server into this one,\noptionally with a given prefix.\n\n.. deprecated::\n    Use :meth:`mount` instead. ``import_server`` will be removed in a\n    future version.\n\nNote that when a server is *imported*, its objects are immediately\nregistered to the importing server. This is a one-time operation and\nfuture changes to the imported server will not be reflected in the\nimporting server. Server-level configurations and lifespans are not imported.\n\nWhen a server is imported with a prefix:\n- The tools are imported with prefixed names\n  Example: If server has a tool named \"get_weather\", it will be\n  available as \"prefix_get_weather\"\n- The resources are imported with prefixed URIs using the new format\n  Example: If server has a resource with URI \"weather://forecast\", it will\n  be available as \"weather://prefix/forecast\"\n- The templates are imported with prefixed URI templates using the new format\n  Example: If server has a template with URI \"weather://location/{id}\", it will\n  be available as \"weather://prefix/location/{id}\"\n- The prompts are imported with prefixed names\n  Example: If server has a prompt named \"weather_prompt\", it will be available as\n  \"prefix_weather_prompt\"\n\nWhen a server is imported without a prefix (prefix=None), its tools, resources,\ntemplates, and prompts are imported with their original names.\n\n**Args:**\n- `server`: The FastMCP server to import\n- `prefix`: Optional prefix to use for the imported server's objects. If None,\nobjects are imported with their original names.\n\n\n#### `from_openapi` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2559\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_openapi(cls, openapi_spec: dict[str, Any], client: httpx.AsyncClient, name: str = 'OpenAPI Server', route_maps: list[RouteMap] | None = None, route_map_fn: OpenAPIRouteMapFn | None = None, mcp_component_fn: OpenAPIComponentFn | None = None, mcp_names: dict[str, str] | None = None, tags: set[str] | None = None, timeout: float | None = None, **settings: Any) -> Self\n```\n\nCreate a FastMCP server from an OpenAPI specification.\n\n**Args:**\n- `openapi_spec`: OpenAPI schema as a dictionary\n- `client`: httpx AsyncClient for making HTTP requests\n- `name`: Name for the MCP server\n- `route_maps`: Optional list of RouteMap objects defining route mappings\n- `route_map_fn`: Optional callable for advanced route type mapping\n- `mcp_component_fn`: Optional callable for component customization\n- `mcp_names`: Optional dictionary mapping operationId to component names\n- `tags`: Optional set of tags to add to all components\n- `timeout`: Optional timeout (in seconds) for all requests\n- `**settings`: Additional settings passed to FastMCP\n\n**Returns:**\n- A FastMCP server with an OpenAPIProvider attached.\n\n\n#### `from_fastapi` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2605\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_fastapi(cls, app: Any, name: str | None = None, route_maps: list[RouteMap] | None = None, route_map_fn: OpenAPIRouteMapFn | None = None, mcp_component_fn: OpenAPIComponentFn | None = None, mcp_names: dict[str, str] | None = None, httpx_client_kwargs: dict[str, Any] | None = None, tags: set[str] | None = None, timeout: float | None = None, **settings: Any) -> Self\n```\n\nCreate a FastMCP server from a FastAPI application.\n\n**Args:**\n- `app`: FastAPI application instance\n- `name`: Name for the MCP server (defaults to app.title)\n- `route_maps`: Optional list of RouteMap objects defining route mappings\n- `route_map_fn`: Optional callable for advanced route type mapping\n- `mcp_component_fn`: Optional callable for component customization\n- `mcp_names`: Optional dictionary mapping operationId to component names\n- `httpx_client_kwargs`: Optional kwargs passed to httpx.AsyncClient\n- `tags`: Optional set of tags to add to all components\n- `timeout`: Optional timeout (in seconds) for all requests\n- `**settings`: Additional settings passed to FastMCP\n\n**Returns:**\n- A FastMCP server with an OpenAPIProvider attached.\n\n\n#### `as_proxy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2662\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nas_proxy(cls, backend: Client[ClientTransportT] | ClientTransport | FastMCP[Any] | FastMCP1Server | AnyUrl | Path | MCPConfig | dict[str, Any] | str, **settings: Any) -> FastMCPProxy\n```\n\nCreate a FastMCP proxy server for the given backend.\n\nThe `backend` argument can be either an existing `fastmcp.client.Client`\ninstance or any value accepted as the `transport` argument of\n`fastmcp.client.Client`. This mirrors the convenience of the\n`fastmcp.client.Client` constructor.\n\n\n#### `generate_name` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/server.py#L2723\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_name(cls, name: str | None = None) -> str\n```\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.server.tasks`\n\n\nMCP SEP-1686 background tasks support.\n\nThis module implements protocol-level background task execution for MCP servers.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-capabilities.mdx", "content": "---\ntitle: capabilities\nsidebarTitle: capabilities\n---\n\n# `fastmcp.server.tasks.capabilities`\n\n\nSEP-1686 task capabilities declaration.\n\n## Functions\n\n### `get_task_capabilities` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/capabilities.py#L6\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_task_capabilities() -> dict[str, Any]\n```\n\n\nReturn the SEP-1686 task capabilities structure.\n\nThis is the standard capabilities map advertised to clients,\ndeclaring support for list, cancel, and request operations.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-config.mdx", "content": "---\ntitle: config\nsidebarTitle: config\n---\n\n# `fastmcp.server.tasks.config`\n\n\nTaskConfig for MCP SEP-1686 background task execution modes.\n\nThis module defines the configuration for how tools, resources, and prompts\nhandle task-augmented execution as specified in SEP-1686.\n\n\n## Classes\n\n### `TaskConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/config.py#L25\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for MCP background task execution (SEP-1686).\n\nControls how a component handles task-augmented requests:\n\n- \"forbidden\": Component does not support task execution. Clients must not\n  request task augmentation; server returns -32601 if they do.\n- \"optional\": Component supports both synchronous and task execution.\n  Client may request task augmentation or call normally.\n- \"required\": Component requires task execution. Clients must request task\n  augmentation; server returns -32601 if they don't.\n\n\n**Methods:**\n\n#### `from_bool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/config.py#L58\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_bool(cls, value: bool) -> TaskConfig\n```\n\nConvert boolean task flag to TaskConfig.\n\n**Args:**\n- `value`: True for \"optional\" mode, False for \"forbidden\" mode.\n\n**Returns:**\n- TaskConfig with appropriate mode.\n\n\n#### `supports_tasks` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/config.py#L69\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsupports_tasks(self) -> bool\n```\n\nCheck if this component supports task execution.\n\n**Returns:**\n- True if mode is \"optional\" or \"required\", False if \"forbidden\".\n\n\n#### `validate_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/config.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_function(self, fn: Callable[..., Any], name: str) -> None\n```\n\nValidate that function is compatible with this task config.\n\nTask execution requires async functions. Raises ValueError if mode\nis \"optional\" or \"required\" but function is synchronous.\n\n**Args:**\n- `fn`: The function to validate (handles callable classes and staticmethods).\n- `name`: Name for error messages.\n\n**Raises:**\n- `ValueError`: If task execution is enabled but function is sync.\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-handlers.mdx", "content": "---\ntitle: handlers\nsidebarTitle: handlers\n---\n\n# `fastmcp.server.tasks.handlers`\n\n\nSEP-1686 task execution handlers.\n\nHandles queuing tool/prompt/resource executions to Docket as background tasks.\n\n\n## Functions\n\n### `submit_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/handlers.py#L30\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsubmit_to_docket(task_type: Literal['tool', 'resource', 'template', 'prompt'], key: str, component: Tool | Resource | ResourceTemplate | Prompt, arguments: dict[str, Any] | None = None) -> mcp.types.CreateTaskResult\n```\n\n\nSubmit any component to Docket for background execution (SEP-1686).\n\nUnified handler for all component types. Called by component's internal\nmethods (_run, _read, _render) when task metadata is present and mode allows.\n\nQueues the component's method to Docket, stores raw return values,\nand converts to MCP types on retrieval.\n\nNote: Client-requested TTL in task_meta is intentionally ignored.\nServer-side TTL policy (docket.execution_ttl) takes precedence for\nconsistent task lifecycle management.\n\n**Args:**\n- `task_type`: Component type for task key construction\n- `key`: The component key as seen by MCP layer (with namespace prefix)\n- `component`: The component instance (Tool, Resource, ResourceTemplate, Prompt)\n- `arguments`: Arguments/params (None for Resource which has no args)\n\n**Returns:**\n- Task stub with proper Task object\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-keys.mdx", "content": "---\ntitle: keys\nsidebarTitle: keys\n---\n\n# `fastmcp.server.tasks.keys`\n\n\nTask key management for SEP-1686 background tasks.\n\nTask keys encode security scoping and metadata in the Docket key format:\n    {session_id}:{client_task_id}:{task_type}:{component_identifier}\n\nThis format provides:\n- Session-based security scoping (prevents cross-session access)\n- Task type identification (tool/prompt/resource)\n- Component identification (name or URI for result conversion)\n\n\n## Functions\n\n### `build_task_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/keys.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nbuild_task_key(session_id: str, client_task_id: str, task_type: str, component_identifier: str) -> str\n```\n\n\nBuild Docket task key with embedded metadata.\n\nFormat: {session_id}:{client_task_id}:{task_type}:{component_identifier}\n\nThe component_identifier is URI-encoded to handle special characters (colons, slashes, etc.).\n\n**Args:**\n- `session_id`: Session ID for security scoping\n- `client_task_id`: Client-provided task ID\n- `task_type`: Type of task (\"tool\", \"prompt\", \"resource\")\n- `component_identifier`: Tool name, prompt name, or resource URI\n\n**Returns:**\n- Encoded task key for Docket\n\n**Examples:**\n\n>>> build_task_key(\"session123\", \"task456\", \"tool\", \"my_tool\")\n'session123:task456:tool:my_tool'\n>>> build_task_key(\"session123\", \"task456\", \"resource\", \"file://data.txt\")\n'session123:task456:resource:file%3A%2F%2Fdata.txt'\n\n\n### `parse_task_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/keys.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_task_key(task_key: str) -> dict[str, str]\n```\n\n\nParse Docket task key to extract metadata.\n\n**Args:**\n- `task_key`: Encoded task key from Docket\n\n**Returns:**\n- Dict with keys: session_id, client_task_id, task_type, component_identifier\n\n**Examples:**\n\n>>> parse_task_key(\"session123:task456:tool:my_tool\")\n{'session_id': 'session123', 'client_task_id': 'task456',\n 'task_type': 'tool', 'component_identifier': 'my_tool'}\n>>> parse_task_key(\"session123:task456:resource:file%3A%2F%2Fdata.txt\")\n{'session_id': 'session123', 'client_task_id': 'task456',\n 'task_type': 'resource', 'component_identifier': 'file://data.txt'}\n\n\n### `get_client_task_id_from_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/keys.py#L80\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_client_task_id_from_key(task_key: str) -> str\n```\n\n\nExtract just the client task ID from a task key.\n\n**Args:**\n- `task_key`: Full encoded task key\n\n**Returns:**\n- Client-provided task ID (second segment)\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-requests.mdx", "content": "---\ntitle: requests\nsidebarTitle: requests\n---\n\n# `fastmcp.server.tasks.requests`\n\n\nSEP-1686 task request handlers.\n\nHandles MCP task protocol requests: tasks/get, tasks/result, tasks/list, tasks/cancel.\nThese handlers query and manage existing tasks (contrast with handlers.py which creates tasks).\n\n\n## Functions\n\n### `tasks_get_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/requests.py#L105\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntasks_get_handler(server: FastMCP, params: dict[str, Any]) -> GetTaskResult\n```\n\n\nHandle MCP 'tasks/get' request (SEP-1686).\n\n**Args:**\n- `server`: FastMCP server instance\n- `params`: Request params containing taskId\n\n**Returns:**\n- Task status response with spec-compliant fields\n\n\n### `tasks_result_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/requests.py#L191\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntasks_result_handler(server: FastMCP, params: dict[str, Any]) -> Any\n```\n\n\nHandle MCP 'tasks/result' request (SEP-1686).\n\nConverts raw task return values to MCP types based on task type.\n\n**Args:**\n- `server`: FastMCP server instance\n- `params`: Request params containing taskId\n\n**Returns:**\n- MCP result (CallToolResult, GetPromptResult, or ReadResourceResult)\n\n\n### `tasks_list_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/requests.py#L352\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntasks_list_handler(server: FastMCP, params: dict[str, Any]) -> ListTasksResult\n```\n\n\nHandle MCP 'tasks/list' request (SEP-1686).\n\nNote: With client-side tracking, this returns minimal info.\n\n**Args:**\n- `server`: FastMCP server instance\n- `params`: Request params (cursor, limit)\n\n**Returns:**\n- Response with tasks list and pagination\n\n\n### `tasks_cancel_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/requests.py#L370\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntasks_cancel_handler(server: FastMCP, params: dict[str, Any]) -> CancelTaskResult\n```\n\n\nHandle MCP 'tasks/cancel' request (SEP-1686).\n\nCancels a running task, transitioning it to cancelled state.\n\n**Args:**\n- `server`: FastMCP server instance\n- `params`: Request params containing taskId\n\n**Returns:**\n- Task status response showing cancelled state\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-routing.mdx", "content": "---\ntitle: routing\nsidebarTitle: routing\n---\n\n# `fastmcp.server.tasks.routing`\n\n\nTask routing helper for MCP components.\n\nProvides unified task mode enforcement and docket routing logic.\n\n\n## Functions\n\n### `check_background_task` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/routing.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncheck_background_task(component: Tool | Resource | ResourceTemplate | Prompt, task_type: TaskType, key: str, arguments: dict[str, Any] | None = None) -> mcp.types.CreateTaskResult | None\n```\n\n\nCheck task mode and submit to background if requested.\n\n**Args:**\n- `component`: The MCP component\n- `task_type`: Type of task (\"tool\", \"resource\", \"template\", \"prompt\")\n- `key`: Docket registration key (caller resolves from contextvar + fallback)\n- `arguments`: Arguments for tool/prompt/template execution\n\n**Returns:**\n- CreateTaskResult if submitted to docket, None for sync execution\n\n**Raises:**\n- `McpError`: If mode=\"required\" but no task metadata, or mode=\"forbidden\"\n      but task metadata is present\n\n"}, {"filename": "docs/python-sdk/fastmcp-server-tasks-subscriptions.mdx", "content": "---\ntitle: subscriptions\nsidebarTitle: subscriptions\n---\n\n# `fastmcp.server.tasks.subscriptions`\n\n\nTask subscription helpers for sending MCP notifications (SEP-1686).\n\nSubscribes to Docket execution state changes and sends notifications/tasks/status\nto clients when their tasks change state.\n\n\n## Functions\n\n### `subscribe_to_task_updates` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/tasks/subscriptions.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nsubscribe_to_task_updates(task_id: str, task_key: str, session: ServerSession, docket: Docket, poll_interval_ms: int = 5000) -> None\n```\n\n\nSubscribe to Docket execution events and send MCP notifications.\n\nPer SEP-1686 lines 436-444, servers MAY send notifications/tasks/status\nwhen task state changes. This is an optional optimization that reduces\nclient polling frequency.\n\n**Args:**\n- `task_id`: Client-visible task ID (server-generated UUID)\n- `task_key`: Internal Docket execution key (includes session, type, component)\n- `session`: MCP ServerSession for sending notifications\n- `docket`: Docket instance for subscribing to execution events\n- `poll_interval_ms`: Poll interval in milliseconds to include in notifications\n\n"}, {"filename": "docs/python-sdk/fastmcp-settings.mdx", "content": "---\ntitle: settings\nsidebarTitle: settings\n---\n\n# `fastmcp.settings`\n\n## Classes\n\n### `DocketSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L33\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nDocket worker configuration.\n\n\n### `ExperimentalSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L121\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `Settings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L145\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nFastMCP settings.\n\n\n**Methods:**\n\n#### `get_setting` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L157\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_setting(self, attr: str) -> Any\n```\n\nGet a setting. If the setting contains one or more `__`, it will be\ntreated as a nested setting.\n\n\n#### `set_setting` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L170\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nset_setting(self, attr: str, value: Any) -> None\n```\n\nSet a setting. If the setting contains one or more `__`, it will be\ntreated as a nested setting.\n\n\n#### `normalize_log_level` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L192\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nnormalize_log_level(cls, v)\n```\n\n#### `server_auth_class` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/settings.py#L396\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nserver_auth_class(self) -> AuthProvider | None\n```\n"}, {"filename": "docs/python-sdk/fastmcp-tools-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.tools`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-tools-tool.mdx", "content": "---\ntitle: tool\nsidebarTitle: tool\n---\n\n# `fastmcp.tools.tool`\n\n## Functions\n\n### `default_serializer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L74\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndefault_serializer(data: Any) -> str\n```\n\n## Classes\n\n### `ToolResult` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L78\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `to_mcp_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L111\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_result(self) -> list[ContentBlock] | tuple[list[ContentBlock], dict[str, Any]] | CallToolResult\n```\n\n### `Tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L127\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInternal tool registration info.\n\n\n**Methods:**\n\n#### `to_mcp_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L157\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_tool(self, **overrides: Any) -> MCPTool\n```\n\nConvert the FastMCP tool to an MCP tool.\n\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L186\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(fn: Callable[..., Any], name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, tags: set[str] | None = None, annotations: ToolAnnotations | None = None, exclude_args: list[str] | None = None, output_schema: dict[str, Any] | NotSetT | None = NotSet, serializer: ToolResultSerializerType | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionTool\n```\n\nCreate a Tool from a function.\n\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L216\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any]) -> ToolResult\n```\n\nRun the tool with arguments.\n\nThis method is not implemented in the base Tool class and must be\nimplemented by subclasses.\n\n`run()` can EITHER return a list of ContentBlocks, or a tuple of\n(list of ContentBlocks, dict of structured output).\n\n\n#### `convert_result` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L228\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_result(self, raw_value: Any) -> ToolResult\n```\n\nConvert a raw result to ToolResult.\n\nHandles ToolResult passthrough and converts raw values using the tool's\nattributes (serializer, output_schema) for proper conversion.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L293\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this tool with docket for background execution.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L299\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, arguments: dict[str, Any], **kwargs: Any) -> Execution\n```\n\nSchedule this tool for background execution via docket.\n\n**Args:**\n- `docket`: The Docket instance\n- `arguments`: Tool arguments\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n#### `from_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L323\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_tool(cls, tool: Tool) -> TransformedTool\n```\n\n### `FunctionTool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L355\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `to_mcp_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L358\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_mcp_tool(self, **overrides: Any) -> MCPTool\n```\n\nConvert the FastMCP tool to an MCP tool.\n\nExtends the base implementation to add task execution mode if enabled.\n\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L381\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., Any], name: str | None = None, title: str | None = None, description: str | None = None, icons: list[Icon] | None = None, tags: set[str] | None = None, annotations: ToolAnnotations | None = None, exclude_args: list[str] | None = None, output_schema: dict[str, Any] | NotSetT | None = NotSet, serializer: ToolResultSerializerType | None = None, meta: dict[str, Any] | None = None, task: bool | TaskConfig | None = None) -> FunctionTool\n```\n\nCreate a Tool from a function.\n\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L451\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any]) -> ToolResult\n```\n\nRun the tool with arguments.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L461\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this tool with docket for background execution.\n\nFunctionTool registers the underlying function, which has the user's\nDepends parameters for docket to resolve.\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L471\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, arguments: dict[str, Any], **kwargs: Any) -> Execution\n```\n\nSchedule this tool for background execution via docket.\n\nFunctionTool splats the arguments dict since .fn expects **kwargs.\n\n**Args:**\n- `docket`: The Docket instance\n- `arguments`: Tool arguments\n- `fn_key`: Function lookup key in Docket registry (defaults to self.key)\n- `task_key`: Redis storage key for the result\n- `**kwargs`: Additional kwargs passed to docket.add()\n\n\n### `ParsedFunction` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L513\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `from_function` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool.py#L521\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_function(cls, fn: Callable[..., Any], exclude_args: list[str] | None = None, validate: bool = True, wrap_non_object_output_schema: bool = True) -> ParsedFunction\n```\n"}, {"filename": "docs/python-sdk/fastmcp-tools-tool_transform.mdx", "content": "---\ntitle: tool_transform\nsidebarTitle: tool_transform\n---\n\n# `fastmcp.tools.tool_transform`\n\n## Functions\n\n### `forward` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L36\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nforward(**kwargs: Any) -> ToolResult\n```\n\n\nForward to parent tool with argument transformation applied.\n\nThis function can only be called from within a transformed tool's custom\nfunction. It applies argument transformation (renaming, validation) before\ncalling the parent tool.\n\nFor example, if the parent tool has args `x` and `y`, but the transformed\ntool has args `a` and `b`, and an `transform_args` was provided that maps `x` to\n`a` and `y` to `b`, then `forward(a=1, b=2)` will call the parent tool with\n`x=1` and `y=2`.\n\n**Args:**\n- `**kwargs`: Arguments to forward to the parent tool (using transformed names).\n\n**Returns:**\n- The ToolResult from the parent tool execution.\n\n**Raises:**\n- `RuntimeError`: If called outside a transformed tool context.\n- `TypeError`: If provided arguments don't match the transformed schema.\n\n\n### `forward_raw` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L66\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nforward_raw(**kwargs: Any) -> ToolResult\n```\n\n\nForward directly to parent tool without transformation.\n\nThis function bypasses all argument transformation and validation, calling the parent\ntool directly with the provided arguments. Use this when you need to call the parent\nwith its original parameter names and structure.\n\nFor example, if the parent tool has args `x` and `y`, then `forward_raw(x=1,\ny=2)` will call the parent tool with `x=1` and `y=2`.\n\n**Args:**\n- `**kwargs`: Arguments to pass directly to the parent tool (using original names).\n\n**Returns:**\n- The ToolResult from the parent tool execution.\n\n**Raises:**\n- `RuntimeError`: If called outside a transformed tool context.\n\n\n### `apply_transformations_to_tools` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L916\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\napply_transformations_to_tools(tools: dict[str, Tool], transformations: dict[str, ToolTransformConfig]) -> dict[str, Tool]\n```\n\n\nApply a list of transformations to a list of tools. Tools that do not have any transformations\nare left unchanged.\n\nNote: tools dict is keyed by prefixed key (e.g., \"tool:my_tool\"),\nbut transformations are keyed by tool name (e.g., \"my_tool\").\n\n\n## Classes\n\n### `ArgTransform` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L93\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for transforming a parent tool's argument.\n\nThis class allows fine-grained control over how individual arguments are transformed\nwhen creating a new tool from an existing one. You can rename arguments, change their\ndescriptions, add default values, or hide them from clients while passing constants.\n\n**Attributes:**\n- `name`: New name for the argument. Use None to keep original name, or ... for no change.\n- `description`: New description for the argument. Use None to remove description, or ... for no change.\n- `default`: New default value for the argument. Use ... for no change.\n- `default_factory`: Callable that returns a default value. Cannot be used with default.\n- `type`: New type for the argument. Use ... for no change.\n- `hide`: If True, hide this argument from clients but pass a constant value to parent.\n- `required`: If True, make argument required (remove default). Use ... for no change.\n- `examples`: Examples for the argument. Use ... for no change.\n\n**Examples:**\n\nRename argument 'old_name' to 'new_name'\n```python\nArgTransform(name=\"new_name\")\n```\n\nChange description only\n```python\nArgTransform(description=\"Updated description\")\n```\n\nAdd a default value (makes argument optional)\n```python\nArgTransform(default=42)\n```\n\nAdd a default factory (makes argument optional)\n```python\nArgTransform(default_factory=lambda: time.time())\n```\n\nChange the type\n```python\nArgTransform(type=str)\n```\n\nHide the argument entirely from clients\n```python\nArgTransform(hide=True)\n```\n\nHide argument but pass a constant value to parent\n```python\nArgTransform(hide=True, default=\"constant_value\")\n```\n\nHide argument but pass a factory-generated value to parent\n```python\nArgTransform(hide=True, default_factory=lambda: uuid.uuid4().hex)\n```\n\nMake an optional parameter required (removes any default)\n```python\nArgTransform(required=True)\n```\n\nCombine multiple transformations\n```python\nArgTransform(name=\"new_name\", description=\"New desc\", default=None, type=int)\n```\n\n\n### `ArgTransformConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L207\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA model for requesting a single argument transform.\n\n\n**Methods:**\n\n#### `to_arg_transform` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L225\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_arg_transform(self) -> ArgTransform\n```\n\nConvert the argument transform to a FastMCP argument transform.\n\n\n### `TransformedTool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L231\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nA tool that is transformed from another tool.\n\nThis class represents a tool that has been created by transforming another tool.\nIt supports argument renaming, schema modification, custom function injection,\nstructured output control, and provides context for the forward() and forward_raw() functions.\n\nThe transformation can be purely schema-based (argument renaming, dropping, etc.)\nor can include a custom function that uses forward() to call the parent tool\nwith transformed arguments. Output schemas and structured outputs are automatically\ninherited from the parent tool but can be overridden or disabled.\n\n**Attributes:**\n- `parent_tool`: The original tool that this tool was transformed from.\n- `fn`: The function to execute when this tool is called (either the forwarding\nfunction for pure transformations or a custom user function).\n- `forwarding_fn`: Internal function that handles argument transformation and\nvalidation when forward() is called from custom functions.\n\n\n**Methods:**\n\n#### `run` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L258\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun(self, arguments: dict[str, Any]) -> ToolResult\n```\n\nRun the tool with context set for forward() functions.\n\nThis method executes the tool's function while setting up the context\nthat allows forward() and forward_raw() to work correctly within custom\nfunctions.\n\n**Args:**\n- `arguments`: Dictionary of arguments to pass to the tool's function.\n\n**Returns:**\n- ToolResult object containing content and optional structured output.\n\n\n#### `from_tool` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L363\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_tool(cls, tool: Tool, name: str | None = None, title: str | NotSetT | None = NotSet, description: str | NotSetT | None = NotSet, tags: set[str] | None = None, transform_fn: Callable[..., Any] | None = None, transform_args: dict[str, ArgTransform] | None = None, annotations: ToolAnnotations | NotSetT | None = NotSet, output_schema: dict[str, Any] | NotSetT | None = NotSet, serializer: Callable[[Any], str] | NotSetT | None = NotSet, meta: dict[str, Any] | NotSetT | None = NotSet) -> TransformedTool\n```\n\nCreate a transformed tool from a parent tool.\n\n**Args:**\n- `tool`: The parent tool to transform.\n- `transform_fn`: Optional custom function. Can use forward() and forward_raw()\nto call the parent tool. Functions with **kwargs receive transformed\nargument names.\n- `name`: New name for the tool. Defaults to parent tool's name.\n- `title`: New title for the tool. Defaults to parent tool's title.\n- `transform_args`: Optional transformations for parent tool arguments.\nOnly specified arguments are transformed, others pass through unchanged\\:\n- Simple rename (str)\n- Complex transformation (rename/description/default/drop) (ArgTransform)\n- Drop the argument (None)\n- `description`: New description. Defaults to parent's description.\n- `tags`: New tags. Defaults to parent's tags.\n- `annotations`: New annotations. Defaults to parent's annotations.\n- `output_schema`: Control output schema for structured outputs\\:\n- None (default)\\: Inherit from transform_fn if available, then parent tool\n- dict\\: Use custom output schema\n- False\\: Disable output schema and structured outputs\n- `serializer`: New serializer. Defaults to parent's serializer.\n- `meta`: Control meta information\\:\n- NotSet (default)\\: Inherit from parent tool\n- dict\\: Use custom meta information\n- None\\: Remove meta information\n\n**Returns:**\n- TransformedTool with the specified transformations.\n\n**Examples:**\n\n# Transform specific arguments only\n```python\nTool.from_tool(parent, transform_args={\"old\": \"new\"})  # Others unchanged\n```\n\n# Custom function with partial transforms\n```python\nasync def custom(x: int, y: int) -> str:\n    result = await forward(x=x, y=y)\n    return f\"Custom: {result}\"\n\nTool.from_tool(parent, transform_fn=custom, transform_args={\"a\": \"x\", \"b\": \"y\"})\n```\n\n# Using **kwargs (gets all args, transformed and untransformed)\n```python\nasync def flexible(**kwargs) -> str:\n    result = await forward(**kwargs)\n    return f\"Got: {kwargs}\"\n\nTool.from_tool(parent, transform_fn=flexible, transform_args={\"a\": \"x\"})\n```\n\n# Control structured outputs and schemas\n```python\n# Custom output schema\nTool.from_tool(parent, output_schema={\n    \"type\": \"object\",\n    \"properties\": {\"status\": {\"type\": \"string\"}}\n})\n\n# Disable structured outputs\nTool.from_tool(parent, output_schema=None)\n\n# Return ToolResult for full control\nasync def custom_output(**kwargs) -> ToolResult:\n    result = await forward(**kwargs)\n    return ToolResult(\n        content=[TextContent(text=\"Summary\")],\n        structured_content={\"processed\": True}\n    )\n```\n\n\n### `ToolTransformConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L875\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nProvides a way to transform a tool.\n\n\n**Methods:**\n\n#### `apply` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/tools/tool_transform.py#L902\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\napply(self, tool: Tool) -> TransformedTool\n```\n\nCreate a TransformedTool from a provided tool and this transformation configuration.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities`\n\n\nFastMCP utility modules.\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-auth.mdx", "content": "---\ntitle: auth\nsidebarTitle: auth\n---\n\n# `fastmcp.utilities.auth`\n\n\nAuthentication utility helpers.\n\n## Functions\n\n### `parse_scopes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/auth.py#L9\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_scopes(value: Any) -> list[str] | None\n```\n\n\nParse scopes from environment variables or settings values.\n\nAccepts either a JSON array string, a comma- or space-separated string,\na list of strings, or ``None``. Returns a list of scopes or ``None`` if\nno value is provided.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-cli.mdx", "content": "---\ntitle: cli\nsidebarTitle: cli\n---\n\n# `fastmcp.utilities.cli`\n\n## Functions\n\n### `is_already_in_uv_subprocess` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/cli.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_already_in_uv_subprocess() -> bool\n```\n\n\nCheck if we're already running in a FastMCP uv subprocess.\n\n\n### `load_and_merge_config` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/cli.py#L32\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_and_merge_config(server_spec: str | None, **cli_overrides) -> tuple[MCPServerConfig, str]\n```\n\n\nLoad config from server_spec and apply CLI overrides.\n\nThis consolidates the config parsing logic that was duplicated across\nrun, inspect, and dev commands.\n\n**Args:**\n- `server_spec`: Python file, config file, URL, or None to auto-detect\n- `cli_overrides`: CLI arguments that override config values\n\n**Returns:**\n- Tuple of (MCPServerConfig, resolved_server_spec)\n\n\n### `log_server_banner` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/cli.py#L200\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nlog_server_banner(server: FastMCP[Any], transport: Literal['stdio', 'http', 'sse', 'streamable-http']) -> None\n```\n\n\nCreates and logs a formatted banner with server information and logo.\n\n**Args:**\n- `transport`: The transport protocol being used\n- `server_name`: Optional server name to display\n- `host`: Host address (for HTTP transports)\n- `port`: Port number (for HTTP transports)\n- `path`: Server path (for HTTP transports)\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-components.mdx", "content": "---\ntitle: components\nsidebarTitle: components\n---\n\n# `fastmcp.utilities.components`\n\n## Classes\n\n### `FastMCPMeta` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L21\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `FastMCPComponent` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for FastMCP tools, prompts, resources, and resource templates.\n\n\n**Methods:**\n\n#### `make_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L80\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmake_key(cls, identifier: str) -> str\n```\n\nConstruct the lookup key for this component type.\n\n**Args:**\n- `identifier`: The raw identifier (name for tools/prompts, uri for resources)\n\n**Returns:**\n- A prefixed key like \"tool:name\" or \"resource:uri\"\n\n\n#### `key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L94\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nkey(self) -> str\n```\n\nThe globally unique lookup key for this component.\n\nFormat: \"{key_prefix}:{identifier}\" e.g. \"tool:my_tool\", \"resource:file://x.txt\"\n\nSubclasses should override this to use their specific identifier.\nBase implementation uses name.\n\n\n#### `get_meta` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L104\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_meta(self, include_fastmcp_meta: bool | None = None) -> dict[str, Any] | None\n```\n\nGet the meta information about the component.\n\nIf include_fastmcp_meta is True, a `_fastmcp` key will be added to the\nmeta, containing a `tags` field with the tags of the component.\n\n\n#### `enable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L138\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nenable(self) -> None\n```\n\nRemoved in 3.0. Use server.enable(keys=[...]) instead.\n\n\n#### `disable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L145\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndisable(self) -> None\n```\n\nRemoved in 3.0. Use server.disable(keys=[...]) instead.\n\n\n#### `copy` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L152\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncopy(self) -> Self\n```\n\nCreate a copy of the component.\n\n\n#### `register_with_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L156\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nregister_with_docket(self, docket: Docket) -> None\n```\n\nRegister this component with docket for background execution.\n\nNo-ops if task_config.mode is \"forbidden\". Subclasses override to\nregister their callable (self.run, self.read, self.render, or self.fn).\n\n\n#### `add_to_docket` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/components.py#L164\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nadd_to_docket(self, docket: Docket, *args: Any, **kwargs: Any) -> Execution\n```\n\nSchedule this component for background execution via docket.\n\nSubclasses override this to handle their specific calling conventions:\n- Tool: add_to_docket(docket, arguments: dict, **kwargs)\n- Resource: add_to_docket(docket, **kwargs)\n- ResourceTemplate: add_to_docket(docket, params: dict, **kwargs)\n- Prompt: add_to_docket(docket, arguments: dict | None, **kwargs)\n\nThe **kwargs are passed through to docket.add() (e.g., key=task_key).\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-exceptions.mdx", "content": "---\ntitle: exceptions\nsidebarTitle: exceptions\n---\n\n# `fastmcp.utilities.exceptions`\n\n## Functions\n\n### `iter_exc` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/exceptions.py#L12\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\niter_exc(group: BaseExceptionGroup)\n```\n\n### `get_catch_handlers` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/exceptions.py#L42\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_catch_handlers() -> Mapping[type[BaseException] | Iterable[type[BaseException]], Callable[[BaseExceptionGroup[Any]], Any]]\n```\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-http.mdx", "content": "---\ntitle: http\nsidebarTitle: http\n---\n\n# `fastmcp.utilities.http`\n\n## Functions\n\n### `find_available_port` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/http.py#L4\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfind_available_port() -> int\n```\n\n\nFind an available port by letting the OS assign one.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-inspect.mdx", "content": "---\ntitle: inspect\nsidebarTitle: inspect\n---\n\n# `fastmcp.utilities.inspect`\n\n\nUtilities for inspecting FastMCP instances.\n\n## Functions\n\n### `inspect_fastmcp_v2` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninspect_fastmcp_v2(mcp: FastMCP[Any]) -> FastMCPInfo\n```\n\n\nExtract information from a FastMCP v2.x instance.\n\n**Args:**\n- `mcp`: The FastMCP v2.x instance to inspect\n\n**Returns:**\n- FastMCPInfo dataclass containing the extracted information\n\n\n### `inspect_fastmcp_v1` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L236\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninspect_fastmcp_v1(mcp: FastMCP1x) -> FastMCPInfo\n```\n\n\nExtract information from a FastMCP v1.x instance using a Client.\n\n**Args:**\n- `mcp`: The FastMCP v1.x instance to inspect\n\n**Returns:**\n- FastMCPInfo dataclass containing the extracted information\n\n\n### `inspect_fastmcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L378\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ninspect_fastmcp(mcp: FastMCP[Any] | FastMCP1x) -> FastMCPInfo\n```\n\n\nExtract information from a FastMCP instance into a dataclass.\n\nThis function automatically detects whether the instance is FastMCP v1.x or v2.x\nand uses the appropriate extraction method.\n\n**Args:**\n- `mcp`: The FastMCP instance to inspect (v1.x or v2.x)\n\n**Returns:**\n- FastMCPInfo dataclass containing the extracted information\n\n\n### `format_fastmcp_info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L403\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_fastmcp_info(info: FastMCPInfo) -> bytes\n```\n\n\nFormat FastMCPInfo as FastMCP-specific JSON.\n\nThis includes FastMCP-specific fields like tags, enabled, annotations, etc.\n\n\n### `format_mcp_info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L432\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_mcp_info(mcp: FastMCP[Any] | FastMCP1x) -> bytes\n```\n\n\nFormat server info as standard MCP protocol JSON.\n\nUses Client to get the standard MCP protocol format with camelCase fields.\nIncludes version metadata at the top level.\n\n\n### `format_info` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L465\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_info(mcp: FastMCP[Any] | FastMCP1x, format: InspectFormat | Literal['fastmcp', 'mcp'], info: FastMCPInfo | None = None) -> bytes\n```\n\n\nFormat server information according to the specified format.\n\n**Args:**\n- `mcp`: The FastMCP instance\n- `format`: Output format (\"fastmcp\" or \"mcp\")\n- `info`: Pre-extracted FastMCPInfo (optional, will be extracted if not provided)\n\n**Returns:**\n- JSON bytes in the requested format\n\n\n## Classes\n\n### `ToolInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L19\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInformation about a tool.\n\n\n### `PromptInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L35\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInformation about a prompt.\n\n\n### `ResourceInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L49\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInformation about a resource.\n\n\n### `TemplateInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInformation about a resource template.\n\n\n### `FastMCPInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L82\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nInformation extracted from a FastMCP instance.\n\n\n### `InspectFormat` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/inspect.py#L396\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOutput format for inspect command.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-json_schema.mdx", "content": "---\ntitle: json_schema\nsidebarTitle: json_schema\n---\n\n# `fastmcp.utilities.json_schema`\n\n## Functions\n\n### `compress_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/json_schema.py#L200\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncompress_schema(schema: dict, prune_params: list[str] | None = None, prune_defs: bool = True, prune_additional_properties: bool = True, prune_titles: bool = False) -> dict\n```\n\n\nRemove the given parameters from the schema.\n\n**Args:**\n- `schema`: The schema to compress\n- `prune_params`: List of parameter names to remove from properties\n- `prune_defs`: Whether to remove unused definitions\n- `prune_additional_properties`: Whether to remove additionalProperties\\: false\n- `prune_titles`: Whether to remove title fields from the schema\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-json_schema_type.mdx", "content": "---\ntitle: json_schema_type\nsidebarTitle: json_schema_type\n---\n\n# `fastmcp.utilities.json_schema_type`\n\n\nConvert JSON Schema to Python types with validation.\n\nThe json_schema_to_type function converts a JSON Schema into a Python type that can be used\nfor validation with Pydantic. It supports:\n\n- Basic types (string, number, integer, boolean, null)\n- Complex types (arrays, objects)\n- Format constraints (date-time, email, uri)\n- Numeric constraints (minimum, maximum, multipleOf)\n- String constraints (minLength, maxLength, pattern)\n- Array constraints (minItems, maxItems, uniqueItems)\n- Object properties with defaults\n- References and recursive schemas\n- Enums and constants\n- Union types\n\nExample:\n    ```python\n    schema = {\n        \"type\": \"object\",\n        \"properties\": {\n            \"name\": {\"type\": \"string\", \"minLength\": 1},\n            \"age\": {\"type\": \"integer\", \"minimum\": 0},\n            \"email\": {\"type\": \"string\", \"format\": \"email\"}\n        },\n        \"required\": [\"name\", \"age\"]\n    }\n\n    # Name is optional and will be inferred from schema's \"title\" property if not provided\n    Person = json_schema_to_type(schema)\n    # Creates a validated dataclass with name, age, and optional email fields\n    ```\n\n\n## Functions\n\n### `json_schema_to_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/json_schema_type.py#L110\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\njson_schema_to_type(schema: Mapping[str, Any], name: str | None = None) -> type\n```\n\n\nConvert JSON schema to appropriate Python type with validation.\n\n**Args:**\n- `schema`: A JSON Schema dictionary defining the type structure and validation rules\n- `name`: Optional name for object schemas. Only allowed when schema type is \"object\".\nIf not provided for objects, name will be inferred from schema's \"title\"\nproperty or default to \"Root\".\n\n**Returns:**\n- A Python type (typically a dataclass for objects) with Pydantic validation\n\n**Raises:**\n- `ValueError`: If a name is provided for a non-object schema\n\n**Examples:**\n\nCreate a dataclass from an object schema:\n```python\nschema = {\n    \"type\": \"object\",\n    \"title\": \"Person\",\n    \"properties\": {\n        \"name\": {\"type\": \"string\", \"minLength\": 1},\n        \"age\": {\"type\": \"integer\", \"minimum\": 0},\n        \"email\": {\"type\": \"string\", \"format\": \"email\"}\n    },\n    \"required\": [\"name\", \"age\"]\n}\n\nPerson = json_schema_to_type(schema)\n# Creates a dataclass with name, age, and optional email fields:\n# @dataclass\n# class Person:\n#     name: str\n#     age: int\n#     email: str | None = None\n```\nPerson(name=\"John\", age=30)\n\nCreate a scalar type with constraints:\n```python\nschema = {\n    \"type\": \"string\",\n    \"minLength\": 3,\n    \"pattern\": \"^[A-Z][a-z]+$\"\n}\n\nNameType = json_schema_to_type(schema)\n# Creates Annotated[str, StringConstraints(min_length=3, pattern=\"^[A-Z][a-z]+$\")]\n\n@dataclass\nclass Name:\n    name: NameType\n```\n\n\n## Classes\n\n### `JSONSchema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/json_schema_type.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-logging.mdx", "content": "---\ntitle: logging\nsidebarTitle: logging\n---\n\n# `fastmcp.utilities.logging`\n\n\nLogging utilities for FastMCP.\n\n## Functions\n\n### `get_logger` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/logging.py#L14\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_logger(name: str) -> logging.Logger\n```\n\n\nGet a logger nested under FastMCP namespace.\n\n**Args:**\n- `name`: the name of the logger, which will be prefixed with 'FastMCP.'\n\n**Returns:**\n- a configured logger instance\n\n\n### `configure_logging` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/logging.py#L29\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconfigure_logging(level: Literal['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'] | int = 'INFO', logger: logging.Logger | None = None, enable_rich_tracebacks: bool | None = None, **rich_kwargs: Any) -> None\n```\n\n\nConfigure logging for FastMCP.\n\n**Args:**\n- `logger`: the logger to configure\n- `level`: the log level to use\n- `rich_kwargs`: the parameters to use for creating RichHandler\n\n\n### `temporary_log_level` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/logging.py#L103\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntemporary_log_level(level: str | None, logger: logging.Logger | None = None, enable_rich_tracebacks: bool | None = None, **rich_kwargs: Any)\n```\n\n\nContext manager to temporarily set log level and restore it afterwards.\n\n**Args:**\n- `level`: The temporary log level to set (e.g., \"DEBUG\", \"INFO\")\n- `logger`: Optional logger to configure (defaults to FastMCP logger)\n- `enable_rich_tracebacks`: Whether to enable rich tracebacks\n- `**rich_kwargs`: Additional parameters for RichHandler\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_config.mdx", "content": "---\ntitle: mcp_config\nsidebarTitle: mcp_config\n---\n\n# `fastmcp.utilities.mcp_config`\n\n## Functions\n\n### `mcp_config_to_servers_and_transports` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_config.py#L17\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmcp_config_to_servers_and_transports(config: MCPConfig) -> list[tuple[str, FastMCP[Any], ClientTransport]]\n```\n\n\nA utility function to convert each entry of an MCP Config into a transport and server.\n\n\n### `mcp_server_type_to_servers_and_transports` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_config.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nmcp_server_type_to_servers_and_transports(name: str, mcp_server: MCPServerTypes) -> tuple[str, FastMCP[Any], ClientTransport]\n```\n\n\nA utility function to convert each entry of an MCP Config into a transport and server.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities.mcp_server_config`\n\n\nFastMCP Configuration module.\n\nThis module provides versioned configuration support for FastMCP servers.\nThe current version is v1, which is re-exported here for convenience.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities.mcp_server_config.v1`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-environments-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.environments`\n\n\nEnvironment configuration for MCP servers.\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-environments-base.mdx", "content": "---\ntitle: base\nsidebarTitle: base\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.environments.base`\n\n## Classes\n\n### `Environment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/base.py#L7\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase class for environment configuration.\n\n\n**Methods:**\n\n#### `build_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/base.py#L13\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nbuild_command(self, command: list[str]) -> list[str]\n```\n\nBuild the full command with environment setup.\n\n**Args:**\n- `command`: Base command to wrap with environment setup\n\n**Returns:**\n- Full command ready for subprocess execution\n\n\n#### `prepare` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/base.py#L23\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare(self, output_dir: Path | None = None) -> None\n```\n\nPrepare the environment (optional, can be no-op).\n\n**Args:**\n- `output_dir`: Directory for persistent environment setup\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-environments-uv.mdx", "content": "---\ntitle: uv\nsidebarTitle: uv\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.environments.uv`\n\n## Classes\n\n### `UVEnvironment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/uv.py#L14\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for Python environment setup.\n\n\n**Methods:**\n\n#### `build_command` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/uv.py#L49\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nbuild_command(self, command: list[str]) -> list[str]\n```\n\nBuild complete uv run command with environment args and command to execute.\n\n**Args:**\n- `command`: Command to execute (e.g., [\"fastmcp\", \"run\", \"server.py\"])\n\n**Returns:**\n- Complete command ready for subprocess.run, including \"uv\" prefix if needed.\n- If no environment configuration is set, returns the command unchanged.\n\n\n#### `prepare` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/environments/uv.py#L109\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare(self, output_dir: Path | None = None) -> None\n```\n\nPrepare the Python environment using uv.\n\n**Args:**\n- `output_dir`: Directory where the persistent uv project will be created.\n       If None, creates a temporary directory for ephemeral use.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-mcp_server_config.mdx", "content": "---\ntitle: mcp_server_config\nsidebarTitle: mcp_server_config\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.mcp_server_config`\n\n\nFastMCP Configuration File Support.\n\nThis module provides support for fastmcp.json configuration files that allow\nusers to specify server settings in a declarative format instead of using\ncommand-line arguments.\n\n\n## Functions\n\n### `generate_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L416\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_schema(output_path: Path | str | None = None) -> dict[str, Any] | None\n```\n\n\nGenerate JSON schema for fastmcp.json files.\n\nThis is used to create the schema file that IDEs can use for\nvalidation and auto-completion.\n\n**Args:**\n- `output_path`: Optional path to write the schema to. If provided,\n        writes the schema and returns None. If not provided,\n        returns the schema as a dictionary.\n\n**Returns:**\n- JSON schema as a dictionary if output_path is None, otherwise None\n\n\n## Classes\n\n### `Deployment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L36\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for server deployment and runtime settings.\n\n\n**Methods:**\n\n#### `apply_runtime_settings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L85\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\napply_runtime_settings(self, config_path: Path | None = None) -> None\n```\n\nApply runtime settings like environment variables and working directory.\n\n**Args:**\n- `config_path`: Path to config file for resolving relative paths\n\nEnvironment variables support interpolation with ${VAR_NAME} syntax.\nFor example: \"API_URL\": \"https://api.${ENVIRONMENT}.example.com\"\nwill substitute the value of the ENVIRONMENT variable at runtime.\n\n\n### `MCPServerConfig` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L134\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nConfiguration for a FastMCP server.\n\nThis configuration file allows you to specify all settings needed to run\na FastMCP server in a declarative format.\n\n\n**Methods:**\n\n#### `validate_source` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L183\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_source(cls, v: dict | Source) -> SourceType\n```\n\nValidate and convert source to proper format.\n\nSupports:\n- Dict format: `{\"path\": \"server.py\", \"entrypoint\": \"app\"}`\n- FileSystemSource instance (passed through)\n\nNo string parsing happens here - that's only at CLI boundaries.\nMCPServerConfig works only with properly typed objects.\n\n\n#### `validate_environment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L199\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_environment(cls, v: dict | Any) -> EnvironmentType\n```\n\nEnsure environment has a type field for discrimination.\n\nFor backward compatibility, if no type is specified, default to \"uv\".\n\n\n#### `validate_deployment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L210\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nvalidate_deployment(cls, v: dict | Deployment) -> Deployment\n```\n\nValidate and convert deployment to Deployment.\n\nAccepts:\n- Deployment instance\n- dict that can be converted to Deployment\n\n\n#### `from_file` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L223\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_file(cls, file_path: Path) -> MCPServerConfig\n```\n\nLoad configuration from a JSON file.\n\n**Args:**\n- `file_path`: Path to the configuration file\n\n**Returns:**\n- MCPServerConfig instance\n\n**Raises:**\n- `FileNotFoundError`: If the file doesn't exist\n- `json.JSONDecodeError`: If the file is not valid JSON\n- `pydantic.ValidationError`: If the configuration is invalid\n\n\n#### `from_cli_args` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L246\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfrom_cli_args(cls, source: FileSystemSource, transport: Literal['stdio', 'http', 'sse', 'streamable-http'] | None = None, host: str | None = None, port: int | None = None, path: str | None = None, log_level: Literal['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'] | None = None, python: str | None = None, dependencies: list[str] | None = None, requirements: str | None = None, project: str | None = None, editable: str | None = None, env: dict[str, str] | None = None, cwd: str | None = None, args: list[str] | None = None) -> MCPServerConfig\n```\n\nCreate a config from CLI arguments.\n\nThis allows us to have a single code path where everything\ngoes through a config object.\n\n**Args:**\n- `source`: Server source (FileSystemSource instance)\n- `transport`: Transport protocol\n- `host`: Host for HTTP transport\n- `port`: Port for HTTP transport\n- `path`: URL path for server\n- `log_level`: Logging level\n- `python`: Python version\n- `dependencies`: Python packages to install\n- `requirements`: Path to requirements file\n- `project`: Path to project directory\n- `editable`: Path to install in editable mode\n- `env`: Environment variables\n- `cwd`: Working directory\n- `args`: Server arguments\n\n**Returns:**\n- MCPServerConfig instance\n\n\n#### `find_config` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L323\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfind_config(cls, start_path: Path | None = None) -> Path | None\n```\n\nFind a fastmcp.json file in the specified directory.\n\n**Args:**\n- `start_path`: Directory to look in (defaults to current directory)\n\n**Returns:**\n- Path to the configuration file, or None if not found\n\n\n#### `prepare` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L342\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare(self, skip_source: bool = False, output_dir: Path | None = None) -> None\n```\n\nPrepare environment and source for execution.\n\nWhen output_dir is provided, creates a persistent uv project.\nWhen output_dir is None, does ephemeral caching (for backwards compatibility).\n\n**Args:**\n- `skip_source`: Skip source preparation if True\n- `output_dir`: Directory to create the persistent uv project in (optional)\n\n\n#### `prepare_environment` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L363\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare_environment(self, output_dir: Path | None = None) -> None\n```\n\nPrepare the Python environment.\n\n**Args:**\n- `output_dir`: If provided, creates a persistent uv project in this directory.\n       If None, just populates uv's cache for ephemeral use.\n\nDelegates to the environment's prepare() method\n\n\n#### `prepare_source` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L374\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare_source(self) -> None\n```\n\nPrepare the source for loading.\n\nDelegates to the source's prepare() method.\n\n\n#### `run_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L381\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_server(self, **kwargs: Any) -> None\n```\n\nLoad and run the server with this configuration.\n\n**Args:**\n- `**kwargs`: Additional arguments to pass to server.run_async()\n     These override config settings\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-sources-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.sources`\n\n*This module is empty or contains only private/internal implementations.*\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-sources-base.mdx", "content": "---\ntitle: base\nsidebarTitle: base\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.sources.base`\n\n## Classes\n\n### `Source` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/base.py#L7\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nAbstract base class for all source types.\n\n\n**Methods:**\n\n#### `prepare` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/base.py#L12\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nprepare(self) -> None\n```\n\nPrepare the source (download, clone, install, etc).\n\nFor sources that need preparation (e.g., git clone, download),\nthis method performs that preparation. For sources that don't\nneed preparation (e.g., local files), this is a no-op.\n\n\n#### `load_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/base.py#L22\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_server(self) -> Any\n```\n\nLoad and return the FastMCP server instance.\n\nMust be called after prepare() if the source requires preparation.\nAll information needed to load the server should be available\nas attributes on the source instance.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-mcp_server_config-v1-sources-filesystem.mdx", "content": "---\ntitle: filesystem\nsidebarTitle: filesystem\n---\n\n# `fastmcp.utilities.mcp_server_config.v1.sources.filesystem`\n\n## Classes\n\n### `FileSystemSource` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/filesystem.py#L15\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nSource for local Python files.\n\n\n**Methods:**\n\n#### `parse_path_with_object` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/filesystem.py#L28\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_path_with_object(cls, v: str) -> str\n```\n\nParse path:object syntax and extract the object name.\n\nThis validator runs before the model is created, allowing us to\nhandle the \"file.py:object\" syntax at the model boundary.\n\n\n#### `load_server` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/sources/filesystem.py#L63\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nload_server(self) -> Any\n```\n\nLoad server from filesystem.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-__init__.mdx", "content": "---\ntitle: __init__\nsidebarTitle: __init__\n---\n\n# `fastmcp.utilities.openapi`\n\n\nOpenAPI utilities for FastMCP - refactored for better maintainability.\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-director.mdx", "content": "---\ntitle: director\nsidebarTitle: director\n---\n\n# `fastmcp.utilities.openapi.director`\n\n\nRequest director using openapi-core for stateless HTTP request building.\n\n## Classes\n\n### `RequestDirector` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/director.py#L16\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBuilds httpx.Request objects from HTTPRoute and arguments using openapi-core.\n\n\n**Methods:**\n\n#### `build` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/director.py#L23\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nbuild(self, route: HTTPRoute, flat_args: dict[str, Any], base_url: str = 'http://localhost') -> httpx.Request\n```\n\nConstructs a final httpx.Request object, handling all OpenAPI serialization.\n\n**Args:**\n- `route`: HTTPRoute containing OpenAPI operation details\n- `flat_args`: Flattened arguments from LLM (may include suffixed parameters)\n- `base_url`: Base URL for the request\n\n**Returns:**\n- httpx.Request: Properly formatted HTTP request\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-formatters.mdx", "content": "---\ntitle: formatters\nsidebarTitle: formatters\n---\n\n# `fastmcp.utilities.openapi.formatters`\n\n\nParameter formatting functions for OpenAPI operations.\n\n## Functions\n\n### `format_array_parameter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L12\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_array_parameter(values: list, parameter_name: str, is_query_parameter: bool = False) -> str | list\n```\n\n\nFormat an array parameter according to OpenAPI specifications.\n\n**Args:**\n- `values`: List of values to format\n- `parameter_name`: Name of the parameter (for error messages)\n- `is_query_parameter`: If True, can return list for explode=True behavior\n\n**Returns:**\n- String (comma-separated) or list (for query params with explode=True)\n\n\n### `format_deep_object_parameter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L66\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_deep_object_parameter(param_value: dict, parameter_name: str) -> dict[str, str]\n```\n\n\nFormat a dictionary parameter for deep-object style serialization.\n\nAccording to OpenAPI 3.0 spec, deepObject style with explode=true serializes\nobject properties as separate query parameters with bracket notation.\n\nFor example, `{\"id\": \"123\", \"type\": \"user\"}` becomes\n`param[id]=123&param[type]=user`.\n\n**Args:**\n- `param_value`: Dictionary value to format\n- `parameter_name`: Name of the parameter\n\n**Returns:**\n- Dictionary with bracketed parameter names as keys\n\n\n### `generate_example_from_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ngenerate_example_from_schema(schema: JsonSchema | None) -> Any\n```\n\n\nGenerate a simple example value from a JSON schema dictionary.\nVery basic implementation focusing on types.\n\n\n### `format_json_for_description` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L183\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_json_for_description(data: Any, indent: int = 2) -> str\n```\n\n\nFormats Python data as a JSON string block for Markdown.\n\n\n### `format_simple_description` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L192\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_simple_description(base_description: str, parameters: list[ParameterInfo] | None = None, request_body: RequestBodyInfo | None = None) -> str\n```\n\n\nFormats a simple description for MCP objects (tools, resources, prompts).\nExcludes response details, examples, and verbose status codes.\n\n**Args:**\n- `base_description`: The initial description to be formatted.\n- `parameters`: A list of parameter information.\n- `request_body`: Information about the request body.\n\n**Returns:**\n- The formatted description string with minimal details.\n\n\n### `format_description_with_responses` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/formatters.py#L225\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nformat_description_with_responses(base_description: str, responses: dict[str, Any], parameters: list[ParameterInfo] | None = None, request_body: RequestBodyInfo | None = None) -> str\n```\n\n\nFormats the base description string with response, parameter, and request body information.\n\n**Args:**\n- `base_description`: The initial description to be formatted.\n- `responses`: A dictionary of response information, keyed by status code.\n- `parameters`: A list of parameter information,\nincluding path and query parameters. Each parameter includes details such as name,\nlocation, whether it is required, and a description.\n- `request_body`: Information about the request body,\nincluding its description, whether it is required, and its content schema.\n\n**Returns:**\n- The formatted description string with additional details about responses, parameters,\n- and the request body.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-json_schema_converter.mdx", "content": "---\ntitle: json_schema_converter\nsidebarTitle: json_schema_converter\n---\n\n# `fastmcp.utilities.openapi.json_schema_converter`\n\n\n\nClean OpenAPI 3.0 to JSON Schema converter for the experimental parser.\n\nThis module provides a systematic approach to converting OpenAPI 3.0 schemas\nto JSON Schema, inspired by py-openapi-schema-to-json-schema but optimized\nfor our specific use case.\n\n\n## Functions\n\n### `convert_openapi_schema_to_json_schema` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/json_schema_converter.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_openapi_schema_to_json_schema(schema: dict[str, Any], openapi_version: str | None = None, remove_read_only: bool = False, remove_write_only: bool = False, convert_one_of_to_any_of: bool = True) -> dict[str, Any]\n```\n\n\nConvert an OpenAPI schema to JSON Schema format.\n\nThis is a clean, systematic approach that:\n1. Removes OpenAPI-specific fields\n2. Converts nullable fields to type arrays (for OpenAPI 3.0 only)\n3. Converts oneOf to anyOf for overlapping union handling\n4. Recursively processes nested schemas\n5. Optionally removes readOnly/writeOnly properties\n\n**Args:**\n- `schema`: OpenAPI schema dictionary\n- `openapi_version`: OpenAPI version for optimization\n- `remove_read_only`: Whether to remove readOnly properties\n- `remove_write_only`: Whether to remove writeOnly properties\n- `convert_one_of_to_any_of`: Whether to convert oneOf to anyOf\n\n**Returns:**\n- JSON Schema-compatible dictionary\n\n\n### `convert_schema_definitions` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/json_schema_converter.py#L322\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nconvert_schema_definitions(schema_definitions: dict[str, Any] | None, openapi_version: str | None = None, **kwargs) -> dict[str, Any]\n```\n\n\nConvert a dictionary of OpenAPI schema definitions to JSON Schema.\n\n**Args:**\n- `schema_definitions`: Dictionary of schema definitions\n- `openapi_version`: OpenAPI version for optimization\n- `**kwargs`: Additional arguments passed to convert_openapi_schema_to_json_schema\n\n**Returns:**\n- Dictionary of converted schema definitions\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-models.mdx", "content": "---\ntitle: models\nsidebarTitle: models\n---\n\n# `fastmcp.utilities.openapi.models`\n\n\nIntermediate Representation (IR) models for OpenAPI operations.\n\n## Classes\n\n### `ParameterInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/models.py#L17\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents a single parameter for an HTTP operation in our IR.\n\n\n### `RequestBodyInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/models.py#L29\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents the request body for an HTTP operation in our IR.\n\n\n### `ResponseInfo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/models.py#L39\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nRepresents response information in our IR.\n\n\n### `HTTPRoute` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/models.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nIntermediate Representation for a single OpenAPI operation.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-parser.mdx", "content": "---\ntitle: parser\nsidebarTitle: parser\n---\n\n# `fastmcp.utilities.openapi.parser`\n\n\nOpenAPI parsing logic for converting OpenAPI specs to HTTPRoute objects.\n\n## Functions\n\n### `parse_openapi_to_http_routes` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/parser.py#L55\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse_openapi_to_http_routes(openapi_dict: dict[str, Any]) -> list[HTTPRoute]\n```\n\n\nParses an OpenAPI schema dictionary into a list of HTTPRoute objects\nusing the openapi-pydantic library.\n\nSupports both OpenAPI 3.0.x and 3.1.x versions.\n\n\n## Classes\n\n### `OpenAPIParser` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/parser.py#L109\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nUnified parser for OpenAPI schemas with generic type parameters to handle both 3.0 and 3.1.\n\n\n**Methods:**\n\n#### `parse` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/parser.py#L659\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nparse(self) -> list[HTTPRoute]\n```\n\nParse the OpenAPI schema into HTTP routes.\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-openapi-schemas.mdx", "content": "---\ntitle: schemas\nsidebarTitle: schemas\n---\n\n# `fastmcp.utilities.openapi.schemas`\n\n\nSchema manipulation utilities for OpenAPI operations.\n\n## Functions\n\n### `clean_schema_for_display` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/schemas.py#L12\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nclean_schema_for_display(schema: JsonSchema | None) -> JsonSchema | None\n```\n\n\nClean up a schema dictionary for display by removing internal/complex fields.\n\n\n### `extract_output_schema_from_responses` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/openapi/schemas.py#L461\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nextract_output_schema_from_responses(responses: dict[str, ResponseInfo], schema_definitions: dict[str, Any] | None = None, openapi_version: str | None = None) -> dict[str, Any] | None\n```\n\n\nExtract output schema from OpenAPI responses for use as MCP tool output schema.\n\nThis function finds the first successful response (200, 201, 202, 204) with a\nJSON-compatible content type and extracts its schema. If the schema is not an\nobject type, it wraps it to comply with MCP requirements.\n\n**Args:**\n- `responses`: Dictionary of ResponseInfo objects keyed by status code\n- `schema_definitions`: Optional schema definitions to include in the output schema\n- `openapi_version`: OpenAPI version string, used to optimize nullable field handling\n\n**Returns:**\n- MCP-compliant output schema with potential wrapping, or None if no suitable schema found\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-tests.mdx", "content": "---\ntitle: tests\nsidebarTitle: tests\n---\n\n# `fastmcp.utilities.tests`\n\n## Functions\n\n### `temporary_settings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ntemporary_settings(**kwargs: Any)\n```\n\n\nTemporarily override FastMCP setting values.\n\n**Args:**\n- `**kwargs`: The settings to override, including nested settings.\n\n\n### `run_server_in_process` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_server_in_process(server_fn: Callable[..., None], *args: Any, **kwargs: Any) -> Generator[str, None, None]\n```\n\n\nContext manager that runs a FastMCP server in a separate process and\nreturns the server URL. When the context manager is exited, the server process is killed.\n\n**Args:**\n- `server_fn`: The function that runs a FastMCP server. FastMCP servers are\nnot pickleable, so we need a function that creates and runs one.\n- `*args`: Arguments to pass to the server function.\n- `provide_host_and_port`: Whether to provide the host and port to the server function as kwargs.\n- `host`: Host to bind the server to (default\\: \"127.0.0.1\").\n- `port`: Port to bind the server to (default\\: find available port).\n- `**kwargs`: Keyword arguments to pass to the server function.\n\n**Returns:**\n- The server URL.\n\n\n### `run_server_async` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L145\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nrun_server_async(server: FastMCP, port: int | None = None, transport: Literal['http', 'streamable-http', 'sse'] = 'http', path: str = '/mcp', host: str = '127.0.0.1') -> AsyncGenerator[str, None]\n```\n\n\nStart a FastMCP server as an asyncio task for in-process async testing.\n\nThis is the recommended way to test FastMCP servers. It runs the server\nas an async task in the same process, eliminating subprocess coordination,\nsleeps, and cleanup issues.\n\n**Args:**\n- `server`: FastMCP server instance\n- `port`: Port to bind to (default\\: find available port)\n- `transport`: Transport type (\"http\", \"streamable-http\", or \"sse\")\n- `path`: URL path for the server (default\\: \"/mcp\")\n- `host`: Host to bind to (default\\: \"127.0.0.1\")\n\n\n### `caplog_for_fastmcp` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L228\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncaplog_for_fastmcp(caplog: LogCaptureFixture) -> Generator[LogCaptureFixture, None, None]\n```\n\n\nContext manager to capture logs from FastMCP loggers even when propagation is disabled.\n\n\n## Classes\n\n### `HeadlessOAuth` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L241\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nOAuth provider that bypasses browser interaction for testing.\n\nThis simulates the complete OAuth flow programmatically by making HTTP requests\ninstead of opening a browser and running a callback server. Useful for automated testing.\n\n\n**Methods:**\n\n#### `redirect_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L254\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nredirect_handler(self, authorization_url: str) -> None\n```\n\nMake HTTP request to authorization URL and store response for callback handler.\n\n\n#### `callback_handler` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L260\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncallback_handler(self) -> tuple[str, str | None]\n```\n\nParse stored response and return (auth_code, state).\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-types.mdx", "content": "---\ntitle: types\nsidebarTitle: types\n---\n\n# `fastmcp.utilities.types`\n\n\nCommon types used across FastMCP.\n\n## Functions\n\n### `get_fn_name` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L34\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_fn_name(fn: Callable[..., Any]) -> str\n```\n\n### `get_cached_typeadapter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L45\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nget_cached_typeadapter(cls: T) -> TypeAdapter[T]\n```\n\n\nTypeAdapters are heavy objects, and in an application context we'd typically\ncreate them once in a global scope and reuse them as often as possible.\nHowever, this isn't feasible for user-generated functions. Instead, we use a\ncache to minimize the cost of creating them as much as possible.\n\n\n### `issubclass_safe` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L120\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nissubclass_safe(cls: type, base: type) -> bool\n```\n\n\nCheck if cls is a subclass of base, even if cls is a type variable.\n\n\n### `is_class_member_of_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L130\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_class_member_of_type(cls: Any, base: type) -> bool\n```\n\n\nCheck if cls is a member of base, even if cls is a type variable.\n\nBase can be a type, a UnionType, or an Annotated type. Generic types are not\nconsidered members (e.g. T is not a member of list\\[T]).\n\n\n### `find_kwarg_by_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L152\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nfind_kwarg_by_type(fn: Callable, kwarg_type: type) -> str | None\n```\n\n\nFind the name of the kwarg that is of type kwarg_type.\n\nIncludes union types that contain the kwarg_type, as well as Annotated types.\n\n\n### `create_function_without_params` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L178\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_function_without_params(fn: Callable[..., Any], exclude_params: list[str]) -> Callable[..., Any]\n```\n\n\nCreate a new function with the same code but without the specified parameters in annotations.\n\nThis is used to exclude parameters from type adapter processing when they can't be serialized.\nThe excluded parameters are removed from the function's __annotations__ dictionary.\n\n\n### `replace_type` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L451\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nreplace_type(type_, type_map: dict[type, type])\n```\n\n\nGiven a (possibly generic, nested, or otherwise complex) type, replaces all\ninstances of old_type with new_type.\n\nThis is useful for transforming types when creating tools.\n\n**Args:**\n- `type_`: The type to replace instances of old_type with new_type.\n- `old_type`: The type to replace.\n- `new_type`: The type to replace old_type with.\n\nExamples:\n```python\n>>> replace_type(list[int | bool], {int: str})\nlist[str | bool]\n\n>>> replace_type(list[list[int]], {int: str})\nlist[list[str]]\n```\n\n\n## Classes\n\n### `FastMCPBaseModel` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L38\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nBase model for FastMCP models.\n\n\n### `Image` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L235\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nHelper class for returning images from tools.\n\n\n**Methods:**\n\n#### `to_image_content` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L286\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_image_content(self, mime_type: str | None = None, annotations: Annotations | None = None) -> mcp.types.ImageContent\n```\n\nConvert to MCP ImageContent.\n\n\n#### `to_data_uri` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L301\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_data_uri(self, mime_type: str | None = None) -> str\n```\n\nGet image as a data URI.\n\n\n### `Audio` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L307\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nHelper class for returning audio from tools.\n\n\n**Methods:**\n\n#### `to_audio_content` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L344\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_audio_content(self, mime_type: str | None = None, annotations: Annotations | None = None) -> mcp.types.AudioContent\n```\n\n### `File` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L365\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nHelper class for returning file data from tools.\n\n\n**Methods:**\n\n#### `to_resource_content` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L404\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nto_resource_content(self, mime_type: str | None = None, annotations: Annotations | None = None) -> mcp.types.EmbeddedResource\n```\n\n### `ContextSamplingFallbackProtocol` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/types.py#L488\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-ui.mdx", "content": "---\ntitle: ui\nsidebarTitle: ui\n---\n\n# `fastmcp.utilities.ui`\n\n\n\nShared UI utilities for FastMCP HTML pages.\n\nThis module provides reusable HTML/CSS components for OAuth callbacks,\nconsent pages, and other user-facing interfaces.\n\n\n## Functions\n\n### `create_page` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L453\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_page(content: str, title: str = 'FastMCP', additional_styles: str = '', csp_policy: str = \"default-src 'none'; style-src 'unsafe-inline'; img-src https: data:; base-uri 'none'\") -> str\n```\n\n\nCreate a complete HTML page with FastMCP styling.\n\n**Args:**\n- `content`: HTML content to place inside the page\n- `title`: Page title\n- `additional_styles`: Extra CSS to include\n- `csp_policy`: Content Security Policy header value.\nIf empty string \"\", the CSP meta tag is omitted entirely.\n\n**Returns:**\n- Complete HTML page as string\n\n\n### `create_logo` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L501\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_logo(icon_url: str | None = None, alt_text: str = 'FastMCP') -> str\n```\n\n\nCreate logo HTML.\n\n**Args:**\n- `icon_url`: Optional custom icon URL. If not provided, uses the FastMCP logo.\n- `alt_text`: Alt text for the logo image.\n\n**Returns:**\n- HTML for logo image tag.\n\n\n### `create_status_message` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L516\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_status_message(message: str, is_success: bool = True) -> str\n```\n\n\nCreate a status message with icon.\n\n**Args:**\n- `message`: Status message text\n- `is_success`: True for success (\u2713), False for error (\u2715)\n\n**Returns:**\n- HTML for status message\n\n\n### `create_info_box` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L539\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_info_box(content: str, is_error: bool = False, centered: bool = False, monospace: bool = False) -> str\n```\n\n\nCreate an info box.\n\n**Args:**\n- `content`: HTML content for the info box\n- `is_error`: True for error styling, False for normal\n- `centered`: True to center the text, False for left-aligned\n- `monospace`: True to use gray monospace font styling instead of blue\n\n**Returns:**\n- HTML for info box\n\n\n### `create_detail_box` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L568\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_detail_box(rows: list[tuple[str, str]]) -> str\n```\n\n\nCreate a detail box with key-value pairs.\n\n**Args:**\n- `rows`: List of (label, value) tuples\n\n**Returns:**\n- HTML for detail box\n\n\n### `create_button_group` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L591\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_button_group(buttons: list[tuple[str, str, str]]) -> str\n```\n\n\nCreate a group of buttons.\n\n**Args:**\n- `buttons`: List of (text, value, css_class) tuples\n\n**Returns:**\n- HTML for button group\n\n\n### `create_secure_html_response` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/ui.py#L609\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ncreate_secure_html_response(html: str, status_code: int = 200) -> HTMLResponse\n```\n\n\nCreate an HTMLResponse with security headers.\n\nAdds X-Frame-Options: DENY to prevent clickjacking attacks per MCP security best practices.\n\n**Args:**\n- `html`: HTML content to return\n- `status_code`: HTTP status code\n\n**Returns:**\n- HTMLResponse with security headers\n\n"}, {"filename": "docs/python-sdk/fastmcp-utilities-visibility.mdx", "content": "---\ntitle: visibility\nsidebarTitle: visibility\n---\n\n# `fastmcp.utilities.visibility`\n\n\nVisibility filtering for FastMCP components.\n\nThis module provides the VisibilityFilter class which handles blocklist and\nallowlist logic for controlling component visibility at both the provider\nand server levels.\n\n\n## Classes\n\n### `VisibilityFilter` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/visibility.py#L26\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n\nManages component visibility with blocklist and allowlist support.\n\nBoth servers and providers use this class to control which components\nare visible. Visibility is hierarchical: if a component is hidden at\nany level (provider or server), it's hidden to the client.\n\nFiltering logic (blocklist wins over allowlist):\n1. If component key is in _disabled_keys \u2192 HIDDEN\n2. If any component tag is in _disabled_tags \u2192 HIDDEN\n3. If _default_enabled is False and component not in allowlist \u2192 HIDDEN\n4. Otherwise \u2192 VISIBLE\n\nThe `only=True` flag on enable() switches to allowlist mode:\n- Sets _default_enabled = False\n- Clears existing allowlists\n- Adds specified keys/tags to allowlist\n\n\n**Methods:**\n\n#### `disable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/visibility.py#L77\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\ndisable(self) -> None\n```\n\nAdd to blocklist (hide components).\n\n**Args:**\n- `keys`: Component keys to hide (e.g., \"tool\\:my_tool\", \"resource\\:file\\://x\")\n- `tags`: Tags to hide - any component with these tags will be hidden\n\n\n#### `enable` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/visibility.py#L105\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nenable(self) -> None\n```\n\nRemove from blocklist, or set allowlist with only=True.\n\n**Args:**\n- `keys`: Component keys to show\n- `tags`: Tags to show\n- `only`: If True, switches to allowlist mode - ONLY show these keys/tags.\nThis sets default visibility to False, clears existing allowlists,\nand adds the specified keys/tags to the allowlist.\n\n\n#### `reset` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/visibility.py#L159\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nreset(self) -> None\n```\n\nReset to default state (everything enabled, no filters).\n\n\n#### `is_enabled` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/visibility.py#L178\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python\nis_enabled(self, component: FastMCPComponent) -> bool\n```\n\nCheck if component is enabled. Blocklist wins over allowlist.\n\n"}, {"filename": "docs/servers/auth/authentication.mdx", "content": "---\ntitle: Authentication\nsidebarTitle: Overview\ndescription: Secure your FastMCP server with flexible authentication patterns, from simple API keys to full OAuth 2.1 integration with external identity providers.\nicon: user-shield\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.11.0\" />\n\nAuthentication in MCP presents unique challenges that differ from traditional web applications. MCP clients need to discover authentication requirements automatically, negotiate OAuth flows without user intervention, and work seamlessly across different identity providers. FastMCP addresses these challenges by providing authentication patterns that integrate with the MCP protocol while remaining simple to implement and deploy.\n\n<Tip>\nAuthentication applies only to FastMCP's HTTP-based transports (`http` and `sse`). The STDIO transport inherits security from its local execution environment.\n</Tip>\n\n<Warning>\n**Authentication is rapidly evolving in MCP.** The specification and best practices are changing quickly. FastMCP aims to provide stable, secure patterns that adapt to these changes while keeping your code simple and maintainable.\n</Warning>\n\n## MCP Authentication Challenges\n\nTraditional web authentication assumes a human user with a browser who can interact with login forms and consent screens. MCP clients are often automated systems that need to authenticate without human intervention. This creates several unique requirements:\n\n**Automatic Discovery**: MCP clients must discover authentication requirements by examining server metadata rather than encountering login redirects.\n\n**Programmatic OAuth**: OAuth flows must work without human interaction, relying on pre-configured credentials or Dynamic Client Registration.\n\n**Token Management**: Clients need to obtain, refresh, and manage tokens automatically across multiple MCP servers.\n\n**Protocol Integration**: Authentication must integrate cleanly with MCP's transport mechanisms and error handling.\n\nThese challenges mean that not all authentication approaches work well with MCP. The patterns that do work fall into three categories based on the level of authentication responsibility your server assumes.\n\n## Authentication Responsibility\n\nAuthentication responsibility exists on a spectrum. Your MCP server can validate tokens created elsewhere, coordinate with external identity providers, or handle the complete authentication lifecycle internally. Each approach involves different trade-offs between simplicity, security, and control.\n\n### Token Validation\n\nYour server validates tokens but delegates their creation to external systems. This approach treats your MCP server as a pure resource server that trusts tokens signed by known issuers.\n\nToken validation works well when you already have authentication infrastructure that can issue structured tokens like JWTs. Your existing API gateway, microservices platform, or enterprise SSO system becomes the source of truth for user identity, while your MCP server focuses on its core functionality.\n\nThe key insight is that token validation separates authentication (proving who you are) from authorization (determining what you can do). Your MCP server receives proof of identity in the form of a signed token and makes access decisions based on the claims within that token.\n\nThis pattern excels in microservices architectures where multiple services need to validate the same tokens, or when integrating MCP servers into existing systems that already handle user authentication.\n\n### External Identity Providers\n\nYour server coordinates with established identity providers to create seamless authentication experiences for MCP clients. This approach leverages OAuth 2.0 and OpenID Connect protocols to delegate user authentication while maintaining control over authorization decisions.\n\nExternal identity providers handle the complex aspects of authentication: user credential verification, multi-factor authentication, account recovery, and security monitoring. Your MCP server receives tokens from these trusted providers and validates them using the provider's public keys.\n\nThe MCP protocol's support for Dynamic Client Registration makes this pattern particularly powerful. MCP clients can automatically discover your authentication requirements and register themselves with your identity provider without manual configuration.\n\nThis approach works best for production applications that need enterprise-grade authentication features without the complexity of building them from scratch. It scales well across multiple applications and provides consistent user experiences.\n\n### Full OAuth Implementation\n\nYour server implements a complete OAuth 2.0 authorization server, handling everything from user credential verification to token lifecycle management. This approach provides maximum control at the cost of significant complexity.\n\nFull OAuth implementation means building user interfaces for login and consent, implementing secure credential storage, managing token lifecycles, and maintaining ongoing security updates. The complexity extends beyond initial implementation to include threat monitoring, compliance requirements, and keeping pace with evolving security best practices.\n\nThis pattern makes sense only when you need complete control over the authentication process, operate in air-gapped environments, or have specialized requirements that external providers cannot meet.\n\n## FastMCP Authentication Providers\n\nFastMCP translates these authentication responsibility levels into a variety of concrete classes that handle the complexities of MCP protocol integration. You can build on these classes to handle the complexities of MCP protocol integration.\n\n### TokenVerifier\n\n`TokenVerifier` provides pure token validation without OAuth metadata endpoints. This class focuses on the essential task of determining whether a token is valid and extracting authorization information from its claims.\n\nThe implementation handles JWT signature verification, expiration checking, and claim extraction. It validates tokens against known issuers and audiences, ensuring that tokens intended for your server are not accepted by other systems.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n\nauth = JWTVerifier(\n    jwks_uri=\"https://your-auth-system.com/.well-known/jwks.json\",\n    issuer=\"https://your-auth-system.com\", \n    audience=\"your-mcp-server\"\n)\n\nmcp = FastMCP(name=\"Protected Server\", auth=auth)\n```\n\nThis example configures token validation against a JWT issuer. The `JWTVerifier` will fetch public keys from the JWKS endpoint and validate incoming tokens against those keys. Only tokens with the correct issuer and audience claims will be accepted.\n\n`TokenVerifier` works well when you control both the token issuer and your MCP server, or when integrating with existing JWT-based infrastructure.\n\n\u2192 **Complete guide**: [Token Verification](/servers/auth/token-verification)\n\n### RemoteAuthProvider\n\n`RemoteAuthProvider` enables authentication with identity providers that **support Dynamic Client Registration (DCR)**, such as Descope and WorkOS AuthKit. With DCR, MCP clients can automatically register themselves with the identity provider and obtain credentials without any manual configuration.\n\nThis class combines token validation with OAuth discovery metadata. It extends `TokenVerifier` functionality by adding OAuth 2.0 protected resource endpoints that advertise your authentication requirements. MCP clients examine these endpoints to understand which identity providers you trust and how to obtain valid tokens.\n\nThe key requirement is that your identity provider must support DCR - the ability for clients to dynamically register and obtain credentials. This is what enables the seamless, automated authentication flow that MCP requires.\n\nFor example, the built-in `AuthKitProvider` uses WorkOS AuthKit, which fully supports DCR:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import AuthKitProvider\n\nauth = AuthKitProvider(\n    authkit_domain=\"https://your-project.authkit.app\",\n    base_url=\"https://your-fastmcp-server.com\"\n)\n\nmcp = FastMCP(name=\"Enterprise Server\", auth=auth)\n```\n\nThis example uses WorkOS AuthKit as the external identity provider. The `AuthKitProvider` automatically configures token validation against WorkOS and provides the OAuth metadata that MCP clients need for automatic authentication.\n\n`RemoteAuthProvider` is ideal for production applications when your identity provider supports Dynamic Client Registration (DCR). This enables fully automated authentication without manual client configuration.\n\n\u2192 **Complete guide**: [Remote OAuth](/servers/auth/remote-oauth)\n\n### OAuthProxy\n\n<VersionBadge version=\"2.12.0\" />\n\n`OAuthProxy` enables authentication with OAuth providers that **don't support Dynamic Client Registration (DCR)**, such as GitHub, Google, Azure, AWS, and most traditional enterprise identity systems.\n\nWhen identity providers require manual app registration and fixed credentials, `OAuthProxy` bridges the gap. It presents a DCR-compliant interface to MCP clients (accepting any registration request) while using your pre-registered credentials with the upstream provider. The proxy handles the complexity of callback forwarding, enabling dynamic client callbacks to work with providers that require fixed redirect URIs.\n\nThis class solves the fundamental incompatibility between MCP's expectation of dynamic registration and traditional OAuth providers' requirement for manual app registration.\n\nFor example, the built-in `GitHubProvider` extends `OAuthProxy` to work with GitHub's OAuth system:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.github import GitHubProvider\n\nauth = GitHubProvider(\n    client_id=\"Ov23li...\",  # Your GitHub OAuth App ID\n    client_secret=\"abc123...\",  # Your GitHub OAuth App Secret\n    base_url=\"https://your-server.com\"\n)\n\nmcp = FastMCP(name=\"GitHub-Protected Server\", auth=auth)\n```\n\nThis example uses the GitHub provider, which extends `OAuthProxy` with GitHub-specific token validation. The proxy handles the complete OAuth flow while making GitHub's non-DCR authentication work seamlessly with MCP clients.\n\n`OAuthProxy` is essential when integrating with OAuth providers that don't support DCR. This includes most established providers like GitHub, Google, and Azure, which require manual app registration through their developer consoles.\n\n\u2192 **Complete guide**: [OAuth Proxy](/servers/auth/oauth-proxy)\n\n### OAuthProvider\n\n`OAuthProvider` implements a complete OAuth 2.0 authorization server within your MCP server. This class handles the full authentication lifecycle from user credential verification to token management.\n\nThe implementation provides all required OAuth endpoints including authorization, token, and discovery endpoints. It manages client registration, user consent, and token lifecycle while integrating with your user storage and authentication logic.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.oauth import MyOAuthProvider\n\nauth = MyOAuthProvider(\n    user_store=your_user_database,\n    client_store=your_client_registry,\n    # Additional configuration...\n)\n\nmcp = FastMCP(name=\"Auth Server\", auth=auth)\n```\n\nThis example shows the basic structure of a custom OAuth provider. The actual implementation requires significant additional configuration for user management, client registration, and security policies.\n\n`OAuthProvider` should be used only when you have specific requirements that external providers cannot meet and the expertise to implement OAuth securely.\n\n\u2192 **Complete guide**: [Full OAuth Server](/servers/auth/full-oauth-server)\n\n## Configuration Approaches\n\nFastMCP supports both programmatic configuration for maximum flexibility and environment-based configuration for deployment simplicity.\n\n### Programmatic Configuration\n\nProgrammatic configuration provides complete control over authentication settings and allows for complex initialization logic. This approach works well during development and when you need to customize authentication behavior based on runtime conditions.\n\nAuthentication providers are instantiated directly in your code with their required parameters. This makes dependencies explicit and allows your IDE to provide helpful autocompletion and type checking.\n\n### Environment Configuration\n\n<VersionBadge version=\"2.12.1\" />\n\nEnvironment-based configuration separates authentication settings from application code, enabling the same codebase to work across different deployment environments without modification.\n\nFastMCP automatically detects authentication configuration from environment variables when no explicit `auth` parameter is provided. The configuration system supports all authentication providers and their various options.\n\n#### Provider Configuration\n\nAuthentication providers are configured by specifying the full module path to the provider class:\n\n<ParamField path=\"FASTMCP_SERVER_AUTH\" type=\"string\">\nThe full module path to the authentication provider class. Examples:\n- `fastmcp.server.auth.providers.github.GitHubProvider` - GitHub OAuth\n- `fastmcp.server.auth.providers.google.GoogleProvider` - Google OAuth\n- `fastmcp.server.auth.providers.jwt.JWTVerifier` - JWT token verification\n- `fastmcp.server.auth.providers.workos.WorkOSProvider` - WorkOS OAuth\n- `fastmcp.server.auth.providers.workos.AuthKitProvider` - WorkOS AuthKit\n- `mycompany.auth.CustomProvider` - Your custom provider class\n</ParamField>\n\nWhen using providers like GitHub or Google, you'll need to set provider-specific environment variables:\n\n```bash\n# GitHub OAuth\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.github.GitHubProvider\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=\"Ov23li...\"\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=\"github_pat_...\"\n\n# Google OAuth\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.google.GoogleProvider\nexport FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=\"123456.apps.googleusercontent.com\"\nexport FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=\"GOCSPX-...\"\n```\n\n#### Provider-Specific Configuration\n\nEach provider has its own configuration options set through environment variables:\n\n```bash\n# JWT Token Verification\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.jwt.JWTVerifier\nexport FASTMCP_SERVER_AUTH_JWT_JWKS_URI=\"https://auth.example.com/jwks\"\nexport FASTMCP_SERVER_AUTH_JWT_ISSUER=\"https://auth.example.com\"\nexport FASTMCP_SERVER_AUTH_JWT_AUDIENCE=\"mcp-server\"\n\n# Custom Provider\nexport FASTMCP_SERVER_AUTH=mycompany.auth.CustomProvider\n# Plus any environment variables your custom provider expects\n```\n\nWith these environment variables set, creating an authenticated FastMCP server requires no additional configuration:\n\n```python\nfrom fastmcp import FastMCP\n\n# Authentication automatically configured from environment\nmcp = FastMCP(name=\"My Server\")\n```\n\nThis approach simplifies deployment pipelines and follows twelve-factor app principles for configuration management.\n\n## Choosing Your Implementation\n\nThe authentication approach you choose depends on your existing infrastructure, security requirements, and operational constraints.\n\n**For OAuth providers without DCR support (GitHub, Google, Azure, AWS, most enterprise systems), use OAuth Proxy.** These providers require manual app registration through their developer consoles. OAuth Proxy bridges the gap by presenting a DCR-compliant interface to MCP clients while using your fixed credentials with the provider. The proxy's callback forwarding pattern enables dynamic client ports to work with providers that require fixed redirect URIs.\n\n**For identity providers with DCR support (Descope, WorkOS AuthKit, modern auth platforms), use RemoteAuthProvider.** These providers allow clients to dynamically register and obtain credentials without manual configuration. This enables the fully automated authentication flow that MCP is designed for, providing the best user experience and simplest implementation.\n\n**Token validation works well when you already have authentication infrastructure that issues structured tokens.** If your organization already uses JWT-based systems, API gateways, or enterprise SSO that can generate tokens, this approach integrates seamlessly while keeping your MCP server focused on its core functionality. The simplicity comes from leveraging existing investment in authentication infrastructure.\n\n**Full OAuth implementation should be avoided unless you have compelling reasons that external providers cannot address.** Air-gapped environments, specialized compliance requirements, or unique organizational constraints might justify this approach, but it requires significant security expertise and ongoing maintenance commitment. The complexity extends far beyond initial implementation to include threat monitoring, security updates, and keeping pace with evolving attack vectors.\n\nFastMCP's architecture supports migration between these approaches as your requirements evolve. You can integrate with existing token systems initially and migrate to external identity providers as your application scales, or implement custom solutions when your requirements outgrow standard patterns."}, {"filename": "docs/servers/auth/full-oauth-server.mdx", "content": "---\ntitle: Full OAuth Server\nsidebarTitle: Full OAuth Server\ndescription: Build a self-contained authentication system where your FastMCP server manages users, issues tokens, and validates them.\nicon: users-between-lines\n\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.11.0\" />\n\n<Warning>\n**This is an extremely advanced pattern that most users should avoid.** Building a secure OAuth 2.1 server requires deep expertise in authentication protocols, cryptography, and security best practices. The complexity extends far beyond initial implementation to include ongoing security monitoring, threat response, and compliance maintenance.\n\n**Use [Remote OAuth](/servers/auth/remote-oauth) instead** unless you have compelling requirements that external identity providers cannot meet, such as air-gapped environments or specialized compliance needs.\n</Warning>\n\nThe Full OAuth Server pattern exists to support the MCP protocol specification's requirements. Your FastMCP server becomes both an Authorization Server and Resource Server, handling the complete authentication lifecycle from user login to token validation.\n\nThis documentation exists for completeness - the vast majority of applications should use external identity providers instead.\n\n## OAuthProvider\n\nFastMCP provides the `OAuthProvider` abstract class that implements the OAuth 2.1 specification. To use this pattern, you must subclass `OAuthProvider` and implement all required abstract methods.\n\n<Note>\n`OAuthProvider` handles OAuth endpoints, protocol flows, and security requirements, but delegates all storage, user management, and business logic to your implementation of the abstract methods.\n</Note>\n\n## Required Implementation\n\nYou must implement these abstract methods to create a functioning OAuth server:\n\n### Client Management\n\n<Card icon=\"code\" title=\"Client Management Methods\">\n<ParamField body=\"get_client\" type=\"async method\">\n  Retrieve client information by ID from your database.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client_id\" type=\"str\">\n      Client identifier to look up\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"OAuthClientInformationFull | None\" type=\"return type\">\n      Client information object or `None` if client not found\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"register_client\" type=\"async method\">\n  Store new client registration information in your database.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client_info\" type=\"OAuthClientInformationFull\">\n      Complete client registration information to store\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"None\" type=\"return type\">\n      No return value\n    </ParamField>\n  </Expandable>\n</ParamField>\n</Card>\n\n### Authorization Flow\n\n<Card icon=\"code\" title=\"Authorization Flow Methods\">\n<ParamField body=\"authorize\" type=\"async method\">\n  Handle authorization request and return redirect URL. Must implement user authentication and consent collection.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client\" type=\"OAuthClientInformationFull\">\n      OAuth client making the authorization request\n    </ParamField>\n    <ParamField body=\"params\" type=\"AuthorizationParams\">\n      Authorization request parameters from the client\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"str\" type=\"return type\">\n      Redirect URL to send the client to\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"load_authorization_code\" type=\"async method\">\n  Load authorization code from storage by code string. Return `None` if code is invalid or expired.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client\" type=\"OAuthClientInformationFull\">\n      OAuth client attempting to use the authorization code\n    </ParamField>\n    <ParamField body=\"authorization_code\" type=\"str\">\n      Authorization code string to look up\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"AuthorizationCode | None\" type=\"return type\">\n      Authorization code object or `None` if not found\n    </ParamField>\n  </Expandable>\n</ParamField>\n</Card>\n\n### Token Management\n\n<Card icon=\"code\" title=\"Token Management Methods\">\n<ParamField body=\"exchange_authorization_code\" type=\"async method\">\n  Exchange authorization code for access and refresh tokens. Must validate code and create new tokens.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client\" type=\"OAuthClientInformationFull\">\n      OAuth client exchanging the authorization code\n    </ParamField>\n    <ParamField body=\"authorization_code\" type=\"AuthorizationCode\">\n      Valid authorization code object to exchange\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"OAuthToken\" type=\"return type\">\n      New OAuth token containing access and refresh tokens\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"load_refresh_token\" type=\"async method\">\n  Load refresh token from storage by token string. Return `None` if token is invalid or expired.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client\" type=\"OAuthClientInformationFull\">\n      OAuth client attempting to use the refresh token\n    </ParamField>\n    <ParamField body=\"refresh_token\" type=\"str\">\n      Refresh token string to look up\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"RefreshToken | None\" type=\"return type\">\n      Refresh token object or `None` if not found\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"exchange_refresh_token\" type=\"async method\">\n  Exchange refresh token for new access/refresh token pair. Must validate scopes and token.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"client\" type=\"OAuthClientInformationFull\">\n      OAuth client using the refresh token\n    </ParamField>\n    <ParamField body=\"refresh_token\" type=\"RefreshToken\">\n      Valid refresh token object to exchange\n    </ParamField>\n    <ParamField body=\"scopes\" type=\"list[str]\">\n      Requested scopes for the new access token\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"OAuthToken\" type=\"return type\">\n      New OAuth token with updated access and refresh tokens\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"load_access_token\" type=\"async method\">\n  Load an access token by its token string.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"token\" type=\"str\">\n      The access token to verify\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"AccessToken | None\" type=\"return type\">\n      The access token object, or `None` if the token is invalid\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"revoke_token\" type=\"async method\">\n  Revoke access or refresh token, marking it as invalid in storage.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"token\" type=\"AccessToken | RefreshToken\">\n      Token object to revoke and mark invalid\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"None\" type=\"return type\">\n      No return value\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"verify_token\" type=\"async method\">\n  Verify bearer token for incoming requests. Return `AccessToken` if valid, `None` if invalid.\n  \n  <Expandable title=\"Parameters\">\n    <ParamField body=\"token\" type=\"str\">\n      Bearer token string from incoming request\n    </ParamField>\n  </Expandable>\n  \n  <Expandable title=\"Returns\">\n    <ParamField body=\"AccessToken | None\" type=\"return type\">\n      Access token object if valid, `None` if invalid or expired\n    </ParamField>\n  </Expandable>\n</ParamField>\n</Card>\n\nEach method must handle storage, validation, security, and error cases according to the OAuth 2.1 specification. The implementation complexity is substantial and requires expertise in OAuth security considerations.\n\n<Warning>\n**Security Notice:** OAuth server implementation involves numerous security considerations including PKCE, state parameters, redirect URI validation, token binding, replay attack prevention, and secure storage requirements. Mistakes can lead to serious security vulnerabilities.\n</Warning>"}, {"filename": "docs/servers/auth/oauth-proxy.mdx", "content": "---\ntitle: OAuth Proxy\nsidebarTitle: OAuth Proxy\ndescription: Bridge traditional OAuth providers to work seamlessly with MCP's authentication flow.\nicon: share\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.12.0\" />\n\nThe OAuth proxy enables FastMCP servers to authenticate with OAuth providers that **don't support Dynamic Client Registration (DCR)**. This includes virtually all traditional OAuth providers: GitHub, Google, Azure, AWS, Discord, Facebook, and most enterprise identity systems. For providers that do support DCR (like Descope and WorkOS AuthKit), use [`RemoteAuthProvider`](/servers/auth/remote-oauth) instead.\n\nMCP clients expect to register automatically and obtain credentials on the fly, but traditional providers require manual app registration through their developer consoles. The OAuth proxy bridges this gap by presenting a DCR-compliant interface to MCP clients while using your pre-registered credentials with the upstream provider. When a client attempts to register, the proxy returns your fixed credentials. When a client initiates authorization, the proxy handles the complexity of callback forwarding\u2014storing the client's dynamic callback URL, using its own fixed callback with the provider, then forwarding back to the client after token exchange.\n\nThis approach enables any MCP client (whether using random localhost ports or fixed URLs like Claude.ai) to authenticate with any traditional OAuth provider, all while maintaining full OAuth 2.1 and PKCE security.\n\n<Note>\n  For providers that support OIDC discovery (Auth0, Google with OIDC\n  configuration, Azure AD), consider using [`OIDC\n  Proxy`](/servers/auth/oidc-proxy) for automatic configuration. OIDC Proxy\n  extends the OAuth proxy to automatically discover endpoints from the provider's\n  `/.well-known/openid-configuration` URL, simplifying setup.\n</Note>\n\n## Implementation\n\n### Provider Setup Requirements\n\nBefore using the OAuth proxy, you need to register your application with your OAuth provider:\n\n1. **Register your application** in the provider's developer console (GitHub Settings, Google Cloud Console, Azure Portal, etc.)\n2. **Configure the redirect URI** as your FastMCP server URL plus your chosen callback path:\n   - Default: `https://your-server.com/auth/callback`\n   - Custom: `https://your-server.com/your/custom/path` (if you set `redirect_path`)\n   - Development: `http://localhost:8000/auth/callback`\n3. **Obtain your credentials**: Client ID and Client Secret\n4. **Note the OAuth endpoints**: Authorization URL and Token URL (usually found in the provider's OAuth documentation)\n\n<Warning>\n  The redirect URI you configure with your provider must exactly match your\n  FastMCP server's URL plus the callback path. If you customize `redirect_path`\n  in the OAuth proxy, update your provider's redirect URI accordingly.\n</Warning>\n\n### Basic Setup\n\nHere's how to implement the OAuth proxy with any provider:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import OAuthProxy\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n\n# Configure token verification for your provider\n# See the Token Verification guide for provider-specific setups\ntoken_verifier = JWTVerifier(\n    jwks_uri=\"https://your-provider.com/.well-known/jwks.json\",\n    issuer=\"https://your-provider.com\",\n    audience=\"your-app-id\"\n)\n\n# Create the OAuth proxy\nauth = OAuthProxy(\n    # Provider's OAuth endpoints (from their documentation)\n    upstream_authorization_endpoint=\"https://provider.com/oauth/authorize\",\n    upstream_token_endpoint=\"https://provider.com/oauth/token\",\n\n    # Your registered app credentials\n    upstream_client_id=\"your-client-id\",\n    upstream_client_secret=\"your-client-secret\",\n\n    # Token validation (see Token Verification guide)\n    token_verifier=token_verifier,\n\n    # Your FastMCP server's public URL\n    base_url=\"https://your-server.com\",\n\n    # Optional: customize the callback path (default is \"/auth/callback\")\n    # redirect_path=\"/custom/callback\",\n)\n\nmcp = FastMCP(name=\"My Server\", auth=auth)\n```\n\n### Configuration Parameters\n\n<Card icon=\"code\" title=\"OAuthProxy Parameters\">\n<ParamField body=\"upstream_authorization_endpoint\" type=\"str\" required>\n  URL of your OAuth provider's authorization endpoint (e.g., `https://github.com/login/oauth/authorize`)\n</ParamField>\n\n<ParamField body=\"upstream_token_endpoint\" type=\"str\" required>\n  URL of your OAuth provider's token endpoint (e.g.,\n  `https://github.com/login/oauth/access_token`)\n</ParamField>\n\n<ParamField body=\"upstream_client_id\" type=\"str\" required>\n  Client ID from your registered OAuth application\n</ParamField>\n\n<ParamField body=\"upstream_client_secret\" type=\"str\" required>\n  Client secret from your registered OAuth application\n</ParamField>\n\n<ParamField body=\"token_verifier\" type=\"TokenVerifier\" required>\n  A [`TokenVerifier`](/servers/auth/token-verification) instance to validate the\n  provider's tokens\n</ParamField>\n\n<ParamField body=\"base_url\" type=\"AnyHttpUrl | str\" required>\n  Public URL where OAuth endpoints will be accessible, **including any mount path** (e.g., `https://your-server.com/api`).\n\n  This URL is used to construct OAuth callback URLs and operational endpoints. When mounting under a path prefix, include that prefix in `base_url`. Use `issuer_url` separately to specify where auth server metadata is located (typically at root level).\n</ParamField>\n\n<ParamField body=\"redirect_path\" type=\"str\" default=\"/auth/callback\">\n  Path for OAuth callbacks. Must match the redirect URI configured in your OAuth\n  application\n</ParamField>\n\n<ParamField body=\"upstream_revocation_endpoint\" type=\"str | None\">\n  Optional URL of provider's token revocation endpoint\n</ParamField>\n\n<ParamField body=\"issuer_url\" type=\"AnyHttpUrl | str | None\">\n  Issuer URL for OAuth authorization server metadata (defaults to `base_url`).\n\n  When `issuer_url` has a path component (either explicitly or by defaulting from `base_url`), FastMCP creates path-aware discovery routes per RFC 8414. For example, if `base_url` is `http://localhost:8000/api`, the authorization server metadata will be at `/.well-known/oauth-authorization-server/api`.\n\n  **Default behavior (recommended for most cases):**\n  ```python\n  auth = GitHubProvider(\n      base_url=\"http://localhost:8000/api\",  # OAuth endpoints under /api\n      # issuer_url defaults to base_url - path-aware discovery works automatically\n  )\n  ```\n\n  **When to set explicitly:**\n  Set `issuer_url` to root level only if you want multiple MCP servers to share a single discovery endpoint:\n  ```python\n  auth = GitHubProvider(\n      base_url=\"http://localhost:8000/api\",\n      issuer_url=\"http://localhost:8000\"  # Shared root-level discovery\n  )\n  ```\n\n  See the [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for complete mounting examples.\n</ParamField>\n\n<ParamField body=\"service_documentation_url\" type=\"AnyHttpUrl | str | None\">\n  Optional URL to your service documentation\n</ParamField>\n\n<ParamField body=\"forward_pkce\" type=\"bool\" default=\"True\">\n  Whether to forward PKCE (Proof Key for Code Exchange) to the upstream OAuth\n  provider. When enabled and the client uses PKCE, the proxy generates its own\n  PKCE parameters to send upstream while separately validating the client's\n  PKCE. This ensures end-to-end PKCE security at both layers (client-to-proxy\n  and proxy-to-upstream). - `True` (default): Forward PKCE for providers that\n  support it (Google, Azure, AWS, GitHub, etc.) - `False`: Disable only if upstream\n  provider doesn't support PKCE\n</ParamField>\n\n<ParamField body=\"token_endpoint_auth_method\" type=\"str | None\">\n  Token endpoint authentication method for the upstream OAuth server. Controls\n  how the proxy authenticates when exchanging authorization codes and refresh\n  tokens with the upstream provider. - `\"client_secret_basic\"`: Send credentials\n  in Authorization header (most common) - `\"client_secret_post\"`: Send\n  credentials in request body (required by some providers) - `\"none\"`: No\n  authentication (for public clients) - `None` (default): Uses authlib's default\n  (typically `\"client_secret_basic\"`) Set this if your provider requires a\n  specific authentication method and the default doesn't work.\n</ParamField>\n\n<ParamField body=\"allowed_client_redirect_uris\" type=\"list[str] | None\">\n  List of allowed redirect URI patterns for MCP clients. Patterns support\n  wildcards (e.g., `\"http://localhost:*\"`, `\"https://*.example.com/*\"`). -\n  `None` (default): All redirect URIs allowed (for MCP/DCR compatibility) -\n  Empty list `[]`: No redirect URIs allowed - Custom list: Only matching\n  patterns allowed These patterns apply to MCP client loopback redirects, NOT\n  the upstream OAuth app redirect URI.\n</ParamField>\n\n<ParamField body=\"valid_scopes\" type=\"list[str] | None\">\n  List of all possible valid scopes for the OAuth provider. These are advertised\n  to clients through the `/.well-known` endpoints. Defaults to `required_scopes`\n  from your TokenVerifier if not specified.\n</ParamField>\n\n<ParamField body=\"extra_authorize_params\" type=\"dict[str, str] | None\">\n  Additional parameters to forward to the upstream authorization endpoint. Useful for provider-specific parameters that aren't part of the standard OAuth2 flow.\n  \n  For example, Auth0 requires an `audience` parameter to issue JWT tokens:\n  ```python\n  extra_authorize_params={\"audience\": \"https://api.example.com\"}\n  ```\n  \n  These parameters are added to every authorization request sent to the upstream provider.\n</ParamField>\n\n<ParamField body=\"extra_token_params\" type=\"dict[str, str] | None\">\n  Additional parameters to forward to the upstream token endpoint during code exchange and token refresh. Useful for provider-specific requirements during token operations.\n\nFor example, some providers require additional context during token exchange:\n\n```python\nextra_token_params={\"audience\": \"https://api.example.com\"}\n```\n\nThese parameters are included in all token requests to the upstream provider.\n\n</ParamField>\n\n<ParamField body=\"client_storage\" type=\"AsyncKeyValue | None\">\n\n<VersionBadge version=\"2.13.0\" />\n  Storage backend for persisting OAuth client registrations and upstream tokens.\n\n  **Default behavior:**\n  By default, clients are automatically persisted to an encrypted disk store, allowing them to survive server restarts as long as the filesystem remains accessible. This means MCP clients only need to register once and can reconnect seamlessly. The disk store is encrypted using a key derived from the JWT Signing Key (which is derived from the upstream client secret by default). For client registrations to survive upstream client secret rotation, you should provide a JWT Signing Key or your own client_storage.\n\nFor production deployments with multiple servers or cloud deployments, see [Storage Backends](/servers/storage-backends) for available options.\n\n<Warning>\n  **When providing custom storage**, wrap it in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest:\n\n  ```python\n  from key_value.aio.stores.redis import RedisStore\n  from key_value.aio.wrappers.encryption import FernetEncryptionWrapper\n  from cryptography.fernet import Fernet\n  import os\n\n  auth = OAuthProxy(\n      ...,\n      jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n      client_storage=FernetEncryptionWrapper(\n          key_value=RedisStore(host=\"redis.example.com\", port=6379),\n          fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n      )\n  )\n  ```\n\n  Without encryption, upstream OAuth tokens are stored in plaintext.\n</Warning>\n\nTesting with in-memory storage (unencrypted):\n\n```python\nfrom key_value.aio.stores.memory import MemoryStore\n\n# Use in-memory storage for testing (clients lost on restart)\nauth = OAuthProxy(..., client_storage=MemoryStore())\n```\n\n</ParamField>\n\n<ParamField body=\"jwt_signing_key\" type=\"str | bytes | None\">\n\n<VersionBadge version=\"2.13.0\" />\n  Secret used to sign FastMCP JWT tokens issued to clients. Accepts any string or bytes - will be derived into a proper 32-byte cryptographic key using HKDF.\n\n  **Default behavior (`None`):**\n  Derives a 32-byte key using PBKDF2 from the upstream client secret.\n\n  **For production:**\n  Provide an explicit secret (e.g., from environment variable) to use a fixed key instead of the key derived from the upstream client secret. This allows you to manage keys securely in cloud environments, allows keys to work across multiple instances, and allows you to rotate keys without losing client registrations.\n\n  ```python\n  import os\n\n  auth = OAuthProxy(\n      ...,\n      jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],  # Any sufficiently complex string!\n      client_storage=RedisStore(...)  # Persistent storage\n  )\n  ```\n\n  See [HTTP Deployment - OAuth Token Security](/deployment/http#oauth-token-security) for complete production setup.\n</ParamField>\n\n\n<ParamField body=\"require_authorization_consent\" type=\"bool\" default=\"True\">\n  Whether to require user consent before authorizing MCP clients. When enabled (default), users see a consent screen that displays which client is requesting access, preventing [confused deputy attacks](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices#confused-deputy-problem) by ensuring users explicitly approve new clients.\n\n  **Default behavior (True):**\n  Users see a consent screen on first authorization. Consent choices are remembered via signed cookies, so users only need to approve each client once. This protects against malicious clients impersonating the user.\n\n  **Disabling consent (False):**\n  Authorization proceeds directly to the upstream provider without user confirmation. Only use this for local development or testing environments where the security trade-off is acceptable.\n\n  ```python\n  # Development/testing only - skip consent screen\n  auth = OAuthProxy(\n      ...,\n      require_authorization_consent=False  # \u26a0\ufe0f Security warning: only for local/testing\n  )\n  ```\n\n  <Warning>\n    Disabling consent removes an important security layer. Only disable for local development or testing environments where you fully control all connecting clients.\n  </Warning>\n</ParamField>\n\n<ParamField body=\"consent_csp_policy\" type=\"str | None\" default=\"None\">\n  Content Security Policy for the consent page.\n\n  - `None` (default): Uses the built-in CSP policy with appropriate directives for form submission\n  - Empty string `\"\"`: Disables CSP entirely (no meta tag rendered)\n  - Custom string: Uses the provided value as the CSP policy\n\n  This is useful for organizations that have their own CSP policies and need to override or disable FastMCP's built-in CSP directives.\n\n  ```python\n  # Disable CSP entirely (let org CSP policies apply)\n  auth = OAuthProxy(..., consent_csp_policy=\"\")\n\n  # Use custom CSP policy\n  auth = OAuthProxy(..., consent_csp_policy=\"default-src 'self'; style-src 'unsafe-inline'\")\n  ```\n</ParamField>\n</Card>\n\n### Using Built-in Providers\n\nFastMCP includes pre-configured providers for common services:\n\n```python\nfrom fastmcp.server.auth.providers.github import GitHubProvider\n\nauth = GitHubProvider(\n    client_id=\"your-github-app-id\",\n    client_secret=\"your-github-app-secret\",\n    base_url=\"https://your-server.com\"\n)\n\nmcp = FastMCP(name=\"My Server\", auth=auth)\n```\n\nAvailable providers include `GitHubProvider`, `GoogleProvider`, and others. These handle token verification automatically.\n\n### Token Verification\n\nThe OAuth proxy requires a compatible `TokenVerifier` to validate tokens from your provider. Different providers use different token formats:\n\n- **JWT tokens** (Google, Azure): Use `JWTVerifier` with the provider's JWKS endpoint\n- **Opaque tokens with RFC 7662 introspection** (Auth0, Okta, WorkOS): Use `IntrospectionTokenVerifier`\n- **Opaque tokens (provider-specific)** (GitHub, Discord): Use provider-specific verifiers like `GitHubTokenVerifier`\n\nSee the [Token Verification guide](/servers/auth/token-verification) for detailed setup instructions for your provider.\n\n### Scope Configuration\n\nOAuth scopes control what permissions your application requests from users. They're configured through your `TokenVerifier` (required for the OAuth proxy to validate tokens from your provider). Set `required_scopes` to automatically request the permissions your application needs:\n\n```python\nJWTVerifier(..., required_scopes = [\"read:user\", \"write:data\"])\n```\n\nDynamic clients created by the proxy will automatically include these scopes in their authorization requests. See the [Token Verification](#token-verification) section below for detailed setup.\n\n### Custom Parameters\n\nSome OAuth providers require additional parameters beyond the standard OAuth2 flow. Use `extra_authorize_params` and `extra_token_params` to pass provider-specific requirements. For example, Auth0 requires an `audience` parameter to issue JWT tokens instead of opaque tokens:\n\n```python\nauth = OAuthProxy(\n    upstream_authorization_endpoint=\"https://your-domain.auth0.com/authorize\",\n    upstream_token_endpoint=\"https://your-domain.auth0.com/oauth/token\",\n    upstream_client_id=\"your-auth0-client-id\",\n    upstream_client_secret=\"your-auth0-client-secret\",\n\n    # Auth0-specific audience parameter\n    extra_authorize_params={\"audience\": \"https://your-api-identifier.com\"},\n    extra_token_params={\"audience\": \"https://your-api-identifier.com\"},\n\n    token_verifier=JWTVerifier(\n        jwks_uri=\"https://your-domain.auth0.com/.well-known/jwks.json\",\n        issuer=\"https://your-domain.auth0.com/\",\n        audience=\"https://your-api-identifier.com\"\n    ),\n    base_url=\"https://your-server.com\"\n)\n```\n\nThe proxy also automatically forwards RFC 8707 `resource` parameters from MCP clients to upstream providers that support them.\n\n## OAuth Flow\n\n```mermaid\nsequenceDiagram\n    participant Client as MCP Client<br/>(localhost:random)\n    participant User as User\n    participant Proxy as FastMCP OAuth Proxy<br/>(server:8000)\n    participant Provider as OAuth Provider<br/>(GitHub, etc.)\n\n    Note over Client, Proxy: Dynamic Registration (Local)\n    Client->>Proxy: 1. POST /register<br/>redirect_uri: localhost:54321/callback\n    Proxy-->>Client: 2. Returns fixed upstream credentials\n\n    Note over Client, User: Authorization with User Consent\n    Client->>Proxy: 3. GET /authorize<br/>redirect_uri=localhost:54321/callback<br/>code_challenge=CLIENT_CHALLENGE\n    Note over Proxy: Store transaction with client PKCE<br/>Generate proxy PKCE pair\n    Proxy->>User: 4. Show consent page<br/>(client details, redirect URI, scopes)\n    User->>Proxy: 5. Approve/deny consent\n    Proxy->>Provider: 6. Redirect to provider<br/>redirect_uri=server:8000/auth/callback<br/>code_challenge=PROXY_CHALLENGE\n\n    Note over Provider, Proxy: Provider Callback\n    Provider->>Proxy: 7. GET /auth/callback<br/>with authorization code\n    Proxy->>Provider: 8. Exchange code for tokens<br/>code_verifier=PROXY_VERIFIER\n    Provider-->>Proxy: 9. Access & refresh tokens\n\n    Note over Proxy, Client: Client Callback Forwarding\n    Proxy->>Client: 10. Redirect to localhost:54321/callback<br/>with new authorization code\n\n    Note over Client, Proxy: Token Exchange\n    Client->>Proxy: 11. POST /token with code<br/>code_verifier=CLIENT_VERIFIER\n    Proxy-->>Client: 12. Returns stored provider tokens\n```\n\nThe flow diagram above illustrates the complete OAuth proxy pattern. Let's understand each phase:\n\n### Registration Phase\n\nWhen an MCP client calls `/register` with its dynamic callback URL, the proxy responds with your pre-configured upstream credentials. The client stores these credentials believing it has registered a new app. Meanwhile, the proxy records the client's callback URL for later use.\n\n### Authorization Phase\n\nThe client initiates OAuth by redirecting to the proxy's `/authorize` endpoint. The proxy:\n\n1. Stores the client's transaction with its PKCE challenge\n2. Generates its own PKCE parameters for upstream security\n3. Shows the user a consent page with the client's details, redirect URI, and requested scopes\n4. If the user approves (or the client was previously approved), redirects to the upstream provider using the fixed callback URL\n\nThis dual-PKCE approach maintains end-to-end security at both the client-to-proxy and proxy-to-provider layers. The consent step protects against confused deputy attacks by ensuring you explicitly approve each client before it can complete authorization.\n\n### Callback Phase\n\nAfter user authorization, the provider redirects back to the proxy's fixed callback URL. The proxy:\n\n1. Exchanges the authorization code for tokens with the provider\n2. Stores these tokens temporarily\n3. Generates a new authorization code for the client\n4. Redirects to the client's original dynamic callback URL\n\n### Token Exchange Phase\n\nFinally, the client exchanges its authorization code with the proxy to receive the provider's tokens. The proxy validates the client's PKCE verifier before returning the stored tokens.\n\nThis entire flow is transparent to the MCP client\u2014it experiences a standard OAuth flow with dynamic registration, unaware that a proxy is managing the complexity behind the scenes.\n\n### Token Architecture\n\nThe OAuth proxy implements a **token factory pattern**: instead of directly forwarding tokens from the upstream OAuth provider, it issues its own JWT tokens to MCP clients. This maintains proper OAuth 2.0 token audience boundaries and enables better security controls.\n\n**How it works:**\n\nWhen an MCP client completes authorization, the proxy:\n\n1. **Receives upstream tokens** from the OAuth provider (GitHub, Google, etc.)\n2. **Encrypts and stores** these tokens using Fernet encryption (AES-128-CBC + HMAC-SHA256)\n3. **Issues FastMCP JWT tokens** to the client, signed with HS256\n\nThe FastMCP JWT contains minimal claims: issuer, audience, client ID, scopes, expiration, and a unique token identifier (JTI). The JTI acts as a reference linking to the encrypted upstream token.\n\n**Token validation:**\n\nWhen a client makes an MCP request with its FastMCP token:\n\n1. **FastMCP validates the JWT** signature, expiration, issuer, and audience\n2. **Looks up the upstream token** using the JTI from the validated JWT\n3. **Decrypts and validates** the upstream token with the provider\n\nThis two-tier validation ensures that FastMCP tokens can only be used with this server (via audience validation) while maintaining full upstream token security.\n\n**Token expiry alignment:**\n\nFastMCP token lifetimes match the upstream token lifetimes. When the upstream token expires, the FastMCP token also expires, maintaining consistent security boundaries.\n\n**Refresh tokens:**\n\nThe proxy issues its own refresh tokens that map to upstream refresh tokens. When a client uses a FastMCP refresh token, the proxy refreshes the upstream token and issues a new FastMCP access token.\n\n### PKCE Forwarding\n\nThe OAuth proxy automatically handles PKCE (Proof Key for Code Exchange) when working with providers that support or require it. The proxy generates its own PKCE parameters to send upstream while separately validating the client's PKCE, ensuring end-to-end security at both layers.\n\nThis is enabled by default via the `forward_pkce` parameter and works seamlessly with providers like Google, Azure AD, and GitHub. Only disable it for legacy providers that don't support PKCE:\n\n```python\n# Disable PKCE forwarding only if upstream doesn't support it\nauth = OAuthProxy(\n    ...,\n    forward_pkce=False  # Default is True\n)\n```\n\n### Redirect URI Validation\n\nWhile the OAuth proxy accepts all redirect URIs by default (for DCR compatibility), you can restrict which clients can connect by specifying allowed patterns:\n\n```python\n# Allow only localhost clients (common for development)\nauth = OAuthProxy(\n    # ... other parameters ...\n    allowed_client_redirect_uris=[\n        \"http://localhost:*\",\n        \"http://127.0.0.1:*\"\n    ]\n)\n\n# Allow specific known clients\nauth = OAuthProxy(\n    # ... other parameters ...\n    allowed_client_redirect_uris=[\n        \"http://localhost:*\",\n        \"https://claude.ai/api/mcp/auth_callback\",\n        \"https://*.mycompany.com/auth/*\"  # Wildcard patterns supported\n    ]\n)\n```\n\nCheck your server logs for \"Client registered with redirect_uri\" messages to identify what URLs your clients use.\n\n## Security\n\n### Key and Storage Management\n\n<VersionBadge version=\"2.13.0\" />\nThe OAuth proxy requires cryptographic keys for JWT signing and storage encryption, plus persistent storage to maintain valid tokens across server restarts.\n\n**Default behavior (appropriate for development only):**\n- **Mac/Windows**: FastMCP automatically generates keys and stores them in your system keyring. Storage defaults to disk. Tokens survive server restarts. This is **only** suitable for development and local testing.\n- **Linux**: Keys are ephemeral (random salt at startup). Storage defaults to memory. Tokens become invalid on server restart.\n\n**For production:**\nConfigure the following parameters together: provide a unique `jwt_signing_key` (for signing FastMCP JWTs), and a shared `client_storage` backend (for storing tokens). Both are required for production deployments. Use a network-accessible storage backend like Redis or DynamoDB rather than local disk storage. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** (see the `client_storage` parameter documentation above for examples). The keys accept any secret string and derive proper cryptographic keys using HKDF. See [OAuth Token Security](/deployment/http#oauth-token-security) and [Storage Backends](/servers/storage-backends) for complete production setup.\n\n### Confused Deputy Attacks\n\n<VersionBadge version=\"2.13.0\" />\n\nA confused deputy attack allows a malicious client to steal your authorization by tricking you into granting it access under your identity.\n\nThe OAuth proxy works by bridging DCR clients to traditional auth providers, which means that multiple MCP clients connect through a single upstream OAuth application. An attacker can exploit this shared application by registering a malicious client with their own redirect URI, then sending you an authorization link. When you click it, your browser goes through the OAuth flow\u2014but since you may have already authorized this OAuth app before, the provider might auto-approve the request. The authorization code then gets sent to the attacker's redirect URI instead of a legitimate client, giving them access under your credentials.\n\n#### Mitigation\n\nFastMCP's OAuth proxy requires you to explicitly consent whenever any new or unrecognized client attempts to connect to your server. Before any authorization happens, you see a consent page showing the client's details, redirect URI, and requested scopes. This gives you the opportunity to review and deny suspicious requests. Once you approve a client, it's remembered so you don't see the consent page again for that client. The consent mechanism is implemented with CSRF tokens and cryptographically signed cookies to prevent tampering.\n\n![](/assets/images/oauth-proxy-consent-screen.png)\n\nThe consent page automatically displays your server's name, icon, and website URL, if available. These visual identifiers help users confirm they're authorizing the correct server.\n\n\n\n**Learn more:**\n- [MCP Security Best Practices](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices#confused-deputy-problem) - Official specification guidance\n- [Confused Deputy Attacks Explained](https://den.dev/blog/mcp-confused-deputy-api-management/) - Detailed walkthrough by Den Delimarsky\n\n## Environment Configuration\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, configure the OAuth proxy through environment variables instead of hardcoding credentials:\n\n```bash\n# Specify the provider implementation\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.github.GitHubProvider\n\n# Provider-specific credentials\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=\"Ov23li...\"\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=\"abc123...\"\nexport FASTMCP_SERVER_AUTH_GITHUB_BASE_URL=\"https://your-production-server.com\"\n```\n\nWith environment configuration, your server code simplifies to:\n\n```python\nfrom fastmcp import FastMCP\n\n# Authentication automatically configured from environment\nmcp = FastMCP(name=\"My Server\")\n\n@mcp.tool\ndef protected_tool(data: str) -> str:\n    \"\"\"This tool is now protected by OAuth.\"\"\"\n    return f\"Processed: {data}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n"}, {"filename": "docs/servers/auth/oidc-proxy.mdx", "content": "---\ntitle: OIDC Proxy\nsidebarTitle: OIDC Proxy\ndescription: Bridge OIDC providers to work seamlessly with MCP's authentication flow.\nicon: share\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.12.4\" />\n\nThe OIDC proxy enables FastMCP servers to authenticate with OIDC providers that **don't support Dynamic Client Registration (DCR)** out of the box. This includes OAuth providers like: Auth0, Google, Azure, AWS, etc. For providers that do support DCR (like WorkOS AuthKit), use [`RemoteAuthProvider`](/servers/auth/remote-oauth) instead.\n\nThe OIDC proxy is built upon [`OAuthProxy`](/servers/auth/oauth-proxy) so it has all the same functionality under the covers.\n\n## Implementation\n\n### Provider Setup Requirements\n\nBefore using the OIDC proxy, you need to register your application with your OAuth provider:\n\n1. **Register your application** in the provider's developer console (Auth0 Applications, Google Cloud Console, Azure Portal, etc.)\n2. **Configure the redirect URI** as your FastMCP server URL plus your chosen callback path:\n   - Default: `https://your-server.com/auth/callback`\n   - Custom: `https://your-server.com/your/custom/path` (if you set `redirect_path`)\n   - Development: `http://localhost:8000/auth/callback`\n3. **Obtain your credentials**: Client ID and Client Secret\n\n<Warning>\n  The redirect URI you configure with your provider must exactly match your\n  FastMCP server's URL plus the callback path. If you customize `redirect_path`\n  in the OIDC proxy, update your provider's redirect URI accordingly.\n</Warning>\n\n### Basic Setup\n\nHere's how to implement the OIDC proxy with any provider:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.oidc_proxy import OIDCProxy\n\n# Create the OIDC proxy\nauth = OIDCProxy(\n    # Provider's configuration URL\n    config_url=\"https://provider.com/.well-known/openid-configuration\",\n\n    # Your registered app credentials\n    client_id=\"your-client-id\",\n    client_secret=\"your-client-secret\",\n\n    # Your FastMCP server's public URL\n    base_url=\"https://your-server.com\",\n\n    # Optional: customize the callback path (default is \"/auth/callback\")\n    # redirect_path=\"/custom/callback\",\n)\n\nmcp = FastMCP(name=\"My Server\", auth=auth)\n```\n\n### Configuration Parameters\n\n<Card icon=\"code\" title=\"OIDCProxy Parameters\">\n<ParamField body=\"config_url\" type=\"str\" required>\n  URL of your OAuth provider's OIDC configuration\n</ParamField>\n\n<ParamField body=\"client_id\" type=\"str\" required>\n  Client ID from your registered OAuth application\n</ParamField>\n\n<ParamField body=\"client_secret\" type=\"str\" required>\n  Client secret from your registered OAuth application\n</ParamField>\n\n<ParamField body=\"base_url\" type=\"AnyHttpUrl | str\" required>\n  Public URL of your FastMCP server (e.g., `https://your-server.com`)\n</ParamField>\n\n<ParamField body=\"strict\" type=\"bool | None\">\n  Strict flag for configuration validation. When True, requires all OIDC\n  mandatory fields.\n</ParamField>\n\n<ParamField body=\"audience\" type=\"str | None\">\n  Audience parameter for OIDC providers that require it (e.g., Auth0). This is\n  typically your API identifier.\n</ParamField>\n\n<ParamField body=\"timeout_seconds\" type=\"int | None\" default=\"10\">\n  HTTP request timeout in seconds for fetching OIDC configuration\n</ParamField>\n\n<ParamField body=\"token_verifier\" type=\"TokenVerifier | None\">\n\n<VersionBadge version=\"2.13.1\" />\n  Custom token verifier for validating tokens. When provided, FastMCP uses your custom verifier instead of creating a default `JWTVerifier`.\n\n  Cannot be used with `algorithm` or `required_scopes` parameters - configure these on your verifier instead. The verifier's `required_scopes` are automatically loaded and advertised.\n</ParamField>\n\n<ParamField body=\"algorithm\" type=\"str | None\">\n  JWT algorithm to use for token verification (e.g., \"RS256\"). If not specified,\n  uses the provider's default. Only used when `token_verifier` is not provided.\n</ParamField>\n\n<ParamField body=\"required_scopes\" type=\"list[str] | None\">\n  List of OAuth scopes for token validation. These are automatically\n  included in authorization requests. Only used when `token_verifier` is not provided.\n</ParamField>\n\n<ParamField body=\"redirect_path\" type=\"str\" default=\"/auth/callback\">\n  Path for OAuth callbacks. Must match the redirect URI configured in your OAuth\n  application\n</ParamField>\n\n<ParamField body=\"allowed_client_redirect_uris\" type=\"list[str] | None\">\n  List of allowed redirect URI patterns for MCP clients. Patterns support wildcards (e.g., `\"http://localhost:*\"`, `\"https://*.example.com/*\"`).\n  - `None` (default): All redirect URIs allowed (for MCP/DCR compatibility)\n  - Empty list `[]`: No redirect URIs allowed\n  - Custom list: Only matching patterns allowed\n\nThese patterns apply to MCP client loopback redirects, NOT the upstream OAuth app redirect URI.\n\n</ParamField>\n\n<ParamField body=\"token_endpoint_auth_method\" type=\"str | None\">\n  Token endpoint authentication method for the upstream OAuth server. Controls how the proxy authenticates when exchanging authorization codes and refresh tokens with the upstream provider.\n  - `\"client_secret_basic\"`: Send credentials in Authorization header (most common)\n  - `\"client_secret_post\"`: Send credentials in request body (required by some providers)\n  - `\"none\"`: No authentication (for public clients)\n  - `None` (default): Uses authlib's default (typically `\"client_secret_basic\"`)\n\nSet this if your provider requires a specific authentication method and the default doesn't work.\n\n</ParamField>\n\n<ParamField body=\"jwt_signing_key\" type=\"str | bytes | None\">\n\n<VersionBadge version=\"2.13.0\" />\n  Secret used to sign FastMCP JWT tokens issued to clients. Accepts any string or bytes - will be derived into a proper 32-byte cryptographic key using HKDF.\n\n  **Default behavior (`None`):**\n  - **Mac/Windows**: Auto-managed via system keyring. Keys are generated once and persisted, surviving server restarts with zero configuration. Keys are automatically derived from server attributes, so this approach, while convenient, is **only** suitable for development and local testing. For production, you must provide an explicit secret.\n  - **Linux**: Ephemeral (random salt at startup). Tokens become invalid on server restart, triggering client re-authentication.\n\n  **For production:**\n  Provide an explicit secret (e.g., from environment variable) to use a fixed key instead of the auto-generated one.\n</ParamField>\n\n<ParamField body=\"client_storage\" type=\"AsyncKeyValue | None\">\n\n<VersionBadge version=\"2.13.0\" />\n  Storage backend for persisting OAuth client registrations and upstream tokens.\n\n  **Default behavior:**\n  - **Mac/Windows**: Encrypted DiskStore in your platform's data directory (derived from `platformdirs`)\n  - **Linux**: MemoryStore (ephemeral - clients lost on restart)\n\n  By default on Mac/Windows, clients are automatically persisted to encrypted disk storage, allowing them to survive server restarts as long as the filesystem remains accessible. This means MCP clients only need to register once and can reconnect seamlessly. On Linux where keyring isn't available, ephemeral storage is used to match the ephemeral key strategy.\n\nFor production deployments with multiple servers or cloud deployments, use a network-accessible storage backend rather than local disk storage. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest.** See [Storage Backends](/servers/storage-backends) for available options.\n\nTesting with in-memory storage (unencrypted):\n\n```python\nfrom key_value.aio.stores.memory import MemoryStore\n\n# Use in-memory storage for testing (clients lost on restart)\nauth = OIDCProxy(..., client_storage=MemoryStore())\n```\n\nProduction with encrypted Redis storage:\n\n```python\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\nimport os\n\nauth = OIDCProxy(\n    ...,\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(host=\"redis.example.com\", port=6379),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n```\n\n</ParamField>\n\n<ParamField body=\"require_authorization_consent\" type=\"bool\" default=\"True\">\n  Whether to require user consent before authorizing MCP clients. When enabled (default), users see a consent screen that displays which client is requesting access. See [OAuthProxy documentation](/servers/auth/oauth-proxy#confused-deputy-attacks) for details on confused deputy attack protection.\n</ParamField>\n\n<ParamField body=\"consent_csp_policy\" type=\"str | None\" default=\"None\">\n  Content Security Policy for the consent page.\n\n  - `None` (default): Uses the built-in CSP policy with appropriate directives for form submission\n  - Empty string `\"\"`: Disables CSP entirely (no meta tag rendered)\n  - Custom string: Uses the provided value as the CSP policy\n\n  This is useful for organizations that have their own CSP policies and need to override or disable FastMCP's built-in CSP directives.\n</ParamField>\n</Card>\n\n### Using Built-in Providers\n\nFastMCP includes pre-configured OIDC providers for common services:\n\n```python\nfrom fastmcp.server.auth.providers.auth0 import Auth0Provider\n\nauth = Auth0Provider(\n    config_url=\"https://.../.well-known/openid-configuration\",\n    client_id=\"your-auth0-client-id\",\n    client_secret=\"your-auth0-client-secret\",\n    audience=\"https://...\",\n    base_url=\"https://localhost:8000\"\n)\n\nmcp = FastMCP(name=\"My Server\", auth=auth)\n```\n\nAvailable providers include `Auth0Provider` at present.\n\n### Scope Configuration\n\nOAuth scopes are configured with `required_scopes` to automatically request the permissions your application needs.\n\nDynamic clients created by the proxy will automatically include these scopes in their authorization requests.\n\n## Environment Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments, configure the OIDC proxy through environment variables instead of hardcoding credentials:\n\n```bash\n# Specify the provider implementation\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.auth0.Auth0Provider\n\n# Provider-specific credentials\nexport FASTMCP_SERVER_AUTH_AUTH0_CONFIG_URL=https://.../.well-known/openid-configuration\nexport FASTMCP_SERVER_AUTH_AUTH0_CLIENT_ID=tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB\nexport FASTMCP_SERVER_AUTH_AUTH0_CLIENT_SECRET=vPYqbjemq...\nexport FASTMCP_SERVER_AUTH_AUTH0_AUDIENCE=https://...\nexport FASTMCP_SERVER_AUTH_AUTH0_BASE_URL=https://localhost:8000\n```\n\nWith environment configuration, your server code simplifies to:\n\n```python\nfrom fastmcp import FastMCP\n\n# Authentication automatically configured from environment\nmcp = FastMCP(name=\"My Server\")\n\n@mcp.tool\ndef protected_tool(data: str) -> str:\n    \"\"\"This tool is now protected by OAuth.\"\"\"\n    return f\"Processed: {data}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n"}, {"filename": "docs/servers/auth/remote-oauth.mdx", "content": "---\ntitle: Remote OAuth\nsidebarTitle: Remote OAuth\ndescription: Integrate your FastMCP server with external identity providers like Descope, WorkOS, Auth0, and corporate SSO systems.\nicon: camera-cctv\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.11.0\" />\n\nRemote OAuth integration allows your FastMCP server to leverage external identity providers that **support Dynamic Client Registration (DCR)**. With DCR, MCP clients can automatically register themselves with the identity provider and obtain credentials without any manual configuration. This provides enterprise-grade authentication with fully automated flows, making it ideal for production applications with modern identity providers.\n\n<Tip>\n**When to use RemoteAuthProvider vs OAuth Proxy:**\n- **RemoteAuthProvider**: For providers WITH Dynamic Client Registration (Descope, WorkOS AuthKit, modern OIDC providers)\n- **OAuth Proxy**: For providers WITHOUT Dynamic Client Registration (GitHub, Google, Azure, AWS, Discord, etc.)\n\nRemoteAuthProvider requires DCR support for fully automated client registration and authentication.\n</Tip>\n\n## DCR-Enabled Providers\n\nRemoteAuthProvider works with identity providers that support **Dynamic Client Registration (DCR)** - a critical capability that enables automated authentication flows:\n\n| Feature | DCR Providers (RemoteAuth) | Non-DCR Providers (OAuth Proxy) |\n|---------|---------------------------|--------------------------------|\n| **Client Registration** | Automatic via API | Manual in provider console |\n| **Credentials** | Dynamic per client | Fixed app credentials |\n| **Configuration** | Zero client config | Pre-shared credentials |\n| **Examples** | Descope, WorkOS AuthKit, modern OIDC | GitHub, Google, Azure |\n| **FastMCP Class** | `RemoteAuthProvider` | [`OAuthProxy`](/servers/auth/oauth-proxy) |\n\nIf your provider doesn't support DCR (most traditional OAuth providers), you'll need to use [`OAuth Proxy`](/servers/auth/oauth-proxy) instead, which bridges the gap between MCP's DCR expectations and fixed OAuth credentials.\n\n## The Remote OAuth Challenge\n\nTraditional OAuth flows assume human users with web browsers who can interact with login forms, consent screens, and redirects. MCP clients operate differently - they're often automated systems that need to authenticate programmatically without human intervention.\n\nThis creates several unique requirements that standard OAuth implementations don't address well:\n\n**Automatic Discovery**: MCP clients must discover authentication requirements by examining server metadata rather than encountering HTTP redirects. They need to know which identity provider to use and how to reach it before making any authenticated requests.\n\n**Programmatic Registration**: Clients need to register themselves with identity providers automatically. Manual client registration doesn't work when clients might be dynamically created tools or services.\n\n**Seamless Token Management**: Clients must obtain, store, and refresh tokens without user interaction. The authentication flow needs to work in headless environments where no human is available to complete OAuth consent flows.\n\n**Protocol Integration**: The authentication process must integrate cleanly with MCP's JSON-RPC transport layer and error handling mechanisms.\n\nThese requirements mean that your MCP server needs to do more than just validate tokens - it needs to provide discovery metadata that enables MCP clients to understand and navigate your authentication requirements automatically.\n\n## MCP Authentication Discovery\n\nMCP authentication discovery relies on well-known endpoints that clients can examine to understand your authentication requirements. Your server becomes a bridge between MCP clients and your chosen identity provider.\n\nThe core discovery endpoint is `/.well-known/oauth-protected-resource`, which tells clients that your server requires OAuth authentication and identifies the authorization servers you trust. This endpoint contains static metadata that points clients to your identity provider without requiring any dynamic lookups.\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant FastMCPServer as FastMCP Server\n    participant ExternalIdP as Identity Provider\n\n    Client->>FastMCPServer: 1. GET /.well-known/oauth-protected-resource\n    FastMCPServer-->>Client: 2. \"Use https://my-idp.com for auth\"\n    \n    note over Client, ExternalIdP: Client goes directly to the IdP\n    Client->>ExternalIdP: 3. Authenticate & get token via DCR\n    ExternalIdP-->>Client: 4. Access token\n    \n    Client->>FastMCPServer: 5. MCP request with Bearer token\n    FastMCPServer->>FastMCPServer: 6. Verify token signature\n    FastMCPServer-->>Client: 7. MCP response\n```\n\nThis flow separates concerns cleanly: your MCP server handles resource protection and token validation, while your identity provider handles user authentication and token issuance. The client coordinates between these systems using standardized OAuth discovery mechanisms.\n\n## FastMCP Remote Authentication\n\n<VersionBadge version=\"2.11.1\" />\n\nFastMCP provides `RemoteAuthProvider` to handle the complexities of remote OAuth integration. This class combines token validation capabilities with the OAuth discovery metadata that MCP clients require.\n\n### RemoteAuthProvider\n\n`RemoteAuthProvider` works by composing a [`TokenVerifier`](/servers/auth/token-verification) with authorization server information. A `TokenVerifier` is another FastMCP authentication class that focuses solely on token validation - signature verification, expiration checking, and claim extraction. The `RemoteAuthProvider` takes that token validation capability and adds the OAuth discovery endpoints that enable MCP clients to automatically find and authenticate with your identity provider.\n\nThis composition pattern means you can use any token validation strategy while maintaining consistent OAuth discovery behavior:\n- **JWT tokens**: Use `JWTVerifier` for self-contained tokens\n- **Opaque tokens**: Use `IntrospectionTokenVerifier` for RFC 7662 introspection\n- **Custom validation**: Implement your own `TokenVerifier` subclass\n\nThe separation allows you to change token validation approaches without affecting the client discovery experience.\n\nThe class automatically generates the required OAuth metadata endpoints using the MCP SDK's standardized route creation functions. This ensures compatibility with MCP clients while reducing the implementation complexity for server developers.\n\n### Basic Implementation\n\nMost applications can use `RemoteAuthProvider` directly without subclassing. The implementation requires a `TokenVerifier` instance, a list of trusted authorization servers, and your server's URL for metadata generation.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import RemoteAuthProvider\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\nfrom pydantic import AnyHttpUrl\n\n# Configure token validation for your identity provider\ntoken_verifier = JWTVerifier(\n    jwks_uri=\"https://auth.yourcompany.com/.well-known/jwks.json\",\n    issuer=\"https://auth.yourcompany.com\",\n    audience=\"mcp-production-api\"\n)\n\n# Create the remote auth provider\nauth = RemoteAuthProvider(\n    token_verifier=token_verifier,\n    authorization_servers=[AnyHttpUrl(\"https://auth.yourcompany.com\")],\n    base_url=\"https://api.yourcompany.com\",  # Your server base URL\n    # Optional: customize allowed client redirect URIs (defaults to localhost only)\n    allowed_client_redirect_uris=[\"http://localhost:*\", \"http://127.0.0.1:*\"]\n)\n\nmcp = FastMCP(name=\"Company API\", auth=auth)\n```\n\nThis configuration creates a server that accepts tokens issued by `auth.yourcompany.com` and provides the OAuth discovery metadata that MCP clients need. The `JWTVerifier` handles token validation using your identity provider's public keys, while the `RemoteAuthProvider` generates the required OAuth endpoints.\n\nThe `authorization_servers` list tells MCP clients which identity providers you trust. The `base_url` identifies your server in OAuth metadata, enabling proper token audience validation. **Important**: The `base_url` should point to your server base URL - for example, if your MCP server is accessible at `https://api.yourcompany.com/mcp`, use `https://api.yourcompany.com` as the base URL.\n\n### Custom Endpoints\n\nYou can extend `RemoteAuthProvider` to add additional endpoints beyond the standard OAuth protected resource metadata. These don't have to be OAuth-specific - you can add any endpoints your authentication integration requires.\n\n```python\nimport httpx\nfrom starlette.responses import JSONResponse\nfrom starlette.routing import Route\n\nclass CompanyAuthProvider(RemoteAuthProvider):\n    def __init__(self):\n        token_verifier = JWTVerifier(\n            jwks_uri=\"https://auth.yourcompany.com/.well-known/jwks.json\",\n            issuer=\"https://auth.yourcompany.com\",\n            audience=\"mcp-production-api\"\n        )\n        \n        super().__init__(\n            token_verifier=token_verifier,\n            authorization_servers=[AnyHttpUrl(\"https://auth.yourcompany.com\")],\n            base_url=\"https://api.yourcompany.com\"  # Your server base URL\n        )\n    \n    def get_routes(self) -> list[Route]:\n        \"\"\"Add custom endpoints to the standard protected resource routes.\"\"\"\n        \n        # Get the standard OAuth protected resource routes\n        routes = super().get_routes()\n        \n        # Add authorization server metadata forwarding for client convenience\n        async def authorization_server_metadata(request):\n            async with httpx.AsyncClient() as client:\n                response = await client.get(\n                    \"https://auth.yourcompany.com/.well-known/oauth-authorization-server\"\n                )\n                response.raise_for_status()\n                return JSONResponse(response.json())\n        \n        routes.append(\n            Route(\"/.well-known/oauth-authorization-server\", authorization_server_metadata)\n        )\n        \n        return routes\n\nmcp = FastMCP(name=\"Company API\", auth=CompanyAuthProvider())\n```\n\nThis pattern uses `super().get_routes()` to get the standard protected resource routes, then adds additional endpoints as needed. A common use case is providing authorization server metadata forwarding, which allows MCP clients to discover your identity provider's capabilities through your MCP server rather than contacting the identity provider directly.\n\n## WorkOS AuthKit Integration\n\nWorkOS AuthKit provides an excellent example of remote OAuth integration. The `AuthKitProvider` demonstrates how to implement both token validation and OAuth metadata forwarding in a production-ready package.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import AuthKitProvider\n\nauth = AuthKitProvider(\n    authkit_domain=\"https://your-project.authkit.app\",\n    base_url=\"https://your-mcp-server.com\"\n)\n\nmcp = FastMCP(name=\"Protected Application\", auth=auth)\n```\n\nThe `AuthKitProvider` automatically configures JWT validation against WorkOS's public keys and provides both protected resource metadata and authorization server metadata forwarding. This implementation handles the complete remote OAuth integration with minimal configuration.\n\nWorkOS's support for Dynamic Client Registration makes it particularly well-suited for MCP applications. Clients can automatically register themselves with your WorkOS project and obtain the credentials needed for authentication without manual intervention.\n\n\u2192 **Complete WorkOS tutorial**: [AuthKit Integration Guide](/integrations/authkit)\n\n## Client Redirect URI Security\n\n<Note>\n`RemoteAuthProvider` also supports the `allowed_client_redirect_uris` parameter for controlling which redirect URIs are accepted from MCP clients during DCR:\n\n- `None` (default): Only localhost patterns allowed\n- Custom list: Specify allowed patterns with wildcard support\n- Empty list `[]`: Allow all (not recommended)\n\nThis provides defense-in-depth even though DCR providers typically validate redirect URIs themselves.\n</Note>\n\n## Implementation Considerations\n\nRemote OAuth integration requires careful attention to several technical details that affect reliability and security.\n\n**Token Validation Performance**: Your server validates every incoming token by checking signatures against your identity provider's public keys. Consider implementing key caching and rotation handling to minimize latency while maintaining security.\n\n**Error Handling**: Network issues with your identity provider can affect token validation. Implement appropriate timeouts, retry logic, and graceful degradation to maintain service availability during identity provider outages.\n\n**Audience Validation**: Ensure that tokens intended for your server are not accepted by other applications. Proper audience validation prevents token misuse across different services in your ecosystem.\n\n**Scope Management**: Map token scopes to your application's permission model consistently. Consider how scope changes affect existing tokens and plan for smooth permission updates.\n\nThe complexity of these considerations reinforces why external identity providers are recommended over custom OAuth implementations. Established providers handle these technical details with extensive testing and operational experience."}, {"filename": "docs/servers/auth/token-verification.mdx", "content": "---\ntitle: Token Verification\nsidebarTitle: Token Verification\ndescription: Protect your server by validating bearer tokens issued by external systems.\nicon: key\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.11.0\" />\n\nToken verification enables your FastMCP server to validate bearer tokens issued by external systems without participating in user authentication flows. Your server acts as a pure resource server, focusing on token validation and authorization decisions while delegating identity management to other systems in your infrastructure.\n\n<Note>\nToken verification operates somewhat outside the formal MCP authentication flow, which expects OAuth-style discovery. It's best suited for internal systems, microservices architectures, or when you have full control over token generation and distribution.\n</Note>\n\n## Understanding Token Verification\n\nToken verification addresses scenarios where authentication responsibility is distributed across multiple systems. Your MCP server receives structured tokens containing identity and authorization information, validates their authenticity, and makes access control decisions based on their contents.\n\nThis pattern emerges naturally in microservices architectures where a central authentication service issues tokens that multiple downstream services validate independently. It also works well when integrating MCP servers into existing systems that already have established token-based authentication mechanisms.\n\n### The Token Verification Model\n\nToken verification treats your MCP server as a resource server in OAuth terminology. The key insight is that token validation and token issuance are separate concerns that can be handled by different systems.\n\n**Token Issuance**: Another system (API gateway, authentication service, or identity provider) handles user authentication and creates signed tokens containing identity and permission information.\n\n**Token Validation**: Your MCP server receives these tokens, verifies their authenticity using cryptographic signatures, and extracts authorization information from their claims.\n\n**Access Control**: Based on token contents, your server determines what resources, tools, and prompts the client can access.\n\nThis separation allows your MCP server to focus on its core functionality while leveraging existing authentication infrastructure. The token acts as a portable proof of identity that travels with each request.\n\n### Token Security Considerations\n\nToken-based authentication relies on cryptographic signatures to ensure token integrity. Your MCP server validates tokens using public keys corresponding to the private keys used for token creation. This asymmetric approach means your server never needs access to signing secrets.\n\nToken validation must address several security requirements: signature verification ensures tokens haven't been tampered with, expiration checking prevents use of stale tokens, and audience validation ensures tokens intended for your server aren't accepted by other systems.\n\nThe challenge in MCP environments is that clients need to obtain valid tokens before making requests, but the MCP protocol doesn't provide built-in discovery mechanisms for token endpoints. Clients must obtain tokens through separate channels or prior configuration.\n\n\n## TokenVerifier Class\n\nFastMCP provides the `TokenVerifier` class to handle token validation complexity while remaining flexible about token sources and validation strategies.\n\n`TokenVerifier` focuses exclusively on token validation without providing OAuth discovery metadata. This makes it ideal for internal systems where clients already know how to obtain tokens, or for microservices that trust tokens from known issuers.\n\nThe class validates token signatures, checks expiration timestamps, and extracts authorization information from token claims. It supports various token formats and validation strategies while maintaining a consistent interface for authorization decisions.\n\nYou can subclass `TokenVerifier` to implement custom validation logic for specialized token formats or validation requirements. The base class handles common patterns while allowing extension for unique use cases.\n\n## JWT Token Verification\n\nJSON Web Tokens (JWTs) represent the most common token format for modern applications. FastMCP's `JWTVerifier` validates JWTs using industry-standard cryptographic techniques and claim validation.\n\n### JWKS Endpoint Integration\n\nJWKS endpoint integration provides the most flexible approach for production systems. The verifier automatically fetches public keys from a JSON Web Key Set endpoint, enabling automatic key rotation without server configuration changes.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n\n# Configure JWT verification against your identity provider\nverifier = JWTVerifier(\n    jwks_uri=\"https://auth.yourcompany.com/.well-known/jwks.json\",\n    issuer=\"https://auth.yourcompany.com\",\n    audience=\"mcp-production-api\"\n)\n\nmcp = FastMCP(name=\"Protected API\", auth=verifier)\n```\n\nThis configuration creates a server that validates JWTs issued by `auth.yourcompany.com`. The verifier periodically fetches public keys from the JWKS endpoint and validates incoming tokens against those keys. Only tokens with the correct issuer and audience claims will be accepted.\n\nThe `issuer` parameter ensures tokens come from your trusted authentication system, while `audience` validation prevents tokens intended for other services from being accepted by your MCP server.\n\n### Symmetric Key Verification (HMAC)\n\nSymmetric key verification uses a shared secret for both signing and validation, making it ideal for internal microservices and trusted environments where the same secret can be securely distributed to both token issuers and validators.\n\nThis approach is commonly used in microservices architectures where services share a secret key, or when your authentication service and MCP server are both managed by the same organization. The HMAC algorithms (HS256, HS384, HS512) provide strong security when the shared secret is properly managed.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n\n# Use a shared secret for symmetric key verification\nverifier = JWTVerifier(\n    public_key=\"your-shared-secret-key-minimum-32-chars\",  # Despite the name, this accepts symmetric secrets\n    issuer=\"internal-auth-service\",\n    audience=\"mcp-internal-api\",\n    algorithm=\"HS256\"  # or HS384, HS512 for stronger security\n)\n\nmcp = FastMCP(name=\"Internal API\", auth=verifier)\n```\n\nThe verifier will validate tokens signed with the same secret using the specified HMAC algorithm. This approach offers several advantages for internal systems:\n\n- **Simplicity**: No key pair management or certificate distribution\n- **Performance**: HMAC operations are typically faster than RSA\n- **Compatibility**: Works well with existing microservice authentication patterns\n\n<Note>\nThe parameter is named `public_key` for backwards compatibility, but when using HMAC algorithms (HS256/384/512), it accepts the symmetric secret string.\n</Note>\n\n<Warning>\n**Security Considerations for Symmetric Keys:**\n- Use a strong, randomly generated secret (minimum 32 characters recommended)\n- Never expose the secret in logs, error messages, or version control\n- Implement secure key distribution and rotation mechanisms\n- Consider using asymmetric keys (RSA/ECDSA) for external-facing APIs\n</Warning>\n\n### Static Public Key Verification\n\nStatic public key verification works when you have a fixed RSA or ECDSA signing key and don't need automatic key rotation. This approach is primarily useful for development environments or controlled deployments where JWKS endpoints aren't available.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier\n\n# Use a static public key for token verification\npublic_key_pem = \"\"\"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END PUBLIC KEY-----\"\"\"\n\nverifier = JWTVerifier(\n    public_key=public_key_pem,\n    issuer=\"https://auth.yourcompany.com\",\n    audience=\"mcp-production-api\"\n)\n\nmcp = FastMCP(name=\"Protected API\", auth=verifier)\n```\n\nThis configuration validates tokens using a specific RSA or ECDSA public key. The key must correspond to the private key used by your token issuer. While less flexible than JWKS endpoints, this approach can be useful in development environments or when testing with fixed keys.\n## Opaque Token Verification\n\nMany authorization servers issue opaque tokens rather than self-contained JWTs. Opaque tokens are random strings that carry no information themselves - the authorization server maintains their state and validation requires querying the server. FastMCP supports opaque token validation through OAuth 2.0 Token Introspection (RFC 7662).\n\n### Understanding Opaque Tokens\n\nOpaque tokens differ fundamentally from JWTs in their verification model. Where JWTs carry signed claims that can be validated locally, opaque tokens require network calls to the issuing authorization server for validation. The authorization server maintains token state and can revoke tokens immediately, providing stronger security guarantees for sensitive operations.\n\nThis approach trades performance (network latency on each validation) for security and flexibility. Authorization servers can revoke opaque tokens instantly, implement complex authorization logic, and maintain detailed audit logs of token usage. Many enterprise OAuth providers default to opaque tokens for these security advantages.\n\n### Token Introspection Protocol\n\nRFC 7662 standardizes how resource servers validate opaque tokens. The protocol defines an introspection endpoint where resource servers authenticate using client credentials and receive token metadata including active status, scopes, expiration, and subject identity.\n\nFastMCP implements this protocol through the `IntrospectionTokenVerifier` class, handling authentication, request formatting, and response parsing according to the specification.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.introspection import IntrospectionTokenVerifier\n\n# Configure introspection with your OAuth provider\nverifier = IntrospectionTokenVerifier(\n    introspection_url=\"https://auth.yourcompany.com/oauth/introspect\",\n    client_id=\"mcp-resource-server\",\n    client_secret=\"your-client-secret\",\n    required_scopes=[\"api:read\", \"api:write\"]\n)\n\nmcp = FastMCP(name=\"Protected API\", auth=verifier)\n```\n\nThe verifier authenticates to the introspection endpoint using HTTP Basic Auth with your client credentials. When a request arrives with a bearer token, FastMCP queries the introspection endpoint to determine if the token is active and has sufficient scopes.\n\n## Development and Testing\n\nDevelopment environments often need simpler token management without the complexity of full JWT infrastructure. FastMCP provides tools specifically designed for these scenarios.\n\n### Static Token Verification\n\nStatic token verification enables rapid development by accepting predefined tokens with associated claims. This approach eliminates the need for token generation infrastructure during development and testing.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.jwt import StaticTokenVerifier\n\n# Define development tokens and their associated claims\nverifier = StaticTokenVerifier(\n    tokens={\n        \"dev-alice-token\": {\n            \"client_id\": \"alice@company.com\",\n            \"scopes\": [\"read:data\", \"write:data\", \"admin:users\"]\n        },\n        \"dev-guest-token\": {\n            \"client_id\": \"guest-user\",\n            \"scopes\": [\"read:data\"]\n        }\n    },\n    required_scopes=[\"read:data\"]\n)\n\nmcp = FastMCP(name=\"Development Server\", auth=verifier)\n```\n\nClients can now authenticate using `Authorization: Bearer dev-alice-token` headers. The server will recognize the token and load the associated claims for authorization decisions. This approach enables immediate development without external dependencies.\n\n<Warning>\nStatic token verification stores tokens as plain text and should never be used in production environments. It's designed exclusively for development and testing scenarios.\n</Warning>\n\n\n### Debug/Custom Token Verification\n\n<VersionBadge version=\"2.13.1\" />\n\nThe `DebugTokenVerifier` provides maximum flexibility for testing and special cases where standard token verification isn't applicable. It delegates validation to a user-provided callable, making it useful for prototyping, testing scenarios, or handling opaque tokens without introspection endpoints.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.debug import DebugTokenVerifier\n\n# Accept all tokens (useful for rapid development)\nverifier = DebugTokenVerifier()\n\nmcp = FastMCP(name=\"Development Server\", auth=verifier)\n```\n\nBy default, `DebugTokenVerifier` accepts any non-empty token as valid. This eliminates authentication barriers during early development, allowing you to focus on core functionality before adding security.\n\nFor more controlled testing, provide custom validation logic:\n\n```python\nfrom fastmcp.server.auth.providers.debug import DebugTokenVerifier\n\n# Synchronous validation - check token prefix\nverifier = DebugTokenVerifier(\n    validate=lambda token: token.startswith(\"dev-\"),\n    client_id=\"development-client\",\n    scopes=[\"read\", \"write\"]\n)\n\nmcp = FastMCP(name=\"Development Server\", auth=verifier)\n```\n\nThe validation callable can also be async, enabling database lookups or external service calls:\n\n```python\nfrom fastmcp.server.auth.providers.debug import DebugTokenVerifier\n\n# Asynchronous validation - check against cache\nasync def validate_token(token: str) -> bool:\n    # Check if token exists in Redis, database, etc.\n    return await redis.exists(f\"valid_tokens:{token}\")\n\nverifier = DebugTokenVerifier(\n    validate=validate_token,\n    client_id=\"api-client\",\n    scopes=[\"api:access\"]\n)\n\nmcp = FastMCP(name=\"Custom API\", auth=verifier)\n```\n\n**Use Cases:**\n\n- **Testing**: Accept any token during integration tests without setting up token infrastructure\n- **Prototyping**: Quickly validate concepts without authentication complexity\n- **Opaque tokens without introspection**: When you have tokens from an IDP that provides no introspection endpoint, and you're willing to accept tokens without validation (validation happens later at the upstream service)\n- **Custom token formats**: Implement validation for non-standard token formats or legacy systems\n\n<Warning>\n`DebugTokenVerifier` bypasses standard security checks. Only use in controlled environments (development, testing) or when you fully understand the security implications. For production, use proper JWT or introspection-based verification.\n</Warning>\n\n### Test Token Generation\n\nTest token generation helps when you need to test JWT verification without setting up complete identity infrastructure. FastMCP includes utilities for generating test key pairs and signed tokens.\n\n```python\nfrom fastmcp.server.auth.providers.jwt import JWTVerifier, RSAKeyPair\n\n# Generate a key pair for testing\nkey_pair = RSAKeyPair.generate()\n\n# Configure your server with the public key\nverifier = JWTVerifier(\n    public_key=key_pair.public_key,\n    issuer=\"https://test.yourcompany.com\",\n    audience=\"test-mcp-server\"\n)\n\n# Generate a test token using the private key\ntest_token = key_pair.create_token(\n    subject=\"test-user-123\",\n    issuer=\"https://test.yourcompany.com\", \n    audience=\"test-mcp-server\",\n    scopes=[\"read\", \"write\", \"admin\"]\n)\n\nprint(f\"Test token: {test_token}\")\n```\n\nThis pattern enables comprehensive testing of JWT validation logic without depending on external token issuers. The generated tokens are cryptographically valid and will pass all standard JWT validation checks.\n\n## Environment Configuration\n\n<VersionBadge version=\"2.12.1\" />\n\nFastMCP supports both programmatic and environment-based configuration for token verification, enabling flexible deployment across different environments.\n\nEnvironment-based configuration separates authentication settings from application code, following twelve-factor app principles and simplifying deployment pipelines.\n\n```bash\n# Enable JWT verification\nexport FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.jwt.JWTVerifier\n\n# For asymmetric verification with JWKS endpoint:\nexport FASTMCP_SERVER_AUTH_JWT_JWKS_URI=\"https://auth.company.com/.well-known/jwks.json\"\nexport FASTMCP_SERVER_AUTH_JWT_ISSUER=\"https://auth.company.com\"\nexport FASTMCP_SERVER_AUTH_JWT_AUDIENCE=\"mcp-production-api\"\nexport FASTMCP_SERVER_AUTH_JWT_REQUIRED_SCOPES=\"read:data,write:data\"\n\n# OR for symmetric key verification (HMAC):\nexport FASTMCP_SERVER_AUTH_JWT_PUBLIC_KEY=\"your-shared-secret-key-minimum-32-chars\"\nexport FASTMCP_SERVER_AUTH_JWT_ALGORITHM=\"HS256\"  # or HS384, HS512\nexport FASTMCP_SERVER_AUTH_JWT_ISSUER=\"internal-auth-service\"\nexport FASTMCP_SERVER_AUTH_JWT_AUDIENCE=\"mcp-internal-api\"\n```\n\nWith these environment variables configured, your FastMCP server automatically enables JWT verification:\n\n```python\nfrom fastmcp import FastMCP\n\n# Authentication automatically configured from environment\nmcp = FastMCP(name=\"Production API\")\n```\n\nThis approach enables the same codebase to run across development, staging, and production environments with different authentication requirements. Development might use static tokens while production uses JWT verification, all controlled through environment configuration.\n\n"}, {"filename": "docs/servers/composition.mdx", "content": "---\ntitle: Server Composition\nsidebarTitle: Composition\ndescription: Combine multiple FastMCP servers into a single, larger application using mounting and importing.\nicon: puzzle-piece\n---\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.2.0\" />\n\nAs your MCP applications grow, you might want to organize your tools, resources, and prompts into logical modules or reuse existing server components. FastMCP supports composition through two methods:\n\n- **`import_server`**: For a one-time copy of components with prefixing (static composition).\n- **`mount`**: For creating a live link where the main server delegates requests to the subserver (dynamic composition).\n\n## Why Compose Servers?\n\n-   **Modularity**: Break down large applications into smaller, focused servers (e.g., a `WeatherServer`, a `DatabaseServer`, a `CalendarServer`).\n-   **Reusability**: Create common utility servers (e.g., a `TextProcessingServer`) and mount them wherever needed.\n-   **Teamwork**: Different teams can work on separate FastMCP servers that are later combined.\n-   **Organization**: Keep related functionality grouped together logically.\n\n### Importing vs Mounting\n\nThe choice of importing or mounting depends on your use case and requirements.\n\n| Feature | Importing | Mounting |\n|---------|----------------|---------|\n| **Method** | `FastMCP.import_server(server, prefix=None)` | `FastMCP.mount(server, prefix=None)` |\n| **Composition Type** | One-time copy (static) | Live link (dynamic) |\n| **Updates** | Changes to subserver NOT reflected | Changes to subserver immediately reflected |\n| **Performance** | Fast - no runtime delegation | Slower - affected by slowest mounted server |\n| **Prefix** | Optional - omit for original names | Optional - omit for original names |\n| **Best For** | Bundling finalized components, performance-critical setups | Modular runtime composition |\n\n### Proxy Servers\n\nFastMCP supports [MCP proxying](/servers/proxy), which allows you to mirror a local or remote server in a local FastMCP instance. Proxies are fully compatible with both importing and mounting.\n\n<VersionBadge version=\"2.4.0\" />\n\nYou can also create proxies from configuration dictionaries that follow the MCPConfig schema, which is useful for quickly connecting to one or more remote servers. See the [Proxy Servers documentation](/servers/proxy#configuration-based-proxies) for details on configuration-based proxying. Note that MCPConfig follows an emerging standard and its format may evolve over time.\n\nPrefixing rules for tools, prompts, resources, and templates are identical across importing, mounting, and proxies. When prefixes are used, resource URIs are prefixed using path format (since 2.4.0): `resource://prefix/path/to/resource`.\n\n## Importing (Static Composition)\n\nThe `import_server()` method copies all components (tools, resources, templates, prompts) from one `FastMCP` instance (the *subserver*) into another (the *main server*). An optional `prefix` can be provided to avoid naming conflicts. If no prefix is provided, components are imported without modification. When multiple servers are imported with the same prefix (or no prefix), the most recently imported server's components take precedence.\n\n```python\nfrom fastmcp import FastMCP\nimport asyncio\n\n# Define subservers\nweather_mcp = FastMCP(name=\"WeatherService\")\n\n@weather_mcp.tool\ndef get_forecast(city: str) -> dict:\n    \"\"\"Get weather forecast.\"\"\"\n    return {\"city\": city, \"forecast\": \"Sunny\"}\n\n@weather_mcp.resource(\"data://cities/supported\")\ndef list_supported_cities() -> list[str]:\n    \"\"\"List cities with weather support.\"\"\"\n    return [\"London\", \"Paris\", \"Tokyo\"]\n\n# Define main server\nmain_mcp = FastMCP(name=\"MainApp\")\n\n# Import subserver\nasync def setup():\n    await main_mcp.import_server(weather_mcp, prefix=\"weather\")\n\n# Result: main_mcp now contains prefixed components:\n# - Tool: \"weather_get_forecast\"\n# - Resource: \"data://weather/cities/supported\" \n\nif __name__ == \"__main__\":\n    asyncio.run(setup())\n    main_mcp.run()\n```\n\n### How Importing Works\n\nWhen you call `await main_mcp.import_server(subserver, prefix={whatever})`:\n\n1.  **Tools**: All tools from `subserver` are added to `main_mcp` with names prefixed using `{prefix}_`.\n    -   `subserver.tool(name=\"my_tool\")` becomes `main_mcp.tool(name=\"{prefix}_my_tool\")`.\n2.  **Resources**: All resources are added with both URIs and names prefixed.\n    -   URI: `subserver.resource(uri=\"data://info\")` becomes `main_mcp.resource(uri=\"data://{prefix}/info\")`.\n    -   Name: `resource.name` becomes `\"{prefix}_{resource.name}\"`.\n3.  **Resource Templates**: Templates are prefixed similarly to resources.\n    -   URI: `subserver.resource(uri=\"data://{id}\")` becomes `main_mcp.resource(uri=\"data://{prefix}/{id}\")`.\n    -   Name: `template.name` becomes `\"{prefix}_{template.name}\"`.\n4.  **Prompts**: All prompts are added with names prefixed using `{prefix}_`.\n    -   `subserver.prompt(name=\"my_prompt\")` becomes `main_mcp.prompt(name=\"{prefix}_my_prompt\")`.\n\nNote that `import_server` performs a **one-time copy** of components. Changes made to the `subserver` *after* importing **will not** be reflected in `main_mcp`. The `subserver`'s `lifespan` context is also **not** executed by the main server.\n\n<Tip>\nThe `prefix` parameter is optional. If omitted, components are imported without modification.\n</Tip>\n\n#### Importing Without Prefixes\n\n<VersionBadge version=\"2.9.0\" />\n\nYou can also import servers without specifying a prefix, which copies components using their original names:\n\n```python\n\nfrom fastmcp import FastMCP\nimport asyncio\n\n# Define subservers\nweather_mcp = FastMCP(name=\"WeatherService\")\n\n@weather_mcp.tool\ndef get_forecast(city: str) -> dict:\n    \"\"\"Get weather forecast.\"\"\"\n    return {\"city\": city, \"forecast\": \"Sunny\"}\n\n@weather_mcp.resource(\"data://cities/supported\")\ndef list_supported_cities() -> list[str]:\n    \"\"\"List cities with weather support.\"\"\"\n    return [\"London\", \"Paris\", \"Tokyo\"]\n\n# Define main server\nmain_mcp = FastMCP(name=\"MainApp\")\n\n# Import subserver\nasync def setup():\n    # Import without prefix - components keep original names\n    await main_mcp.import_server(weather_mcp)\n\n# Result: main_mcp now contains:\n# - Tool: \"get_forecast\" (original name preserved)\n# - Resource: \"data://cities/supported\" (original URI preserved)\n\nif __name__ == \"__main__\":\n    asyncio.run(setup())\n    main_mcp.run()\n```\n\n#### Conflict Resolution\n\n<VersionBadge version=\"2.9.0\" />\n\nWhen importing multiple servers with the same prefix, or no prefix, components from the **most recently imported** server take precedence.\n\n\n\n\n## Mounting (Live Linking)\n\nThe `mount()` method creates a **live link** between the `main_mcp` server and the `subserver`. Instead of copying components, requests for components matching the optional `prefix` are **delegated** to the `subserver` at runtime. If no prefix is provided, the subserver's components are accessible without prefixing. When multiple servers are mounted with the same prefix (or no prefix), the most recently mounted server takes precedence for conflicting component names.\n\n```python\nimport asyncio\nfrom fastmcp import FastMCP, Client\n\n# Define subserver\ndynamic_mcp = FastMCP(name=\"DynamicService\")\n\n@dynamic_mcp.tool\ndef initial_tool():\n    \"\"\"Initial tool demonstration.\"\"\"\n    return \"Initial Tool Exists\"\n\n# Mount subserver (synchronous operation)\nmain_mcp = FastMCP(name=\"MainAppLive\")\nmain_mcp.mount(dynamic_mcp, prefix=\"dynamic\")\n\n# Add a tool AFTER mounting - it will be accessible through main_mcp\n@dynamic_mcp.tool\ndef added_later():\n    \"\"\"Tool added after mounting.\"\"\"\n    return \"Tool Added Dynamically!\"\n\n# Testing access to mounted tools\nasync def test_dynamic_mount():\n    tools = await main_mcp.get_tools()\n    print(\"Available tools:\", list(tools.keys()))\n    # Shows: ['dynamic_initial_tool', 'dynamic_added_later']\n    \n    async with Client(main_mcp) as client:\n        result = await client.call_tool(\"dynamic_added_later\")\n        print(\"Result:\", result.data)\n        # Shows: \"Tool Added Dynamically!\"\n\nif __name__ == \"__main__\":\n    asyncio.run(test_dynamic_mount())\n```\n\n### How Mounting Works\n\nWhen mounting is configured:\n\n1. **Live Link**: The parent server establishes a connection to the mounted server.\n2. **Dynamic Updates**: Changes to the mounted server are immediately reflected when accessed through the parent.\n3. **Prefixed Access**: The parent server uses prefixes to route requests to the mounted server.\n4. **Delegation**: Requests for components matching the prefix are delegated to the mounted server at runtime.\n\nThe same prefixing rules apply as with `import_server` for naming tools, resources, templates, and prompts. This includes prefixing both the URIs/keys and the names of resources and templates for better identification in multi-server configurations.\n\n<Tip>\n    The `prefix` parameter is optional. If omitted, components are mounted without modification.\n</Tip>\n\n<Note>\nWhen mounting servers, custom HTTP routes defined with `@server.custom_route()` are also forwarded to the parent server, making them accessible through the parent's HTTP application.\n</Note>\n\n#### Performance Considerations\n\nDue to the \"live link\", operations like `list_tools()` on the parent server will be impacted by the speed of the slowest mounted server. In particular, HTTP-based mounted servers can introduce significant latency (300-400ms vs 1-2ms for local tools), and this slowdown affects the whole server, not just interactions with the HTTP-proxied tools. If performance is important, importing tools via [`import_server()`](#importing-static-composition) may be a more appropriate solution as it copies components once at startup rather than delegating requests at runtime.\n\n#### Mounting Without Prefixes\n\n<VersionBadge version=\"2.9.0\" />\n\nYou can also mount servers without specifying a prefix, which makes components accessible without prefixing. This works identically to [importing without prefixes](#importing-without-prefixes), including [conflict resolution](#conflict-resolution).\n\n\n\n\n### Direct vs. Proxy Mounting\n\n<VersionBadge version=\"2.2.7\" />\n\nFastMCP supports two mounting modes:\n\n1. **Direct Mounting** (default): The parent server directly accesses the mounted server's objects in memory.\n   - No client lifecycle events occur on the mounted server\n   - The mounted server's lifespan context is not executed\n   - Communication is handled through direct method calls\n   \n2. **Proxy Mounting**: The parent server treats the mounted server as a separate entity and communicates with it through a client interface.\n   - Full client lifecycle events occur on the mounted server\n   - The mounted server's lifespan is executed when a client connects\n   - Communication happens via an in-memory Client transport\n\n```python\n# Direct mounting (default when no custom lifespan)\nmain_mcp.mount(api_server, prefix=\"api\")\n\n# Proxy mounting (preserves full client lifecycle)\nmain_mcp.mount(api_server, prefix=\"api\", as_proxy=True)\n\n# Mounting without a prefix (components accessible without prefixing)\nmain_mcp.mount(api_server)\n```\n\nFastMCP automatically uses proxy mounting when the mounted server has a custom lifespan, but you can override this behavior with the `as_proxy` parameter.\n\n#### Interaction with Proxy Servers\n\nWhen using `FastMCP.as_proxy()` to create a proxy server, mounting that server will always use proxy mounting:\n\n```python\n# Create a proxy for a remote server\nremote_proxy = FastMCP.as_proxy(Client(\"http://example.com/mcp\"))\n\n# Mount the proxy (always uses proxy mounting)\nmain_server.mount(remote_proxy, prefix=\"remote\")\n```\n\n\n\n## Tag Filtering with Composition\n\n<VersionBadge version=\"2.9.0\" />\n\nWhen using `include_tags` or `exclude_tags` on a parent server, these filters apply **recursively** to all components, including those from mounted or imported servers. This allows you to control which components are exposed at the parent level, regardless of how your application is composed.\n\n```python\nimport asyncio\nfrom fastmcp import FastMCP, Client\n\n# Create a subserver with tools tagged for different environments\napi_server = FastMCP(name=\"APIServer\")\n\n@api_server.tool(tags={\"production\"})\ndef prod_endpoint() -> str:\n    \"\"\"Production-ready endpoint.\"\"\"\n    return \"Production data\"\n\n@api_server.tool(tags={\"development\"})\ndef dev_endpoint() -> str:\n    \"\"\"Development-only endpoint.\"\"\"\n    return \"Debug data\"\n\n# Mount the subserver with production tag filtering at parent level\nprod_app = FastMCP(name=\"ProductionApp\", include_tags={\"production\"})\nprod_app.mount(api_server, prefix=\"api\")\n\n# Test the filtering\nasync def test_filtering():\n    async with Client(prod_app) as client:\n        tools = await client.list_tools()\n        print(\"Available tools:\", [t.name for t in tools])\n        # Shows: ['api_prod_endpoint']\n        # The 'api_dev_endpoint' is filtered out\n\n        # Calling the filtered tool raises an error\n        try:\n            await client.call_tool(\"api_dev_endpoint\")\n        except Exception as e:\n            print(f\"Filtered tool not accessible: {e}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(test_filtering())\n```\n\n### How Recursive Filtering Works\n\nTag filters apply in the following order:\n\n1. **Child Server Filters**: Each mounted/imported server first applies its own `include_tags`/`exclude_tags` to its components.\n2. **Parent Server Filters**: The parent server then applies its own `include_tags`/`exclude_tags` to all components, including those from child servers.\n\nThis ensures that parent server tag policies act as a global policy for everything the parent server exposes, no matter how your application is composed.\n\n<Note>\nThis filtering applies to both **listing** (e.g., `list_tools()`) and **execution** (e.g., `call_tool()`). Filtered components are neither visible nor executable through the parent server.\n</Note>\n"}, {"filename": "docs/servers/context.mdx", "content": "---\ntitle: MCP Context\nsidebarTitle: Context\ndescription: Access MCP capabilities like logging, progress, and resources within your MCP objects.\nicon: rectangle-code\n---\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\nWhen defining FastMCP [tools](/servers/tools), [resources](/servers/resources), resource templates, or [prompts](/servers/prompts), your functions might need to interact with the underlying MCP session or access advanced server capabilities. FastMCP provides the `Context` object for this purpose.\n\n<Note>\nFastMCP uses [Docket](https://github.com/chrisguidry/docket)'s dependency injection system for managing runtime dependencies. This page covers Context and the built-in dependencies; see [Custom Dependencies](#custom-dependencies) for creating your own.\n</Note>\n\n## What Is Context?\n\nThe `Context` object provides a clean interface to access MCP features within your functions, including:\n\n- **Logging**: Send debug, info, warning, and error messages back to the client\n- **Progress Reporting**: Update the client on the progress of long-running operations\n- **Resource Access**: List and read data from resources registered with the server\n- **Prompt Access**: List and retrieve prompts registered with the server\n- **LLM Sampling**: Request the client's LLM to generate text based on provided messages\n- **User Elicitation**: Request structured input from users during tool execution\n- **State Management**: Store and share data between middleware and the handler within a single request\n- **Request Information**: Access metadata about the current request\n- **Server Access**: When needed, access the underlying FastMCP server instance\n\n## Accessing the Context\n\n<VersionBadge version=\"2.14\" />\n\nThe preferred way to access context is using the `CurrentContext()` dependency:\n\n```python {1, 6}\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import CurrentContext\nfrom fastmcp.server.context import Context\n\nmcp = FastMCP(name=\"Context Demo\")\n\n@mcp.tool\nasync def process_file(file_uri: str, ctx: Context = CurrentContext()) -> str:\n    \"\"\"Processes a file, using context for logging and resource access.\"\"\"\n    await ctx.info(f\"Processing {file_uri}\")\n    return \"Processed file\"\n```\n\nThis works with tools, resources, and prompts:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import CurrentContext\nfrom fastmcp.server.context import Context\n\nmcp = FastMCP(name=\"Context Demo\")\n\n@mcp.resource(\"resource://user-data\")\nasync def get_user_data(ctx: Context = CurrentContext()) -> dict:\n    await ctx.debug(\"Fetching user data\")\n    return {\"user_id\": \"example\"}\n\n@mcp.prompt\nasync def data_analysis_request(dataset: str, ctx: Context = CurrentContext()) -> str:\n    return f\"Please analyze the following dataset: {dataset}\"\n```\n\n**Key Points:**\n\n- Dependency parameters are automatically excluded from the MCP schema\u2014clients never see them.\n- Context methods are async, so your function usually needs to be async as well.\n- **Each MCP request receives a new context object.** Context is scoped to a single request; state or data set in one request will not be available in subsequent requests.\n- Context is only available during a request; attempting to use context methods outside a request will raise errors.\n\n### Legacy Type-Hint Injection\n\nFor backwards compatibility, you can still access context by simply adding a parameter with the `Context` type hint. FastMCP will automatically inject the context instance:\n\n```python {1, 6}\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(name=\"Context Demo\")\n\n@mcp.tool\nasync def process_file(file_uri: str, ctx: Context) -> str:\n    \"\"\"Processes a file, using context for logging and resource access.\"\"\"\n    # Context is injected automatically based on the type hint\n    return \"Processed file\"\n```\n\nThis approach still works for tools, resources, and prompts. The parameter name doesn't matter\u2014only the `Context` type hint is important. The type hint can also be a union (`Context | None`) or use `Annotated[]`.\n\n### Via `get_context()` Function\n\n<VersionBadge version=\"2.2.11\" />\n\nFor code nested deeper within your function calls where passing context through parameters is inconvenient, use `get_context()` to retrieve the active context from anywhere within a request's execution flow:\n\n```python {2,9}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_context\n\nmcp = FastMCP(name=\"Dependency Demo\")\n\n# Utility function that needs context but doesn't receive it as a parameter\nasync def process_data(data: list[float]) -> dict:\n    # Get the active context - only works when called within a request\n    ctx = get_context()\n    await ctx.info(f\"Processing {len(data)} data points\")\n\n@mcp.tool\nasync def analyze_dataset(dataset_name: str) -> dict:\n    # Call utility function that uses context internally\n    data = load_data(dataset_name)\n    await process_data(data)\n```\n\n**Important Notes:**\n\n- The `get_context()` function should only be used within the context of a server request. Calling it outside of a request will raise a `RuntimeError`.\n- The `get_context()` function is server-only and should not be used in client code.\n\n## Context Capabilities\n\nFastMCP provides several advanced capabilities through the context object. Each capability has dedicated documentation with comprehensive examples and best practices:\n\n### Logging\n\nSend debug, info, warning, and error messages back to the MCP client for visibility into function execution.\n\n```python\nawait ctx.debug(\"Starting analysis\")\nawait ctx.info(f\"Processing {len(data)} items\") \nawait ctx.warning(\"Deprecated parameter used\")\nawait ctx.error(\"Processing failed\")\n```\n\nSee [Server Logging](/servers/logging) for complete documentation and examples.\n### Client Elicitation\n\n<VersionBadge version=\"2.10.0\" />\n\nRequest structured input from clients during tool execution, enabling interactive workflows and progressive disclosure. This is a new feature in the 6/18/2025 MCP spec.\n\n```python\nresult = await ctx.elicit(\"Enter your name:\", response_type=str)\nif result.action == \"accept\":\n    name = result.data\n```\n\nSee [User Elicitation](/servers/elicitation) for detailed examples and supported response types.\n\n### LLM Sampling\n\n<VersionBadge version=\"2.0.0\" />\n\nRequest the client's LLM to generate text based on provided messages, useful for leveraging AI capabilities within your tools.\n\n```python\nresponse = await ctx.sample(\"Analyze this data\", temperature=0.7)\n```\n\nSee [LLM Sampling](/servers/sampling) for comprehensive usage and advanced techniques.\n\n\n### Progress Reporting\n\nUpdate clients on the progress of long-running operations, enabling progress indicators and better user experience.\n\n```python\nawait ctx.report_progress(progress=50, total=100)  # 50% complete\n```\n\nSee [Progress Reporting](/servers/progress) for detailed patterns and examples.\n\n### Resource Access\n\nList and read data from resources registered with your FastMCP server, allowing access to files, configuration, or dynamic content.\n\n```python\n# List available resources\nresources = await ctx.list_resources()\n\n# Read a specific resource\ncontent_list = await ctx.read_resource(\"resource://config\")\ncontent = content_list[0].content\n```\n\n**Method signatures:**\n- **`ctx.list_resources() -> list[MCPResource]`**: <VersionBadge version=\"2.13.0\" /> Returns list of all available resources\n- **`ctx.read_resource(uri: str | AnyUrl) -> list[ReadResourceContents]`**: Returns a list of resource content parts\n\n### Prompt Access\n\n<VersionBadge version=\"2.13.0\" />\n\nList and retrieve prompts registered with your FastMCP server, allowing tools and middleware to discover and use available prompts programmatically.\n\n```python\n# List available prompts\nprompts = await ctx.list_prompts()\n\n# Get a specific prompt with arguments\nresult = await ctx.get_prompt(\"analyze_data\", {\"dataset\": \"users\"})\nmessages = result.messages\n```\n\n**Method signatures:**\n- **`ctx.list_prompts() -> list[MCPPrompt]`**: Returns list of all available prompts\n- **`ctx.get_prompt(name: str, arguments: dict[str, Any] | None = None) -> GetPromptResult`**: Get a specific prompt with optional arguments\n\n### State Management\n\n<VersionBadge version=\"2.11.0\" />\n\nStore and share data between middleware and handlers within a single MCP request. Each MCP request (such as calling a tool, reading a resource, listing tools, or listing resources) receives its own context object with isolated state. Context state is particularly useful for passing information from [middleware](/servers/middleware) to your handlers.\n\nTo store a value in the context state, use `ctx.set_state(key, value)`. To retrieve a value, use `ctx.get_state(key)`.\n\n<Warning>\nContext state is scoped to a single MCP request. Each operation (tool call, resource read, list operation, etc.) receives a new context object. State set during one request will not be available in subsequent requests. For persistent data storage across requests, use external storage mechanisms like databases, files, or in-memory caches.\n</Warning>\n\nThis simplified example shows how to use MCP middleware to store user info in the context state, and how to access that state in a tool:\n\n```python {7-8, 16-17}\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass UserAuthMiddleware(Middleware):\n    async def on_call_tool(self, context: MiddlewareContext, call_next):\n\n        # Middleware stores user info in context state\n        context.fastmcp_context.set_state(\"user_id\", \"user_123\")\n        context.fastmcp_context.set_state(\"permissions\", [\"read\", \"write\"])\n\n        return await call_next(context)\n\n@mcp.tool\nasync def secure_operation(data: str, ctx: Context) -> str:\n    \"\"\"Tool can access state set by middleware.\"\"\"\n\n    user_id = ctx.get_state(\"user_id\")  # \"user_123\"\n    permissions = ctx.get_state(\"permissions\")  # [\"read\", \"write\"]\n    \n    if \"write\" not in permissions:\n        return \"Access denied\"\n    \n    return f\"Processing {data} for user {user_id}\"\n```\n\n**Method signatures:**\n- **`ctx.set_state(key: str, value: Any) -> None`**: Store a value in the context state\n- **`ctx.get_state(key: str) -> Any`**: Retrieve a value from the context state (returns None if not found)\n\n**State Inheritance:**\nWhen a new context is created (nested contexts), it inherits a copy of its parent's state. This ensures that:\n- State set on a child context never affects the parent context\n- State set on a parent context after the child context is initialized is not propagated to the child context\n\nThis makes state management predictable and prevents unexpected side effects between nested operations.\n\n### Change Notifications\n\n<VersionBadge version=\"3.0.0\" />\n\nFastMCP automatically sends list change notifications when components (such as tools, resources, or prompts) are added, removed, enabled, or disabled. In rare cases where you need to manually trigger these notifications, you can use the context's notification methods:\n\n```python\nimport mcp.types\n\n@mcp.tool\nasync def custom_tool_management(ctx: Context) -> str:\n    \"\"\"Example of manual notification after custom tool changes.\"\"\"\n    # In async code, send immediately\n    await ctx.send_notification(mcp.types.ToolListChangedNotification())\n    await ctx.send_notification(mcp.types.ResourceListChangedNotification())\n    await ctx.send_notification(mcp.types.PromptListChangedNotification())\n    return \"Notifications sent\"\n\n\n@mcp.tool\ndef sync_tool(ctx: Context) -> str:\n    \"\"\"Example of notification from sync code.\"\"\"\n    # In sync code, queue for background sending (~1 second delay)\n    ctx.send_notification_sync(mcp.types.ToolListChangedNotification())\n    return \"Notification queued\"\n```\n\nThese methods are primarily used internally by FastMCP's automatic notification system and most users will not need to invoke them directly.\n\n### FastMCP Server\n\nTo access the underlying FastMCP server instance, you can use the `ctx.fastmcp` property:\n\n```python\n@mcp.tool\nasync def my_tool(ctx: Context) -> None:\n    # Access the FastMCP server instance\n    server_name = ctx.fastmcp.name\n    ...\n```\n\n### MCP Request\n\nAccess metadata about the current request and client.\n\n```python\n@mcp.tool\nasync def request_info(ctx: Context) -> dict:\n    \"\"\"Return information about the current request.\"\"\"\n    return {\n        \"request_id\": ctx.request_id,\n        \"client_id\": ctx.client_id or \"Unknown client\"\n    }\n```\n\n**Available Properties:**\n\n- **`ctx.request_id -> str`**: Get the unique ID for the current MCP request\n- **`ctx.client_id -> str | None`**: Get the ID of the client making the request, if provided during initialization\n- **`ctx.session_id -> str | None`**: Get the MCP session ID for session-based data sharing (HTTP transports only)\n\n#### Request Context Availability\n\n<VersionBadge version=\"2.13.1\" />\n\nThe `ctx.request_context` property provides access to the underlying MCP request context, but returns `None` when the MCP session has not been established yet. This typically occurs:\n\n- During middleware execution in the `on_request` hook before the MCP handshake completes\n- During the initialization phase of client connections\n\nThe MCP request context is distinct from the HTTP request. For HTTP transports, HTTP request data may be available even when the MCP session is not yet established.\n\nTo safely access the request context in situations where it may not be available:\n\n```python\nfrom fastmcp import FastMCP, Context\nfrom fastmcp.server.dependencies import get_http_request\n\nmcp = FastMCP(name=\"Session Aware Demo\")\n\n@mcp.tool\nasync def session_info(ctx: Context) -> dict:\n    \"\"\"Return session information when available.\"\"\"\n\n    # Check if MCP session is available\n    if ctx.request_context:\n        # MCP session available - can access MCP-specific attributes\n        return {\n            \"session_id\": ctx.session_id,\n            \"request_id\": ctx.request_id,\n            \"has_meta\": ctx.request_context.meta is not None\n        }\n    else:\n        # MCP session not available - use HTTP helpers for request data (if using HTTP transport)\n        request = get_http_request()\n        return {\n            \"message\": \"MCP session not available\",\n            \"user_agent\": request.headers.get(\"user-agent\", \"Unknown\")\n        }\n```\n\nFor HTTP request access that works regardless of MCP session availability (when using HTTP transports), use the [HTTP request helpers](#http-requests) like `get_http_request()` and `get_http_headers()`.\n\n#### Client Metadata\n\n<VersionBadge version=\"2.13.1\" />\n\nClients can send contextual information with their requests using the `meta` parameter. This metadata is accessible through `ctx.request_context.meta` and is available for all MCP operations (tools, resources, prompts).\n\nThe `meta` field is `None` when clients don't provide metadata. When provided, metadata is accessible via attribute access (e.g., `meta.user_id`) rather than dictionary access. The structure of metadata is determined by the client making the request.\n\n```python\n@mcp.tool\ndef send_email(to: str, subject: str, body: str, ctx: Context) -> str:\n    \"\"\"Send an email, logging metadata about the request.\"\"\"\n\n    # Access client-provided metadata\n    meta = ctx.request_context.meta\n\n    if meta:\n        # Meta is accessed as an object with attribute access\n        user_id = meta.user_id if hasattr(meta, 'user_id') else None\n        trace_id = meta.trace_id if hasattr(meta, 'trace_id') else None\n\n        # Use metadata for logging, observability, etc.\n        if trace_id:\n            log_with_trace(f\"Sending email for user {user_id}\", trace_id)\n\n    # Send the email...\n    return f\"Email sent to {to}\"\n```\n\n<Warning>\nThe MCP request is part of the low-level MCP SDK and intended for advanced use cases. Most users will not need to use it directly.\n</Warning>\n\n## Runtime Dependencies\n\n### HTTP Requests\n\n<VersionBadge version=\"2.2.11\" />\n\nThe recommended way to access the current HTTP request is through the `get_http_request()` dependency function:\n\n```python {2, 3, 11}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_http_request\nfrom starlette.requests import Request\n\nmcp = FastMCP(name=\"HTTP Request Demo\")\n\n@mcp.tool\nasync def user_agent_info() -> dict:\n    \"\"\"Return information about the user agent.\"\"\"\n    # Get the HTTP request\n    request: Request = get_http_request()\n    \n    # Access request data\n    user_agent = request.headers.get(\"user-agent\", \"Unknown\")\n    client_ip = request.client.host if request.client else \"Unknown\"\n    \n    return {\n        \"user_agent\": user_agent,\n        \"client_ip\": client_ip,\n        \"path\": request.url.path,\n    }\n```\n\nThis approach works anywhere within a request's execution flow, not just within your MCP function. It's useful when:\n\n1. You need access to HTTP information in helper functions\n2. You're calling nested functions that need HTTP request data\n3. You're working with middleware or other request processing code\n\n### HTTP Headers\n<VersionBadge version=\"2.2.11\" />\n\nIf you only need request headers and want to avoid potential errors, you can use the `get_http_headers()` helper:\n\n```python {2, 10}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_http_headers\n\nmcp = FastMCP(name=\"Headers Demo\")\n\n@mcp.tool\nasync def safe_header_info() -> dict:\n    \"\"\"Safely get header information without raising errors.\"\"\"\n    # Get headers (returns empty dict if no request context)\n    headers = get_http_headers()\n    \n    # Get authorization header\n    auth_header = headers.get(\"authorization\", \"\")\n    is_bearer = auth_header.startswith(\"Bearer \")\n    \n    return {\n        \"user_agent\": headers.get(\"user-agent\", \"Unknown\"),\n        \"content_type\": headers.get(\"content-type\", \"Unknown\"),\n        \"has_auth\": bool(auth_header),\n        \"auth_type\": \"Bearer\" if is_bearer else \"Other\" if auth_header else \"None\",\n        \"headers_count\": len(headers)\n    }\n```\n\nBy default, `get_http_headers()` excludes problematic headers like `host` and `content-length`. To include all headers, use `get_http_headers(include_all=True)`.\n\n### Access Tokens\n\n<VersionBadge version=\"2.11.0\" />\n\nWhen using authentication with your FastMCP server, you can access the authenticated user's access token information using the `get_access_token()` dependency function:\n\n```python {2, 10}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_access_token, AccessToken\n\nmcp = FastMCP(name=\"Auth Token Demo\")\n\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Get information about the authenticated user.\"\"\"\n    # Get the access token (None if not authenticated)\n    token: AccessToken | None = get_access_token()\n    \n    if token is None:\n        return {\"authenticated\": False}\n    \n    return {\n        \"authenticated\": True,\n        \"client_id\": token.client_id,\n        \"scopes\": token.scopes,\n        \"expires_at\": token.expires_at,\n        \"token_claims\": token.claims,  # JWT claims or custom token data\n    }\n```\n\nThis is particularly useful when you need to:\n\n1. **Access user identification** - Get the `client_id` or subject from token claims\n2. **Check permissions** - Verify scopes or custom claims before performing operations\n3. **Multi-tenant applications** - Extract tenant information from token claims\n4. **Audit logging** - Track which user performed which actions\n\n#### Working with Token Claims\n\nThe `claims` field contains all the data from the original token (JWT claims for JWT tokens, or custom data for other token types):\n\n```python {2, 3, 9, 12, 15}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.dependencies import get_access_token\n\nmcp = FastMCP(name=\"Multi-tenant Demo\")\n\n@mcp.tool\nasync def get_tenant_data(resource_id: str) -> dict:\n    \"\"\"Get tenant-specific data using token claims.\"\"\"\n    token: AccessToken | None = get_access_token()\n    \n    # Extract tenant ID from token claims\n    tenant_id = token.claims.get(\"tenant_id\") if token else None\n    \n    # Extract user ID from standard JWT subject claim\n    user_id = token.claims.get(\"sub\") if token else None\n    \n    # Use tenant and user info to authorize and filter data\n    if not tenant_id:\n        raise ValueError(\"No tenant information in token\")\n    \n    return {\n        \"resource_id\": resource_id,\n        \"tenant_id\": tenant_id,\n        \"user_id\": user_id,\n        \"data\": f\"Tenant-specific data for {tenant_id}\",\n    }\n```\n\n## Custom Dependencies\n\n<VersionBadge version=\"2.14\" />\n\nFastMCP's dependency injection is powered by [Docket](https://github.com/chrisguidry/docket), which provides a flexible system for injecting values into your functions. Beyond the built-in dependencies like `CurrentContext()`, you can create your own.\n\n### Using `Depends()`\n\nThe simplest way to create a custom dependency is with `Depends()`. Pass any callable (sync or async function, or async context manager) and its return value will be injected:\n\n```python\nfrom contextlib import asynccontextmanager\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Depends\n\nmcp = FastMCP(name=\"Custom Deps Demo\")\n\n# Simple function dependency\ndef get_config() -> dict:\n    return {\"api_url\": \"https://api.example.com\", \"timeout\": 30}\n\n# Async function dependency\nasync def get_user_id() -> int:\n    return 42\n\n@mcp.tool\nasync def fetch_data(\n    query: str,\n    config: dict = Depends(get_config),\n    user_id: int = Depends(get_user_id),\n) -> str:\n    return f\"User {user_id} fetching '{query}' from {config['api_url']}\"\n```\n\nDependencies using `Depends()` are automatically excluded from the MCP schema\u2014clients never see them as parameters.\n\n### Resource Management with Context Managers\n\nFor dependencies that need cleanup (database connections, file handles, etc.), use an async context manager:\n\n```python\nfrom contextlib import asynccontextmanager\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Depends\n\nmcp = FastMCP(name=\"Resource Demo\")\n\n@asynccontextmanager\nasync def get_database():\n    db = await connect_to_database()\n    try:\n        yield db\n    finally:\n        await db.close()\n\n@mcp.tool\nasync def query_users(sql: str, db = Depends(get_database)) -> list:\n    return await db.execute(sql)\n```\n\nThe context manager's cleanup code runs after your function completes, even if an error occurs.\n\n### Nested Dependencies\n\nDependencies can depend on other dependencies:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Depends\n\nmcp = FastMCP(name=\"Nested Demo\")\n\ndef get_base_url() -> str:\n    return \"https://api.example.com\"\n\ndef get_api_client(base_url: str = Depends(get_base_url)) -> dict:\n    return {\"base_url\": base_url, \"version\": \"v1\"}\n\n@mcp.tool\nasync def call_api(endpoint: str, client: dict = Depends(get_api_client)) -> str:\n    return f\"Calling {client['base_url']}/{client['version']}/{endpoint}\"\n```\n\n### Advanced: Subclassing `Dependency`\n\nFor more complex dependency patterns\u2014like dependencies that need access to Docket's execution context or require custom lifecycle management\u2014you can subclass Docket's `Dependency` class. See the [Docket documentation on dependencies](https://chrisguidry.github.io/docket/dependencies/) for details.\n"}, {"filename": "docs/servers/elicitation.mdx", "content": "---\ntitle: User Elicitation\nsidebarTitle: Elicitation\ndescription: Request structured input from users during tool execution through the MCP context.\nicon: message-question\ntag: NEW\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.10.0\" />\n\nUser elicitation allows MCP servers to request structured input from users during tool execution. Instead of requiring all inputs upfront, tools can interactively ask for missing parameters, clarification, or additional context as needed.\n\n<Tip>\nMost of the examples in this document assume you have a FastMCP server instance named `mcp` and show how to use the `ctx.elicit` method to request user input from an `@mcp.tool`-decorated function.\n</Tip>\n\n## What is Elicitation?\n\nElicitation enables tools to pause execution and request specific information from users. This is particularly useful for:\n\n- **Missing parameters**: Ask for required information not provided initially\n- **Clarification requests**: Get user confirmation or choices for ambiguous scenarios  \n- **Progressive disclosure**: Collect complex information step-by-step\n- **Dynamic workflows**: Adapt tool behavior based on user responses\n\nFor example, a file management tool might ask \"Which directory should I create?\" or a data analysis tool might request \"What date range should I analyze?\"\n\n### Basic Usage\n\nUse the `ctx.elicit()` method within any tool function to request user input:\n\n```python {14-17}\nfrom fastmcp import FastMCP, Context\nfrom dataclasses import dataclass\n\nmcp = FastMCP(\"Elicitation Server\")\n\n@dataclass\nclass UserInfo:\n    name: str\n    age: int\n\n@mcp.tool\nasync def collect_user_info(ctx: Context) -> str:\n    \"\"\"Collect user information through interactive prompts.\"\"\"\n    result = await ctx.elicit(\n        message=\"Please provide your information\",\n        response_type=UserInfo\n    )\n    \n    if result.action == \"accept\":\n        user = result.data\n        return f\"Hello {user.name}, you are {user.age} years old\"\n    elif result.action == \"decline\":\n        return \"Information not provided\"\n    else:  # cancel\n        return \"Operation cancelled\"\n```\n\n## Method Signature\n\n<Card icon=\"code\" title=\"Context Elicitation Method\">\n<ResponseField name=\"ctx.elicit\" type=\"async method\">\n  <Expandable title=\"Parameters\">\n    <ResponseField name=\"message\" type=\"str\">\n      The prompt message to display to the user\n    </ResponseField>\n    \n    <ResponseField name=\"response_type\" type=\"type\" default=\"None\">\n      The Python type defining the expected response structure (dataclass, primitive type, etc.) Note that elicitation responses are subject to a restricted subset of JSON Schema types. See [Supported Response Types](#supported-response-types) for more details. \n    </ResponseField>\n  </Expandable>\n  \n  <Expandable title=\"Response\">\n    <ResponseField name=\"ElicitationResult\" type=\"object\">\n      Result object containing the user's response\n      \n      <Expandable title=\"properties\">\n        <ResponseField name=\"action\" type=\"Literal['accept', 'decline', 'cancel']\">\n          How the user responded to the request\n        </ResponseField>\n        \n        <ResponseField name=\"data\" type=\"response_type | None\">\n          The user's input data (only present when action is \"accept\")\n        </ResponseField>\n      </Expandable>\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n## Elicitation Actions\n\nThe elicitation result contains an `action` field indicating how the user responded:\n\n- **`accept`**: User provided valid input - data is available in the `data` field\n- **`decline`**: User chose not to provide the requested information and the data field is `None`\n- **`cancel`**: User cancelled the entire operation and the data field is `None`\n\n```python {5, 7}\n@mcp.tool\nasync def my_tool(ctx: Context) -> str:\n    result = await ctx.elicit(\"Choose an action\")\n\n    if result.action == \"accept\":\n        return \"Accepted!\"\n    elif result.action == \"decline\":\n        return \"Declined!\"\n    else:\n        return \"Cancelled!\"\n```\n\nFastMCP also provides typed result classes for pattern matching on the `action` field:\n\n```python {1-5, 12, 14, 16}\nfrom fastmcp.server.elicitation import (\n    AcceptedElicitation, \n    DeclinedElicitation, \n    CancelledElicitation,\n)\n\n@mcp.tool\nasync def pattern_example(ctx: Context) -> str:\n    result = await ctx.elicit(\"Enter your name:\", response_type=str)\n    \n    match result:\n        case AcceptedElicitation(data=name):\n            return f\"Hello {name}!\"\n        case DeclinedElicitation():\n            return \"No name provided\"\n        case CancelledElicitation():\n            return \"Operation cancelled\"\n```\n\n## Response Types\n\nThe server must send a schema to the client indicating the type of data it expects in response to the elicitation request. If the request is `accept`-ed, the client must send a response that matches the schema.\n\nThe MCP spec only supports a limited subset of JSON Schema types for elicitation responses. Specifically, it only supports JSON  **objects** with **primitive** properties including `string`, `number` (or `integer`), `boolean` and `enum` fields.\n\nFastMCP makes it easy to request a broader range of types, including scalars (e.g. `str`) or no response at all, by automatically wrapping them in MCP-compatible object schemas.\n\n\n### Scalar Types\n\nYou can request simple scalar data types for basic input, such as a string, integer, or boolean.\n\nWhen you request a scalar type, FastMCP automatically wraps it in an object schema for MCP spec compatibility. Clients will see a corresponding schema requesting a single \"value\" field of the requested type. Once clients respond, the provided object is \"unwrapped\" and the scalar value is returned to your tool function as the `data` field of the `ElicitationResult` object.\n\nAs a developer, this means you do not have to worry about creating or accessing a structured object when you only need a scalar value.\n\n<CodeGroup>\n```python {4} title=\"Request a string\"\n@mcp.tool\nasync def get_user_name(ctx: Context) -> str:\n    \"\"\"Get the user's name.\"\"\"\n    result = await ctx.elicit(\"What's your name?\", response_type=str)\n    \n    if result.action == \"accept\":\n        return f\"Hello, {result.data}!\"\n    return \"No name provided\"\n```\n```python {4} title=\"Request an integer\"\n@mcp.tool\nasync def pick_a_number(ctx: Context) -> str:\n    \"\"\"Pick a number.\"\"\"\n    result = await ctx.elicit(\"Pick a number!\", response_type=int)\n    \n    if result.action == \"accept\":\n        return f\"You picked {result.data}\"\n    return \"No number provided\"\n```\n```python {4} title=\"Request a boolean\"\n@mcp.tool\nasync def pick_a_boolean(ctx: Context) -> str:\n    \"\"\"Pick a boolean.\"\"\"\n    result = await ctx.elicit(\"True or false?\", response_type=bool)\n    \n    if result.action == \"accept\":\n        return f\"You picked {result.data}\"\n    return \"No boolean provided\"\n```\n</CodeGroup>\n\n### No Response\n\nSometimes, the goal of an elicitation is to simply get a user to approve or reject an action. In this case, you can pass `None` as the response type to indicate that no response is expected. In order to comply with the MCP spec, the client will see a schema requesting an empty object in response. In this case, the `data` field of the `ElicitationResult` object will be `None` when the user accepts the elicitation.\n\n```python {4} title=\"No response\"\n@mcp.tool\nasync def approve_action(ctx: Context) -> str:\n    \"\"\"Approve an action.\"\"\"\n    result = await ctx.elicit(\"Approve this action?\", response_type=None)\n\n    if result.action == \"accept\":\n        return do_action()\n    else:\n        raise ValueError(\"Action rejected\")\n```\n\n### Constrained Options\n\nOften you'll want to constrain the user's response to a specific set of values. You can do this by using a `Literal` type or a Python enum as the response type, or by passing a list of strings to the `response_type` parameter as a convenient shortcut.\n\n<CodeGroup>\n```python {6} title=\"Using a list of strings\"\n@mcp.tool\nasync def set_priority(ctx: Context) -> str:\n    \"\"\"Set task priority level.\"\"\"\n    result = await ctx.elicit(\n        \"What priority level?\",\n        response_type=[\"low\", \"medium\", \"high\"],\n    )\n\n    if result.action == \"accept\":\n        return f\"Priority set to: {result.data}\"\n```\n```python {1, 8} title=\"Using a Literal type\"\nfrom typing import Literal\n\n@mcp.tool\nasync def set_priority(ctx: Context) -> str:\n    \"\"\"Set task priority level.\"\"\"\n    result = await ctx.elicit(\n        \"What priority level?\",\n        response_type=Literal[\"low\", \"medium\", \"high\"]\n    )\n\n    if result.action == \"accept\":\n        return f\"Priority set to: {result.data}\"\n    return \"No priority set\"\n```\n```python {1, 11} title=\"Using a Python enum\"\nfrom enum import Enum\n\nclass Priority(Enum):\n    LOW = \"low\"\n    MEDIUM = \"medium\"\n    HIGH = \"high\"\n\n@mcp.tool\nasync def set_priority(ctx: Context) -> str:\n    \"\"\"Set task priority level.\"\"\"\n    result = await ctx.elicit(\"What priority level?\", response_type=Priority)\n\n    if result.action == \"accept\":\n        return f\"Priority set to: {result.data.value}\"\n    return \"No priority set\"\n```\n</CodeGroup>\n\n#### Multi-Select\n\n<VersionBadge version=\"2.14.0\" />\n\nEnable multi-select by wrapping your choices in an additional list level. This allows users to select multiple values from the available options.\n\n<CodeGroup>\n```python {6-8} title=\"List of a list of strings\"\n@mcp.tool\nasync def select_tags(ctx: Context) -> str:\n    \"\"\"Select multiple tags.\"\"\"\n    result = await ctx.elicit(\n        \"Choose tags\",\n        response_type=[[\"bug\", \"feature\", \"documentation\"]]  # Note: list of a list\n    )\n\n    if result.action == \"accept\":\n        tags = result.data  # List of selected strings\n        return f\"Selected tags: {', '.join(tags)}\"\n```\n\n```python {1, 3-6, 11-14} title=\"list[Enum] type annotation\"\nfrom enum import Enum\n\nclass Tag(Enum):\n    BUG = \"bug\"\n    FEATURE = \"feature\"\n    DOCS = \"documentation\"\n\n@mcp.tool\nasync def select_tags(ctx: Context) -> str:\n    result = await ctx.elicit(\n        \"Choose tags\",\n        response_type=list[Tag]  # Type annotation for multi-select\n    )\n    if result.action == \"accept\":\n        tags = [tag.value for tag in result.data]\n        return f\"Selected: {', '.join(tags)}\"\n```\n</CodeGroup>\n\nFor titled multi-select, wrap a dict in a list (see [Titled Options](#titled-options) for dict syntax):\n\n```python {6-12}\n@mcp.tool\nasync def select_priorities(ctx: Context) -> str:\n    \"\"\"Select multiple priorities.\"\"\"\n    result = await ctx.elicit(\n        \"Choose priorities\",\n        response_type=[{  # Note: list containing a dict\n            \"low\": {\"title\": \"Low Priority\"},\n            \"medium\": {\"title\": \"Medium Priority\"},\n            \"high\": {\"title\": \"High Priority\"}\n        }]\n    )\n\n    if result.action == \"accept\":\n        priorities = result.data  # List of selected strings\n        return f\"Selected: {', '.join(priorities)}\"\n```\n\n#### Titled Options\n\n<VersionBadge version=\"2.14.0\" />\n\nFor better UI display, you can provide human-readable titles for enum options. FastMCP generates SEP-1330 compliant schemas using the `oneOf` pattern with `const` and `title` fields.\n\nUse a dict to specify titles for enum values:\n\n```python {6-10}\n@mcp.tool\nasync def set_priority(ctx: Context) -> str:\n    \"\"\"Set task priority level.\"\"\"\n    result = await ctx.elicit(\n        \"What priority level?\",\n        response_type={\n            \"low\": {\"title\": \"Low Priority\"},\n            \"medium\": {\"title\": \"Medium Priority\"},\n            \"high\": {\"title\": \"High Priority\"}\n        }\n    )\n\n    if result.action == \"accept\":\n        return f\"Priority set to: {result.data}\"\n```\n\nFor multi-select with titles, wrap the dict in a list:\n\n```python {6-12}\n@mcp.tool\nasync def select_priorities(ctx: Context) -> str:\n    \"\"\"Select multiple priorities.\"\"\"\n    result = await ctx.elicit(\n        \"Choose priorities\",\n        response_type=[{  # List containing a dict for multi-select\n            \"low\": {\"title\": \"Low Priority\"},\n            \"medium\": {\"title\": \"Medium Priority\"},\n            \"high\": {\"title\": \"High Priority\"}\n        }]\n    )\n\n    if result.action == \"accept\":\n        priorities = result.data  # List of selected strings\n        return f\"Selected: {', '.join(priorities)}\"\n```\n\n### Structured Responses\n\nYou can request structured data with multiple fields by using a dataclass, typed dict, or Pydantic model as the response type. Note that the MCP spec only supports shallow objects with scalar (string, number, boolean) or enum properties.\n\n```python {1, 16, 20}\nfrom dataclasses import dataclass\nfrom typing import Literal\n\n@dataclass\nclass TaskDetails:\n    title: str\n    description: str\n    priority: Literal[\"low\", \"medium\", \"high\"]\n    due_date: str\n\n@mcp.tool\nasync def create_task(ctx: Context) -> str:\n    \"\"\"Create a new task with user-provided details.\"\"\"\n    result = await ctx.elicit(\n        \"Please provide task details\",\n        response_type=TaskDetails\n    )\n    \n    if result.action == \"accept\":\n        task = result.data\n        return f\"Created task: {task.title} (Priority: {task.priority})\"\n    return \"Task creation cancelled\"\n```\n\n### Default Values\n\n<VersionBadge version=\"2.14.0\" />\n\nYou can provide default values for elicitation fields using Pydantic's `Field(default=...)`. Clients will pre-populate form fields with these defaults, making it easier for users to provide input.\n\nDefault values are supported for all primitive types:\n- Strings: `Field(default=\"[email protected]\")`\n- Integers: `Field(default=50)`\n- Numbers: `Field(default=3.14)`\n- Booleans: `Field(default=False)`\n- Enums: `Field(default=EnumValue.A)`\n\nFields with default values are automatically marked as optional (not included in the `required` list), so users can accept the default or provide their own value.\n\n```python\nfrom pydantic import BaseModel, Field\nfrom enum import Enum\n\nclass Priority(Enum):\n    LOW = \"low\"\n    MEDIUM = \"medium\"\n    HIGH = \"high\"\n\nclass TaskDetails(BaseModel):\n    title: str = Field(description=\"Task title\")\n    description: str = Field(default=\"\", description=\"Task description\")\n    priority: Priority = Field(default=Priority.MEDIUM, description=\"Task priority\")\n\n@mcp.tool\nasync def create_task(ctx: Context) -> str:\n    result = await ctx.elicit(\"Please provide task details\", response_type=TaskDetails)\n    if result.action == \"accept\":\n        return f\"Created: {result.data.title}\"\n    return \"Task creation cancelled\"\n```\n\n## Multi-Turn Elicitation\n\nTools can make multiple elicitation calls to gather information progressively:\n\n```python {6, 11, 16-19}\n@mcp.tool\nasync def plan_meeting(ctx: Context) -> str:\n    \"\"\"Plan a meeting by gathering details step by step.\"\"\"\n    \n    # Get meeting title\n    title_result = await ctx.elicit(\"What's the meeting title?\", response_type=str)\n    if title_result.action != \"accept\":\n        return \"Meeting planning cancelled\"\n    \n    # Get duration\n    duration_result = await ctx.elicit(\"Duration in minutes?\", response_type=int)\n    if duration_result.action != \"accept\":\n        return \"Meeting planning cancelled\"\n    \n    # Get priority\n    priority_result = await ctx.elicit(\n        \"Is this urgent?\", \n        response_type=Literal[\"yes\", \"no\"]\n    )\n    if priority_result.action != \"accept\":\n        return \"Meeting planning cancelled\"\n    \n    urgent = priority_result.data == \"yes\"\n    return f\"Meeting '{title_result.data}' planned for {duration_result.data} minutes (Urgent: {urgent})\"\n```\n\n\n## Client Requirements\n\nElicitation requires the client to implement an elicitation handler. See [Client Elicitation](/clients/elicitation) for details on how clients can handle these requests.\n\nIf a client doesn't support elicitation, calls to `ctx.elicit()` will raise an error indicating that elicitation is not supported."}, {"filename": "docs/servers/icons.mdx", "content": "---\ntitle: Icons\ndescription: Add visual icons to your servers, tools, resources, and prompts\nicon: image\ntag: NEW\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.13.0\" />\n\nIcons provide visual representations for your MCP servers and components, helping client applications present better user interfaces. When displayed in MCP clients, icons help users quickly identify and navigate your server's capabilities.\n\n## Icon Format\n\nIcons use the standard MCP Icon type from the MCP protocol specification. Each icon specifies:\n\n- **src**: URL or data URI pointing to the icon image\n- **mimeType** (optional): MIME type of the image (e.g., \"image/png\", \"image/svg+xml\")\n- **sizes** (optional): Array of size descriptors (e.g., [\"48x48\"], [\"any\"])\n\n```python\nfrom mcp.types import Icon\n\nicon = Icon(\n    src=\"https://example.com/icon.png\",\n    mimeType=\"image/png\",\n    sizes=[\"48x48\"]\n)\n```\n\n## Server Icons\n\nAdd icons and a website URL to your server for display in client applications:\n\n```python\nfrom fastmcp import FastMCP\nfrom mcp.types import Icon\n\nmcp = FastMCP(\n    name=\"WeatherService\",\n    website_url=\"https://weather.example.com\",\n    icons=[\n        Icon(\n            src=\"https://weather.example.com/icon-48.png\",\n            mimeType=\"image/png\",\n            sizes=[\"48x48\"]\n        ),\n        Icon(\n            src=\"https://weather.example.com/icon-96.png\",\n            mimeType=\"image/png\",\n            sizes=[\"96x96\"]\n        ),\n    ]\n)\n```\n\nServer icons appear in MCP client interfaces to help users identify your server among others they may have installed.\n\n## Component Icons\n\nIcons can be added to individual tools, resources, resource templates, and prompts:\n\n### Tool Icons\n\n```python\nfrom mcp.types import Icon\n\n@mcp.tool(\n    icons=[Icon(src=\"https://example.com/calculator-icon.png\")]\n)\ndef calculate_sum(a: int, b: int) -> int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n```\n\n### Resource Icons\n\n```python\n@mcp.resource(\n    \"config://settings\",\n    icons=[Icon(src=\"https://example.com/config-icon.png\")]\n)\ndef get_settings() -> dict:\n    \"\"\"Retrieve application settings.\"\"\"\n    return {\"theme\": \"dark\", \"language\": \"en\"}\n```\n\n### Resource Template Icons\n\n```python\n@mcp.resource(\n    \"user://{user_id}/profile\",\n    icons=[Icon(src=\"https://example.com/user-icon.png\")]\n)\ndef get_user_profile(user_id: str) -> dict:\n    \"\"\"Get a user's profile.\"\"\"\n    return {\"id\": user_id, \"name\": f\"User {user_id}\"}\n```\n\n### Prompt Icons\n\n```python\n@mcp.prompt(\n    icons=[Icon(src=\"https://example.com/prompt-icon.png\")]\n)\ndef analyze_code(code: str):\n    \"\"\"Create a prompt for code analysis.\"\"\"\n    return f\"Please analyze this code:\\n\\n{code}\"\n```\n\n## Using Data URIs\n\nFor small icons or when you want to embed the icon directly, use data URIs:\n\n```python\nfrom mcp.types import Icon\nfrom fastmcp.utilities.types import Image\n\n# SVG icon as data URI\nsvg_icon = Icon(\n    src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6Ii8+PC9zdmc+\",\n    mimeType=\"image/svg+xml\"\n)\n\n@mcp.tool(icons=[svg_icon])\ndef my_tool() -> str:\n    \"\"\"A tool with an embedded SVG icon.\"\"\"\n    return \"result\"\n\n# Generating a data URI from a local image file.\nimg = Image(path=\"./assets/brand/favicon.png\")\nicon = Icon(src=img.to_data_uri())\n\n@mcp.tool(icons=[icon])\ndef file_icon_tool() -> str:\n    \"\"\"A tool with an icon generated from a local file.\"\"\"\n    return \"result\"\n```\n"}, {"filename": "docs/servers/logging.mdx", "content": "---\ntitle: Client Logging\nsidebarTitle: Logging\ndescription: Send log messages back to MCP clients through the context.\nicon: receipt\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<Tip>\nThis documentation covers **MCP client logging** - sending messages from your server to MCP clients. For standard server-side logging (e.g., writing to files, console), use `fastmcp.utilities.logging.get_logger()` or Python's built-in `logging` module.\n</Tip>\n\nServer logging allows MCP tools to send debug, info, warning, and error messages back to the client. This provides visibility into function execution and helps with debugging during development and operation.\n\n## Why Use Server Logging?\n\nServer logging is essential for:\n\n- **Debugging**: Send detailed execution information to help diagnose issues\n- **Progress visibility**: Keep users informed about what the tool is doing\n- **Error reporting**: Communicate problems and their context to clients\n- **Audit trails**: Create records of tool execution for compliance or analysis\n\nUnlike standard Python logging, MCP server logging sends messages directly to the client, making them visible in the client's interface or logs.\n\n### Basic Usage\n\nUse the context logging methods within any tool function:\n\n```python {8-9, 13, 17, 21}\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(\"LoggingDemo\")\n\n@mcp.tool\nasync def analyze_data(data: list[float], ctx: Context) -> dict:\n    \"\"\"Analyze numerical data with comprehensive logging.\"\"\"\n    await ctx.debug(\"Starting analysis of numerical data\")\n    await ctx.info(f\"Analyzing {len(data)} data points\")\n    \n    try:\n        if not data:\n            await ctx.warning(\"Empty data list provided\")\n            return {\"error\": \"Empty data list\"}\n        \n        result = sum(data) / len(data)\n        await ctx.info(f\"Analysis complete, average: {result}\")\n        return {\"average\": result, \"count\": len(data)}\n        \n    except Exception as e:\n        await ctx.error(f\"Analysis failed: {str(e)}\")\n        raise\n```\n\n## Structured Logging with `extra`\n\nAll logging methods (`debug`, `info`, `warning`, `error`, `log`) now accept an `extra` parameter, which is a dictionary of arbitrary data. This allows you to send structured data to the client, which is useful for creating rich, queryable logs.\n\n```python\n@mcp.tool\nasync def process_transaction(transaction_id: str, amount: float, ctx: Context):\n    await ctx.info(\n        f\"Processing transaction {transaction_id}\",\n        extra={\n            \"transaction_id\": transaction_id,\n            \"amount\": amount,\n            \"currency\": \"USD\"\n        }\n    )\n    # ... processing logic ...\n```\n\n## Server Logs\n\nClient Logging in the form of `ctx.log()` and its convenience methods (`debug`, `info`, `warning`, `error`) are meant for sending messages to the MCP clients. Messages sent to clients are also logged to the server's log at `DEBUG` level. Enable debug logging on the server or enable debug logging on the `fastmcp.server.context.to_client` logger to see these messages in the server's log.\n\n```python\nimport logging\n\nfrom fastmcp.utilities.logging import get_logger\n\nto_client_logger = get_logger(name=\"fastmcp.server.context.to_client\")\nto_client_logger.setLevel(level=logging.DEBUG)\n```\n\n## Logging Methods\n\n<Card icon=\"code\" title=\"Context Logging Methods\">\n<ResponseField name=\"ctx.debug\" type=\"async method\">\n  Send debug-level messages for detailed execution information\n\n  <Expandable title=\"parameters\">\n    <ResponseField name=\"message\" type=\"str\">\n      The debug message to send to the client\n    </ResponseField>\n    <ResponseField name=\"extra\" type=\"dict | None\" default=\"None\">\n      Optional dictionary for structured logging data\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n\n<ResponseField name=\"ctx.info\" type=\"async method\">\n  Send informational messages about normal execution\n\n  <Expandable title=\"parameters\">\n    <ResponseField name=\"message\" type=\"str\">\n      The information message to send to the client\n    </ResponseField>\n    <ResponseField name=\"extra\" type=\"dict | None\" default=\"None\">\n      Optional dictionary for structured logging data\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n\n<ResponseField name=\"ctx.warning\" type=\"async method\">\n  Send warning messages for potential issues that didn't prevent execution\n\n  <Expandable title=\"parameters\">\n    <ResponseField name=\"message\" type=\"str\">\n      The warning message to send to the client\n    </ResponseField>\n    <ResponseField name=\"extra\" type=\"dict | None\" default=\"None\">\n      Optional dictionary for structured logging data\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n\n<ResponseField name=\"ctx.error\" type=\"async method\">\n  Send error messages for problems that occurred during execution\n\n  <Expandable title=\"parameters\">\n    <ResponseField name=\"message\" type=\"str\">\n      The error message to send to the client\n    </ResponseField>\n    <ResponseField name=\"extra\" type=\"dict | None\" default=\"None\">\n      Optional dictionary for structured logging data\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n\n<ResponseField name=\"ctx.log\" type=\"async method\">\n  Generic logging method with custom level and logger name\n\n  <Expandable title=\"parameters\">\n    <ResponseField name=\"level\" type=\"Literal['debug', 'info', 'warning', 'error']\">\n      The log level for the message\n    </ResponseField>\n\n    <ResponseField name=\"message\" type=\"str\">\n      The message to send to the client\n    </ResponseField>\n\n    <ResponseField name=\"logger_name\" type=\"str | None\" default=\"None\">\n      Optional custom logger name for categorizing messages\n    </ResponseField>\n    <ResponseField name=\"extra\" type=\"dict | None\" default=\"None\">\n      Optional dictionary for structured logging data\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n## Log Levels\n\n### Debug\nUse for detailed information that's typically only useful when diagnosing problems:\n\n```python \n@mcp.tool\nasync def process_file(file_path: str, ctx: Context) -> str:\n    \"\"\"Process a file with detailed debug logging.\"\"\"\n    await ctx.debug(f\"Starting to process file: {file_path}\")\n    await ctx.debug(\"Checking file permissions\")\n    \n    # File processing logic\n    await ctx.debug(\"File processing completed successfully\")\n    return \"File processed\"\n```\n\n### Info\nUse for general information about normal program execution:\n\n```python\n@mcp.tool\nasync def backup_database(ctx: Context) -> str:\n    \"\"\"Backup database with progress information.\"\"\"\n    await ctx.info(\"Starting database backup\")\n    await ctx.info(\"Connecting to database\")\n    await ctx.info(\"Backup completed successfully\")\n    return \"Database backed up\"\n```\n\n### Warning\nUse for potentially harmful situations that don't prevent execution:\n\n```python\n@mcp.tool\nasync def validate_config(config: dict, ctx: Context) -> dict:\n    \"\"\"Validate configuration with warnings for deprecated options.\"\"\"\n    if \"old_api_key\" in config:\n        await ctx.warning(\n            \"Using deprecated 'old_api_key' field. Please use 'api_key' instead\",\n            extra={\"deprecated_field\": \"old_api_key\"}\n        )\n    \n    if config.get(\"timeout\", 30) > 300:\n        await ctx.warning(\n            \"Timeout value is very high (>5 minutes), this may cause issues\",\n            extra={\"timeout_value\": config.get(\"timeout\")}\n        )\n    \n    return {\"status\": \"valid\", \"warnings\": \"see logs\"}\n```\n\n### Error\nUse for error events that might still allow the application to continue:\n\n```python\n@mcp.tool\nasync def batch_process(items: list[str], ctx: Context) -> dict:\n    \"\"\"Process multiple items, logging errors for failed items.\"\"\"\n    successful = 0\n    failed = 0\n    \n    for item in items:\n        try:\n            # Process item\n            successful += 1\n        except Exception as e:\n            await ctx.error(\n                f\"Failed to process item '{item}': {str(e)}\",\n                extra={\"failed_item\": item}\n            )\n            failed += 1\n    \n    return {\"successful\": successful, \"failed\": failed}\n```\n\n\n## Client Handling\n\nLog messages are sent to the client through the MCP protocol. How clients handle these messages depends on their implementation:\n\n- **Development clients**: May display logs in real-time for debugging\n- **Production clients**: May store logs for later analysis or display to users\n- **Integration clients**: May forward logs to external logging systems\n\nSee [Client Logging](/clients/logging) for details on how clients can handle server log messages.\n"}, {"filename": "docs/servers/middleware.mdx", "content": "---\ntitle: MCP Middleware\nsidebarTitle: Middleware\ndescription: Add cross-cutting functionality to your MCP server with middleware that can inspect, modify, and respond to all MCP requests and responses.\nicon: layer-group\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.9.0\" />\n\nMCP middleware is a powerful concept that allows you to add cross-cutting functionality to your FastMCP server. Unlike traditional web middleware, MCP middleware is designed specifically for the Model Context Protocol, providing hooks for different types of MCP operations like tool calls, resource reads, and prompt requests.\n\n<Tip>\nMCP middleware is a FastMCP-specific concept and is not part of the official MCP protocol specification. This middleware system is designed to work with FastMCP servers and may not be compatible with other MCP implementations.\n</Tip>\n\n<Warning>\nMCP middleware is a brand new concept and may be subject to breaking changes in future versions.\n</Warning>\n\n## What is MCP Middleware?\n\nMCP middleware lets you intercept and modify MCP requests and responses as they flow through your server. Think of it as a pipeline where each piece of middleware can inspect what's happening, make changes, and then pass control to the next middleware in the chain.\n\nCommon use cases for MCP middleware include:\n- **Authentication and Authorization**: Verify client permissions before executing operations\n- **Logging and Monitoring**: Track usage patterns and performance metrics\n- **Rate Limiting**: Control request frequency per client or operation type\n- **Request/Response Transformation**: Modify data before it reaches tools or after it leaves\n- **Caching**: Store frequently requested data to improve performance\n- **Error Handling**: Provide consistent error responses across your server\n\n## How Middleware Works\n\nFastMCP middleware operates on a pipeline model. When a request comes in, it flows through your middleware in the order they were added to the server. Each middleware can:\n\n1. **Inspect the incoming request** and its context\n2. **Modify the request** before passing it to the next middleware or handler\n3. **Execute the next middleware/handler** in the chain by calling `call_next()`\n4. **Inspect and modify the response** before returning it\n5. **Handle errors** that occur during processing\n\nThe key insight is that middleware forms a chain where each piece decides whether to continue processing or stop the chain entirely.\n\nIf you're familiar with ASGI middleware, the basic structure of FastMCP middleware will feel familiar. At its core, middleware is a callable class that receives a context object containing information about the current JSON-RPC message and a handler function to continue the middleware chain.\n\nIt's important to understand that MCP operates on the [JSON-RPC specification](https://spec.modelcontextprotocol.io/specification/basic/transports/). While FastMCP presents requests and responses in a familiar way, these are fundamentally JSON-RPC messages, not HTTP request/response pairs like you might be used to in web applications. FastMCP middleware works with all [transport types](/clients/transports), including local stdio transport and HTTP transports, though not all middleware implementations are compatible across all transports (e.g., middleware that inspects HTTP headers won't work with stdio transport).\n\nThe most fundamental way to implement middleware is by overriding the `__call__` method on the `Middleware` base class:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass RawMiddleware(Middleware):\n    async def __call__(self, context: MiddlewareContext, call_next):\n        # This method receives ALL messages regardless of type\n        print(f\"Raw middleware processing: {context.method}\")\n        result = await call_next(context)\n        print(f\"Raw middleware completed: {context.method}\")\n        return result\n```\n\nThis gives you complete control over every message that flows through your server, but requires you to handle all message types manually.\n\n## Middleware Hooks\n\nTo make it easier for users to target specific types of messages, FastMCP middleware provides a variety of specialized hooks. Instead of implementing the raw `__call__` method, you can override specific hook methods that are called only for certain types of operations, allowing you to target exactly the level of specificity you need for your middleware logic.\n\n### Hook Hierarchy and Execution Order\n\nFastMCP provides multiple hooks that are called with varying levels of specificity. Understanding this hierarchy is crucial for effective middleware design.\n\nWhen a request comes in, **multiple hooks may be called for the same request**, going from general to specific:\n\n1. **`on_message`** - Called for ALL MCP messages (both requests and notifications)\n2. **`on_request` or `on_notification`** - Called based on the message type\n3. **Operation-specific hooks** - Called for specific MCP operations like `on_call_tool`\n\nFor example, when a client calls a tool, your middleware will receive **multiple hook calls**:\n1. `on_message` and `on_request` for any initial tool discovery operations (list_tools)\n2. `on_message` (because it's any MCP message) for the tool call itself\n3. `on_request` (because tool calls expect responses) for the tool call itself\n4. `on_call_tool` (because it's specifically a tool execution) for the tool call itself\n\nNote that the MCP SDK may perform additional operations like listing tools for caching purposes, which will trigger additional middleware calls beyond just the direct tool execution.\n\nThis hierarchy allows you to target your middleware logic with the right level of specificity. Use `on_message` for broad concerns like logging, `on_request` for authentication, and `on_call_tool` for tool-specific logic like performance monitoring.\n\n### Available Hooks\n<VersionBadge version=\"2.9.0\" />\n\n- `on_message`: Called for all MCP messages (requests and notifications)\n- `on_request`: Called specifically for MCP requests (that expect responses)\n- `on_notification`: Called specifically for MCP notifications (fire-and-forget)\n\n- `on_call_tool`: Called when tools are being executed\n- `on_read_resource`: Called when resources are being read\n- `on_get_prompt`: Called when prompts are being retrieved\n- `on_list_tools`: Called when listing available tools\n- `on_list_resources`: Called when listing available resources\n- `on_list_resource_templates`: Called when listing resource templates\n- `on_list_prompts`: Called when listing available prompts\n<VersionBadge version=\"2.13.0\" />\n- `on_initialize`: Called when a client connects and initializes the session (returns `None`)\n<Note>\nThe `on_initialize` hook receives the client's initialization request but **returns `None`** rather than a result. The initialization response is handled internally by the MCP protocol and cannot be modified by middleware. This hook is useful for client detection, logging connections, or initializing session state, but not for modifying the initialization handshake itself.\n</Note>\n\n**Example:**\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\nfrom mcp import McpError\nfrom mcp.types import ErrorData\n\nclass InitializationMiddleware(Middleware):\n    async def on_initialize(self, context: MiddlewareContext, call_next):\n        # Check client capabilities before initialization\n        client_info = context.message.params.get(\"clientInfo\", {})\n        client_name = client_info.get(\"name\", \"unknown\")\n\n        # Reject unsupported clients BEFORE call_next\n        if client_name == \"unsupported-client\":\n            raise McpError(ErrorData(code=-32000, message=\"This client is not supported\"))\n\n        # Log successful initialization\n        await call_next(context)\n        print(f\"Client {client_name} initialized successfully\")\n```\n\n<Warning>\nIf you raise `McpError` in `on_initialize` **after** calling `call_next()`, the error will only be logged and will not be sent to the client. The initialization response has already been sent at that point. Always raise `McpError` **before** `call_next()` if you want to reject the initialization.\n</Warning>\n\n### MCP Session Availability in Middleware\n\n<VersionBadge version=\"2.13.1\" />\n\nThe MCP session and request context are not available during certain phases like initialization. When middleware runs during these phases, `context.fastmcp_context.request_context` returns `None` rather than the full MCP request context.\n\nThis typically occurs when:\n- The `on_request` hook fires during client initialization\n- The MCP handshake hasn't completed yet\n\nTo handle this in middleware, check if the MCP request context is available before accessing MCP-specific attributes. Note that the MCP request context is distinct from the HTTP request - for HTTP transports, you can use HTTP helpers to access request data even when the MCP session is not available:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass SessionAwareMiddleware(Middleware):\n    async def on_request(self, context: MiddlewareContext, call_next):\n        ctx = context.fastmcp_context\n\n        if ctx.request_context:\n            # MCP session available - can access session-specific attributes\n            session_id = ctx.session_id\n            request_id = ctx.request_id\n        else:\n            # MCP session not available yet - use HTTP helpers for request data (if using HTTP transport)\n            from fastmcp.server.dependencies import get_http_headers\n            headers = get_http_headers()\n            # Access HTTP data for auth, logging, etc.\n\n        return await call_next(context)\n```\n\nFor HTTP request data (headers, client IP, etc.) when using HTTP transports, use `get_http_request()` or `get_http_headers()` from `fastmcp.server.dependencies`, which work regardless of MCP session availability. See [HTTP Requests](/servers/context#http-requests) for details.\n\n## Component Access in Middleware\n\nUnderstanding how to access component information (tools, resources, prompts) in middleware is crucial for building powerful middleware functionality. The access patterns differ significantly between listing operations and execution operations.\n\n### Listing Operations vs Execution Operations\n\nFastMCP middleware handles two types of operations differently:\n\n**Listing Operations** (`on_list_tools`, `on_list_resources`, `on_list_prompts`, etc.):\n- Middleware receives **FastMCP component objects** with full metadata\n- These objects include FastMCP-specific properties like `tags` that can be accessed directly from the component\n- The result contains complete component information before it's converted to MCP format  \n- Tags are included in the component's `meta` field in the listing response returned to MCP clients\n\n**Execution Operations** (`on_call_tool`, `on_read_resource`, `on_get_prompt`):\n- Middleware runs **before** the component is executed\n- The middleware result is either the execution result or an error if the component wasn't found\n- Component metadata isn't directly available in the hook parameters\n\n### Accessing Component Metadata During Execution\n\nIf you need to check component properties (like tags) during execution operations, use the FastMCP server instance available through the context:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\nfrom fastmcp.exceptions import ToolError\n\nclass TagBasedMiddleware(Middleware):\n    async def on_call_tool(self, context: MiddlewareContext, call_next):\n        # Access the tool object to check its metadata\n        if context.fastmcp_context:\n            try:\n                tool = await context.fastmcp_context.fastmcp.get_tool(context.message.name)\n                \n                # Check if this tool has a \"private\" tag\n                if \"private\" in tool.tags:\n                    raise ToolError(\"Access denied: private tool\")\n                    \n                # Check if tool is enabled\n                if not tool.enabled:\n                    raise ToolError(\"Tool is currently disabled\")\n                    \n            except Exception:\n                # Tool not found or other error - let execution continue\n                # and handle the error naturally\n                pass\n        \n        return await call_next(context)\n```\n\nThe same pattern works for resources and prompts:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\nfrom fastmcp.exceptions import ResourceError, PromptError\n\nclass ComponentAccessMiddleware(Middleware):\n    async def on_read_resource(self, context: MiddlewareContext, call_next):\n        if context.fastmcp_context:\n            try:\n                resource = await context.fastmcp_context.fastmcp.get_resource(context.message.uri)\n                if \"restricted\" in resource.tags:\n                    raise ResourceError(\"Access denied: restricted resource\")\n            except Exception:\n                pass\n        return await call_next(context)\n    \n    async def on_get_prompt(self, context: MiddlewareContext, call_next):\n        if context.fastmcp_context:\n            try:\n                prompt = await context.fastmcp_context.fastmcp.get_prompt(context.message.name)\n                if not prompt.enabled:\n                    raise PromptError(\"Prompt is currently disabled\")\n            except Exception:\n                pass\n        return await call_next(context)\n```\n\n### Working with Listing Results\n\nFor listing operations, the middleware `call_next` function returns a list of FastMCP components prior to being converted to MCP format. You can filter or modify this list and return it to the client. For example:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass ListingFilterMiddleware(Middleware):\n    async def on_list_tools(self, context: MiddlewareContext, call_next):\n        result = await call_next(context)\n        \n        # Filter out tools with \"private\" tag\n        filtered_tools = [\n            tool for tool in result \n            if \"private\" not in tool.tags\n        ]\n        \n        # Return modified list\n        return filtered_tools\n```\n\nThis filtering happens before the components are converted to MCP format and returned to the client. Tags are accessible both during filtering and are included in the component's `meta` field in the final listing response.\n\n<Tip>\nWhen filtering components in listing operations, ensure you also prevent execution of filtered components in the corresponding execution hooks (`on_call_tool`, `on_read_resource`, `on_get_prompt`) to maintain consistency.\n</Tip>\n\n### Tool Call Denial\n\nYou can deny access to specific tools by raising a `ToolError` in your middleware. This is the correct way to block tool execution, as it integrates properly with the FastMCP error handling system.\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\nfrom fastmcp.exceptions import ToolError\n\nclass AuthMiddleware(Middleware):\n    async def on_call_tool(self, context: MiddlewareContext, call_next):\n        tool_name = context.message.name\n        \n        # Deny access to restricted tools\n        if tool_name.lower() in [\"delete\", \"admin_config\"]:\n            raise ToolError(\"Access denied: tool requires admin privileges\")\n        \n        # Allow other tools to proceed\n        return await call_next(context)\n```\n\n<Warning>\nWhen denying tool calls, always raise `ToolError` rather than returning `ToolResult` objects or other values. `ToolError` ensures proper error propagation through the middleware chain and converts to the correct MCP error response format.\n</Warning>\n\n### Tool Call Modification\n\nFor execution operations like tool calls, you can modify arguments before execution or transform results afterward:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass ToolCallMiddleware(Middleware):\n    async def on_call_tool(self, context: MiddlewareContext, call_next):\n        # Modify arguments before execution\n        if context.message.name == \"calculate\":\n            # Ensure positive inputs\n            if context.message.arguments.get(\"value\", 0) < 0:\n                context.message.arguments[\"value\"] = abs(context.message.arguments[\"value\"])\n        \n        result = await call_next(context)\n        \n        # Transform result after execution\n        if context.message.name == \"get_data\":\n            # Add metadata to result\n            if result.structured_content:\n                result.structured_content[\"processed_at\"] = \"2024-01-01T00:00:00Z\"\n        \n        return result\n```\n\n<Tip>\nFor more complex tool rewriting scenarios, consider using [Tool Transformation](/patterns/tool-transformation) patterns which provide a more structured approach to creating modified tool variants.\n</Tip>\n\n### Anatomy of a Hook\n\nEvery middleware hook follows the same pattern. Let's examine the `on_message` hook to understand the structure:\n\n```python\nasync def on_message(self, context: MiddlewareContext, call_next):\n    # 1. Pre-processing: Inspect and optionally modify the request\n    print(f\"Processing {context.method}\")\n    \n    # 2. Chain continuation: Call the next middleware/handler\n    result = await call_next(context)\n    \n    # 3. Post-processing: Inspect and optionally modify the response\n    print(f\"Completed {context.method}\")\n    \n    # 4. Return the result (potentially modified)\n    return result\n```\n\n### Hook Parameters\n\nEvery hook receives two parameters:\n\n1. **`context: MiddlewareContext`** - Contains information about the current request:\n   - `context.method` - The MCP method name (e.g., \"tools/call\")\n   - `context.source` - Where the request came from (\"client\" or \"server\")\n   - `context.type` - Message type (\"request\" or \"notification\")\n   - `context.message` - The MCP message data\n   - `context.timestamp` - When the request was received\n   - `context.fastmcp_context` - FastMCP Context object (if available)\n\n2. **`call_next`** - A function that continues the middleware chain. You **must** call this to proceed, unless you want to stop processing entirely.\n\n### Control Flow\n\nYou have complete control over the request flow:\n- **Continue processing**: Call `await call_next(context)` to proceed\n- **Modify the request**: Change the context before calling `call_next`\n- **Modify the response**: Change the result after calling `call_next`\n- **Stop the chain**: Don't call `call_next` (rarely needed)\n- **Handle errors**: Wrap `call_next` in try/catch blocks\n\n#### State Management\n\n<VersionBadge version=\"2.11.0\" />\n\nIn addition to modifying the request and response, you can also store state data that your tools can (optionally) access later. To do so, use the FastMCP Context to either `set_state` or `get_state` as appropriate. For more information, see the [Context State Management](/servers/context#state-management) docs.\n\n## Creating Middleware\n\nFastMCP middleware is implemented by subclassing the `Middleware` base class and overriding the hooks you need. You only need to implement the hooks that are relevant to your use case.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass LoggingMiddleware(Middleware):\n    \"\"\"Middleware that logs all MCP operations.\"\"\"\n    \n    async def on_message(self, context: MiddlewareContext, call_next):\n        \"\"\"Called for all MCP messages.\"\"\"\n        print(f\"Processing {context.method} from {context.source}\")\n        \n        result = await call_next(context)\n        \n        print(f\"Completed {context.method}\")\n        return result\n\n# Add middleware to your server\nmcp = FastMCP(\"MyServer\")\nmcp.add_middleware(LoggingMiddleware())\n```\n\nThis creates a basic logging middleware that will print information about every request that flows through your server.\n\n## Adding Middleware to Your Server\n\n### Single Middleware\n\nAdding middleware to your server is straightforward:\n\n```python\nmcp = FastMCP(\"MyServer\")\nmcp.add_middleware(LoggingMiddleware())\n```\n\n### Multiple Middleware\n\nMiddleware executes in the order it's added to the server. The first middleware added runs first on the way in, and last on the way out:\n\n```python\nmcp = FastMCP(\"MyServer\")\n\nmcp.add_middleware(AuthenticationMiddleware(\"secret-token\"))\nmcp.add_middleware(PerformanceMiddleware())\nmcp.add_middleware(LoggingMiddleware())\n```\n\nThis creates the following execution flow:\n1. AuthenticationMiddleware (pre-processing)\n2. PerformanceMiddleware (pre-processing)  \n3. LoggingMiddleware (pre-processing)\n4. Actual tool/resource handler\n5. LoggingMiddleware (post-processing)\n6. PerformanceMiddleware (post-processing)\n7. AuthenticationMiddleware (post-processing)\n\n## Server Composition and Middleware\n\nWhen using [Server Composition](/servers/composition) with `mount` or `import_server`, middleware behavior follows these rules:\n\n1. **Parent server middleware** runs for all requests, including those routed to mounted servers\n2. **Mounted server middleware** only runs for requests handled by that specific server\n3. **Middleware order** is preserved within each server\n\nThis allows you to create layered middleware architectures where parent servers handle cross-cutting concerns like authentication, while child servers focus on domain-specific middleware.\n\n```python\n# Parent server with middleware\nparent = FastMCP(\"Parent\")\nparent.add_middleware(AuthenticationMiddleware(\"token\"))\n\n# Child server with its own middleware  \nchild = FastMCP(\"Child\")\nchild.add_middleware(LoggingMiddleware())\n\n@child.tool\ndef child_tool() -> str:\n    return \"from child\"\n\n# Mount the child server\nparent.mount(child, prefix=\"child\")\n```\n\nWhen a client calls \"child_tool\", the request will flow through the parent's authentication middleware first, then route to the child server where it will go through the child's logging middleware.\n\n## Built-in Middleware Examples\n\nFastMCP includes several middleware implementations that demonstrate best practices and provide immediately useful functionality. Let's explore how each type works by building simplified versions, then see how to use the full implementations.\n\n### Timing Middleware\n\nPerformance monitoring is essential for understanding your server's behavior and identifying bottlenecks. FastMCP includes timing middleware at `fastmcp.server.middleware.timing`. \n\nHere's an example of how it works:\n\n```python\nimport time\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass SimpleTimingMiddleware(Middleware):\n    async def on_request(self, context: MiddlewareContext, call_next):\n        start_time = time.perf_counter()\n        \n        try:\n            result = await call_next(context)\n            duration_ms = (time.perf_counter() - start_time) * 1000\n            print(f\"Request {context.method} completed in {duration_ms:.2f}ms\")\n            return result\n        except Exception as e:\n            duration_ms = (time.perf_counter() - start_time) * 1000\n            print(f\"Request {context.method} failed after {duration_ms:.2f}ms: {e}\")\n            raise\n```\n\nTo use the full version with proper logging and configuration:\n\n```python\nfrom fastmcp.server.middleware.timing import (\n    TimingMiddleware, \n    DetailedTimingMiddleware\n)\n\n# Basic timing for all requests\nmcp.add_middleware(TimingMiddleware())\n\n# Detailed per-operation timing (tools, resources, prompts)\nmcp.add_middleware(DetailedTimingMiddleware())\n```\n\nThe built-in versions include custom logger support, proper formatting, and **DetailedTimingMiddleware** provides operation-specific hooks like `on_call_tool` and `on_read_resource` for granular timing.\n\n### Tool Injection Middleware\n\nTool injection middleware is a middleware that injects tools into the server during the request lifecycle:\n\n```python\nfrom fastmcp.server.middleware.tool_injection import ToolInjectionMiddleware\n\ndef my_tool_fn(a: int, b: int) -> int:\n    return a + b\n\nmy_tool = Tool.from_function(fn=my_tool_fn, name=\"my_tool\")\n\nmcp.add_middleware(ToolInjectionMiddleware(tools=[my_tool]))\n```\n\n### Prompt Tool Middleware\n\nPrompt tool middleware is a compatibility middleware for clients that are unable to list or get prompts. It provides two tools: `list_prompts` and `get_prompt` which allow clients to list and get prompts respectively using only tool calls.\n\n```python\nfrom fastmcp.server.middleware.tool_injection import PromptToolMiddleware\n\nmcp.add_middleware(PromptToolMiddleware())\n```\n\n### Resource Tool Middleware\n\nResource tool middleware is a compatibility middleware for clients that are unable to list or read resources. It provides two tools: `list_resources` and `read_resource` which allow clients to list and read resources respectively using only tool calls.\n\n```python\nfrom fastmcp.server.middleware.tool_injection import ResourceToolMiddleware\n\nmcp.add_middleware(ResourceToolMiddleware())\n```\n\n### Caching Middleware\n\nCaching middleware is essential for improving performance and reducing server load. FastMCP provides caching middleware at `fastmcp.server.middleware.caching`.\n\nHere's how to use the full version:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\n\nmcp.add_middleware(ResponseCachingMiddleware())\n```\n\nOut of the box, it caches call/list tool, resources, and prompts to an in-memory cache with TTL-based expiration. Cache entries expire based on their TTL; there is no event-based cache invalidation. List calls are stored under global keys\u2014when sharing a storage backend across multiple servers, consider namespacing collections to prevent conflicts. See [Storage Backends](/servers/storage-backends) for advanced configuration options.\n\nEach method can be configured individually, for example, caching list tools for 30 seconds, limiting caching to specific tools, and disabling caching for resource reads:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware, CallToolSettings, ListToolsSettings, ReadResourceSettings\n\nmcp.add_middleware(ResponseCachingMiddleware(\n    list_tools_settings=ListToolsSettings(\n        ttl=30,\n    ),\n    call_tool_settings=CallToolSettings(\n        included_tools=[\"tool1\"],\n    ),\n    read_resource_settings=ReadResourceSettings(\n        enabled=False\n    )\n))\n```\n\n#### Storage Backends\n\nBy default, caching uses in-memory storage, which is fast but doesn't persist across restarts. For production or persistent caching across server restarts, configure a different storage backend. See [Storage Backends](/servers/storage-backends) for complete options including disk, Redis, DynamoDB, and custom implementations.\n\nDisk-based caching example:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\nfrom key_value.aio.stores.disk import DiskStore\n\nmcp.add_middleware(ResponseCachingMiddleware(\n    cache_storage=DiskStore(directory=\"cache\"),\n))\n```\n\nRedis for distributed deployments:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\nfrom key_value.aio.stores.redis import RedisStore\n\nmcp.add_middleware(ResponseCachingMiddleware(\n    cache_storage=RedisStore(host=\"redis.example.com\", port=6379),\n))\n```\n\n#### Cache Statistics\n\nThe caching middleware collects operation statistics (hits, misses, etc.) through the underlying storage layer. Access statistics from the middleware instance:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\n\nmiddleware = ResponseCachingMiddleware()\nmcp.add_middleware(middleware)\n\n# Later, retrieve statistics\nstats = middleware.statistics()\nprint(f\"Total cache operations: {stats}\")\n```\n\n### Logging Middleware\n\nRequest and response logging is crucial for debugging, monitoring, and understanding usage patterns in your MCP server. FastMCP provides comprehensive logging middleware at `fastmcp.server.middleware.logging`. \n\nHere's an example of how it works:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass SimpleLoggingMiddleware(Middleware):\n    async def on_message(self, context: MiddlewareContext, call_next):\n        print(f\"Processing {context.method} from {context.source}\")\n        \n        try:\n            result = await call_next(context)\n            print(f\"Completed {context.method}\")\n            return result\n        except Exception as e:\n            print(f\"Failed {context.method}: {e}\")\n            raise\n```\n\nTo use the full versions with advanced features:\n\n```python\nfrom fastmcp.server.middleware.logging import (\n    LoggingMiddleware, \n    StructuredLoggingMiddleware\n)\n\n# Human-readable logging with payload support\nmcp.add_middleware(LoggingMiddleware(\n    include_payloads=True,\n    max_payload_length=1000\n))\n\n# JSON-structured logging for log aggregation tools\nmcp.add_middleware(StructuredLoggingMiddleware(include_payloads=True))\n```\n\nThe built-in versions include payload logging, structured JSON output, custom logger support, payload size limits, and operation-specific hooks for granular control.\n\n### Rate Limiting Middleware\n\nRate limiting is essential for protecting your server from abuse, ensuring fair resource usage, and maintaining performance under load. FastMCP includes sophisticated rate limiting middleware at `fastmcp.server.middleware.rate_limiting`. \n\nHere's an example of how it works:\n\n```python\nimport time\nfrom collections import defaultdict\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\nfrom mcp import McpError\nfrom mcp.types import ErrorData\n\nclass SimpleRateLimitMiddleware(Middleware):\n    def __init__(self, requests_per_minute: int = 60):\n        self.requests_per_minute = requests_per_minute\n        self.client_requests = defaultdict(list)\n    \n    async def on_request(self, context: MiddlewareContext, call_next):\n        current_time = time.time()\n        client_id = \"default\"  # In practice, extract from headers or context\n        \n        # Clean old requests and check limit\n        cutoff_time = current_time - 60\n        self.client_requests[client_id] = [\n            req_time for req_time in self.client_requests[client_id]\n            if req_time > cutoff_time\n        ]\n        \n        if len(self.client_requests[client_id]) >= self.requests_per_minute:\n            raise McpError(ErrorData(code=-32000, message=\"Rate limit exceeded\"))\n        \n        self.client_requests[client_id].append(current_time)\n        return await call_next(context)\n```\n\nTo use the full versions with advanced algorithms:\n\n```python\nfrom fastmcp.server.middleware.rate_limiting import (\n    RateLimitingMiddleware, \n    SlidingWindowRateLimitingMiddleware\n)\n\n# Token bucket rate limiting (allows controlled bursts)\nmcp.add_middleware(RateLimitingMiddleware(\n    max_requests_per_second=10.0,\n    burst_capacity=20\n))\n\n# Sliding window rate limiting (precise time-based control)\nmcp.add_middleware(SlidingWindowRateLimitingMiddleware(\n    max_requests=100,\n    window_minutes=1\n))\n```\n\nThe built-in versions include token bucket algorithms, per-client identification, global rate limiting, and async-safe implementations with configurable client identification functions.\n\n### Error Handling Middleware\n\nConsistent error handling and recovery is critical for robust MCP servers. FastMCP provides comprehensive error handling middleware at `fastmcp.server.middleware.error_handling`.\n\nHere's an example of how it works:\n\n```python\nimport logging\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass SimpleErrorHandlingMiddleware(Middleware):\n    def __init__(self):\n        self.logger = logging.getLogger(\"errors\")\n        self.error_counts = {}\n    \n    async def on_message(self, context: MiddlewareContext, call_next):\n        try:\n            return await call_next(context)\n        except Exception as error:\n            # Log the error and track statistics\n            error_key = f\"{type(error).__name__}:{context.method}\"\n            self.error_counts[error_key] = self.error_counts.get(error_key, 0) + 1\n            \n            self.logger.error(f\"Error in {context.method}: {type(error).__name__}: {error}\")\n            raise\n```\n\nTo use the full versions with advanced features:\n\n```python\nfrom fastmcp.server.middleware.error_handling import (\n    ErrorHandlingMiddleware, \n    RetryMiddleware\n)\n\n# Comprehensive error logging and transformation\nmcp.add_middleware(ErrorHandlingMiddleware(\n    include_traceback=True,\n    transform_errors=True,\n    error_callback=my_error_callback\n))\n\n# Automatic retry with exponential backoff\nmcp.add_middleware(RetryMiddleware(\n    max_retries=3,\n    retry_exceptions=(ConnectionError, TimeoutError)\n))\n```\n\nThe built-in versions include error transformation, custom callbacks, configurable retry logic, and proper MCP error formatting.\n\n### Combining Middleware\n\nThese middleware work together seamlessly:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.middleware.timing import TimingMiddleware\nfrom fastmcp.server.middleware.logging import LoggingMiddleware\nfrom fastmcp.server.middleware.rate_limiting import RateLimitingMiddleware\nfrom fastmcp.server.middleware.error_handling import ErrorHandlingMiddleware\n\nmcp = FastMCP(\"Production Server\")\n\n# Add middleware in logical order\nmcp.add_middleware(ErrorHandlingMiddleware())  # Handle errors first\nmcp.add_middleware(RateLimitingMiddleware(max_requests_per_second=50))\nmcp.add_middleware(TimingMiddleware())  # Time actual execution\nmcp.add_middleware(LoggingMiddleware())  # Log everything\n\n@mcp.tool\ndef my_tool(data: str) -> str:\n    return f\"Processed: {data}\"\n```\n\nThis configuration provides comprehensive monitoring, protection, and observability for your MCP server.\n\n### Custom Middleware Example\n\nYou can also create custom middleware by extending the base class:\n\n```python\nfrom fastmcp.server.middleware import Middleware, MiddlewareContext\n\nclass CustomHeaderMiddleware(Middleware):\n    async def on_request(self, context: MiddlewareContext, call_next):\n        # Add custom logic here\n        print(f\"Processing {context.method}\")\n        \n        result = await call_next(context)\n        \n        print(f\"Completed {context.method}\")\n        return result\n\nmcp.add_middleware(CustomHeaderMiddleware())\n```\n"}, {"filename": "docs/servers/progress.mdx", "content": "---\ntitle: Progress Reporting\nsidebarTitle: Progress\ndescription: Update clients on the progress of long-running operations through the MCP context.\nicon: chart-line\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\nProgress reporting allows MCP tools to notify clients about the progress of long-running operations. This enables clients to display progress indicators and provide better user experience during time-consuming tasks.\n\n## Why Use Progress Reporting?\n\nProgress reporting is valuable for:\n\n- **User experience**: Keep users informed about long-running operations\n- **Progress indicators**: Enable clients to show progress bars or percentages\n- **Timeout prevention**: Demonstrate that operations are actively progressing\n- **Debugging**: Track execution progress for performance analysis\n\n### Basic Usage\n\nUse `ctx.report_progress()` to send progress updates to the client:\n\n```python {14, 21}\nfrom fastmcp import FastMCP, Context\nimport asyncio\n\nmcp = FastMCP(\"ProgressDemo\")\n\n@mcp.tool\nasync def process_items(items: list[str], ctx: Context) -> dict:\n    \"\"\"Process a list of items with progress updates.\"\"\"\n    total = len(items)\n    results = []\n    \n    for i, item in enumerate(items):\n        # Report progress as we process each item\n        await ctx.report_progress(progress=i, total=total)\n        \n        # Simulate processing time\n        await asyncio.sleep(0.1)\n        results.append(item.upper())\n    \n    # Report 100% completion\n    await ctx.report_progress(progress=total, total=total)\n    \n    return {\"processed\": len(results), \"results\": results}\n```\n\n## Method Signature\n\n<Card icon=\"code\" title=\"Context Progress Method\">\n<ResponseField name=\"ctx.report_progress\" type=\"async method\">\n  Report progress to the client for long-running operations\n  \n  <Expandable title=\"Parameters\">\n    <ResponseField name=\"progress\" type=\"float\">\n      Current progress value (e.g., 24, 0.75, 1500)\n    </ResponseField>\n    \n    <ResponseField name=\"total\" type=\"float | None\" default=\"None\">\n      Optional total value (e.g., 100, 1.0, 2000). When provided, clients may interpret this as enabling percentage calculation.\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n## Progress Patterns\n\n### Percentage-Based Progress\n\nReport progress as a percentage (0-100):\n\n```python {13-14}\n@mcp.tool\nasync def download_file(url: str, ctx: Context) -> str:\n    \"\"\"Download a file with percentage progress.\"\"\"\n    total_size = 1000  # KB\n    downloaded = 0\n    \n    while downloaded < total_size:\n        # Download chunk\n        chunk_size = min(50, total_size - downloaded)\n        downloaded += chunk_size\n        \n        # Report percentage progress\n        percentage = (downloaded / total_size) * 100\n        await ctx.report_progress(progress=percentage, total=100)\n        \n        await asyncio.sleep(0.1)  # Simulate download time\n    \n    return f\"Downloaded file from {url}\"\n```\n\n### Absolute Progress\n\nReport progress with absolute values:\n\n```python {10}\n@mcp.tool\nasync def backup_database(ctx: Context) -> str:\n    \"\"\"Backup database tables with absolute progress.\"\"\"\n    tables = [\"users\", \"orders\", \"products\", \"inventory\", \"logs\"]\n    \n    for i, table in enumerate(tables):\n        await ctx.info(f\"Backing up table: {table}\")\n        \n        # Report absolute progress\n        await ctx.report_progress(progress=i + 1, total=len(tables))\n        \n        # Simulate backup time\n        await asyncio.sleep(0.5)\n    \n    return \"Database backup completed\"\n```\n\n### Indeterminate Progress\n\nReport progress without a known total for operations where the endpoint is unknown:\n\n```python {11}\n@mcp.tool\nasync def scan_directory(directory: str, ctx: Context) -> dict:\n    \"\"\"Scan directory with indeterminate progress.\"\"\"\n    files_found = 0\n    \n    # Simulate directory scanning\n    for i in range(10):  # Unknown number of files\n        files_found += 1\n        \n        # Report progress without total for indeterminate operations\n        await ctx.report_progress(progress=files_found)\n        \n        await asyncio.sleep(0.2)\n    \n    return {\"files_found\": files_found, \"directory\": directory}\n```\n\n### Multi-Stage Operations\n\nBreak complex operations into stages with progress for each:\n\n```python\n@mcp.tool\nasync def data_migration(source: str, destination: str, ctx: Context) -> str:\n    \"\"\"Migrate data with multi-stage progress reporting.\"\"\"\n    \n    # Stage 1: Validation (0-25%)\n    await ctx.info(\"Validating source data\")\n    for i in range(5):\n        await ctx.report_progress(progress=i * 5, total=100)\n        await asyncio.sleep(0.1)\n    \n    # Stage 2: Export (25-60%)\n    await ctx.info(\"Exporting data from source\")\n    for i in range(7):\n        progress = 25 + (i * 5)\n        await ctx.report_progress(progress=progress, total=100)\n        await asyncio.sleep(0.1)\n    \n    # Stage 3: Transform (60-80%)\n    await ctx.info(\"Transforming data format\")\n    for i in range(4):\n        progress = 60 + (i * 5)\n        await ctx.report_progress(progress=progress, total=100)\n        await asyncio.sleep(0.1)\n    \n    # Stage 4: Import (80-100%)\n    await ctx.info(\"Importing to destination\")\n    for i in range(4):\n        progress = 80 + (i * 5)\n        await ctx.report_progress(progress=progress, total=100)\n        await asyncio.sleep(0.1)\n    \n    # Final completion\n    await ctx.report_progress(progress=100, total=100)\n    \n    return f\"Migration from {source} to {destination} completed\"\n```\n\n\n## Client Requirements\n\nProgress reporting requires clients to support progress handling:\n\n- Clients must send a `progressToken` in the initial request to receive progress updates\n- If no progress token is provided, progress calls will have no effect (they won't error)\n- See [Client Progress](/clients/progress) for details on implementing client-side progress handling\n"}, {"filename": "docs/servers/prompts.mdx", "content": "---\ntitle: Prompts\nsidebarTitle: Prompts\ndescription: Create reusable, parameterized prompt templates for MCP clients.\nicon: message-lines\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\nPrompts are reusable message templates that help LLMs generate structured, purposeful responses. FastMCP simplifies defining these templates, primarily using the `@mcp.prompt` decorator.\n\n## What Are Prompts?\n\nPrompts provide parameterized message templates for LLMs. When a client requests a prompt:\n\n1.  FastMCP finds the corresponding prompt definition.\n2.  If it has parameters, they are validated against your function signature.\n3.  Your function executes with the validated inputs.\n4.  The generated message(s) are returned to the LLM to guide its response.\n\nThis allows you to define consistent, reusable templates that LLMs can use across different clients and contexts.\n\n## Prompts\n\n### The `@prompt` Decorator\n\nThe most common way to define a prompt is by decorating a Python function. The decorator uses the function name as the prompt's identifier.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.prompts.prompt import Message, PromptMessage, TextContent\n\nmcp = FastMCP(name=\"PromptServer\")\n\n# Basic prompt returning a string (converted to user message automatically)\n@mcp.prompt\ndef ask_about_topic(topic: str) -> str:\n    \"\"\"Generates a user message asking for an explanation of a topic.\"\"\"\n    return f\"Can you please explain the concept of '{topic}'?\"\n\n# Prompt returning a specific message type\n@mcp.prompt\ndef generate_code_request(language: str, task_description: str) -> PromptMessage:\n    \"\"\"Generates a user message requesting code generation.\"\"\"\n    content = f\"Write a {language} function that performs the following task: {task_description}\"\n    return PromptMessage(role=\"user\", content=TextContent(type=\"text\", text=content))\n```\n\n**Key Concepts:**\n\n*   **Name:** By default, the prompt name is taken from the function name.\n*   **Parameters:** The function parameters define the inputs needed to generate the prompt.\n*   **Inferred Metadata:** By default:\n    *   Prompt Name: Taken from the function name (`ask_about_topic`).\n    *   Prompt Description: Taken from the function's docstring.\n<Tip>\nFunctions with `*args` or `**kwargs` are not supported as prompts. This restriction exists because FastMCP needs to generate a complete parameter schema for the MCP protocol, which isn't possible with variable argument lists.\n</Tip>\n\n#### Decorator Arguments\n\nWhile FastMCP infers the name and description from your function, you can override these and add additional metadata using arguments to the `@mcp.prompt` decorator:\n\n```python\n@mcp.prompt(\n    name=\"analyze_data_request\",          # Custom prompt name\n    description=\"Creates a request to analyze data with specific parameters\",  # Custom description\n    tags={\"analysis\", \"data\"},            # Optional categorization tags\n    meta={\"version\": \"1.1\", \"author\": \"data-team\"}  # Custom metadata\n)\ndef data_analysis_prompt(\n    data_uri: str = Field(description=\"The URI of the resource containing the data.\"),\n    analysis_type: str = Field(default=\"summary\", description=\"Type of analysis.\")\n) -> str:\n    \"\"\"This docstring is ignored when description is provided.\"\"\"\n    return f\"Please perform a '{analysis_type}' analysis on the data found at {data_uri}.\"\n```\n\n<Card icon=\"code\" title=\"@prompt Decorator Arguments\">\n<ParamField body=\"name\" type=\"str | None\">\n  Sets the explicit prompt name exposed via MCP. If not provided, uses the function name\n</ParamField>\n\n<ParamField body=\"title\" type=\"str | None\">\n  A human-readable title for the prompt\n</ParamField>\n\n<ParamField body=\"description\" type=\"str | None\">\n  Provides the description exposed via MCP. If set, the function's docstring is ignored for this purpose\n</ParamField>\n\n<ParamField body=\"tags\" type=\"set[str] | None\">\n  A set of strings used to categorize the prompt. These can be used by the server and, in some cases, by clients to filter or group available prompts.\n</ParamField>\n\n<ParamField body=\"enabled\" type=\"bool\" default=\"True\">\n  A boolean to enable or disable the prompt. See [Disabling Prompts](#disabling-prompts) for more information\n</ParamField>\n\n<ParamField body=\"icons\" type=\"list[Icon] | None\">\n  <VersionBadge version=\"2.13.0\" />\n\n  Optional list of icon representations for this prompt. See [Icons](/servers/icons) for detailed examples\n</ParamField>\n\n<ParamField body=\"meta\" type=\"dict[str, Any] | None\">\n  <VersionBadge version=\"2.11.0\" />\n\n  Optional meta information about the prompt. This data is passed through to the MCP client as the `_meta` field of the client-side prompt object and can be used for custom metadata, versioning, or other application-specific purposes.\n</ParamField>\n</Card>\n\n### Argument Types\n\n<VersionBadge version=\"2.9.0\" />\n\nThe MCP specification requires that all prompt arguments be passed as strings, but FastMCP allows you to use typed annotations for better developer experience. When you use complex types like `list[int]` or `dict[str, str]`, FastMCP:\n\n1. **Automatically converts** string arguments from MCP clients to the expected types\n2. **Generates helpful descriptions** showing the exact JSON string format needed\n3. **Preserves direct usage** - you can still call prompts with properly typed arguments\n\nSince the MCP specification only allows string arguments, clients need to know what string format to use for complex types. FastMCP solves this by automatically enhancing the argument descriptions with JSON schema information, making it clear to both humans and LLMs how to format their arguments.\n\n<CodeGroup>\n\n```python Python Code\n@mcp.prompt\ndef analyze_data(\n    numbers: list[int],\n    metadata: dict[str, str], \n    threshold: float\n) -> str:\n    \"\"\"Analyze numerical data.\"\"\"\n    avg = sum(numbers) / len(numbers)\n    return f\"Average: {avg}, above threshold: {avg > threshold}\"\n```\n\n```json Resulting MCP Prompt\n{\n  \"name\": \"analyze_data\",\n  \"description\": \"Analyze numerical data.\",\n  \"arguments\": [\n    {\n      \"name\": \"numbers\",\n      \"description\": \"Provide as a JSON string matching the following schema: {\\\"items\\\":{\\\"type\\\":\\\"integer\\\"},\\\"type\\\":\\\"array\\\"}\",\n      \"required\": true\n    },\n    {\n      \"name\": \"metadata\", \n      \"description\": \"Provide as a JSON string matching the following schema: {\\\"additionalProperties\\\":{\\\"type\\\":\\\"string\\\"},\\\"type\\\":\\\"object\\\"}\",\n      \"required\": true\n    },\n    {\n      \"name\": \"threshold\",\n      \"description\": \"Provide as a JSON string matching the following schema: {\\\"type\\\":\\\"number\\\"}\",\n      \"required\": true\n    }\n  ]\n}\n```\n\n</CodeGroup>\n\n**MCP clients will call this prompt with string arguments:**\n```json\n{\n  \"numbers\": \"[1, 2, 3, 4, 5]\",\n  \"metadata\": \"{\\\"source\\\": \\\"api\\\", \\\"version\\\": \\\"1.0\\\"}\",\n  \"threshold\": \"2.5\"\n}\n```\n\n**But you can still call it directly with proper types:**\n```python\n# This also works for direct calls\nresult = await prompt.render({\n    \"numbers\": [1, 2, 3, 4, 5],\n    \"metadata\": {\"source\": \"api\", \"version\": \"1.0\"}, \n    \"threshold\": 2.5\n})\n```\n\n<Warning>\nKeep your type annotations simple when using this feature. Complex nested types or custom classes may not convert reliably from JSON strings. The automatically generated schema descriptions are the only guidance users receive about the expected format.\n\nGood choices: `list[int]`, `dict[str, str]`, `float`, `bool`\nAvoid: Complex Pydantic models, deeply nested structures, custom classes\n</Warning>\n\n### Return Values\n\nFastMCP intelligently handles different return types from your prompt function:\n\n-   **`str`**: Automatically converted to a single `PromptMessage`.\n-   **`PromptMessage`**: Used directly as provided. (Note a more user-friendly `Message` constructor is available that can accept raw strings instead of `TextContent` objects.)\n-   **`list[PromptMessage | str]`**: Used as a sequence of messages (a conversation).\n-   **`PromptResult`**: Full control over messages, description, and metadata. See [PromptResult](#promptresult) below.\n-   **`Any`**: If the return type is not one of the above, the return value is attempted to be converted to a string and used as a `PromptMessage`.\n\n```python\nfrom fastmcp.prompts.prompt import Message\n\n@mcp.prompt\ndef roleplay_scenario(character: str, situation: str) -> list[Message]:\n    \"\"\"Sets up a roleplaying scenario with initial messages.\"\"\"\n    return [\n        Message(f\"Let's roleplay. You are {character}. The situation is: {situation}\"),\n        Message(\"Okay, I understand. I am ready. What happens next?\", role=\"assistant\")\n    ]\n```\n\n#### PromptResult\n\n<VersionBadge version=\"2.14.1\" />\n\nFor complete control over prompt responses, return a `PromptResult` object. This lets you include metadata alongside your prompt messages, which is useful for passing runtime information to clients.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.prompts import PromptResult, Message\n\nmcp = FastMCP(name=\"PromptServer\")\n\n@mcp.prompt\ndef code_review(code: str) -> PromptResult:\n    \"\"\"Returns a code review prompt with metadata.\"\"\"\n    return PromptResult(\n        messages=[\n            Message(f\"Please review this code:\\n\\n```\\n{code}\\n```\"),\n        ],\n        description=\"Code review prompt\",\n        meta={\"review_type\": \"security\", \"priority\": \"high\"}\n    )\n```\n\n`PromptResult` accepts three fields:\n\n**`messages`** - A list of `PromptMessage` or `Message` objects representing the conversation to send to the LLM.\n\n**`description`** - Optional description of the prompt result. If not provided, defaults to the prompt's docstring.\n\n**`meta`** - Optional metadata dictionary that will be included in the MCP response's `_meta` field. Use this for runtime metadata like categorization, priority, or other client-specific data.\n\n<Note>\nThe `meta` field in `PromptResult` is for runtime metadata specific to this render response. This is separate from the `meta` parameter in `@mcp.prompt(meta={...})`, which provides static metadata about the prompt definition itself (returned when listing prompts).\n</Note>\n\nYou can still return plain `str`, `PromptMessage`, or lists from your prompt functions\u2014`PromptResult` is opt-in for when you need to include metadata.\n\n### Required vs. Optional Parameters\n\nParameters in your function signature are considered **required** unless they have a default value.\n\n```python\n@mcp.prompt\ndef data_analysis_prompt(\n    data_uri: str,                        # Required - no default value\n    analysis_type: str = \"summary\",       # Optional - has default value\n    include_charts: bool = False          # Optional - has default value\n) -> str:\n    \"\"\"Creates a request to analyze data with specific parameters.\"\"\"\n    prompt = f\"Please perform a '{analysis_type}' analysis on the data found at {data_uri}.\"\n    if include_charts:\n        prompt += \" Include relevant charts and visualizations.\"\n    return prompt\n```\n\nIn this example, the client *must* provide `data_uri`. If `analysis_type` or `include_charts` are omitted, their default values will be used.\n\n### Disabling Prompts\n\n<VersionBadge version=\"2.8.0\" />\n\nYou can control the visibility and availability of prompts by enabling or disabling them. Disabled prompts will not appear in the list of available prompts, and attempting to call a disabled prompt will result in an \"Unknown prompt\" error.\n\nBy default, all prompts are enabled. You can disable a prompt upon creation using the `enabled` parameter in the decorator:\n\n```python\n@mcp.prompt(enabled=False)\ndef experimental_prompt():\n    \"\"\"This prompt is not ready for use.\"\"\"\n    return \"This is an experimental prompt.\"\n```\n\nYou can also toggle a prompt's state programmatically after it has been created:\n\n```python\n@mcp.prompt\ndef seasonal_prompt(): return \"Happy Holidays!\"\n\n# Disable and re-enable the prompt\nseasonal_prompt.disable()\nseasonal_prompt.enable()\n```\n\n### Async Prompts\n\nFastMCP seamlessly supports both standard (`def`) and asynchronous (`async def`) functions as prompts.\n\n```python\n# Synchronous prompt\n@mcp.prompt\ndef simple_question(question: str) -> str:\n    \"\"\"Generates a simple question to ask the LLM.\"\"\"\n    return f\"Question: {question}\"\n\n# Asynchronous prompt\n@mcp.prompt\nasync def data_based_prompt(data_id: str) -> str:\n    \"\"\"Generates a prompt based on data that needs to be fetched.\"\"\"\n    # In a real scenario, you might fetch data from a database or API\n    async with aiohttp.ClientSession() as session:\n        async with session.get(f\"https://api.example.com/data/{data_id}\") as response:\n            data = await response.json()\n            return f\"Analyze this data: {data['content']}\"\n```\n\nUse `async def` when your prompt function performs I/O operations like network requests, database queries, file I/O, or external service calls.\n\n### Accessing MCP Context\n\n<VersionBadge version=\"2.2.5\" />\n\nPrompts can access additional MCP information and features through the `Context` object. To access it, add a parameter to your prompt function with a type annotation of `Context`:\n\n```python {6}\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(name=\"PromptServer\")\n\n@mcp.prompt\nasync def generate_report_request(report_type: str, ctx: Context) -> str:\n    \"\"\"Generates a request for a report.\"\"\"\n    return f\"Please create a {report_type} report. Request ID: {ctx.request_id}\"\n```\n\nFor full documentation on the Context object and all its capabilities, see the [Context documentation](/servers/context).\n\n### Notifications\n\n<VersionBadge version=\"2.9.1\" />\n\nFastMCP automatically sends `notifications/prompts/list_changed` notifications to connected clients when prompts are added, enabled, or disabled. This allows clients to stay up-to-date with the current prompt set without manually polling for changes.\n\n```python\n@mcp.prompt\ndef example_prompt() -> str:\n    return \"Hello!\"\n\n# These operations trigger notifications:\nmcp.add_prompt(example_prompt)  # Sends prompts/list_changed notification\nexample_prompt.disable()        # Sends prompts/list_changed notification  \nexample_prompt.enable()         # Sends prompts/list_changed notification\n```\n\nNotifications are only sent when these operations occur within an active MCP request context (e.g., when called from within a tool or other MCP operation). Operations performed during server initialization do not trigger notifications.\n\nClients can handle these notifications using a [message handler](/clients/messages) to automatically refresh their prompt lists or update their interfaces.\n\n## Server Behavior\n\n### Duplicate Prompts\n\n<VersionBadge version=\"2.1.0\" />\n\nYou can configure how the FastMCP server handles attempts to register multiple prompts with the same name. Use the `on_duplicate_prompts` setting during `FastMCP` initialization.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\n    name=\"PromptServer\",\n    on_duplicate_prompts=\"error\"  # Raise an error if a prompt name is duplicated\n)\n\n@mcp.prompt\ndef greeting(): return \"Hello, how can I help you today?\"\n\n# This registration attempt will raise a ValueError because\n# \"greeting\" is already registered and the behavior is \"error\".\n# @mcp.prompt\n# def greeting(): return \"Hi there! What can I do for you?\"\n```\n\nThe duplicate behavior options are:\n\n-   `\"warn\"` (default): Logs a warning, and the new prompt replaces the old one.\n-   `\"error\"`: Raises a `ValueError`, preventing the duplicate registration.\n-   `\"replace\"`: Silently replaces the existing prompt with the new one.\n-   `\"ignore\"`: Keeps the original prompt and ignores the new registration attempt. \n"}, {"filename": "docs/servers/proxy.mdx", "content": "---\ntitle: Proxy Servers\nsidebarTitle: Proxy Servers\ndescription: Use FastMCP to act as an intermediary or change transport for other MCP servers.\nicon: arrows-retweet\n---\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\n<VersionBadge version=\"2.0.0\" />\n\nFastMCP provides a powerful proxying capability that allows one FastMCP server instance to act as a frontend for another MCP server (which could be remote, running on a different transport, or even another FastMCP instance). This is achieved using the `FastMCP.as_proxy()` class method.\n\n## What is Proxying?\n\nProxying means setting up a FastMCP server that doesn't implement its own tools or resources directly. Instead, when it receives a request (like `tools/call` or `resources/read`), it forwards that request to a *backend* MCP server, receives the response, and then relays that response back to the original client.\n\n```mermaid\nsequenceDiagram\n    participant ClientApp as Your Client (e.g., Claude Desktop)\n    participant FastMCPProxy as FastMCP Proxy Server\n    participant BackendServer as Backend MCP Server (e.g., remote SSE)\n\n    ClientApp->>FastMCPProxy: MCP Request (e.g. stdio)\n    Note over FastMCPProxy, BackendServer: Proxy forwards the request\n    FastMCPProxy->>BackendServer: MCP Request (e.g. sse)\n    BackendServer-->>FastMCPProxy: MCP Response (e.g. sse)\n    Note over ClientApp, FastMCPProxy: Proxy relays the response\n    FastMCPProxy-->>ClientApp: MCP Response (e.g. stdio)\n```\n\n### Key Benefits\n\n<VersionBadge version=\"2.10.3\" />\n\n- **Session Isolation**: Each request gets its own isolated session, ensuring safe concurrent operations\n- **Transport Bridging**: Expose servers running on one transport via a different transport\n- **Advanced MCP Features**: Automatic forwarding of sampling, elicitation, logging, and progress\n- **Security**: Acts as a controlled gateway to backend servers\n- **Simplicity**: Single endpoint even if backend location or transport changes\n\n### Performance Considerations\n\nWhen using proxy servers, especially those connecting to HTTP-based backend servers, be aware that latency can be significant. Operations like `list_tools()` may take hundreds of milliseconds compared to 1-2ms for local tools. When mounting proxy servers, this latency affects all operations on the parent server, not just interactions with the proxied tools.\n\nIf low latency is a requirement for your use-case, consider using [`import_server()`](/servers/composition#importing-static-composition) to copy tools at startup rather than proxying them at runtime.\n\n## Quick Start\n\n<VersionBadge version=\"2.10.3\" />\n\nThe recommended way to create a proxy is using `ProxyClient`, which provides full MCP feature support with automatic session isolation:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.proxy import ProxyClient\n\n# Create a proxy with full MCP feature support\nproxy = FastMCP.as_proxy(\n    ProxyClient(\"backend_server.py\"),\n    name=\"MyProxy\"\n)\n\n# Run the proxy (e.g., via stdio for Claude Desktop)\nif __name__ == \"__main__\":\n    proxy.run()\n```\n\nThis single setup gives you:\n- Safe concurrent request handling\n- Automatic forwarding of advanced MCP features (sampling, elicitation, etc.)\n- Session isolation to prevent context mixing\n- Full compatibility with all MCP clients\n\nYou can also pass a FastMCP [client transport](/clients/transports) (or parameter that can be inferred to a transport) to `as_proxy()`. This will automatically create a `ProxyClient` instance for you.\n\nFinally, you can pass a regular FastMCP `Client` instance to `as_proxy()`. This will work for many use cases, but may break if advanced MCP features like sampling or elicitation are invoked by the server. \n\n## Session Isolation & Concurrency\n\n<VersionBadge version=\"2.10.3\" />\n\nFastMCP proxies provide session isolation to ensure safe concurrent operations. The session strategy depends on how the proxy is configured:\n\n### Fresh Sessions\n\nWhen you pass a disconnected client (which is the normal case), each request gets its own isolated backend session:\n\n```python\nfrom fastmcp.server.proxy import ProxyClient\n\n# Each request creates a fresh backend session (recommended)\nproxy = FastMCP.as_proxy(ProxyClient(\"backend_server.py\"))\n\n# Multiple clients can use this proxy simultaneously without interference:\n# - Client A calls a tool -> gets isolated backend session\n# - Client B calls a tool -> gets different isolated backend session  \n# - No context mixing between requests\n```\n\n### Session Reuse with Connected Clients\n\nWhen you pass an already-connected client, the proxy will reuse that session for all requests:\n\n```python\nfrom fastmcp import Client\n\n# Create and connect a client\nasync with Client(\"backend_server.py\") as connected_client:\n    # This proxy will reuse the connected session for all requests\n    proxy = FastMCP.as_proxy(connected_client)\n    \n    # \u26a0\ufe0f Warning: All requests share the same backend session\n    # This may cause context mixing in concurrent scenarios\n```\n\n**Important**: Using shared sessions with concurrent requests from multiple clients may lead to context mixing and race conditions. This approach should only be used in single-threaded scenarios or when you have explicit synchronization.\n\n## Transport Bridging\n\nA common use case is bridging transports - exposing a server running on one transport via a different transport. For example, making a remote SSE server available locally via stdio:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.proxy import ProxyClient\n\n# Bridge remote SSE server to local stdio\nremote_proxy = FastMCP.as_proxy(\n    ProxyClient(\"http://example.com/mcp/sse\"),\n    name=\"Remote-to-Local Bridge\"\n)\n\n# Run locally via stdio for Claude Desktop\nif __name__ == \"__main__\":\n    remote_proxy.run()  # Defaults to stdio transport\n```\n\nOr expose a local server via HTTP for remote access:\n\n```python\n# Bridge local server to HTTP\nlocal_proxy = FastMCP.as_proxy(\n    ProxyClient(\"local_server.py\"),\n    name=\"Local-to-HTTP Bridge\"\n)\n\n# Run via HTTP for remote clients\nif __name__ == \"__main__\":\n    local_proxy.run(transport=\"http\", host=\"0.0.0.0\", port=8080)\n```\n\n\n## Advanced MCP Features\n\n<VersionBadge version=\"2.10.3\" />\n\n`ProxyClient` automatically forwards advanced MCP protocol features between the backend server and clients connected to the proxy, ensuring full MCP compatibility.\n\n### Supported Features\n\n- **Roots**: Forwards filesystem root access requests to the client\n- **Sampling**: Forwards LLM completion requests from backend to client  \n- **Elicitation**: Forwards user input requests to the client\n- **Logging**: Forwards log messages from backend through to client\n- **Progress**: Forwards progress notifications during long operations\n\n```python\nfrom fastmcp.server.proxy import ProxyClient\n\n# ProxyClient automatically handles all these features\nbackend = ProxyClient(\"advanced_backend.py\")\nproxy = FastMCP.as_proxy(backend)\n\n# When the backend server:\n# - Requests LLM sampling -> forwarded to your client\n# - Logs messages -> appear in your client\n# - Reports progress -> shown in your client\n# - Needs user input -> prompts your client\n```\n\n### Customizing Feature Support\n\nYou can selectively disable forwarding by passing `None` for specific handlers:\n\n```python\n# Disable sampling but keep other features\nbackend = ProxyClient(\n    \"backend_server.py\",\n    sampling_handler=None,  # Disable LLM sampling forwarding\n    log_handler=None        # Disable log forwarding\n)\n```\n\nWhen you use a transport string directly with `FastMCP.as_proxy()`, it automatically creates a `ProxyClient` internally to ensure full feature support.\n\n## Configuration-Based Proxies\n\n<VersionBadge version=\"2.4.0\" />\n\nYou can create a proxy directly from a configuration dictionary that follows the MCPConfig schema. This is useful for quickly setting up proxies to remote servers without manually configuring each connection detail.\n\n```python\nfrom fastmcp import FastMCP\n\n# Create a proxy directly from a config dictionary\nconfig = {\n    \"mcpServers\": {\n        \"default\": {  # For single server configs, 'default' is commonly used\n            \"url\": \"https://example.com/mcp\",\n            \"transport\": \"http\"\n        }\n    }\n}\n\n# Create a proxy to the configured server (auto-creates ProxyClient)\nproxy = FastMCP.as_proxy(config, name=\"Config-Based Proxy\")\n\n# Run the proxy with stdio transport for local access\nif __name__ == \"__main__\":\n    proxy.run()\n```\n\n<Note>\nThe MCPConfig format follows an emerging standard for MCP server configuration and may evolve as the specification matures. While FastMCP aims to maintain compatibility with future versions, be aware that field names or structure might change.\n</Note>\n\n### Multi-Server Configurations\n\nYou can create a proxy to multiple servers by specifying multiple entries in the config. They are automatically mounted with their config names as prefixes:\n\n```python\n# Multi-server configuration\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather-api.example.com/mcp\",\n            \"transport\": \"http\"\n        },\n        \"calendar\": {\n            \"url\": \"https://calendar-api.example.com/mcp\",\n            \"transport\": \"http\"\n        }\n    }\n}\n\n# Create a unified proxy to multiple servers\ncomposite_proxy = FastMCP.as_proxy(config, name=\"Composite Proxy\")\n\n# Tools, resources, prompts, and templates are accessible with prefixes:\n# - Tools: weather_get_forecast, calendar_add_event\n# - Prompts: weather_daily_summary, calendar_quick_add\n# - Resources: weather://weather/icons/sunny, calendar://calendar/events/today\n# - Templates: weather://weather/locations/{id}, calendar://calendar/events/{date}\n```\n\n## Component Prefixing\n\nWhen proxying one or more servers, component names are prefixed the same way as with mounting and importing:\n\n- Tools: `{prefix}_{tool_name}`\n- Prompts: `{prefix}_{prompt_name}`\n- Resources: `protocol://{prefix}/path/to/resource` (default path format)\n- Resource templates: `protocol://{prefix}/...` and template names are also prefixed\n\nThese rules apply uniformly whether you:\n- Mount a proxy on another server\n- Create a multi-server proxy from an `MCPConfig`\n- Use `FastMCP.as_proxy()` directly\n\n## Mirrored Components\n\n<VersionBadge version=\"2.10.5\" />\n\nWhen you access tools, resources, or prompts from a proxy server, they are \"mirrored\" from the remote server. Mirrored components cannot be modified directly since they reflect the state of the remote server. For example, you can not simply \"disable\" a mirrored component.\n\nHowever, you can create a copy of a mirrored component and store it as a new locally-defined component. Local components always take precedence over mirrored ones because the proxy server will check its own registry before it attempts to engage the remote server.\n\nTherefore, to enable or disable a proxy tool, resource, or prompt, you should first create a local copy and add it to your own server. Here's an example of how to do that for a tool:\n\n```python\n# Create your own server\nmy_server = FastMCP(\"MyServer\")\n\n# Get a proxy server\nproxy = FastMCP.as_proxy(\"backend_server.py\")\n\n# Get mirrored components from proxy\nmirrored_tool = await proxy.get_tool(\"useful_tool\")\n\n# Create a local copy that you can modify\nlocal_tool = mirrored_tool.copy()\n\n# Add the local copy to your server\nmy_server.add_tool(local_tool)\n\n# Now you can disable YOUR copy\nlocal_tool.disable()\n```\n\n\n## `FastMCPProxy` Class\n\nInternally, `FastMCP.as_proxy()` uses the `FastMCPProxy` class. You generally don't need to interact with this class directly, but it's available if needed for advanced scenarios.\n\n### Direct Usage\n\n```python\nfrom fastmcp.server.proxy import FastMCPProxy, ProxyClient\n\n# Provide a client factory for explicit session control\ndef create_client():\n    return ProxyClient(\"backend_server.py\")\n\nproxy = FastMCPProxy(client_factory=create_client)\n```\n\n### Parameters\n\n- **`client_factory`**: A callable that returns a `Client` instance when called. This gives you full control over session creation and reuse strategies.\n\n### Explicit Session Management\n\n`FastMCPProxy` requires explicit session management - no automatic detection is performed. You must choose your session strategy:\n\n```python\n# Share session across all requests (be careful with concurrency)\nshared_client = ProxyClient(\"backend_server.py\")\ndef shared_session_factory():\n    return shared_client\n\nproxy = FastMCPProxy(client_factory=shared_session_factory)\n\n# Create fresh sessions per request (recommended)\ndef fresh_session_factory():\n    return ProxyClient(\"backend_server.py\")\n\nproxy = FastMCPProxy(client_factory=fresh_session_factory)\n```\n\nFor automatic session strategy selection, use the convenience method `FastMCP.as_proxy()` instead.\n\n```python\n# Custom factory with specific configuration\ndef custom_client_factory():\n    client = ProxyClient(\"backend_server.py\")\n    # Add any custom configuration here\n    return client\n\nproxy = FastMCPProxy(client_factory=custom_client_factory)\n```\n"}, {"filename": "docs/servers/resources.mdx", "content": "---\ntitle: Resources & Templates\nsidebarTitle: Resources\ndescription: Expose data sources and dynamic content generators to your MCP client.\nicon: folder-open\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\nResources represent data or files that an MCP client can read, and resource templates extend this concept by allowing clients to request dynamically generated resources based on parameters passed in the URI.\n\nFastMCP simplifies defining both static and dynamic resources, primarily using the `@mcp.resource` decorator.\n\n## What Are Resources?\n\nResources provide read-only access to data for the LLM or client application. When a client requests a resource URI:\n\n1.  FastMCP finds the corresponding resource definition.\n2.  If it's dynamic (defined by a function), the function is executed.\n3.  The content (text, JSON, binary data) is returned to the client.\n\nThis allows LLMs to access files, database content, configuration, or dynamically generated information relevant to the conversation.\n\n## Resources\n\n### The `@resource` Decorator\n\nThe most common way to define a resource is by decorating a Python function. The decorator requires the resource's unique URI.\n\n```python\nimport json\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n# Basic dynamic resource returning a string\n@mcp.resource(\"resource://greeting\")\ndef get_greeting() -> str:\n    \"\"\"Provides a simple greeting message.\"\"\"\n    return \"Hello from FastMCP Resources!\"\n\n# Resource returning JSON data (dict is auto-serialized)\n@mcp.resource(\"data://config\")\ndef get_config() -> dict:\n    \"\"\"Provides application configuration as JSON.\"\"\"\n    return {\n        \"theme\": \"dark\",\n        \"version\": \"1.2.0\",\n        \"features\": [\"tools\", \"resources\"],\n    }\n```\n\n**Key Concepts:**\n\n*   **URI:** The first argument to `@resource` is the unique URI (e.g., `\"resource://greeting\"`) clients use to request this data.\n*   **Lazy Loading:** The decorated function (`get_greeting`, `get_config`) is only executed when a client specifically requests that resource URI via `resources/read`.\n*   **Inferred Metadata:** By default:\n    *   Resource Name: Taken from the function name (`get_greeting`).\n    *   Resource Description: Taken from the function's docstring.\n\n#### Decorator Arguments\n\nYou can customize the resource's properties using arguments in the `@mcp.resource` decorator:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n# Example specifying metadata\n@mcp.resource(\n    uri=\"data://app-status\",      # Explicit URI (required)\n    name=\"ApplicationStatus\",     # Custom name\n    description=\"Provides the current status of the application.\", # Custom description\n    mime_type=\"application/json\", # Explicit MIME type\n    tags={\"monitoring\", \"status\"}, # Categorization tags\n    meta={\"version\": \"2.1\", \"team\": \"infrastructure\"}  # Custom metadata\n)\ndef get_application_status() -> dict:\n    \"\"\"Internal function description (ignored if description is provided above).\"\"\"\n    return {\"status\": \"ok\", \"uptime\": 12345, \"version\": mcp.settings.version} # Example usage\n```\n\n<Card icon=\"code\" title=\"@resource Decorator Arguments\">\n<ParamField body=\"uri\" type=\"str\" required>\n  The unique identifier for the resource\n</ParamField>\n\n<ParamField body=\"name\" type=\"str | None\">\n  A human-readable name. If not provided, defaults to function name\n</ParamField>\n\n<ParamField body=\"description\" type=\"str | None\">\n  Explanation of the resource. If not provided, defaults to docstring\n</ParamField>\n\n<ParamField body=\"mime_type\" type=\"str | None\">\n  Specifies the content type. FastMCP often infers a default like `text/plain` or `application/json`, but explicit is better for non-text types\n</ParamField>\n\n<ParamField body=\"tags\" type=\"set[str] | None\">\n  A set of strings used to categorize the resource. These can be used by the server and, in some cases, by clients to filter or group available resources.\n</ParamField>\n\n<ParamField body=\"enabled\" type=\"bool\" default=\"True\">\n  A boolean to enable or disable the resource. See [Disabling Resources](#disabling-resources) for more information\n</ParamField>\n\n<ParamField body=\"icons\" type=\"list[Icon] | None\">\n  <VersionBadge version=\"2.13.0\" />\n\n  Optional list of icon representations for this resource or template. See [Icons](/servers/icons) for detailed examples\n</ParamField>\n\n<ParamField body=\"annotations\" type=\"Annotations | dict | None\">\n    An optional `Annotations` object or dictionary to add additional metadata about the resource.\n  <Expandable title=\"Annotations attributes\">\n    <ParamField body=\"readOnlyHint\" type=\"bool | None\">\n      If true, the resource is read-only and does not modify its environment.\n    </ParamField>\n    <ParamField body=\"idempotentHint\" type=\"bool | None\">\n      If true, reading the resource repeatedly will have no additional effect on its environment.\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"meta\" type=\"dict[str, Any] | None\">\n  <VersionBadge version=\"2.11.0\" />\n  \n  Optional meta information about the resource. This data is passed through to the MCP client as the `_meta` field of the client-side resource object and can be used for custom metadata, versioning, or other application-specific purposes.\n</ParamField>\n</Card>\n\n### Return Values\n\nFastMCP automatically converts your function's return value into the appropriate MCP resource content:\n\n-   **`str`**: Sent as `TextResourceContents` (with `mime_type=\"text/plain\"` by default).\n-   **`dict`, `list`, `pydantic.BaseModel`**: Automatically serialized to a JSON string and sent as `TextResourceContents` (with `mime_type=\"application/json\"` by default).\n-   **`bytes`**: Base64 encoded and sent as `BlobResourceContents`. You should specify an appropriate `mime_type` (e.g., `\"image/png\"`, `\"application/octet-stream\"`).\n-   **`ResourceContent`**: Full control over content, MIME type, and metadata. See [ResourceContent](#resourcecontent) below.\n-   **`None`**: Results in an empty resource content list being returned.\n\n#### ResourceContent\n\n<VersionBadge version=\"2.14.1\" />\n\nFor complete control over resource responses, return a `ResourceContent` object. This lets you include metadata alongside your resource content, which is useful for cases like Content Security Policy headers for HTML widgets.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.resources import ResourceContent\n\nmcp = FastMCP(name=\"WidgetServer\")\n\n@mcp.resource(\"widget://my-widget\")\ndef get_widget() -> ResourceContent:\n    \"\"\"Returns an HTML widget with CSP metadata.\"\"\"\n    return ResourceContent(\n        content=\"<html><body>My Widget</body></html>\",\n        mime_type=\"text/html\",\n        meta={\"csp\": \"script-src 'self'\"}\n    )\n```\n\n`ResourceContent` accepts three fields:\n\n**`content`** - The actual resource content. Can be `str` (text content) or `bytes` (binary content). This is the data that will be returned to the client.\n\n**`mime_type`** - Optional MIME type for the content. Defaults to `\"text/plain\"` for string content and `\"application/octet-stream\"` for binary content.\n\n**`meta`** - Optional metadata dictionary that will be included in the MCP response's `_meta` field. Use this for runtime metadata like Content Security Policy headers, caching hints, or other client-specific data.\n\n```python\n# Binary content with metadata\n@mcp.resource(\"images://logo\")\ndef get_logo() -> ResourceContent:\n    \"\"\"Returns a logo image with caching metadata.\"\"\"\n    with open(\"logo.png\", \"rb\") as f:\n        image_data = f.read()\n    return ResourceContent(\n        content=image_data,\n        mime_type=\"image/png\",\n        meta={\"cache-control\": \"max-age=3600\"}\n    )\n```\n\n<Note>\nThe `meta` field in `ResourceContent` is for runtime metadata specific to this read response. This is separate from the `meta` parameter in `@mcp.resource(meta={...})`, which provides static metadata about the resource definition itself (returned when listing resources).\n</Note>\n\nYou can still return plain `str` or `bytes` from your resource functions\u2014`ResourceContent` is opt-in for when you need to include metadata.\n\n### Disabling Resources\n\n<VersionBadge version=\"2.8.0\" />\n\nYou can control the visibility and availability of resources and templates by enabling or disabling them. Disabled resources will not appear in the list of available resources or templates, and attempting to read a disabled resource will result in an \"Unknown resource\" error.\n\nBy default, all resources are enabled. You can disable a resource upon creation using the `enabled` parameter in the decorator:\n\n```python\n@mcp.resource(\"data://secret\", enabled=False)\ndef get_secret_data():\n    \"\"\"This resource is currently disabled.\"\"\"\n    return \"Secret data\"\n```\n\nYou can also toggle a resource's state programmatically after it has been created:\n\n```python\n@mcp.resource(\"data://config\")\ndef get_config(): return {\"version\": 1}\n\n# Disable and re-enable the resource\nget_config.disable()\nget_config.enable()\n```\n\n\n### Accessing MCP Context\n\n<VersionBadge version=\"2.2.5\" />\n\nResources and resource templates can access additional MCP information and features through the `Context` object. To access it, add a parameter to your resource function with a type annotation of `Context`:\n\n```python {6, 14}\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(name=\"DataServer\")\n\n@mcp.resource(\"resource://system-status\")\nasync def get_system_status(ctx: Context) -> dict:\n    \"\"\"Provides system status information.\"\"\"\n    return {\n        \"status\": \"operational\",\n        \"request_id\": ctx.request_id\n    }\n\n@mcp.resource(\"resource://{name}/details\")\nasync def get_details(name: str, ctx: Context) -> dict:\n    \"\"\"Get details for a specific name.\"\"\"\n    return {\n        \"name\": name,\n        \"accessed_at\": ctx.request_id\n    }\n```\n\nFor full documentation on the Context object and all its capabilities, see the [Context documentation](/servers/context).\n\n\n### Async Resources\n\nUse `async def` for resource functions that perform I/O operations (e.g., reading from a database or network) to avoid blocking the server.\n\n```python\nimport aiofiles\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n@mcp.resource(\"file:///app/data/important_log.txt\", mime_type=\"text/plain\")\nasync def read_important_log() -> str:\n    \"\"\"Reads content from a specific log file asynchronously.\"\"\"\n    try:\n        async with aiofiles.open(\"/app/data/important_log.txt\", mode=\"r\") as f:\n            content = await f.read()\n        return content\n    except FileNotFoundError:\n        return \"Log file not found.\"\n```\n\n\n### Resource Classes\n\nWhile `@mcp.resource` is ideal for dynamic content, you can directly register pre-defined resources (like static files or simple text) using `mcp.add_resource()` and concrete `Resource` subclasses.\n\n```python\nfrom pathlib import Path\nfrom fastmcp import FastMCP\nfrom fastmcp.resources import FileResource, TextResource, DirectoryResource\n\nmcp = FastMCP(name=\"DataServer\")\n\n# 1. Exposing a static file directly\nreadme_path = Path(\"./README.md\").resolve()\nif readme_path.exists():\n    # Use a file:// URI scheme\n    readme_resource = FileResource(\n        uri=f\"file://{readme_path.as_posix()}\",\n        path=readme_path, # Path to the actual file\n        name=\"README File\",\n        description=\"The project's README.\",\n        mime_type=\"text/markdown\",\n        tags={\"documentation\"}\n    )\n    mcp.add_resource(readme_resource)\n\n# 2. Exposing simple, predefined text\nnotice_resource = TextResource(\n    uri=\"resource://notice\",\n    name=\"Important Notice\",\n    text=\"System maintenance scheduled for Sunday.\",\n    tags={\"notification\"}\n)\nmcp.add_resource(notice_resource)\n\n# 3. Using a custom key different from the URI\nspecial_resource = TextResource(\n    uri=\"resource://common-notice\",\n    name=\"Special Notice\",\n    text=\"This is a special notice with a custom storage key.\",\n)\nmcp.add_resource(special_resource, key=\"resource://custom-key\")\n\n# 4. Exposing a directory listing\ndata_dir_path = Path(\"./app_data\").resolve()\nif data_dir_path.is_dir():\n    data_listing_resource = DirectoryResource(\n        uri=\"resource://data-files\",\n        path=data_dir_path, # Path to the directory\n        name=\"Data Directory Listing\",\n        description=\"Lists files available in the data directory.\",\n        recursive=False # Set to True to list subdirectories\n    )\n    mcp.add_resource(data_listing_resource) # Returns JSON list of files\n```\n\n**Common Resource Classes:**\n\n-   `TextResource`: For simple string content.\n-   `BinaryResource`: For raw `bytes` content.\n-   `FileResource`: Reads content from a local file path. Handles text/binary modes and lazy reading.\n-   `HttpResource`: Fetches content from an HTTP(S) URL (requires `httpx`).\n-   `DirectoryResource`: Lists files in a local directory (returns JSON).\n-   (`FunctionResource`: Internal class used by `@mcp.resource`).\n\nUse these when the content is static or sourced directly from a file/URL, bypassing the need for a dedicated Python function.\n\n#### Custom Resource Keys\n\n<VersionBadge version=\"2.2.0\" />\n\nWhen adding resources directly with `mcp.add_resource()`, you can optionally provide a custom storage key:\n\n```python\n# Creating a resource with standard URI as the key\nresource = TextResource(uri=\"resource://data\")\nmcp.add_resource(resource)  # Will be stored and accessed using \"resource://data\"\n\n# Creating a resource with a custom key\nspecial_resource = TextResource(uri=\"resource://special-data\")\nmcp.add_resource(special_resource, key=\"internal://data-v2\")  # Will be stored and accessed using \"internal://data-v2\"\n```\n\nNote that this parameter is only available when using `add_resource()` directly and not through the `@resource` decorator, as URIs are provided explicitly when using the decorator.\n\n### Notifications\n\n<VersionBadge version=\"2.9.1\" />\n\nFastMCP automatically sends `notifications/resources/list_changed` notifications to connected clients when resources or templates are added, enabled, or disabled. This allows clients to stay up-to-date with the current resource set without manually polling for changes.\n\n```python\n@mcp.resource(\"data://example\")\ndef example_resource() -> str:\n    return \"Hello!\"\n\n# These operations trigger notifications:\nmcp.add_resource(example_resource)  # Sends resources/list_changed notification\nexample_resource.disable()          # Sends resources/list_changed notification  \nexample_resource.enable()           # Sends resources/list_changed notification\n```\n\nNotifications are only sent when these operations occur within an active MCP request context (e.g., when called from within a tool or other MCP operation). Operations performed during server initialization do not trigger notifications.\n\nClients can handle these notifications using a [message handler](/clients/messages) to automatically refresh their resource lists or update their interfaces.\n\n### Annotations\n\n<VersionBadge version=\"2.11.0\" />\n\nFastMCP allows you to add specialized metadata to your resources through annotations. These annotations communicate how resources behave to client applications without consuming token context in LLM prompts.\n\nAnnotations serve several purposes in client applications:\n- Indicating whether resources are read-only or may have side effects\n- Describing the safety profile of resources (idempotent vs. non-idempotent)\n- Helping clients optimize caching and access patterns\n\nYou can add annotations to a resource using the `annotations` parameter in the `@mcp.resource` decorator:\n\n```python\n@mcp.resource(\n    \"data://config\",\n    annotations={\n        \"readOnlyHint\": True,\n        \"idempotentHint\": True\n    }\n)\ndef get_config() -> dict:\n    \"\"\"Get application configuration.\"\"\"\n    return {\"version\": \"1.0\", \"debug\": False}\n```\n\nFastMCP supports these standard annotations:\n\n| Annotation | Type | Default | Purpose |\n| :--------- | :--- | :------ | :------ |\n| `readOnlyHint` | boolean | true | Indicates if the resource only provides data without side effects |\n| `idempotentHint` | boolean | true | Indicates if repeated reads have the same effect as a single read |\n\nRemember that annotations help make better user experiences but should be treated as advisory hints. They help client applications present appropriate UI elements and optimize access patterns, but won't enforce behavior on their own. Always focus on making your annotations accurately represent what your resource actually does.\n\n## Resource Templates\n\nResource Templates allow clients to request resources whose content depends on parameters embedded in the URI. Define a template using the **same `@mcp.resource` decorator**, but include `{parameter_name}` placeholders in the URI string and add corresponding arguments to your function signature.\n\nResource templates share most configuration options with regular resources (name, description, mime_type, tags, annotations), but add the ability to define URI parameters that map to function parameters.\n\nResource templates generate a new resource for each unique set of parameters, which means that resources can be dynamically created on-demand. For example, if the resource template `\"user://profile/{name}\"` is registered, MCP clients could request `\"user://profile/ford\"` or `\"user://profile/marvin\"` to retrieve either of those two user profiles as resources, without having to register each resource individually.\n\n<Tip>\nFunctions with `*args` are not supported as resource templates. However, unlike tools and prompts, resource templates do support `**kwargs` because the URI template defines specific parameter names that will be collected and passed as keyword arguments.\n</Tip>\n\nHere is a complete example that shows how to define two resource templates:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n# Template URI includes {city} placeholder\n@mcp.resource(\"weather://{city}/current\")\ndef get_weather(city: str) -> dict:\n    \"\"\"Provides weather information for a specific city.\"\"\"\n    # In a real implementation, this would call a weather API\n    # Here we're using simplified logic for example purposes\n    return {\n        \"city\": city.capitalize(),\n        \"temperature\": 22,\n        \"condition\": \"Sunny\",\n        \"unit\": \"celsius\"\n    }\n\n# Template with multiple parameters and annotations\n@mcp.resource(\n    \"repos://{owner}/{repo}/info\",\n    annotations={\n        \"readOnlyHint\": True,\n        \"idempotentHint\": True\n    }\n)\ndef get_repo_info(owner: str, repo: str) -> dict:\n    \"\"\"Retrieves information about a GitHub repository.\"\"\"\n    # In a real implementation, this would call the GitHub API\n    return {\n        \"owner\": owner,\n        \"name\": repo,\n        \"full_name\": f\"{owner}/{repo}\",\n        \"stars\": 120,\n        \"forks\": 48\n    }\n```\n\nWith these two templates defined, clients can request a variety of resources:\n- `weather://london/current` \u2192 Returns weather for London\n- `weather://paris/current` \u2192 Returns weather for Paris\n- `repos://jlowin/fastmcp/info` \u2192 Returns info about the jlowin/fastmcp repository\n- `repos://prefecthq/prefect/info` \u2192 Returns info about the prefecthq/prefect repository\n\n### RFC 6570 URI Templates\n\n\nFastMCP implements [RFC 6570 URI Templates](https://datatracker.ietf.org/doc/html/rfc6570) for resource templates, providing a standardized way to define parameterized URIs. This includes support for simple expansion, wildcard path parameters, and form-style query parameters.\n\n#### Wildcard Parameters\n\n<VersionBadge version=\"2.2.4\" />\n\nResource templates support wildcard parameters that can match multiple path segments. While standard parameters (`{param}`) only match a single path segment and don't cross \"/\" boundaries, wildcard parameters (`{param*}`) can capture multiple segments including slashes. Wildcards capture all subsequent path segments *up until* the defined part of the URI template (whether literal or another parameter). This allows you to have multiple wildcard parameters in a single URI template.\n\n```python {15, 23}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n\n# Standard parameter only matches one segment\n@mcp.resource(\"files://{filename}\")\ndef get_file(filename: str) -> str:\n    \"\"\"Retrieves a file by name.\"\"\"\n    # Will only match files://<single-segment>\n    return f\"File content for: {filename}\"\n\n\n# Wildcard parameter can match multiple segments\n@mcp.resource(\"path://{filepath*}\")\ndef get_path_content(filepath: str) -> str:\n    \"\"\"Retrieves content at a specific path.\"\"\"\n    # Can match path://docs/server/resources.mdx\n    return f\"Content at path: {filepath}\"\n\n\n# Mixing standard and wildcard parameters\n@mcp.resource(\"repo://{owner}/{path*}/template.py\")\ndef get_template_file(owner: str, path: str) -> dict:\n    \"\"\"Retrieves a file from a specific repository and path, but\n    only if the resource ends with `template.py`\"\"\"\n    # Can match repo://jlowin/fastmcp/src/resources/template.py\n    return {\n        \"owner\": owner,\n        \"path\": path + \"/template.py\",\n        \"content\": f\"File at {path}/template.py in {owner}'s repository\"\n    }\n```\n\nWildcard parameters are useful when:\n\n- Working with file paths or hierarchical data\n- Creating APIs that need to capture variable-length path segments\n- Building URL-like patterns similar to REST APIs\n\nNote that like regular parameters, each wildcard parameter must still be a named parameter in your function signature, and all required function parameters must appear in the URI template.\n\n#### Query Parameters\n\n<VersionBadge version=\"2.13.0\" />\n\nFastMCP supports RFC 6570 form-style query parameters using the `{?param1,param2}` syntax. Query parameters provide a clean way to pass optional configuration to resources without cluttering the path.\n\nQuery parameters must be optional function parameters (have default values), while path parameters map to required function parameters. This enforces a clear separation: required data goes in the path, optional configuration in query params.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n# Basic query parameters\n@mcp.resource(\"data://{id}{?format}\")\ndef get_data(id: str, format: str = \"json\") -> str:\n    \"\"\"Retrieve data in specified format.\"\"\"\n    if format == \"xml\":\n        return f\"<data id='{id}' />\"\n    return f'{{\"id\": \"{id}\"}}'\n\n# Multiple query parameters with type coercion\n@mcp.resource(\"api://{endpoint}{?version,limit,offset}\")\ndef call_api(endpoint: str, version: int = 1, limit: int = 10, offset: int = 0) -> dict:\n    \"\"\"Call API endpoint with pagination.\"\"\"\n    return {\n        \"endpoint\": endpoint,\n        \"version\": version,\n        \"limit\": limit,\n        \"offset\": offset,\n        \"results\": fetch_results(endpoint, version, limit, offset)\n    }\n\n# Query parameters with wildcards\n@mcp.resource(\"files://{path*}{?encoding,lines}\")\ndef read_file(path: str, encoding: str = \"utf-8\", lines: int = 100) -> str:\n    \"\"\"Read file with optional encoding and line limit.\"\"\"\n    return read_file_content(path, encoding, lines)\n```\n\n**Example requests:**\n- `data://123` \u2192 Uses default format `\"json\"`\n- `data://123?format=xml` \u2192 Uses format `\"xml\"`\n- `api://users?version=2&limit=50` \u2192 `version=2, limit=50, offset=0`\n- `files://src/main.py?encoding=ascii&lines=50` \u2192 Custom encoding and line limit\n\nFastMCP automatically coerces query parameter string values to the correct types based on your function's type hints (`int`, `float`, `bool`, `str`).\n\n**Query parameters vs. hidden defaults:**\n\nQuery parameters expose optional configuration to clients. To hide optional parameters from clients entirely (always use defaults), simply omit them from the URI template:\n\n```python\n# Clients CAN override max_results via query string\n@mcp.resource(\"search://{query}{?max_results}\")\ndef search_configurable(query: str, max_results: int = 10) -> dict:\n    return {\"query\": query, \"limit\": max_results}\n\n# Clients CANNOT override max_results (not in URI template)\n@mcp.resource(\"search://{query}\")\ndef search_fixed(query: str, max_results: int = 10) -> dict:\n    return {\"query\": query, \"limit\": max_results}\n```\n\n### Template Parameter Rules\n\n<VersionBadge version=\"2.2.0\" />\n\nFastMCP enforces these validation rules when creating resource templates:\n\n1. **Required function parameters** (no default values) must appear in the URI path template\n2. **Query parameters** (specified with `{?param}` syntax) must be optional function parameters with default values\n3. **All URI template parameters** (path and query) must exist as function parameters\n\nOptional function parameters (those with default values) can be:\n- Included as query parameters (`{?param}`) - clients can override via query string\n- Omitted from URI template - always uses default value, not exposed to clients\n- Used in alternative path templates - enables multiple ways to access the same resource\n\n**Multiple templates for one function:**\n\nCreate multiple resource templates that expose the same function through different URI patterns by manually applying decorators:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DataServer\")\n\n# Define a user lookup function that can be accessed by different identifiers\ndef lookup_user(name: str | None = None, email: str | None = None) -> dict:\n    \"\"\"Look up a user by either name or email.\"\"\"\n    if email:\n        return find_user_by_email(email)  # pseudocode\n    elif name:\n        return find_user_by_name(name)  # pseudocode\n    else:\n        return {\"error\": \"No lookup parameters provided\"}\n\n# Manually apply multiple decorators to the same function\nmcp.resource(\"users://email/{email}\")(lookup_user)\nmcp.resource(\"users://name/{name}\")(lookup_user)\n```\n\nNow an LLM or client can retrieve user information in two different ways:\n- `users://email/alice@example.com` \u2192 Looks up user by email (with name=None)\n- `users://name/Bob` \u2192 Looks up user by name (with email=None)\n\nThis approach allows a single function to be registered with multiple URI patterns while keeping the implementation clean and straightforward.\n\nTemplates provide a powerful way to expose parameterized data access points following REST-like principles.\n\n## Error Handling\n\n<VersionBadge version=\"2.4.1\" />\n\nIf your resource function encounters an error, you can raise a standard Python exception (`ValueError`, `TypeError`, `FileNotFoundError`, custom exceptions, etc.) or a FastMCP `ResourceError`.\n\nBy default, all exceptions (including their details) are logged and converted into an MCP error response to be sent back to the client LLM. This helps the LLM understand failures and react appropriately.\n\nIf you want to mask internal error details for security reasons, you can:\n\n1. Use the `mask_error_details=True` parameter when creating your `FastMCP` instance:\n```python\nmcp = FastMCP(name=\"SecureServer\", mask_error_details=True)\n```\n\n2. Or use `ResourceError` to explicitly control what error information is sent to clients:\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.exceptions import ResourceError\n\nmcp = FastMCP(name=\"DataServer\")\n\n@mcp.resource(\"resource://safe-error\")\ndef fail_with_details() -> str:\n    \"\"\"This resource provides detailed error information.\"\"\"\n    # ResourceError contents are always sent back to clients,\n    # regardless of mask_error_details setting\n    raise ResourceError(\"Unable to retrieve data: file not found\")\n\n@mcp.resource(\"resource://masked-error\")\ndef fail_with_masked_details() -> str:\n    \"\"\"This resource masks internal error details when mask_error_details=True.\"\"\"\n    # This message would be masked if mask_error_details=True\n    raise ValueError(\"Sensitive internal file path: /etc/secrets.conf\")\n\n@mcp.resource(\"data://{id}\")\ndef get_data_by_id(id: str) -> dict:\n    \"\"\"Template resources also support the same error handling pattern.\"\"\"\n    if id == \"secure\":\n        raise ValueError(\"Cannot access secure data\")\n    elif id == \"missing\":\n        raise ResourceError(\"Data ID 'missing' not found in database\")\n    return {\"id\": id, \"value\": \"data\"}\n```\n\nWhen `mask_error_details=True`, only error messages from `ResourceError` will include details, other exceptions will be converted to a generic message.\n\n## Server Behavior\n\n### Duplicate Resources\n\n<VersionBadge version=\"2.1.0\" />\n\nYou can configure how the FastMCP server handles attempts to register multiple resources or templates with the same URI. Use the `on_duplicate_resources` setting during `FastMCP` initialization.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\n    name=\"ResourceServer\",\n    on_duplicate_resources=\"error\" # Raise error on duplicates\n)\n\n@mcp.resource(\"data://config\")\ndef get_config_v1(): return {\"version\": 1}\n\n# This registration attempt will raise a ValueError because\n# \"data://config\" is already registered and the behavior is \"error\".\n# @mcp.resource(\"data://config\")\n# def get_config_v2(): return {\"version\": 2}\n```\n\nThe duplicate behavior options are:\n\n-   `\"warn\"` (default): Logs a warning, and the new resource/template replaces the old one.\n-   `\"error\"`: Raises a `ValueError`, preventing the duplicate registration.\n-   `\"replace\"`: Silently replaces the existing resource/template with the new one.\n-   `\"ignore\"`: Keeps the original resource/template and ignores the new registration attempt."}, {"filename": "docs/servers/sampling.mdx", "content": "---\ntitle: LLM Sampling\nsidebarTitle: Sampling\ndescription: Request LLM text generation from the client or a configured provider through the MCP context.\nicon: robot\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\";\n\n<VersionBadge version=\"2.0.0\" />\n\nLLM sampling allows your MCP tools to request text generation from an LLM during execution. This enables tools to leverage AI capabilities for analysis, generation, reasoning, and more\u2014without the client needing to orchestrate multiple calls.\n\nBy default, sampling requests are routed to the client's LLM. You can also configure a fallback handler to use a specific provider (like OpenAI) when the client doesn't support sampling, or to always use your own LLM regardless of client capabilities.\n\n## Method Reference\n\n<Card icon=\"code\" title=\"ctx.sample()\">\n<ResponseField name=\"ctx.sample\" type=\"async method\">\n  Request text generation from the LLM, running to completion automatically.\n\n  <Expandable title=\"Parameters\">\n    <ResponseField name=\"messages\" type=\"str | list[str | SamplingMessage]\">\n      The prompt to send. Can be a simple string or a list of messages for multi-turn conversations.\n    </ResponseField>\n\n    <ResponseField name=\"system_prompt\" type=\"str | None\" default=\"None\">\n      Instructions that establish the LLM's role and behavior.\n    </ResponseField>\n\n    <ResponseField name=\"temperature\" type=\"float | None\" default=\"None\">\n      Controls randomness (0.0 = deterministic, 1.0 = creative).\n    </ResponseField>\n\n    <ResponseField name=\"max_tokens\" type=\"int | None\" default=\"512\">\n      Maximum tokens to generate.\n    </ResponseField>\n\n    <ResponseField name=\"model_preferences\" type=\"str | list[str] | None\" default=\"None\">\n      Hints for which model the client should use.\n    </ResponseField>\n\n    <ResponseField name=\"tools\" type=\"list[Callable] | None\" default=\"None\">\n      Functions the LLM can call during sampling.\n    </ResponseField>\n\n    <ResponseField name=\"result_type\" type=\"type[T] | None\" default=\"None\">\n      A type for validated structured output. Supports Pydantic models, dataclasses, and basic types like `int`, `list[str]`, or `dict[str, int]`.\n    </ResponseField>\n\n    <ResponseField name=\"mask_error_details\" type=\"bool | None\" default=\"None\">\n      If True, mask detailed error messages from tool execution. When None (default), uses the global `settings.mask_error_details` value. Tools can raise `ToolError` to bypass masking and provide specific error messages to the LLM.\n    </ResponseField>\n\n  </Expandable>\n\n  <Expandable title=\"Response\">\n    <ResponseField name=\"SamplingResult[T]\" type=\"dataclass\">\n      - `.text`: The raw text response (or JSON for structured output)\n      - `.result`: The typed result\u2014same as `.text` for plain text, or a validated Pydantic object for structured output\n      - `.history`: All messages exchanged during sampling\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n<Card icon=\"code\" title=\"ctx.sample_step()\">\n<ResponseField name=\"ctx.sample_step\" type=\"async method\">\n  Make a single LLM sampling call. Use this for fine-grained control over the sampling loop.\n\n  <Expandable title=\"Parameters\">\n    Same as `sample()`, plus:\n\n    <ResponseField name=\"tool_choice\" type=\"str | None\" default=\"None\">\n      Controls tool usage: `\"auto\"`, `\"required\"`, or `\"none\"`.\n    </ResponseField>\n\n    <ResponseField name=\"execute_tools\" type=\"bool\" default=\"True\">\n      If True, execute tool calls and append results to history. If False, return immediately with tool calls available for manual execution.\n    </ResponseField>\n\n    <ResponseField name=\"mask_error_details\" type=\"bool | None\" default=\"None\">\n      If True, mask detailed error messages from tool execution. When None (default), uses the global `settings.mask_error_details` value. Tools can raise `ToolError` to bypass masking.\n    </ResponseField>\n\n  </Expandable>\n\n  <Expandable title=\"Response\">\n    <ResponseField name=\"SampleStep\" type=\"dataclass\">\n      - `.response`: The raw LLM response\n      - `.history`: Messages including input, assistant response, and tool results\n      - `.is_tool_use`: True if the LLM requested tool execution\n      - `.tool_calls`: List of tool calls (if any)\n      - `.text`: The text content (if any)\n    </ResponseField>\n  </Expandable>\n</ResponseField>\n</Card>\n\n## Basic Sampling\n\nThe simplest use of sampling is passing a prompt string to `ctx.sample()`. The method sends the prompt to the LLM, waits for the complete response, and returns a `SamplingResult`. You can access the generated text through the `.text` attribute.\n\n```python\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP()\n\n@mcp.tool\nasync def summarize(content: str, ctx: Context) -> str:\n    \"\"\"Generate a summary of the provided content.\"\"\"\n    result = await ctx.sample(f\"Please summarize this:\\n\\n{content}\")\n    return result.text or \"\"\n```\n\nThe `SamplingResult` also provides `.result` (identical to `.text` for plain text responses) and `.history` containing the full message exchange\u2014useful if you need to continue the conversation or debug the interaction.\n\n### System Prompts\n\nSystem prompts let you establish the LLM's role and behavioral guidelines before it processes your request. This is useful for controlling tone, enforcing constraints, or providing context that shouldn't clutter the user-facing prompt.\n\n````python\n@mcp.tool\nasync def generate_code(concept: str, ctx: Context) -> str:\n    \"\"\"Generate a Python code example for a concept.\"\"\"\n    result = await ctx.sample(\n        messages=f\"Write a Python example demonstrating '{concept}'.\",\n        system_prompt=(\n            \"You are an expert Python programmer. \"\n            \"Provide concise, working code without explanations.\"\n        ),\n        temperature=0.7,\n        max_tokens=300\n    )\n    return f\"```python\\n{result.text}\\n```\"\n````\n\nThe `temperature` parameter controls randomness\u2014higher values (up to 1.0) produce more varied outputs, while lower values make responses more deterministic. The `max_tokens` parameter limits response length.\n\n### Model Preferences\n\nModel preferences let you hint at which LLM the client should use for a request. You can pass a single model name or a list of preferences in priority order. These are hints rather than requirements\u2014the actual model used depends on what the client has available.\n\n```python\n@mcp.tool\nasync def technical_analysis(data: str, ctx: Context) -> str:\n    \"\"\"Analyze data using a reasoning-focused model.\"\"\"\n    result = await ctx.sample(\n        messages=f\"Analyze this data:\\n\\n{data}\",\n        model_preferences=[\"claude-opus-4-5\", \"gpt-5-2\"],\n        temperature=0.2,\n    )\n    return result.text or \"\"\n```\n\nUse model preferences when different tasks benefit from different model characteristics. Creative writing might prefer faster models with higher temperature, while complex analysis might benefit from larger reasoning-focused models.\n\n### Multi-Turn Conversations\n\nFor requests that need conversational context, construct a list of `SamplingMessage` objects representing the conversation history. Each message has a `role` (\"user\" or \"assistant\") and `content` (a `TextContent` object).\n\n```python\nfrom mcp.types import SamplingMessage, TextContent\n\n@mcp.tool\nasync def contextual_analysis(query: str, data: str, ctx: Context) -> str:\n    \"\"\"Analyze data with conversational context.\"\"\"\n    messages = [\n        SamplingMessage(\n            role=\"user\",\n            content=TextContent(type=\"text\", text=f\"Here's my data: {data}\"),\n        ),\n        SamplingMessage(\n            role=\"assistant\",\n            content=TextContent(type=\"text\", text=\"I see the data. What would you like to know?\"),\n        ),\n        SamplingMessage(\n            role=\"user\",\n            content=TextContent(type=\"text\", text=query),\n        ),\n    ]\n    result = await ctx.sample(messages=messages)\n    return result.text or \"\"\n```\n\nThe LLM receives the full conversation thread and responds with awareness of the preceding context.\n\n## Structured Output\n\n<VersionBadge version=\"2.14.1\" />\n\nWhen you need validated, typed data instead of free-form text, use the `result_type` parameter. FastMCP ensures the LLM returns data matching your type, handling validation and retries automatically. The `result_type` parameter accepts Pydantic models, dataclasses, and basic types like `int`, `list[str]`, or `dict[str, int]`.\n\n```python\nfrom pydantic import BaseModel\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP()\n\nclass SentimentResult(BaseModel):\n    sentiment: str\n    confidence: float\n    reasoning: str\n\n@mcp.tool\nasync def analyze_sentiment(text: str, ctx: Context) -> SentimentResult:\n    \"\"\"Analyze text sentiment with structured output.\"\"\"\n    result = await ctx.sample(\n        messages=f\"Analyze the sentiment of: {text}\",\n        result_type=SentimentResult,\n    )\n    return result.result  # A validated SentimentResult object\n```\n\nWhen you call this tool, the LLM returns a structured response that FastMCP validates against your Pydantic model. You access the validated object through `result.result`, while `result.text` contains the JSON representation.\n\n<Note>\n  When you pass `result_type`, `sample()` automatically creates a\n  `final_response` tool that the LLM calls to provide its response. If\n  validation fails, the error is sent back to the LLM for retry. This automatic\n  handling only applies to `sample()`\u2014with `sample_step()`, you must manage\n  structured output yourself.\n</Note>\n\n## Sampling with Tools\n\n<VersionBadge version=\"2.14.1\" />\n\nSampling with tools enables agentic workflows where the LLM can call functions to gather information before responding. This implements [SEP-1577](https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1577), allowing the LLM to autonomously orchestrate multi-step operations.\n\nPass Python functions to the `tools` parameter, and FastMCP handles the execution loop automatically\u2014calling tools, returning results to the LLM, and continuing until the LLM provides a final response.\n\n### Defining Tools\n\nDefine regular Python functions with type hints and docstrings. FastMCP extracts the function's name, docstring, and parameter types to create tool schemas that the LLM can understand.\n\n```python\nfrom fastmcp import FastMCP, Context\n\ndef search(query: str) -> str:\n    \"\"\"Search the web for information.\"\"\"\n    return f\"Results for: {query}\"\n\ndef get_time() -> str:\n    \"\"\"Get the current time.\"\"\"\n    from datetime import datetime\n    return datetime.now().strftime(\"%H:%M:%S\")\n\nmcp = FastMCP()\n\n@mcp.tool\nasync def research(question: str, ctx: Context) -> str:\n    \"\"\"Answer questions using available tools.\"\"\"\n    result = await ctx.sample(\n        messages=question,\n        tools=[search, get_time],\n    )\n    return result.text or \"\"\n```\n\nThe LLM sees each function's signature and docstring, using this information to decide when and how to call them. Tool errors are caught and sent back to the LLM, allowing it to recover gracefully. An internal safety limit prevents infinite loops.\n\n### Tool Error Handling\n\nBy default, when a sampling tool raises an exception, the error message (including details) is sent back to the LLM so it can attempt recovery. To prevent sensitive information from leaking to the LLM, use the `mask_error_details` parameter:\n\n```python\nresult = await ctx.sample(\n    messages=question,\n    tools=[search],\n    mask_error_details=True,  # Generic error messages only\n)\n```\n\nWhen `mask_error_details=True`, tool errors become generic messages like `\"Error executing tool 'search'\"` instead of exposing stack traces or internal details.\n\nTo intentionally provide specific error messages to the LLM regardless of masking, raise `ToolError`:\n\n```python\nfrom fastmcp.exceptions import ToolError\n\ndef search(query: str) -> str:\n    \"\"\"Search for information.\"\"\"\n    if not query.strip():\n        raise ToolError(\"Search query cannot be empty\")\n    return f\"Results for: {query}\"\n```\n\n`ToolError` messages always pass through to the LLM, making it the escape hatch for errors you want the LLM to see and handle.\n\nFor custom names or descriptions, use `SamplingTool.from_function()`:\n\n```python\nfrom fastmcp.server.sampling import SamplingTool\n\ntool = SamplingTool.from_function(\n    my_func,\n    name=\"custom_name\",\n    description=\"Custom description\"\n)\n\nresult = await ctx.sample(messages=\"...\", tools=[tool])\n```\n\n### Combining with Structured Output\n\nCombine tools with `result_type` for agentic workflows that return validated, structured data. The LLM uses your tools to gather information, then returns a response matching your type.\n\n```python\nresult = await ctx.sample(\n    messages=\"Research Python async patterns\",\n    tools=[search, fetch_url],\n    result_type=ResearchResult,\n)\n```\n\n## Loop Control\n\n<VersionBadge version=\"2.14.1\" />\n\nWhile `sample()` handles the tool execution loop automatically, some scenarios require fine-grained control over each step. The `sample_step()` method makes a single LLM call and returns a `SampleStep` containing the response and updated history.\n\nUnlike `sample()`, `sample_step()` is stateless\u2014it doesn't remember previous calls. You control the conversation by passing the full message history each time. The returned `step.history` includes all messages up through the current response, making it easy to continue the loop.\n\nUse `sample_step()` when you need to:\n\n- Inspect tool calls before they execute\n- Implement custom termination conditions\n- Add logging, metrics, or checkpointing between steps\n- Build custom agentic loops with domain-specific logic\n\n### Using sample_step()\n\nBy default, `sample_step()` executes any tool calls and includes the results in the history. Call it in a loop, passing the updated history each time, until a stop condition is met.\n\n```python\nfrom mcp.types import SamplingMessage\n\n@mcp.tool\nasync def controlled_agent(question: str, ctx: Context) -> str:\n    \"\"\"Agent with manual loop control.\"\"\"\n    messages: list[str | SamplingMessage] = [question]  # strings auto-convert\n\n    while True:\n        step = await ctx.sample_step(\n            messages=messages,\n            tools=[search, get_time],\n        )\n\n        if step.is_tool_use:\n            # Tools already executed (execute_tools=True by default)\n            # Log what was called before continuing\n            for call in step.tool_calls:\n                print(f\"Called tool: {call.name}\")\n\n        if not step.is_tool_use:\n            return step.text or \"\"\n\n        # Continue with updated history\n        messages = step.history\n```\n\n### SampleStep Properties\n\nEach `SampleStep` provides information about what the LLM returned:\n\n- `step.is_tool_use` \u2014 True if the LLM requested tool calls\n- `step.tool_calls` \u2014 List of tool calls requested (if any)\n- `step.text` \u2014 The text content (if any)\n- `step.history` \u2014 All messages exchanged so far\n\nThe contents of `step.history` depend on `execute_tools`:\n- **`execute_tools=True`** (default): Includes tool results, ready for the next iteration\n- **`execute_tools=False`**: Includes the assistant's tool request, but you add results yourself\n\n### Manual Tool Execution\n\nSet `execute_tools=False` to handle tool execution yourself. When disabled, `step.history` contains the user message and the assistant's response with tool calls\u2014but no tool results. You execute the tools and append the results as a user message.\n\n```python\nfrom mcp.types import SamplingMessage, ToolResultContent, TextContent\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP()\n\n@mcp.tool\nasync def research(question: str, ctx: Context) -> str:\n    \"\"\"Research with manual tool handling.\"\"\"\n\n    def search(query: str) -> str:\n        return f\"Results for: {query}\"\n\n    def get_time() -> str:\n        return \"12:00 PM\"\n\n    # Map tool names to functions\n    tools = {\"search\": search, \"get_time\": get_time}\n\n    messages: list[SamplingMessage] = [question]  # strings are converted automatically\n\n    while True:\n        step = await ctx.sample_step(\n            messages=messages,\n            tools=list(tools.values()),\n            execute_tools=False,\n        )\n\n        if not step.is_tool_use:\n            return step.text or \"\"\n\n        # Execute tools and collect results\n        tool_results = []\n        for call in step.tool_calls:\n            fn = tools[call.name]\n            result = fn(**call.input)\n            tool_results.append(\n                ToolResultContent(\n                    type=\"tool_result\",\n                    toolUseId=call.id,\n                    content=[TextContent(type=\"text\", text=result)],\n                )\n            )\n\n        messages = list(step.history)\n        messages.append(SamplingMessage(role=\"user\", content=tool_results))\n```\n\n#### Error Handling\n\nTo report an error, set `isError=True`. The LLM will see the error and can decide how to proceed:\n\n```python\ntool_result = ToolResultContent(\n    type=\"tool_result\",\n    toolUseId=call.id,\n    content=[TextContent(type=\"text\", text=\"Permission denied\")],\n    isError=True,\n)\n```\n\n## Fallback Handlers\n\nClient support for sampling is optional\u2014some clients may not implement it. To ensure your tools work regardless of client capabilities, configure a `sampling_handler` that sends requests directly to an LLM provider.\n\nFastMCP provides built-in handlers for [OpenAI and Anthropic APIs](/clients/sampling#built-in-handlers). These handlers support the full sampling API including tools, automatically converting your Python functions to each provider's format.\n\n<Note>\nInstall handlers with `pip install fastmcp[openai]` or `pip install fastmcp[anthropic]`.\n</Note>\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.client.sampling.handlers.openai import OpenAISamplingHandler\n\nserver = FastMCP(\n    name=\"My Server\",\n    sampling_handler=OpenAISamplingHandler(default_model=\"gpt-4o-mini\"),\n    sampling_handler_behavior=\"fallback\",\n)\n```\n\nOr with Anthropic:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.client.sampling.handlers.anthropic import AnthropicSamplingHandler\n\nserver = FastMCP(\n    name=\"My Server\",\n    sampling_handler=AnthropicSamplingHandler(default_model=\"claude-sonnet-4-5\"),\n    sampling_handler_behavior=\"fallback\",\n)\n```\n\n### Behavior Modes\n\nThe `sampling_handler_behavior` parameter controls when the handler is used:\n\n- **`\"fallback\"`** (default): Use the handler only when the client doesn't support sampling. This lets capable clients use their own LLM while ensuring your tools still work with clients that lack sampling support.\n- **`\"always\"`**: Always use the handler, bypassing the client entirely. Use this when you need guaranteed control over which LLM processes requests\u2014for cost control, compliance requirements, or when specific model characteristics are essential.\n\n<Note>\n  Sampling with tools requires the client to advertise the `sampling.tools`\n  capability. FastMCP clients do this automatically. For external clients that\n  don't support tool-enabled sampling, configure a fallback handler with\n  `sampling_handler_behavior=\"always\"`.\n</Note>\n"}, {"filename": "docs/servers/server.mdx", "content": "---\ntitle: The FastMCP Server\nsidebarTitle: Overview\ndescription: The core FastMCP server class for building MCP applications with tools, resources, and prompts.\nicon: server\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\nThe central piece of a FastMCP application is the `FastMCP` server class. This class acts as the main container for your application's tools, resources, and prompts, and manages communication with MCP clients.\n\n## Creating a Server\n\nInstantiating a server is straightforward. You typically provide a name for your server, which helps identify it in client applications or logs.\n\n```python\nfrom fastmcp import FastMCP\n\n# Create a basic server instance\nmcp = FastMCP(name=\"MyAssistantServer\")\n\n# You can also add instructions for how to interact with the server\nmcp_with_instructions = FastMCP(\n    name=\"HelpfulAssistant\",\n    instructions=\"\"\"\n        This server provides data analysis tools.\n        Call get_average() to analyze numerical data.\n    \"\"\",\n)\n```\n\nThe `FastMCP` constructor accepts several arguments:\n\n<Card icon=\"code\" title=\"FastMCP Constructor Parameters\">\n<ParamField body=\"name\" type=\"str\" default=\"FastMCP\">\n  A human-readable name for your server\n</ParamField>\n\n<ParamField body=\"instructions\" type=\"str | None\">\n  Description of how to interact with this server. These instructions help clients understand the server's purpose and available functionality\n</ParamField>\n\n<ParamField body=\"version\" type=\"str | None\">\n  Version string for your server. If not provided, defaults to the FastMCP library version\n</ParamField>\n\n<ParamField body=\"website_url\" type=\"str | None\">\n  <VersionBadge version=\"2.13.0\" />\n\n  URL to a website with more information about your server. Displayed in client applications\n</ParamField>\n\n<ParamField body=\"icons\" type=\"list[Icon] | None\">\n  <VersionBadge version=\"2.13.0\" />\n\n  List of icon representations for your server. Icons help users visually identify your server in client applications. See [Icons](/servers/icons) for detailed examples\n</ParamField>\n\n<ParamField body=\"auth\" type=\"OAuthProvider | TokenVerifier | None\">\n  Authentication provider for securing HTTP-based transports. See [Authentication](/servers/auth/authentication) for configuration options\n</ParamField>\n\n<ParamField body=\"lifespan\" type=\"AsyncContextManager | None\">\n  An async context manager function for server startup and shutdown logic\n</ParamField>\n\n<ParamField body=\"tools\" type=\"list[Tool | Callable] | None\">\n  A list of tools (or functions to convert to tools) to add to the server. In some cases, providing tools programmatically may be more convenient than using the `@mcp.tool` decorator\n</ParamField>\n\n\n<ParamField body=\"include_tags\" type=\"set[str] | None\">\n  Only expose components with at least one matching tag\n</ParamField>\n\n<ParamField body=\"exclude_tags\" type=\"set[str] | None\">\n  Hide components with any matching tag\n</ParamField>\n\n<ParamField body=\"on_duplicate_tools\" type='Literal[\"error\", \"warn\", \"replace\"]' default=\"error\">\n  How to handle duplicate tool registrations\n</ParamField>\n\n<ParamField body=\"on_duplicate_resources\" type='Literal[\"error\", \"warn\", \"replace\"]' default=\"warn\">\n  How to handle duplicate resource registrations\n</ParamField>\n\n<ParamField body=\"on_duplicate_prompts\" type='Literal[\"error\", \"warn\", \"replace\"]' default=\"replace\">\n  How to handle duplicate prompt registrations\n</ParamField>\n\n\n<ParamField body=\"strict_input_validation\" type=\"bool\" default=\"False\">\n  <VersionBadge version=\"2.13.0\" />\n  Controls how tool input parameters are validated. When `False` (default), FastMCP uses Pydantic's flexible validation that coerces compatible inputs (e.g., `\"10\"` \u2192 `10` for int parameters). When `True`, uses the MCP SDK's JSON Schema validation to validate inputs against the exact schema before passing them to your function, rejecting any type mismatches. The default mode improves compatibility with LLM clients while maintaining type safety. See [Input Validation Modes](/servers/tools#input-validation-modes) for details\n</ParamField>\n\n<ParamField body=\"include_fastmcp_meta\" type=\"bool\" default=\"True\">\n  <VersionBadge version=\"2.11.0\" />\n\n  Whether to include FastMCP metadata in component responses. When `True`, component tags and other FastMCP-specific metadata are included in the `_fastmcp` namespace within each component's `meta` field. When `False`, this metadata is omitted, resulting in cleaner integration with external systems. Can be overridden globally via `FASTMCP_INCLUDE_FASTMCP_META` environment variable\n</ParamField>\n</Card>\n## Components\n\nFastMCP servers expose several types of components to the client:\n\n### Tools\n\nTools are functions that the client can call to perform actions or access external systems.\n\n```python\n@mcp.tool\ndef multiply(a: float, b: float) -> float:\n    \"\"\"Multiplies two numbers together.\"\"\"\n    return a * b\n```\n\nSee [Tools](/servers/tools) for detailed documentation.\n\n### Resources\n\nResources expose data sources that the client can read.\n\n```python\n@mcp.resource(\"data://config\")\ndef get_config() -> dict:\n    \"\"\"Provides the application configuration.\"\"\"\n    return {\"theme\": \"dark\", \"version\": \"1.0\"}\n```\n\nSee [Resources & Templates](/servers/resources) for detailed documentation.\n\n### Resource Templates\n\nResource templates are parameterized resources that allow the client to request specific data.\n\n```python\n@mcp.resource(\"users://{user_id}/profile\")\ndef get_user_profile(user_id: int) -> dict:\n    \"\"\"Retrieves a user's profile by ID.\"\"\"\n    # The {user_id} in the URI is extracted and passed to this function\n    return {\"id\": user_id, \"name\": f\"User {user_id}\", \"status\": \"active\"}\n```\n\nSee [Resources & Templates](/servers/resources) for detailed documentation.\n\n### Prompts\n\nPrompts are reusable message templates for guiding the LLM.\n\n```python\n@mcp.prompt\ndef analyze_data(data_points: list[float]) -> str:\n    \"\"\"Creates a prompt asking for analysis of numerical data.\"\"\"\n    formatted_data = \", \".join(str(point) for point in data_points)\n    return f\"Please analyze these data points: {formatted_data}\"\n```\n\nSee [Prompts](/servers/prompts) for detailed documentation.\n\n## Tag-Based Filtering\n\n<VersionBadge version=\"2.8.0\" />\n\nFastMCP supports tag-based filtering to selectively expose components based on configurable include/exclude tag sets. This is useful for creating different views of your server for different environments or users.\n\nComponents can be tagged when defined using the `tags` parameter:\n\n```python\n@mcp.tool(tags={\"public\", \"utility\"})\ndef public_tool() -> str:\n    return \"This tool is public\"\n\n@mcp.tool(tags={\"internal\", \"admin\"})\ndef admin_tool() -> str:\n    return \"This tool is for admins only\"\n```\n\n\nThe filtering logic works as follows:\n- **Include tags**: If specified, only components with at least one matching tag are exposed\n- **Exclude tags**: Components with any matching tag are filtered out\n- **Precedence**: Exclude tags always take priority over include tags\n\n<Tip>\nTo ensure a component is never exposed, you can set `enabled=False` on the component itself. To learn more, see the component-specific documentation.\n</Tip>\n\nYou configure tag-based filtering when creating your server:\n\n```python\n# Only expose components tagged with \"public\"\nmcp = FastMCP(include_tags={\"public\"})\n\n# Hide components tagged as \"internal\" or \"deprecated\"  \nmcp = FastMCP(exclude_tags={\"internal\", \"deprecated\"})\n\n# Combine both: show admin tools but hide deprecated ones\nmcp = FastMCP(include_tags={\"admin\"}, exclude_tags={\"deprecated\"})\n```\n\nThis filtering applies to all component types (tools, resources, resource templates, and prompts) and affects both listing and access.\n\n## Running the Server\n\nFastMCP servers need a transport mechanism to communicate with clients. You typically start your server by calling the `mcp.run()` method on your `FastMCP` instance, often within an `if __name__ == \"__main__\":` block in your main server script. This pattern ensures compatibility with various MCP clients.\n\n```python\n# my_server.py\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"MyServer\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    \"\"\"Greet a user by name.\"\"\"\n    return f\"Hello, {name}!\"\n\nif __name__ == \"__main__\":\n    # This runs the server, defaulting to STDIO transport\n    mcp.run()\n    \n    # To use a different transport, e.g., HTTP:\n    # mcp.run(transport=\"http\", host=\"127.0.0.1\", port=9000)\n```\n\nFastMCP supports several transport options: \n- STDIO (default, for local tools)\n- HTTP (recommended for web services, uses Streamable HTTP protocol)\n- SSE (legacy web transport, deprecated)\n\nThe server can also be run using the FastMCP CLI.\n\nFor detailed information on each transport, how to configure them (host, port, paths), and when to use which, please refer to the [**Running Your FastMCP Server**](/deployment/running-server) guide.\n\n## Custom Routes\n\nWhen running your server with HTTP transport, you can add custom web routes alongside your MCP endpoint using the `@custom_route` decorator. This is useful for simple endpoints like health checks that need to be served alongside your MCP server:\n\n```python\nfrom fastmcp import FastMCP\nfrom starlette.requests import Request\nfrom starlette.responses import PlainTextResponse\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.custom_route(\"/health\", methods=[\"GET\"])\nasync def health_check(request: Request) -> PlainTextResponse:\n    return PlainTextResponse(\"OK\")\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\")  # Health check at http://localhost:8000/health\n```\n\nCustom routes are served alongside your MCP endpoint and are useful for:\n- Health check endpoints for monitoring\n- Simple status or info endpoints\n- Basic webhooks or callbacks\n\nFor more complex web applications, consider [mounting your MCP server into a FastAPI or Starlette app](/deployment/http#integration-with-web-frameworks).\n\n## Composing Servers\n\n<VersionBadge version=\"2.2.0\" />\n\nFastMCP supports composing multiple servers together using `import_server` (static copy) and `mount` (live link). This allows you to organize large applications into modular components or reuse existing servers.\n\nSee the [Server Composition](/servers/composition) guide for full details, best practices, and examples.\n\n```python\n# Example: Importing a subserver\nfrom fastmcp import FastMCP\nimport asyncio\n\nmain = FastMCP(name=\"Main\")\nsub = FastMCP(name=\"Sub\")\n\n@sub.tool\ndef hello(): \n    return \"hi\"\n\n# Mount directly\nmain.mount(sub, prefix=\"sub\")\n```\n\n## Proxying Servers\n\n<VersionBadge version=\"2.0.0\" />\n\nFastMCP can act as a proxy for any MCP server (local or remote) using `FastMCP.as_proxy`, letting you bridge transports or add a frontend to existing servers. For example, you can expose a remote SSE server locally via stdio, or vice versa.\n\nProxies automatically handle concurrent operations safely by creating fresh sessions for each request when using disconnected clients.\n\nSee the [Proxying Servers](/servers/proxy) guide for details and advanced usage.\n\n```python\nfrom fastmcp import FastMCP, Client\n\nbackend = Client(\"http://example.com/mcp/sse\")\nproxy = FastMCP.as_proxy(backend, name=\"ProxyServer\")\n# Now use the proxy like any FastMCP server\n```\n\n## OpenAPI Integration\n\n<VersionBadge version=\"2.0.0\" />\n\nFastMCP can automatically generate servers from OpenAPI specifications or existing FastAPI applications using `FastMCP.from_openapi()` and `FastMCP.from_fastapi()`. This allows you to instantly convert existing APIs into MCP servers without manual tool creation.\n\nSee the [FastAPI Integration](/integrations/fastapi) and [OpenAPI Integration](/integrations/openapi) guides for detailed examples and configuration options.\n\n```python\nimport httpx\nfrom fastmcp import FastMCP\n\n# From OpenAPI spec\nspec = httpx.get(\"https://api.example.com/openapi.json\").json()\nmcp = FastMCP.from_openapi(openapi_spec=spec, client=httpx.AsyncClient())\n\n# From FastAPI app\nfrom fastapi import FastAPI\napp = FastAPI()\nmcp = FastMCP.from_fastapi(app=app)\n```\n\n## Server Configuration\n\nServers can be configured using a combination of initialization arguments, global settings, and transport-specific settings.\n\n### Server-Specific Configuration\n\nServer-specific settings are passed when creating the `FastMCP` instance and control server behavior:\n\n```python\nfrom fastmcp import FastMCP\n\n# Configure server-specific settings\nmcp = FastMCP(\n    name=\"ConfiguredServer\",\n    include_tags={\"public\", \"api\"},              # Only expose these tagged components\n    exclude_tags={\"internal\", \"deprecated\"},     # Hide these tagged components\n    on_duplicate_tools=\"error\",                  # Handle duplicate registrations\n    on_duplicate_resources=\"warn\",\n    on_duplicate_prompts=\"replace\",\n    include_fastmcp_meta=False,                  # Disable FastMCP metadata for cleaner integration\n)\n```\n\n### Global Settings\n\nGlobal settings affect all FastMCP servers and can be configured via environment variables (prefixed with `FASTMCP_`) or in a `.env` file:\n\n```python\nimport fastmcp\n\n# Access global settings\nprint(fastmcp.settings.log_level)        # Default: \"INFO\"\nprint(fastmcp.settings.mask_error_details)  # Default: False\nprint(fastmcp.settings.strict_input_validation)  # Default: False\nprint(fastmcp.settings.include_fastmcp_meta)   # Default: True\n```\n\nCommon global settings include:\n- **`log_level`**: Logging level (\"DEBUG\", \"INFO\", \"WARNING\", \"ERROR\", \"CRITICAL\"), set with `FASTMCP_LOG_LEVEL`\n- **`mask_error_details`**: Whether to hide detailed error information from clients, set with `FASTMCP_MASK_ERROR_DETAILS`\n- **`strict_input_validation`**: Controls tool input validation mode (default: False for flexible coercion), set with `FASTMCP_STRICT_INPUT_VALIDATION`. See [Input Validation Modes](/servers/tools#input-validation-modes)\n- **`include_fastmcp_meta`**: Whether to include FastMCP metadata in component responses (default: True), set with `FASTMCP_INCLUDE_FASTMCP_META`\n- **`env_file`**: Path to the environment file to load settings from (default: \".env\"), set with `FASTMCP_ENV_FILE`. Useful when your project uses a `.env` file with syntax incompatible with python-dotenv\n\n### Transport-Specific Configuration\n\nTransport settings are provided when running the server and control network behavior:\n\n```python\n# Configure transport when running\nmcp.run(\n    transport=\"http\",\n    host=\"0.0.0.0\",           # Bind to all interfaces\n    port=9000,                # Custom port\n    log_level=\"DEBUG\",        # Override global log level\n)\n\n# Or for async usage\nawait mcp.run_async(\n    transport=\"http\", \n    host=\"127.0.0.1\",\n    port=8080,\n)\n```\n\n### Setting Global Configuration\n\nGlobal FastMCP settings can be configured via environment variables (prefixed with `FASTMCP_`):\n\n```bash\n# Configure global FastMCP behavior\nexport FASTMCP_LOG_LEVEL=DEBUG\nexport FASTMCP_MASK_ERROR_DETAILS=True\nexport FASTMCP_STRICT_INPUT_VALIDATION=False\nexport FASTMCP_INCLUDE_FASTMCP_META=False\n```\n\n### Custom Tool Serialization\n\n<VersionBadge version=\"2.2.7\" />\n\nBy default, FastMCP serializes tool return values to JSON when they need to be converted to text. You can customize this behavior by providing a `tool_serializer` function when creating your server:\n\n```python\nimport yaml\nfrom fastmcp import FastMCP\n\n# Define a custom serializer that formats dictionaries as YAML\ndef yaml_serializer(data):\n    return yaml.dump(data, sort_keys=False)\n\n# Create a server with the custom serializer\nmcp = FastMCP(name=\"MyServer\", tool_serializer=yaml_serializer)\n\n@mcp.tool\ndef get_config():\n    \"\"\"Returns configuration in YAML format.\"\"\"\n    return {\"api_key\": \"abc123\", \"debug\": True, \"rate_limit\": 100}\n```\n\nThe serializer function takes any data object and returns a string representation. This is applied to **all non-string return values** from your tools. Tools that already return strings bypass the serializer.\n\nThis customization is useful when you want to:\n- Format data in a specific way (like YAML or custom formats)\n- Control specific serialization options (like indentation or sorting)\n- Add metadata or transform data before sending it to clients\n\n<Tip>\nIf the serializer function raises an exception, the tool will fall back to the default JSON serialization to avoid breaking the server.\n</Tip>\n"}, {"filename": "docs/servers/storage-backends.mdx", "content": "---\ntitle: Storage Backends\nsidebarTitle: Storage Backends\ndescription: Configure persistent and distributed storage for caching and OAuth state management\nicon: database\ntag: NEW\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.13.0\" />\n\nFastMCP uses pluggable storage backends for caching responses and managing OAuth state. By default, all storage is in-memory, which is perfect for development but doesn't persist across restarts. FastMCP includes support for multiple storage backends, and you can easily extend it with custom implementations.\n\n<Tip>\nThe storage layer is powered by **[py-key-value-aio](https://github.com/strawgate/py-key-value)**, an async key-value library maintained by a core FastMCP maintainer. This library provides a unified interface for multiple backends, making it easy to swap implementations based on your deployment needs.\n</Tip>\n\n## Available Backends\n\n### In-Memory Storage\n\n**Best for:** Development, testing, single-process deployments\n\nIn-memory storage is the default for all FastMCP storage needs. It's fast, requires no setup, and is perfect for getting started.\n\n```python\nfrom key_value.aio.stores.memory import MemoryStore\n\n# Used by default - no configuration needed\n# But you can also be explicit:\ncache_store = MemoryStore()\n```\n\n**Characteristics:**\n- \u2705 No setup required\n- \u2705 Very fast\n- \u274c Data lost on restart\n- \u274c Not suitable for multi-process deployments\n\n### Disk Storage\n\n**Best for:** Single-server production deployments, persistent caching\n\nDisk storage persists data to the filesystem, allowing it to survive server restarts.\n\n```python\nfrom key_value.aio.stores.disk import DiskStore\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\n\n# Persistent response cache\nmiddleware = ResponseCachingMiddleware(\n    cache_storage=DiskStore(directory=\"/var/cache/fastmcp\")\n)\n```\n\nOr with OAuth token storage:\n\n```python\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom key_value.aio.stores.disk import DiskStore\n\nauth = GitHubProvider(\n    client_id=\"your-id\",\n    client_secret=\"your-secret\",\n    base_url=\"https://your-server.com\",\n    client_storage=DiskStore(directory=\"/var/lib/fastmcp/oauth\")\n)\n```\n\n**Characteristics:**\n- \u2705 Data persists across restarts\n- \u2705 Good performance for moderate load\n- \u274c Not suitable for distributed deployments\n- \u274c Filesystem access required\n\n### Redis\n\n**Best for:** Distributed production deployments, shared caching across multiple servers\n\n<Note>\nRedis support requires an optional dependency: `pip install 'py-key-value-aio[redis]'`\n</Note>\n\nRedis provides distributed caching and state management, ideal for production deployments with multiple server instances.\n\n```python\nfrom key_value.aio.stores.redis import RedisStore\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\n\n# Distributed response cache\nmiddleware = ResponseCachingMiddleware(\n    cache_storage=RedisStore(host=\"redis.example.com\", port=6379)\n)\n```\n\nWith authentication:\n\n```python\nfrom key_value.aio.stores.redis import RedisStore\n\ncache_store = RedisStore(\n    host=\"redis.example.com\",\n    port=6379,\n    password=\"your-redis-password\"\n)\n```\n\nFor OAuth token storage:\n\n```python\nimport os\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom key_value.aio.stores.redis import RedisStore\n\nauth = GitHubProvider(\n    client_id=os.environ[\"GITHUB_CLIENT_ID\"],\n    client_secret=os.environ[\"GITHUB_CLIENT_SECRET\"],\n    base_url=\"https://your-server.com\",\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=RedisStore(host=\"redis.example.com\", port=6379)\n)\n```\n\n**Characteristics:**\n- \u2705 Distributed and highly available\n- \u2705 Fast in-memory performance\n- \u2705 Works across multiple server instances\n- \u2705 Built-in TTL support\n- \u274c Requires Redis infrastructure\n- \u274c Network latency vs local storage\n\n### Other Backends from py-key-value-aio\n\nThe py-key-value-aio library includes additional implementations for various storage systems:\n\n- **DynamoDB** - AWS distributed database\n- **MongoDB** - NoSQL document store\n- **Elasticsearch** - Distributed search and analytics\n- **Memcached** - Distributed memory caching\n- **RocksDB** - Embedded high-performance key-value store\n- **Valkey** - Redis-compatible server\n\nFor configuration details on these backends, consult the [py-key-value-aio documentation](https://github.com/strawgate/py-key-value).\n\n<Warning>\nBefore using these backends in production, review the [py-key-value documentation](https://github.com/strawgate/py-key-value) to understand the maturity level and limitations of your chosen backend. Some backends may be in preview or have specific constraints that make them unsuitable for production use.\n</Warning>\n\n## Use Cases in FastMCP\n\n### Server-Side OAuth Token Storage\n\nThe [OAuth Proxy](/servers/auth/oauth-proxy) and OAuth auth providers use storage for persisting OAuth client registrations and upstream tokens. **By default, storage is automatically encrypted using `FernetEncryptionWrapper`.** When providing custom storage, wrap it in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest.\n\n**Development (default behavior):**\n\nBy default, FastMCP automatically manages keys and storage based on your platform:\n- **Mac/Windows**: Keys are auto-managed via system keyring, storage defaults to disk. Suitable **only** for development and local testing.\n- **Linux**: Keys are ephemeral, storage defaults to memory.\n\nNo configuration needed:\n\n```python\nfrom fastmcp.server.auth.providers.github import GitHubProvider\n\nauth = GitHubProvider(\n    client_id=\"your-id\",\n    client_secret=\"your-secret\",\n    base_url=\"https://your-server.com\"\n)\n```\n\n**Production:**\n\nFor production deployments, configure explicit keys and persistent network-accessible storage with encryption:\n\n```python\nimport os\nfrom fastmcp.server.auth.providers.github import GitHubProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\nauth = GitHubProvider(\n    client_id=os.environ[\"GITHUB_CLIENT_ID\"],\n    client_secret=os.environ[\"GITHUB_CLIENT_SECRET\"],\n    base_url=\"https://your-server.com\",\n    # Explicit JWT signing key (required for production)\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    # Encrypted persistent storage (required for production)\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(host=\"redis.example.com\", port=6379),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n```\n\nBoth parameters are required for production. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. See [OAuth Token Security](/deployment/http#oauth-token-security) and [Key and Storage Management](/servers/auth/oauth-proxy#key-and-storage-management) for complete setup details.\n\n### Response Caching Middleware\n\nThe [Response Caching Middleware](/servers/middleware#caching-middleware) caches tool calls, resource reads, and prompt requests. Storage configuration is passed via the `cache_storage` parameter:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\nfrom key_value.aio.stores.disk import DiskStore\n\nmcp = FastMCP(\"My Server\")\n\n# Cache to disk instead of memory\nmcp.add_middleware(ResponseCachingMiddleware(\n    cache_storage=DiskStore(directory=\"cache\")\n))\n```\n\nFor multi-server deployments sharing a Redis instance:\n\n```python\nfrom fastmcp.server.middleware.caching import ResponseCachingMiddleware\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.prefix_collections import PrefixCollectionsWrapper\n\nbase_store = RedisStore(host=\"redis.example.com\")\nnamespaced_store = PrefixCollectionsWrapper(\n    key_value=base_store,\n    prefix=\"my-server\"\n)\n\nmiddleware = ResponseCachingMiddleware(cache_storage=namespaced_store)\n```\n\n### Client-Side OAuth Token Storage\n\nThe [FastMCP Client](/clients/client) uses storage for persisting OAuth tokens locally. By default, tokens are stored in memory:\n\n```python\nfrom fastmcp.client.auth import OAuthClientProvider\nfrom key_value.aio.stores.disk import DiskStore\n\n# Store tokens on disk for persistence across restarts\ntoken_storage = DiskStore(directory=\"~/.local/share/fastmcp/tokens\")\n\noauth_provider = OAuthClientProvider(\n    mcp_url=\"https://your-mcp-server.com/mcp/sse\",\n    token_storage=token_storage\n)\n```\n\nThis allows clients to reconnect without re-authenticating after restarts.\n\n## Choosing a Backend\n\n| Backend | Development | Single Server | Multi-Server | Cloud Native |\n|---------|-------------|---------------|--------------|--------------|\n| Memory | \u2705 Best | \u26a0\ufe0f Limited | \u274c | \u274c |\n| Disk | \u2705 Good | \u2705 Recommended | \u274c | \u26a0\ufe0f |\n| Redis | \u26a0\ufe0f Overkill | \u2705 Good | \u2705 Best | \u2705 Best |\n| DynamoDB | \u274c | \u26a0\ufe0f | \u2705 | \u2705 Best (AWS) |\n| MongoDB | \u274c | \u26a0\ufe0f | \u2705 | \u2705 Good |\n\n**Decision tree:**\n\n1. **Just starting?** Use **Memory** (default) - no configuration needed\n2. **Single server, needs persistence?** Use **Disk**\n3. **Multiple servers or cloud deployment?** Use **Redis** or **DynamoDB**\n4. **Existing infrastructure?** Look for a matching py-key-value-aio backend\n\n## More Resources\n\n- [py-key-value-aio GitHub](https://github.com/strawgate/py-key-value) - Full library documentation\n- [Response Caching Middleware](/servers/middleware#caching-middleware) - Using storage for caching\n- [OAuth Token Security](/deployment/http#oauth-token-security) - Production OAuth configuration\n- [HTTP Deployment](/deployment/http) - Complete deployment guide\n"}, {"filename": "docs/servers/tasks.mdx", "content": "---\ntitle: Background Tasks\nsidebarTitle: Background Tasks\ndescription: Run long-running operations asynchronously with progress tracking\nicon: clock\ntag: \"NEW\"\n---\n\nimport { VersionBadge } from \"/snippets/version-badge.mdx\"\n\n<VersionBadge version=\"2.14.0\" />\n\nFastMCP implements the MCP background task protocol ([SEP-1686](https://modelcontextprotocol.io/specification/2025-11-25/basic/utilities/tasks)), giving your servers a production-ready distributed task scheduler with a single decorator change.\n\n<Tip>\n**What is Docket?** FastMCP's task system is powered by [Docket](https://github.com/chrisguidry/docket), originally built by [Prefect](https://prefect.io) to power [Prefect Cloud](https://www.prefect.io/prefect/cloud)'s managed task scheduling and execution service, where it processes millions of concurrent tasks every day. Docket is now open-sourced for the community.\n</Tip>\n\n\n## What Are MCP Background Tasks?\n\nIn MCP, all component interactions are blocking by default. When a client calls a tool, reads a resource, or fetches a prompt, it sends a request and waits for the response. For operations that take seconds or minutes, this creates a poor user experience.\n\nThe MCP background task protocol solves this by letting clients:\n1. **Start** an operation and receive a task ID immediately\n2. **Track** progress as the operation runs\n3. **Retrieve** the result when ready\n\nFastMCP handles all of this for you. Add `task=True` to your decorator, and your function gains full background execution with progress reporting, distributed processing, and horizontal scaling.\n\n### MCP Background Tasks vs Python Concurrency\n\nYou can always use Python's concurrency primitives (asyncio, threads, multiprocessing) or external task queues in your FastMCP servers. FastMCP is just Python\u2014run code however you like.\n\nMCP background tasks are different: they're **protocol-native**. This means MCP clients that support the task protocol can start operations, receive progress updates, and retrieve results through the standard MCP interface. The coordination happens at the protocol level, not inside your application code.\n\n## Enabling Background Tasks\n\nAdd `task=True` to any tool, resource, resource template, or prompt decorator. This marks the component as capable of background execution.\n\n```python {6}\nimport asyncio\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool(task=True)\nasync def slow_computation(duration: int) -> str:\n    \"\"\"A long-running operation.\"\"\"\n    for i in range(duration):\n        await asyncio.sleep(1)\n    return f\"Completed in {duration} seconds\"\n```\n\nWhen a client requests background execution, the call returns immediately with a task ID. The work executes in a background worker, and the client can poll for status or wait for the result.\n\n<Warning>\nBackground tasks require async functions. Attempting to use `task=True` with a sync function raises a `ValueError` at registration time.\n</Warning>\n\n## Execution Modes\n\nFor fine-grained control over task execution behavior, use `TaskConfig` instead of the boolean shorthand. The MCP task protocol defines three execution modes:\n\n| Mode | Client calls without task | Client calls with task |\n|------|--------------------------|------------------------|\n| `\"forbidden\"` | Executes synchronously | Error: task not supported |\n| `\"optional\"` | Executes synchronously | Executes as background task |\n| `\"required\"` | Error: task required | Executes as background task |\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.server.tasks import TaskConfig\n\nmcp = FastMCP(\"MyServer\")\n\n# Supports both sync and background execution (default when task=True)\n@mcp.tool(task=TaskConfig(mode=\"optional\"))\nasync def flexible_task() -> str:\n    return \"Works either way\"\n\n# Requires background execution - errors if client doesn't request task\n@mcp.tool(task=TaskConfig(mode=\"required\"))\nasync def must_be_background() -> str:\n    return \"Only runs as a background task\"\n\n# No task support (default when task=False or omitted)\n@mcp.tool(task=TaskConfig(mode=\"forbidden\"))\nasync def sync_only() -> str:\n    return \"Never runs as background task\"\n```\n\nThe boolean shortcuts map to these modes:\n- `task=True` \u2192 `TaskConfig(mode=\"optional\")`\n- `task=False` \u2192 `TaskConfig(mode=\"forbidden\")`\n\n### Poll Interval\n\n<VersionBadge version=\"2.15.0\" />\n\nWhen clients poll for task status, the server tells them how frequently to check back. By default, FastMCP suggests a 5-second interval, but you can customize this per component:\n\n```python\nfrom datetime import timedelta\nfrom fastmcp import FastMCP\nfrom fastmcp.server.tasks import TaskConfig\n\nmcp = FastMCP(\"MyServer\")\n\n# Poll every 2 seconds for a fast-completing task\n@mcp.tool(task=TaskConfig(mode=\"optional\", poll_interval=timedelta(seconds=2)))\nasync def quick_task() -> str:\n    return \"Done quickly\"\n\n# Poll every 30 seconds for a long-running task\n@mcp.tool(task=TaskConfig(mode=\"optional\", poll_interval=timedelta(seconds=30)))\nasync def slow_task() -> str:\n    return \"Eventually done\"\n```\n\nShorter intervals give clients faster feedback but increase server load. Longer intervals reduce load but delay status updates.\n\n### Server-Wide Default\n\nTo enable background task support for all components by default, pass `tasks=True` to the constructor. Individual decorators can still override this with `task=False`.\n\n```python\nmcp = FastMCP(\"MyServer\", tasks=True)\n```\n\n<Warning>\nIf your server defines any synchronous tools, resources, or prompts, you will need to explicitly set `task=False` on their decorators to avoid an error.\n</Warning>\n\n### Graceful Degradation\n\nWhen a client requests background execution but the component has `mode=\"forbidden\"`, FastMCP executes synchronously and returns the result inline. This follows the SEP-1686 specification for graceful degradation\u2014clients can always request background execution without worrying about server capabilities.\n\nConversely, when a component has `mode=\"required\"` but the client doesn't request background execution, FastMCP returns an error indicating that task execution is required.\n\n### Configuration\n\n| Environment Variable | Default | Description |\n|---------------------|---------|-------------|\n| `FASTMCP_DOCKET_URL` | `memory://` | Backend URL (`memory://` or `redis://host:port/db`) |\n\n## Backends\n\nFastMCP supports two backends for task execution, each with different tradeoffs.\n\n### In-Memory Backend (Default)\n\nThe in-memory backend (`memory://`) requires zero configuration and works out of the box.\n\n**Advantages:**\n- No external dependencies\n- Simple single-process deployment\n\n**Disadvantages:**\n- **Ephemeral**: If the server restarts, all pending tasks are lost\n- **Higher latency**: ~250ms task pickup time vs single-digit milliseconds with Redis\n- **No horizontal scaling**: Single process only\u2014you cannot add additional workers\n\n### Redis Backend\n\nFor production deployments, use Redis (or Valkey) as your backend by setting `FASTMCP_DOCKET_URL=redis://localhost:6379`.\n\n**Advantages:**\n- **Persistent**: Tasks survive server restarts\n- **Fast**: Single-digit millisecond task pickup latency\n- **Scalable**: Add workers to distribute load across processes or machines\n\n## Workers\n\nEvery FastMCP server with task-enabled components automatically starts an **embedded worker**. You do not need to start a separate worker process for tasks to execute.\n\nTo scale horizontally, add more workers using the CLI:\n\n```bash\nfastmcp tasks worker server.py\n```\n\nEach additional worker pulls tasks from the same queue, distributing load across processes. Configure worker concurrency via environment:\n\n```bash\nexport FASTMCP_DOCKET_CONCURRENCY=20\nfastmcp tasks worker server.py\n```\n\n<Note>\nAdditional workers only work with Redis/Valkey backends. The in-memory backend is single-process only.\n</Note>\n\n## Progress Reporting\n\nThe `Progress` dependency lets you report progress back to clients. Inject it as a parameter with a default value, and FastMCP will provide the active progress reporter.\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Progress\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool(task=True)\nasync def process_files(files: list[str], progress: Progress = Progress()) -> str:\n    await progress.set_total(len(files))\n\n    for file in files:\n        await progress.set_message(f\"Processing {file}\")\n        # ... do work ...\n        await progress.increment()\n\n    return f\"Processed {len(files)} files\"\n```\n\nThe progress API:\n- `await progress.set_total(n)` \u2014 Set the total number of steps\n- `await progress.increment(amount=1)` \u2014 Increment progress\n- `await progress.set_message(text)` \u2014 Update the status message\n\nProgress works in both immediate and background execution modes\u2014you can use the same code regardless of how the client invokes your function.\n\n## Docket Dependencies\n\nFastMCP exposes Docket's full dependency injection system within your task-enabled functions. Beyond `Progress`, you can access the Docket instance, worker information, and use advanced features like retries and timeouts.\n\n```python\nfrom docket import Docket, Worker\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Progress, CurrentDocket, CurrentWorker\n\nmcp = FastMCP(\"MyServer\")\n\n@mcp.tool(task=True)\nasync def my_task(\n    progress: Progress = Progress(),\n    docket: Docket = CurrentDocket(),\n    worker: Worker = CurrentWorker(),\n) -> str:\n    # Schedule additional background work\n    await docket.add(another_task, arg1, arg2)\n\n    # Access worker metadata\n    worker_name = worker.name\n\n    return \"Done\"\n```\n\nWith `CurrentDocket()`, you can schedule additional background tasks, chain work together, and coordinate complex workflows. See the [Docket documentation](https://chrisguidry.github.io/docket/) for the complete API, including retry policies, timeouts, and custom dependencies.\n"}, {"filename": "docs/servers/tools.mdx", "content": "---\ntitle: Tools\nsidebarTitle: Tools\ndescription: Expose functions as executable capabilities for your MCP client.\nicon: wrench\n---\n\nimport { VersionBadge } from '/snippets/version-badge.mdx'\n\nTools are the core building blocks that allow your LLM to interact with external systems, execute code, and access data that isn't in its training data. In FastMCP, tools are Python functions exposed to LLMs through the MCP protocol.\n\nTools in FastMCP transform regular Python functions into capabilities that LLMs can invoke during conversations. When an LLM decides to use a tool:\n\n1.  It sends a request with parameters based on the tool's schema.\n2.  FastMCP validates these parameters against your function's signature.\n3.  Your function executes with the validated inputs.\n4.  The result is returned to the LLM, which can use it in its response.\n\nThis allows LLMs to perform tasks like querying databases, calling APIs, making calculations, or accessing files\u2014extending their capabilities beyond what's in their training data.\n\n\n## The `@tool` Decorator\n\nCreating a tool is as simple as decorating a Python function with `@mcp.tool`:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"CalculatorServer\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n```\n\nWhen this tool is registered, FastMCP automatically:\n- Uses the function name (`add`) as the tool name.\n- Uses the function's docstring (`Adds two integer numbers...`) as the tool description.\n- Generates an input schema based on the function's parameters and type annotations.\n- Handles parameter validation and error reporting.\n\nThe way you define your Python function dictates how the tool appears and behaves for the LLM client.\n\n<Tip>\nFunctions with `*args` or `**kwargs` are not supported as tools. This restriction exists because FastMCP needs to generate a complete parameter schema for the MCP protocol, which isn't possible with variable argument lists.\n</Tip>\n\n### Decorator Arguments\n\nWhile FastMCP infers the name and description from your function, you can override these and add additional metadata using arguments to the `@mcp.tool` decorator:\n\n```python\n@mcp.tool(\n    name=\"find_products\",           # Custom tool name for the LLM\n    description=\"Search the product catalog with optional category filtering.\", # Custom description\n    tags={\"catalog\", \"search\"},      # Optional tags for organization/filtering\n    meta={\"version\": \"1.2\", \"author\": \"product-team\"}  # Custom metadata\n)\ndef search_products_implementation(query: str, category: str | None = None) -> list[dict]:\n    \"\"\"Internal function description (ignored if description is provided above).\"\"\"\n    # Implementation...\n    print(f\"Searching for '{query}' in category '{category}'\")\n    return [{\"id\": 2, \"name\": \"Another Product\"}]\n```\n\n<Card icon=\"code\" title=\"@tool Decorator Arguments\">\n<ParamField body=\"name\" type=\"str | None\">\n  Sets the explicit tool name exposed via MCP. If not provided, uses the function name\n</ParamField>\n\n<ParamField body=\"description\" type=\"str | None\">\n  Provides the description exposed via MCP. If set, the function's docstring is ignored for this purpose\n</ParamField>\n\n<ParamField body=\"tags\" type=\"set[str] | None\">\n  A set of strings used to categorize the tool. These can be used by the server and, in some cases, by clients to filter or group available tools.\n</ParamField>\n\n<ParamField body=\"enabled\" type=\"bool\" default=\"True\">\n  A boolean to enable or disable the tool. See [Disabling Tools](#disabling-tools) for more information\n</ParamField>\n\n<ParamField body=\"icons\" type=\"list[Icon] | None\">\n  <VersionBadge version=\"2.13.0\" />\n\n  Optional list of icon representations for this tool. See [Icons](/servers/icons) for detailed examples\n</ParamField>\n\n<ParamField body=\"annotations\" type=\"ToolAnnotations | dict | None\">\n    An optional `ToolAnnotations` object or dictionary to add additional metadata about the tool.\n  <Expandable title=\"ToolAnnotations attributes\">\n    <ParamField body=\"title\" type=\"str | None\">\n      A human-readable title for the tool.\n    </ParamField>\n    <ParamField body=\"readOnlyHint\" type=\"bool | None\">\n      If true, the tool does not modify its environment.\n    </ParamField>\n    <ParamField body=\"destructiveHint\" type=\"bool | None\">\n      If true, the tool may perform destructive updates to its environment.\n    </ParamField>\n    <ParamField body=\"idempotentHint\" type=\"bool | None\">\n      If true, calling the tool repeatedly with the same arguments will have no additional effect on the its environment.\n    </ParamField>\n    <ParamField body=\"openWorldHint\" type=\"bool | None\">\n      If true, this tool may interact with an \"open world\" of external entities. If false, the tool's domain of interaction is closed.\n    </ParamField>\n  </Expandable>\n</ParamField>\n\n<ParamField body=\"meta\" type=\"dict[str, Any] | None\">\n  <VersionBadge version=\"2.11.0\" />\n  \n  Optional meta information about the tool. This data is passed through to the MCP client as the `_meta` field of the client-side tool object and can be used for custom metadata, versioning, or other application-specific purposes.\n</ParamField>\n</Card>\n\n\n### Async Support\n\nFastMCP is an async-first framework that seamlessly supports both asynchronous (`async def`) and synchronous (`def`) functions as tools. Async tools are preferred for I/O-bound operations to keep your server responsive.\n\nWhile synchronous tools work seamlessly in FastMCP, they can block the event loop during execution. For CPU-intensive or potentially blocking synchronous operations, consider alternative strategies. One approach is to use `anyio` (which FastMCP already uses internally) to wrap them as async functions, for example:\n\n```python {1, 13}\nimport anyio\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\ndef cpu_intensive_task(data: str) -> str:\n    # Some heavy computation that could block the event loop\n    return processed_data\n\n@mcp.tool\nasync def wrapped_cpu_task(data: str) -> str:\n    \"\"\"CPU-intensive task wrapped to prevent blocking.\"\"\"\n    return await anyio.to_thread.run_sync(cpu_intensive_task, data)\n```\n\nAlternative approaches include using `asyncio.get_event_loop().run_in_executor()` or other threading techniques to manage blocking operations without impacting server responsiveness. For example, here's a recipe for using the `asyncer` library (not included in FastMCP) to create a decorator that wraps synchronous functions, courtesy of [@hsheth2](https://github.com/jlowin/fastmcp/issues/864#issuecomment-3103678258):\n\n<CodeGroup>\n```python Decorator Recipe\nimport asyncer\nimport functools\nfrom typing import Callable, ParamSpec, TypeVar, Awaitable\n\n_P = ParamSpec(\"_P\")\n_R = TypeVar(\"_R\")\n\ndef make_async_background(fn: Callable[_P, _R]) -> Callable[_P, Awaitable[_R]]:\n    @functools.wraps(fn)\n    async def wrapper(*args: _P.args, **kwargs: _P.kwargs) -> _R:\n        return await asyncer.asyncify(fn)(*args, **kwargs)\n\n    return wrapper\n```\n\n```python Using the Decorator {6}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n@mcp.tool()\n@make_async_background\ndef my_tool() -> None:\n    time.sleep(5)\n```\n</CodeGroup>\n\n## Arguments\n\nBy default, FastMCP converts Python functions into MCP tools by inspecting the function's signature and type annotations. This allows you to use standard Python type annotations for your tools. In general, the framework strives to \"just work\": idiomatic Python behaviors like parameter defaults and type annotations are automatically translated into MCP schemas. However, there are a number of ways to customize the behavior of your tools.\n\n### Type Annotations\n\nMCP tools have typed arguments, and FastMCP uses type annotations to determine those types. Therefore, you should use standard Python type annotations for tool arguments:\n\n```python\n@mcp.tool\ndef analyze_text(\n    text: str,\n    max_tokens: int = 100,\n    language: str | None = None\n) -> dict:\n    \"\"\"Analyze the provided text.\"\"\"\n    # Implementation...\n```\n\nFastMCP supports a wide range of type annotations, including all Pydantic types:\n\n| Type Annotation         | Example                       | Description                         |\n| :---------------------- | :---------------------------- | :---------------------------------- |\n| Basic types             | `int`, `float`, `str`, `bool` | Simple scalar values |\n| Binary data             | `bytes`                       | Binary content (raw strings, not auto-decoded base64) |\n| Date and Time           | `datetime`, `date`, `timedelta` | Date and time objects (ISO format strings) |\n| Collection types        | `list[str]`, `dict[str, int]`, `set[int]` | Collections of items |\n| Optional types          | `float \\| None`, `Optional[float]`| Parameters that may be null/omitted |\n| Union types             | `str \\| int`, `Union[str, int]`| Parameters accepting multiple types |\n| Constrained types       | `Literal[\"A\", \"B\"]`, `Enum`   | Parameters with specific allowed values |\n| Paths                   | `Path`                        | File system paths (auto-converted from strings) |\n| UUIDs                   | `UUID`                        | Universally unique identifiers (auto-converted from strings) |\n| Pydantic models         | `UserData`                    | Complex structured data with validation |\n\nFastMCP supports all types that Pydantic supports as fields, including all Pydantic custom types. A few FastMCP-specific behaviors to note:\n\n**Binary Data**: `bytes` parameters accept raw strings without automatic base64 decoding. For base64 data, use `str` and decode manually with `base64.b64decode()`.\n\n**Enums**: Clients send enum values (`\"red\"`), not names (`\"RED\"`). Your function receives the Enum member (`Color.RED`).\n\n**Paths and UUIDs**: String inputs are automatically converted to `Path` and `UUID` objects.\n\n**Pydantic Models**: Must be provided as JSON objects (dicts), not stringified JSON. Even with flexible validation, `{\"user\": {\"name\": \"Alice\"}}` works, but `{\"user\": '{\"name\": \"Alice\"}'}` does not.\n\n### Optional Arguments\n\nFastMCP follows Python's standard function parameter conventions. Parameters without default values are required, while those with default values are optional.\n\n```python\n@mcp.tool\ndef search_products(\n    query: str,                   # Required - no default value\n    max_results: int = 10,        # Optional - has default value\n    sort_by: str = \"relevance\",   # Optional - has default value\n    category: str | None = None   # Optional - can be None\n) -> list[dict]:\n    \"\"\"Search the product catalog.\"\"\"\n    # Implementation...\n```\n\nIn this example, the LLM must provide a `query` parameter, while `max_results`, `sort_by`, and `category` will use their default values if not explicitly provided.\n\n### Validation Modes\n\n<VersionBadge version=\"2.13.0\" />\n\nBy default, FastMCP uses Pydantic's flexible validation that coerces compatible inputs to match your type annotations. This improves compatibility with LLM clients that may send string representations of values (like `\"10\"` for an integer parameter).\n\nIf you need stricter validation that rejects any type mismatches, you can enable strict input validation. Strict mode uses the MCP SDK's built-in JSON Schema validation to validate inputs against the exact schema before passing them to your function:\n\n```python\n# Enable strict validation for this server\nmcp = FastMCP(\"StrictServer\", strict_input_validation=True)\n\n@mcp.tool\ndef add_numbers(a: int, b: int) -> int:\n    \"\"\"Add two numbers.\"\"\"\n    return a + b\n\n# With strict_input_validation=True, sending {\"a\": \"10\", \"b\": \"20\"} will fail\n# With strict_input_validation=False (default), it will be coerced to integers\n```\n\n**Validation Behavior Comparison:**\n\n| Input Type | strict_input_validation=False (default) | strict_input_validation=True |\n| :--------- | :-------------------------------------- | :--------------------------- |\n| String integers (`\"10\"` for `int`) | \u2705 Coerced to integer | \u274c Validation error |\n| String floats (`\"3.14\"` for `float`) | \u2705 Coerced to float | \u274c Validation error |\n| String booleans (`\"true\"` for `bool`) | \u2705 Coerced to boolean | \u274c Validation error |\n| Lists with string elements (`[\"1\", \"2\"]` for `list[int]`) | \u2705 Elements coerced | \u274c Validation error |\n| Pydantic model fields with type mismatches | \u2705 Fields coerced | \u274c Validation error |\n| Invalid values (`\"abc\"` for `int`) | \u274c Validation error | \u274c Validation error |\n\n<Note>\n**Note on Pydantic Models:** Even with `strict_input_validation=False`, Pydantic model parameters must be provided as JSON objects (dicts), not as stringified JSON. For example, `{\"user\": {\"name\": \"Alice\"}}` works, but `{\"user\": '{\"name\": \"Alice\"}'}` does not.\n</Note>\n\nThe default flexible validation mode is recommended for most use cases as it handles common LLM client behaviors gracefully while still providing strong type safety through Pydantic's validation.\n\n### Parameter Metadata\n\nYou can provide additional metadata about parameters in several ways:\n\n#### Simple String Descriptions\n\n<VersionBadge version=\"2.11.0\" />\n\nFor basic parameter descriptions, you can use a convenient shorthand with `Annotated`:\n\n```python \nfrom typing import Annotated\n\n@mcp.tool\ndef process_image(\n    image_url: Annotated[str, \"URL of the image to process\"],\n    resize: Annotated[bool, \"Whether to resize the image\"] = False,\n    width: Annotated[int, \"Target width in pixels\"] = 800,\n    format: Annotated[str, \"Output image format\"] = \"jpeg\"\n) -> dict:\n    \"\"\"Process an image with optional resizing.\"\"\"\n    # Implementation...\n```\n\nThis shorthand syntax is equivalent to using `Field(description=...)` but more concise for simple descriptions.\n\n<Tip>\nThis shorthand syntax is only applied to `Annotated` types with a single string description. \n</Tip>\n\n#### Advanced Metadata with Field\n\nFor validation constraints and advanced metadata, use Pydantic's `Field` class with `Annotated`:\n\n```python\nfrom typing import Annotated\nfrom pydantic import Field\n\n@mcp.tool\ndef process_image(\n    image_url: Annotated[str, Field(description=\"URL of the image to process\")],\n    resize: Annotated[bool, Field(description=\"Whether to resize the image\")] = False,\n    width: Annotated[int, Field(description=\"Target width in pixels\", ge=1, le=2000)] = 800,\n    format: Annotated[\n        Literal[\"jpeg\", \"png\", \"webp\"], \n        Field(description=\"Output image format\")\n    ] = \"jpeg\"\n) -> dict:\n    \"\"\"Process an image with optional resizing.\"\"\"\n    # Implementation...\n```\n\n\nYou can also use the Field as a default value, though the Annotated approach is preferred:\n\n```python\n@mcp.tool\ndef search_database(\n    query: str = Field(description=\"Search query string\"),\n    limit: int = Field(10, description=\"Maximum number of results\", ge=1, le=100)\n) -> list:\n    \"\"\"Search the database with the provided query.\"\"\"\n    # Implementation...\n```\n\nField provides several validation and documentation features:\n- `description`: Human-readable explanation of the parameter (shown to LLMs)\n- `ge`/`gt`/`le`/`lt`: Greater/less than (or equal) constraints\n- `min_length`/`max_length`: String or collection length constraints\n- `pattern`: Regex pattern for string validation\n- `default`: Default value if parameter is omitted\n\n### Hiding Parameters from the LLM\n\n<VersionBadge version=\"2.14.0\" />\n\nTo inject values at runtime without exposing them to the LLM (such as `user_id`, credentials, or database connections), use dependency injection with `Depends()`. Parameters using `Depends()` are automatically excluded from the tool schema:\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.dependencies import Depends\n\nmcp = FastMCP()\n\ndef get_user_id() -> str:\n    return \"user_123\"  # Injected at runtime\n\n@mcp.tool\ndef get_user_details(user_id: str = Depends(get_user_id)) -> str:\n    # user_id is injected by the server, not provided by the LLM\n    return f\"Details for {user_id}\"\n```\n\nSee [Custom Dependencies](/servers/context#custom-dependencies) for more details on dependency injection.\n\n## Return Values\n\n\nFastMCP tools can return data in two complementary formats: **traditional content blocks** (like text and images) and **structured outputs** (machine-readable JSON). When you add return type annotations, FastMCP automatically generates **output schemas** to validate the structured data and enables clients to deserialize results back to Python objects.\n\nUnderstanding how these three concepts work together:\n\n- **Return Values**: What your Python function returns (determines both content blocks and structured data)\n- **Structured Outputs**: JSON data sent alongside traditional content for machine processing  \n- **Output Schemas**: JSON Schema declarations that describe and validate the structured output format\n\nThe following sections explain each concept in detail.\n\n### Content Blocks\n\nFastMCP automatically converts tool return values into appropriate MCP content blocks:\n\n- **`str`**: Sent as `TextContent`\n- **`bytes`**: Base64 encoded and sent as `BlobResourceContents` (within an `EmbeddedResource`)\n- **`fastmcp.utilities.types.Image`**: Sent as `ImageContent`\n- **`fastmcp.utilities.types.Audio`**: Sent as `AudioContent`\n- **`fastmcp.utilities.types.File`**: Sent as base64-encoded `EmbeddedResource`\n- **MCP SDK content blocks**: Sent as-is\n- **A list of any of the above**: Converts each item according to the above rules\n- **`None`**: Results in an empty response\n\n#### Media Helper Classes\n\nFastMCP provides helper classes for returning images, audio, and files. When you return one of these classes, either directly or as part of a list, FastMCP automatically converts it to the appropriate MCP content block. For example, if you return a `fastmcp.utilities.types.Image` object, FastMCP will convert it to an MCP `ImageContent` block with the correct MIME type and base64 encoding.\n\n```python\nfrom fastmcp.utilities.types import Image, Audio, File\n\n@mcp.tool\ndef get_chart() -> Image:\n    \"\"\"Generate a chart image.\"\"\"\n    return Image(path=\"chart.png\")\n\n@mcp.tool\ndef get_multiple_charts() -> list[Image]:\n    \"\"\"Return multiple charts.\"\"\"\n    return [Image(path=\"chart1.png\"), Image(path=\"chart2.png\")]\n```\n\n<Tip>\nHelper classes are only automatically converted to MCP content blocks when returned **directly** or as part of a **list**. For more complex containers like dicts, you can manually convert them to MCP types:\n\n```python\n# \u2705 Automatic conversion\nreturn Image(path=\"chart.png\")\nreturn [Image(path=\"chart1.png\"), \"text content\"]\n\n# \u274c Will not be automatically converted\nreturn {\"image\": Image(path=\"chart.png\")}\n\n# \u2705 Manual conversion for nested use\nreturn {\"image\": Image(path=\"chart.png\").to_image_content()}\n```\n</Tip>\n\nEach helper class accepts either `path=` or `data=` (mutually exclusive):\n- **`path`**: File path (string or Path object) - MIME type detected from extension\n- **`data`**: Raw bytes - requires `format=` parameter for MIME type\n- **`format`**: Optional format override (e.g., \"png\", \"wav\", \"pdf\")\n- **`name`**: Optional name for `File` when using `data=`\n- **`annotations`**: Optional MCP annotations for the content\n\n### Structured Output\n\n<VersionBadge version=\"2.10.0\" />\n\nThe 6/18/2025 MCP spec update [introduced](https://modelcontextprotocol.io/specification/2025-06-18/server/tools#structured-content) structured content, which is a new way to return data from tools. Structured content is a JSON object that is sent alongside traditional content. FastMCP automatically creates structured outputs alongside traditional content when your tool returns data that has a JSON object representation. This provides machine-readable JSON data that clients can deserialize back to Python objects.\n\n**Automatic Structured Content Rules:**\n- **Object-like results** (`dict`, Pydantic models, dataclasses) \u2192 Always become structured content (even without output schema)  \n- **Non-object results** (`int`, `str`, `list`) \u2192 Only become structured content if there's an output schema to validate/serialize them\n- **All results** \u2192 Always become traditional content blocks for backward compatibility\n\n<Note>\nThis automatic behavior enables clients to receive machine-readable data alongside human-readable content without requiring explicit output schemas for object-like returns.\n</Note>\n\n#### Dictionaries and Objects\n\nWhen your tool returns a dictionary, dataclass, or Pydantic model, FastMCP automatically creates structured content from it. The structured content contains the actual object data, making it easy for clients to deserialize back to native objects.\n\n<CodeGroup>\n```python Tool Definition\n@mcp.tool\ndef get_user_data(user_id: str) -> dict:\n    \"\"\"Get user data.\"\"\"\n    return {\"name\": \"Alice\", \"age\": 30, \"active\": True}\n```\n\n```json MCP Result\n{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"{\\n  \\\"name\\\": \\\"Alice\\\",\\n  \\\"age\\\": 30,\\n  \\\"active\\\": true\\n}\"\n    }\n  ],\n  \"structuredContent\": {\n    \"name\": \"Alice\",\n    \"age\": 30,\n    \"active\": true\n  }\n}\n```\n</CodeGroup>\n\n#### Primitives and Collections\n\nWhen your tool returns a primitive type (int, str, bool) or a collection (list, set), FastMCP needs a return type annotation to generate structured content. The annotation tells FastMCP how to validate and serialize the result.\n\nWithout a type annotation, the tool only produces `content`:\n\n<CodeGroup>\n```python Tool Definition\n@mcp.tool\ndef calculate_sum(a: int, b: int):\n    \"\"\"Calculate sum without return annotation.\"\"\"\n    return a + b  # Returns 8\n```\n\n```json MCP Result\n{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"8\"\n    }\n  ]\n}\n```\n</CodeGroup>\n\nWhen you add a return annotation, such as `-> int`, FastMCP generates `structuredContent` by wrapping the primitive value in a `{\"result\": ...}` object, since JSON schemas require object-type roots for structured output:\n\n<CodeGroup>\n```python Tool Definition\n@mcp.tool\ndef calculate_sum(a: int, b: int) -> int:\n    \"\"\"Calculate sum with return annotation.\"\"\"\n    return a + b  # Returns 8\n```\n\n```json MCP Result\n{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"8\"\n    }\n  ],\n  \"structuredContent\": {\n    \"result\": 8\n  }\n}\n```\n</CodeGroup>\n\n#### Typed Models\n\nReturn type annotations work with any type that can be converted to a JSON schema. Dataclasses and Pydantic models are particularly useful because FastMCP extracts their field definitions to create detailed schemas.\n\n<CodeGroup>\n```python Tool Definition\nfrom dataclasses import dataclass\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n@dataclass\nclass Person:\n    name: str\n    age: int\n    email: str\n\n@mcp.tool\ndef get_user_profile(user_id: str) -> Person:\n    \"\"\"Get a user's profile information.\"\"\"\n    return Person(\n        name=\"Alice\",\n        age=30,\n        email=\"alice@example.com\",\n    )\n```\n\n```json Generated Output Schema\n{\n  \"properties\": {\n    \"name\": {\"title\": \"Name\", \"type\": \"string\"},\n    \"age\": {\"title\": \"Age\", \"type\": \"integer\"},\n    \"email\": {\"title\": \"Email\", \"type\": \"string\"}\n  },\n  \"required\": [\"name\", \"age\", \"email\"],\n  \"title\": \"Person\",\n  \"type\": \"object\"\n}\n```\n\n```json MCP Result\n{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"{\\\"name\\\": \\\"Alice\\\", \\\"age\\\": 30, \\\"email\\\": \\\"alice@example.com\\\"}\"\n    }\n  ],\n  \"structuredContent\": {\n    \"name\": \"Alice\",\n    \"age\": 30,\n    \"email\": \"alice@example.com\"\n  }\n}\n```\n</CodeGroup>\n\nThe `Person` dataclass becomes an output schema (second tab) that describes the expected format. When executed, clients receive the result (third tab) with both `content` and `structuredContent` fields.\n\n### Output Schemas\n\n<VersionBadge version=\"2.10.0\" />\n\nThe 6/18/2025 MCP spec update [introduced](https://modelcontextprotocol.io/specification/2025-06-18/server/tools#output-schema) output schemas, which are a new way to describe the expected output format of a tool. When an output schema is provided, the tool *must* return structured output that matches the schema.\n\nWhen you add return type annotations to your functions, FastMCP automatically generates JSON schemas that describe the expected output format. These schemas help MCP clients understand and validate the structured data they receive.\n\n#### Primitive Type Wrapping\n\nFor primitive return types (like `int`, `str`, `bool`), FastMCP automatically wraps the result under a `\"result\"` key to create valid structured output:\n\n<CodeGroup>\n```python Primitive Return Type\n@mcp.tool\ndef calculate_sum(a: int, b: int) -> int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n```\n\n```json Generated Schema (Wrapped)\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"result\": {\"type\": \"integer\"}\n  },\n  \"x-fastmcp-wrap-result\": true\n}\n```\n\n```json Structured Output\n{\n  \"result\": 8\n}\n```\n</CodeGroup>\n\n#### Manual Schema Control\n\nYou can override the automatically generated schema by providing a custom `output_schema`:\n\n```python\n@mcp.tool(output_schema={\n    \"type\": \"object\", \n    \"properties\": {\n        \"data\": {\"type\": \"string\"},\n        \"metadata\": {\"type\": \"object\"}\n    }\n})\ndef custom_schema_tool() -> dict:\n    \"\"\"Tool with custom output schema.\"\"\"\n    return {\"data\": \"Hello\", \"metadata\": {\"version\": \"1.0\"}}\n```\n\nSchema generation works for most common types including basic types, collections, union types, Pydantic models, TypedDict structures, and dataclasses.\n\n<Warning>\n**Important Constraints**: \n- Output schemas must be object types (`\"type\": \"object\"`)\n- If you provide an output schema, your tool **must** return structured output that matches it\n- However, you can provide structured output without an output schema (using `ToolResult`)\n</Warning>\n\n### ToolResult and Metadata\n\nFor complete control over tool responses, return a `ToolResult` object. This gives you explicit control over all aspects of the tool's output: traditional content, structured data, and metadata.\n\n```python\nfrom fastmcp.tools.tool import ToolResult\nfrom mcp.types import TextContent\n\n@mcp.tool\ndef advanced_tool() -> ToolResult:\n    \"\"\"Tool with full control over output.\"\"\"\n    return ToolResult(\n        content=[TextContent(type=\"text\", text=\"Human-readable summary\")],\n        structured_content={\"data\": \"value\", \"count\": 42},\n        meta={\"execution_time_ms\": 145}\n    )\n```\n\n`ToolResult` accepts three fields:\n\n**`content`** - The traditional MCP content blocks that clients display to users. Can be a string (automatically converted to `TextContent`), a list of MCP content blocks, or any serializable value (converted to JSON string). At least one of `content` or `structured_content` must be provided.\n\n```python\n# Simple string\nToolResult(content=\"Hello, world!\")\n\n# List of content blocks\nToolResult(content=[\n    TextContent(type=\"text\", text=\"Result: 42\"),\n    ImageContent(type=\"image\", data=\"base64...\", mimeType=\"image/png\")\n])\n```\n\n**`structured_content`** - A dictionary containing structured data that matches your tool's output schema. This enables clients to programmatically process the results. If you provide `structured_content`, it must be a dictionary or `None`. If only `structured_content` is provided, it will also be used as `content` (converted to JSON string).\n\n```python\nToolResult(\n    content=\"Found 3 users\",\n    structured_content={\"users\": [{\"name\": \"Alice\"}, {\"name\": \"Bob\"}]}\n)\n```\n\n**`meta`** \n<VersionBadge version=\"2.13.1\" />\nRuntime metadata about the tool execution. Use this for performance metrics, debugging information, or any client-specific data that doesn't belong in the content or structured output.\n\n```python\nToolResult(\n    content=\"Analysis complete\",\n    structured_content={\"result\": \"positive\"},\n    meta={\n        \"execution_time_ms\": 145,\n        \"model_version\": \"2.1\",\n        \"confidence\": 0.95\n    }\n)\n```\n\n<Note>\nThe `meta` field in `ToolResult` is for runtime metadata about tool execution (e.g., execution time, performance metrics). This is separate from the `meta` parameter in `@mcp.tool(meta={...})`, which provides static metadata about the tool definition itself.\n</Note>\n\nWhen returning `ToolResult`, you have full control - FastMCP won't automatically wrap or transform your data. `ToolResult` can be returned with or without an output schema.\n\n## Error Handling\n\n<VersionBadge version=\"2.4.1\" />\n\nIf your tool encounters an error, you can raise a standard Python exception (`ValueError`, `TypeError`, `FileNotFoundError`, custom exceptions, etc.) or a FastMCP `ToolError`.\n\nBy default, all exceptions (including their details) are logged and converted into an MCP error response to be sent back to the client LLM. This helps the LLM understand failures and react appropriately.\n\nIf you want to mask internal error details for security reasons, you can:\n\n1. Use the `mask_error_details=True` parameter when creating your `FastMCP` instance:\n```python\nmcp = FastMCP(name=\"SecureServer\", mask_error_details=True)\n```\n\n2. Or use `ToolError` to explicitly control what error information is sent to clients:\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.exceptions import ToolError\n\n@mcp.tool\ndef divide(a: float, b: float) -> float:\n    \"\"\"Divide a by b.\"\"\"\n\n    if b == 0:\n        # Error messages from ToolError are always sent to clients,\n        # regardless of mask_error_details setting\n        raise ToolError(\"Division by zero is not allowed.\")\n    \n    # If mask_error_details=True, this message would be masked\n    if not isinstance(a, (int, float)) or not isinstance(b, (int, float)):\n        raise TypeError(\"Both arguments must be numbers.\")\n        \n    return a / b\n```\n\nWhen `mask_error_details=True`, only error messages from `ToolError` will include details, other exceptions will be converted to a generic message.\n\n## Disabling Tools\n\n<VersionBadge version=\"2.8.0\" />\n\nYou can control the visibility and availability of tools by enabling or disabling them. This is useful for feature flagging, maintenance, or dynamically changing the toolset available to a client. Disabled tools will not appear in the list of available tools returned by `list_tools`, and attempting to call a disabled tool will result in an \"Unknown tool\" error, just as if the tool did not exist.\n\nBy default, all tools are enabled. You can disable a tool upon creation using the `enabled` parameter in the decorator:\n\n```python\n@mcp.tool(enabled=False)\ndef maintenance_tool():\n    \"\"\"This tool is currently under maintenance.\"\"\"\n    return \"This tool is disabled.\"\n```\n\nYou can also toggle a tool's state programmatically after it has been created:\n\n```python\n@mcp.tool\ndef dynamic_tool():\n    return \"I am a dynamic tool.\"\n\n# Disable and re-enable the tool\ndynamic_tool.disable()\ndynamic_tool.enable()\n```\n## MCP Annotations\n\n<VersionBadge version=\"2.2.7\" />\n\nFastMCP allows you to add specialized metadata to your tools through annotations. These annotations communicate how tools behave to client applications without consuming token context in LLM prompts.\n\nAnnotations serve several purposes in client applications:\n- Adding user-friendly titles for display purposes\n- Indicating whether tools modify data or systems\n- Describing the safety profile of tools (destructive vs. non-destructive)\n- Signaling if tools interact with external systems\n\nYou can add annotations to a tool using the `annotations` parameter in the `@mcp.tool` decorator:\n\n```python\n@mcp.tool(\n    annotations={\n        \"title\": \"Calculate Sum\",\n        \"readOnlyHint\": True,\n        \"openWorldHint\": False\n    }\n)\ndef calculate_sum(a: float, b: float) -> float:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n```\n\nFastMCP supports these standard annotations:\n\n| Annotation | Type | Default | Purpose |\n| :--------- | :--- | :------ | :------ |\n| `title` | string | - | Display name for user interfaces |\n| `readOnlyHint` | boolean | false | Indicates if the tool only reads without making changes |\n| `destructiveHint` | boolean | true | For non-readonly tools, signals if changes are destructive |\n| `idempotentHint` | boolean | false | Indicates if repeated identical calls have the same effect as a single call |\n| `openWorldHint` | boolean | true | Specifies if the tool interacts with external systems |\n\nRemember that annotations help make better user experiences but should be treated as advisory hints. They help client applications present appropriate UI elements and safety controls, but won't enforce security boundaries on their own. Always focus on making your annotations accurately represent what your tool actually does.\n\n### Using Annotation Hints\n\nMCP clients like Claude and ChatGPT use annotation hints to determine when to skip confirmation prompts and how to present tools to users. The most commonly used hint is `readOnlyHint`, which signals that a tool only reads data without making changes.\n\n**Read-only tools** improve user experience by:\n- Skipping confirmation prompts for safe operations\n- Allowing broader access without security concerns\n- Enabling more aggressive batching and caching\n\nMark a tool as read-only when it retrieves data, performs calculations, or checks status without modifying state:\n\n```python\nfrom fastmcp import FastMCP\nfrom mcp.types import ToolAnnotations\n\nmcp = FastMCP(\"Data Server\")\n\n@mcp.tool(annotations={\"readOnlyHint\": True})\ndef get_user(user_id: str) -> dict:\n    \"\"\"Retrieve user information by ID.\"\"\"\n    return {\"id\": user_id, \"name\": \"Alice\"}\n\n@mcp.tool(\n    annotations=ToolAnnotations(\n        readOnlyHint=True,\n        idempotentHint=True,  # Same result for repeated calls\n        openWorldHint=False   # Only internal data\n    )\n)\ndef search_products(query: str) -> list[dict]:\n    \"\"\"Search the product catalog.\"\"\"\n    return [{\"id\": 1, \"name\": \"Widget\", \"price\": 29.99}]\n\n# Write operations - no readOnlyHint\n@mcp.tool()\ndef update_user(user_id: str, name: str) -> dict:\n    \"\"\"Update user information.\"\"\"\n    return {\"id\": user_id, \"name\": name, \"updated\": True}\n\n@mcp.tool(annotations={\"destructiveHint\": True})\ndef delete_user(user_id: str) -> dict:\n    \"\"\"Permanently delete a user account.\"\"\"\n    return {\"deleted\": user_id}\n```\n\nFor tools that write to databases, send notifications, create/update/delete resources, or trigger workflows, omit `readOnlyHint` or set it to `False`. Use `destructiveHint=True` for operations that cannot be undone.\n\nClient-specific behavior:\n- **ChatGPT**: Skips confirmation prompts for read-only tools in Chat mode (see [ChatGPT integration](/integrations/chatgpt))\n- **Claude**: Uses hints to understand tool safety profiles and make better execution decisions\n\n## Notifications\n\n<VersionBadge version=\"2.9.1\" />\n\nFastMCP automatically sends `notifications/tools/list_changed` notifications to connected clients when tools are added, removed, enabled, or disabled. This allows clients to stay up-to-date with the current tool set without manually polling for changes.\n\n```python\n@mcp.tool\ndef example_tool() -> str:\n    return \"Hello!\"\n\n# These operations trigger notifications:\nmcp.add_tool(example_tool)     # Sends tools/list_changed notification\nexample_tool.disable()         # Sends tools/list_changed notification  \nexample_tool.enable()          # Sends tools/list_changed notification\nmcp.remove_tool(\"example_tool\") # Sends tools/list_changed notification\n```\n\nNotifications are only sent when these operations occur within an active MCP request context (e.g., when called from within a tool or other MCP operation). Operations performed during server initialization do not trigger notifications.\n\nClients can handle these notifications using a [message handler](/clients/messages) to automatically refresh their tool lists or update their interfaces.\n\n## Accessing the MCP Context\n\nTools can access MCP features like logging, reading resources, or reporting progress through the `Context` object. To use it, add a parameter to your tool function with the type hint `Context`.\n\n```python\nfrom fastmcp import FastMCP, Context\n\nmcp = FastMCP(name=\"ContextDemo\")\n\n@mcp.tool\nasync def process_data(data_uri: str, ctx: Context) -> dict:\n    \"\"\"Process data from a resource with progress reporting.\"\"\"\n    await ctx.info(f\"Processing data from {data_uri}\")\n    \n    # Read a resource\n    resource = await ctx.read_resource(data_uri)\n    data = resource[0].content if resource else \"\"\n    \n    # Report progress\n    await ctx.report_progress(progress=50, total=100)\n    \n    # Example request to the client's LLM for help\n    summary = await ctx.sample(f\"Summarize this in 10 words: {data[:200]}\")\n    \n    await ctx.report_progress(progress=100, total=100)\n    return {\n        \"length\": len(data),\n        \"summary\": summary.text\n    }\n```\n\nThe Context object provides access to:\n\n- **Logging**: `ctx.debug()`, `ctx.info()`, `ctx.warning()`, `ctx.error()`\n- **Progress Reporting**: `ctx.report_progress(progress, total)`\n- **Resource Access**: `ctx.read_resource(uri)`\n- **LLM Sampling**: `ctx.sample(...)`\n- **Request Information**: `ctx.request_id`, `ctx.client_id`\n\nFor full documentation on the Context object and all its capabilities, see the [Context documentation](/servers/context).\n\n## Server Behavior\n\n### Duplicate Tools\n\n<VersionBadge version=\"2.1.0\" />\n\nYou can control how the FastMCP server behaves if you try to register multiple tools with the same name. This is configured using the `on_duplicate_tools` argument when creating the `FastMCP` instance.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(\n    name=\"StrictServer\",\n    # Configure behavior for duplicate tool names\n    on_duplicate_tools=\"error\"\n)\n\n@mcp.tool\ndef my_tool(): return \"Version 1\"\n\n# This will now raise a ValueError because 'my_tool' already exists\n# and on_duplicate_tools is set to \"error\".\n# @mcp.tool\n# def my_tool(): return \"Version 2\"\n```\n\nThe duplicate behavior options are:\n\n-   `\"warn\"` (default): Logs a warning and the new tool replaces the old one.\n-   `\"error\"`: Raises a `ValueError`, preventing the duplicate registration.\n-   `\"replace\"`: Silently replaces the existing tool with the new one.\n-   `\"ignore\"`: Keeps the original tool and ignores the new registration attempt.\n\n### Removing Tools\n\n<VersionBadge version=\"2.3.4\" />\n\nYou can dynamically remove tools from a server using the `remove_tool` method:\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"DynamicToolServer\")\n\n@mcp.tool\ndef calculate_sum(a: int, b: int) -> int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n\nmcp.remove_tool(\"calculate_sum\")\n```\n"}, {"filename": "docs/snippets/local-focus.mdx", "content": "export const LocalFocusTip = () => {\n    return (\n        <Tip>\n            <strong>This integration focuses on running local FastMCP server files with STDIO transport.</strong> For remote servers running with HTTP or SSE transport, use your client's native configuration - FastMCP's integrations focus on simplifying the complex local setup with dependencies and <code>uv</code> commands.\n        </Tip>\n    );\n};"}, {"filename": "docs/snippets/version-badge.mdx", "content": "export const VersionBadge = ({ version }) => {\n    return (\n        <Badge stroke size='lg' icon='gift' iconType='regular' className=\"version-badge\">\n            New in version <code>{version}</code>\n        </Badge>\n    );\n};"}, {"filename": "docs/snippets/youtube-embed.mdx", "content": "export const YouTubeEmbed = ({ videoId, title }) => {\n    return (\n        <iframe\n            className=\"w-full aspect-video rounded-md\"\n            src={`https://www.youtube.com/embed/${videoId}`}\n            title={title}\n            frameBorder=\"0\"\n            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n            allowFullScreen\n        />\n    );\n};"}, {"filename": "docs/tutorials/create-mcp-server.mdx", "content": "---\ntitle: \"How to Create an MCP Server in Python\"\nsidebarTitle: \"Creating an MCP Server\"\ndescription: \"A step-by-step guide to building a Model Context Protocol (MCP) server using Python and FastMCP, from basic tools to dynamic resources.\"\nicon: server\n---\n\nSo you want to build a Model Context Protocol (MCP) server in Python. The goal is to create a service that can provide tools and data to AI models like Claude, Gemini, or others that support the protocol. While the [MCP specification](https://modelcontextprotocol.io/specification/) is powerful, implementing it from scratch involves a lot of boilerplate: handling JSON-RPC, managing session state, and correctly formatting requests and responses.\n\nThis is where **FastMCP** comes in. It's a high-level framework that handles all the protocol complexities for you, letting you focus on what matters: writing the Python functions that power your server.\n\nThis guide will walk you through creating a fully-featured MCP server from scratch using FastMCP.\n\n<Tip>\nEvery code block in this tutorial is a complete, runnable example. You can copy and paste it into a file and run it, or paste it directly into a Python REPL like IPython to try it out.\n</Tip>\n\n### Prerequisites\n\nMake sure you have FastMCP installed. If not, follow the [installation guide](/getting-started/installation).\n\n```bash\npip install fastmcp\n```\n\n\n## Step 1: Create the Basic Server\n\nEvery FastMCP application starts with an instance of the `FastMCP` class. This object acts as the container for all your tools and resources.\n\nCreate a new file called `my_mcp_server.py`:\n\n```python my_mcp_server.py\nfrom fastmcp import FastMCP\n\n# Create a server instance with a descriptive name\nmcp = FastMCP(name=\"My First MCP Server\")\n```\n\nThat's it! You have a valid (though empty) MCP server. Now, let's add some functionality.\n\n## Step 2: Add a Tool\n\nTools are functions that an LLM can execute. Let's create a simple tool that adds two numbers.\n\nTo do this, simply write a standard Python function and decorate it with `@mcp.tool`.\n\n```python my_mcp_server.py {5-8}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"My First MCP Server\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n```\n\nFastMCP automatically handles the rest:\n- **Tool Name:** It uses the function name (`add`) as the tool's name.\n- **Description:** It uses the function's docstring as the tool's description for the LLM.\n- **Schema:** It inspects the type hints (`a: int`, `b: int`) to generate a JSON schema for the inputs.\n\nThis is the core philosophy of FastMCP: **write Python, not protocol boilerplate.**\n\n## Step 3: Expose Data with Resources\n\nResources provide read-only data to the LLM. You can define a resource by decorating a function with `@mcp.resource`, providing a unique URI.\n\nLet's expose a simple configuration dictionary as a resource.\n\n```python my_mcp_server.py {10-13}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"My First MCP Server\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n\n@mcp.resource(\"resource://config\")\ndef get_config() -> dict:\n    \"\"\"Provides the application's configuration.\"\"\"\n    return {\"version\": \"1.0\", \"author\": \"MyTeam\"}\n```\n\nWhen a client requests the URI `resource://config`, FastMCP will execute the `get_config` function and return its output (serialized as JSON) to the client. The function is only called when the resource is requested, enabling lazy-loading of data.\n\n## Step 4: Generate Dynamic Content with Resource Templates\n\nSometimes, you need to generate resources based on parameters. This is what **Resource Templates** are for. You define them using the same `@mcp.resource` decorator but with placeholders in the URI.\n\nLet's create a template that provides a personalized greeting.\n\n```python my_mcp_server.py {15-17}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"My First MCP Server\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n\n@mcp.resource(\"resource://config\")\ndef get_config() -> dict:\n    \"\"\"Provides the application's configuration.\"\"\"\n    return {\"version\": \"1.0\", \"author\": \"MyTeam\"}\n\n@mcp.resource(\"greetings://{name}\")\ndef personalized_greeting(name: str) -> str:\n    \"\"\"Generates a personalized greeting for the given name.\"\"\"\n    return f\"Hello, {name}! Welcome to the MCP server.\"\n```\n\nNow, clients can request dynamic URIs:\n- `greetings://Ford` will call `personalized_greeting(name=\"Ford\")`.\n- `greetings://Marvin` will call `personalized_greeting(name=\"Marvin\")`.\n\nFastMCP automatically maps the `{name}` placeholder in the URI to the `name` parameter in your function.\n\n## Step 5: Run the Server\n\nTo make your server executable, add a `__main__` block to your script that calls `mcp.run()`.\n\n```python my_mcp_server.py {19-20}\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"My First MCP Server\")\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n\n@mcp.resource(\"resource://config\")\ndef get_config() -> dict:\n    \"\"\"Provides the application's configuration.\"\"\"\n    return {\"version\": \"1.0\", \"author\": \"MyTeam\"}\n\n@mcp.resource(\"greetings://{name}\")\ndef personalized_greeting(name: str) -> str:\n    \"\"\"Generates a personalized greeting for the given name.\"\"\"\n    return f\"Hello, {name}! Welcome to the MCP server.\"\n\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\nNow you can run your server from the command line:\n```bash\npython my_mcp_server.py\n```\nThis starts the server using the default **STDIO transport**, which is how clients like Claude Desktop communicate with local servers. To learn about other transports, like HTTP, see the [Running Your Server](/deployment/running-server) guide.\n\n## The Complete Server\n\nHere is the full code for `my_mcp_server.py` (click to expand):\n\n```python my_mcp_server.py [expandable]\nfrom fastmcp import FastMCP\n\n# 1. Create the server\nmcp = FastMCP(name=\"My First MCP Server\")\n\n# 2. Add a tool\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    \"\"\"Adds two integer numbers together.\"\"\"\n    return a + b\n\n# 3. Add a static resource\n@mcp.resource(\"resource://config\")\ndef get_config() -> dict:\n    \"\"\"Provides the application's configuration.\"\"\"\n    return {\"version\": \"1.0\", \"author\": \"MyTeam\"}\n\n# 4. Add a resource template for dynamic content\n@mcp.resource(\"greetings://{name}\")\ndef personalized_greeting(name: str) -> str:\n    \"\"\"Generates a personalized greeting for the given name.\"\"\"\n    return f\"Hello, {name}! Welcome to the MCP server.\"\n\n# 5. Make the server runnable\nif __name__ == \"__main__\":\n    mcp.run()\n```\n\n## Next Steps\n\nYou've successfully built an MCP server! From here, you can explore more advanced topics:\n\n-   [**Tools in Depth**](/servers/tools): Learn about asynchronous tools, error handling, and custom return types.\n-   [**Resources & Templates**](/servers/resources): Discover different resource types, including files and HTTP endpoints.\n-   [**Prompts**](/servers/prompts): Create reusable prompt templates for your LLM.\n-   [**Running Your Server**](/deployment/running-server): Deploy your server with different transports like HTTP.\n\n"}, {"filename": "docs/tutorials/mcp.mdx", "content": "---\ntitle: \"What is the Model Context Protocol (MCP)?\"\nsidebarTitle: \"What is MCP?\"\ndescription: \"An introduction to the core concepts of the Model Context Protocol (MCP), explaining what it is, why it's useful, and how it works.\"\nicon: \"diagram-project\"\n---\n\nThe Model Context Protocol (MCP) is an open standard designed to solve a fundamental problem in AI development: how can Large Language Models (LLMs) reliably and securely interact with external tools, data, and services?\n\nIt's the **bridge between the probabilistic, non-deterministic world of AI and the deterministic, reliable world of your code and data.**\n\nWhile you could build a custom REST API for your LLM, MCP provides a specialized, standardized \"port\" for AI-native communication. Think of it as **USB-C for AI**: a single, well-defined interface for connecting any compliant LLM to any compliant tool or data source.\n\nThis guide provides a high-level overview of the protocol itself. We'll use **FastMCP**, the leading Python framework for MCP, to illustrate the concepts with simple code examples.\n\n## Why Do We Need a Protocol?\n\nWith countless APIs already in existence, the most common question is: \"Why do we need another one?\"\n\nThe answer lies in **standardization**. The AI ecosystem is fragmented. Every model provider has its own way of defining and calling tools. MCP's goal is to create a common language that offers several key advantages:\n\n1.  **Interoperability:** Build one MCP server, and it can be used by any MCP-compliant client (Claude, Gemini, OpenAI, custom agents, etc.) without custom integration code. This is the protocol's most important promise.\n2.  **Discoverability:** Clients can dynamically ask a server what it's capable of at runtime. They receive a structured, machine-readable \"menu\" of tools and resources.\n3.  **Security & Safety:** MCP provides a clear, sandboxed boundary. An LLM can't execute arbitrary code on your server; it can only *request* to run the specific, typed, and validated functions you explicitly expose.\n4.  **Composability:** You can build small, specialized MCP servers and combine them to create powerful, complex applications.\n\n## Core MCP Components \n\nAn MCP server exposes its capabilities through three primary components: Tools, Resources, and Prompts.\n\n### Tools: Executable Actions\n\nTools are functions that the LLM can ask the server to execute. They are the action-oriented part of MCP.\n\nIn the spirit of a REST API, you can think of **Tools as being like `POST` requests.** They are used to *perform an action*, *change state*, or *trigger a side effect*, like sending an email, adding a user to a database, or making a calculation.\n\nWith FastMCP, creating a tool is as simple as decorating a Python function.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n# This function is now an MCP tool named \"get_weather\"\n@mcp.tool\ndef get_weather(city: str) -> dict:\n    \"\"\"Gets the current weather for a specific city.\"\"\"\n    # In a real app, this would call a weather API\n    return {\"city\": city, \"temperature\": \"72F\", \"forecast\": \"Sunny\"}\n```\n\n[**Learn more about Tools \u2192**](/servers/tools)\n\n### Resources: Read-Only Data\n\nResources are data sources that the LLM can read. They are used to load information into the LLM's context, providing it with knowledge it doesn't have from its training data.\n\nFollowing the REST API analogy, **Resources are like `GET` requests.** Their purpose is to *retrieve information* idempotently, ideally without causing side effects. A resource can be anything from a static text file to a dynamic piece of data from a database. Each resource is identified by a unique URI.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n# This function provides a resource at the URI \"system://status\"\n@mcp.resource(\"system://status\")\ndef get_system_status() -> dict:\n    \"\"\"Returns the current operational status of the service.\"\"\"\n    return {\"status\": \"all systems normal\"}\n```\n\n#### Resource Templates\n\nYou can also create **Resource Templates** for dynamic data. A client could request `users://42/profile` to get the profile for a specific user.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n# This template provides user data for any given user ID\n@mcp.resource(\"users://{user_id}/profile\")\ndef get_user_profile(user_id: str) -> dict:\n    \"\"\"Returns the profile for a specific user.\"\"\"\n    # Fetch user from a database...\n    return {\"id\": user_id, \"name\": \"Zaphod Beeblebrox\"}\n```\n\n[**Learn more about Resources & Templates \u2192**](/servers/resources)\n\n### Prompts: Reusable Instructions\n\nPrompts are reusable, parameterized message templates. They provide a way to define consistent, structured instructions that a client can request to guide the LLM's behavior for a specific task.\n\n```python\nfrom fastmcp import FastMCP\n\nmcp = FastMCP()\n\n@mcp.prompt\ndef summarize_text(text_to_summarize: str) -> str:\n    \"\"\"Creates a prompt asking the LLM to summarize a piece of text.\"\"\"\n    return f\"\"\"\n        Please provide a concise, one-paragraph summary of the following text:\n        \n        {text_to_summarize}\n        \"\"\"\n```\n\n[**Learn more about Prompts \u2192**](/servers/prompts)\n\n## Advanced Capabilities\n\nBeyond the core components, MCP also supports more advanced interaction patterns, such as a server requesting that the *client's* LLM generate a completion (known as **sampling**), or a server sending asynchronous **notifications** to a client. These features enable more complex, bidirectional workflows and are fully supported by FastMCP.\n\n## Next Steps\n\nNow that you understand the core concepts of the Model Context Protocol, you're ready to start building. The best place to begin is our step-by-step tutorial.\n\n[**Tutorial: How to Create an MCP Server in Python \u2192**](/tutorials/create-mcp-server)\n"}, {"filename": "docs/tutorials/rest-api.mdx", "content": "---\ntitle: \"How to Connect an LLM to a REST API\"\nsidebarTitle: \"Connect LLMs to REST APIs\"\ndescription: \"A step-by-step guide to making any REST API with an OpenAPI spec available to LLMs using FastMCP.\"\nicon: \"plug\"\n---\n\nYou've built a powerful REST API, and now you want your LLM to be able to use it. Manually writing a wrapper function for every single endpoint is tedious, error-prone, and hard to maintain.\n\nThis is where **FastMCP** shines. If your API has an OpenAPI (or Swagger) specification, FastMCP can automatically convert your entire API into a fully-featured MCP server, making every endpoint available as a secure, typed tool for your AI model.\n\nThis guide will walk you through converting a public REST API into an MCP server in just a few lines of code.\n\n<Tip>\nEvery code block in this tutorial is a complete, runnable example. You can copy and paste it into a file and run it, or paste it directly into a Python REPL like IPython to try it out.\n</Tip>\n\n### Prerequisites\n\nMake sure you have FastMCP installed. If not, follow the [installation guide](/getting-started/installation).\n\n```bash\npip install fastmcp\n```\n\n## Step 1: Choose a Target API\n\nFor this tutorial, we'll use the [JSONPlaceholder API](https://jsonplaceholder.typicode.com/), a free, fake online REST API for testing and prototyping. It's perfect because it's simple and has a public OpenAPI specification.\n\n-   **API Base URL:** `https://jsonplaceholder.typicode.com`\n-   **OpenAPI Spec URL:** We'll use a community-provided spec for it.\n\n## Step 2: Create the MCP Server\n\nNow for the magic. We'll use `FastMCP.from_openapi`. This method takes an `httpx.AsyncClient` configured for your API and its OpenAPI specification, and automatically converts **every endpoint** into a callable MCP `Tool`.\n\n<Tip>\nLearn more about working with OpenAPI specs in the [OpenAPI integration docs](/integrations/openapi).\n</Tip>\n\n<Note>\nFor this tutorial, we'll use a simplified OpenAPI spec directly in the code. In a real project, you would typically load the spec from a URL or local file.\n</Note>\n\nCreate a file named `api_server.py`:\n\n```python api_server.py {31-35}\nimport httpx\nfrom fastmcp import FastMCP\n\n# Create an HTTP client for the target API\nclient = httpx.AsyncClient(base_url=\"https://jsonplaceholder.typicode.com\")\n\n# Define a simplified OpenAPI spec for JSONPlaceholder\nopenapi_spec = {\n    \"openapi\": \"3.0.0\",\n    \"info\": {\"title\": \"JSONPlaceholder API\", \"version\": \"1.0\"},\n    \"paths\": {\n        \"/users\": {\n            \"get\": {\n                \"summary\": \"Get all users\",\n                \"operationId\": \"get_users\",\n                \"responses\": {\"200\": {\"description\": \"A list of users.\"}}\n            }\n        },\n        \"/users/{id}\": {\n            \"get\": {\n                \"summary\": \"Get a user by ID\",\n                \"operationId\": \"get_user_by_id\",\n                \"parameters\": [{\"name\": \"id\", \"in\": \"path\", \"required\": True, \"schema\": {\"type\": \"integer\"}}],\n                \"responses\": {\"200\": {\"description\": \"A single user.\"}}\n            }\n        }\n    }\n}\n\n# Create the MCP server from the OpenAPI spec\nmcp = FastMCP.from_openapi(\n    openapi_spec=openapi_spec,\n    client=client,\n    name=\"JSONPlaceholder MCP Server\"\n)\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\nAnd that's it! With just a few lines of code, you've created an MCP server that exposes the entire JSONPlaceholder API as a collection of tools.\n\n## Step 3: Test the Generated Server\n\nLet's verify that our new MCP server works. We can use the `fastmcp.Client` to connect to it and inspect its tools.\n\n<Tip>\nLearn more about the FastMCP client in the [client docs](/clients/client).\n</Tip>\n\nCreate a separate file, `api_client.py`:\n\n```python api_client.py {2, 6, 9, 16}\nimport asyncio\nfrom fastmcp import Client\n\nasync def main():\n    # Connect to the MCP server we just created\n    async with Client(\"http://127.0.0.1:8000/mcp\") as client:\n        \n        # List the tools that were automatically generated\n        tools = await client.list_tools()\n        print(\"Generated Tools:\")\n        for tool in tools:\n            print(f\"- {tool.name}\")\n            \n        # Call one of the generated tools\n        print(\"\\n\\nCalling tool 'get_user_by_id'...\")\n        user = await client.call_tool(\"get_user_by_id\", {\"id\": 1})\n        print(f\"Result:\\n{user.data}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nFirst, run your server:\n```bash\npython api_server.py\n```\n\nThen, in another terminal, run the client:\n```bash\npython api_client.py\n```\n\nYou should see a list of generated tools (`get_users`, `get_user_by_id`) and the result of calling the `get_user_by_id` tool, which fetches data from the live JSONPlaceholder API.\n\n![](/assets/images/tutorial-rest-api-result.png)\n\n\n## Step 4: Customizing Route Maps\n\nBy default, FastMCP converts every API endpoint into an MCP `Tool`. This ensures maximum compatibility with contemporary LLM clients, many of which **only support the `tools` part of the MCP specification.**\n\nHowever, for clients that support the full MCP spec, representing `GET` requests as `Resources` can be more semantically correct and efficient.\n\nFastMCP allows users to customize this behavior using the concept of \"route maps\". A `RouteMap` is a mapping of an API route to an MCP type. FastMCP checks each API route against your custom maps in order. If a route matches a map, it's converted to the specified `mcp_type`. Any route that doesn't match your custom maps will fall back to the default behavior (becoming a `Tool`).\n\n<Tip>\nLearn more about route maps in the [OpenAPI integration docs](/integrations/openapi#route-mapping).\n</Tip>\n\nHere\u2019s how you can add custom route maps to turn `GET` requests into `Resources` and `ResourceTemplates` (if they have path parameters):\n\n```python api_server_with_resources.py {3, 37-42}\nimport httpx\nfrom fastmcp import FastMCP\nfrom fastmcp.server.openapi import RouteMap, MCPType\n\n\n# Create an HTTP client for the target API\nclient = httpx.AsyncClient(base_url=\"https://jsonplaceholder.typicode.com\")\n\n# Define a simplified OpenAPI spec for JSONPlaceholder\nopenapi_spec = {\n    \"openapi\": \"3.0.0\",\n    \"info\": {\"title\": \"JSONPlaceholder API\", \"version\": \"1.0\"},\n    \"paths\": {\n        \"/users\": {\n            \"get\": {\n                \"summary\": \"Get all users\",\n                \"operationId\": \"get_users\",\n                \"responses\": {\"200\": {\"description\": \"A list of users.\"}}\n            }\n        },\n        \"/users/{id}\": {\n            \"get\": {\n                \"summary\": \"Get a user by ID\",\n                \"operationId\": \"get_user_by_id\",\n                \"parameters\": [{\"name\": \"id\", \"in\": \"path\", \"required\": True, \"schema\": {\"type\": \"integer\"}}],\n                \"responses\": {\"200\": {\"description\": \"A single user.\"}}\n            }\n        }\n    }\n}\n\n# Create the MCP server with custom route mapping\nmcp = FastMCP.from_openapi(\n    openapi_spec=openapi_spec,\n    client=client,\n    name=\"JSONPlaceholder MCP Server\",\n    route_maps=[\n        # Map GET requests with path parameters (e.g., /users/{id}) to ResourceTemplate\n        RouteMap(methods=[\"GET\"], pattern=r\".*\\{.*\\}.*\", mcp_type=MCPType.RESOURCE_TEMPLATE),\n        # Map all other GET requests to Resource\n        RouteMap(methods=[\"GET\"], mcp_type=MCPType.RESOURCE),\n    ]\n)\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\nWith this configuration:\n- `GET /users/{id}` becomes a `ResourceTemplate`.\n- `GET /users` becomes a `Resource`.\n- Any `POST`, `PUT`, etc. endpoints would still become `Tools` by default."}, {"filename": "docs/updates.mdx", "content": "---\ntitle: \"FastMCP Updates\"\nsidebarTitle: \"Updates\"\nicon: \"sparkles\"\ntag: NEW\n---\n\n<Update label=\"FastMCP 2.13.0\" description=\"October 25, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.13.0: Cache Me If You Can\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.13.0\"\ncta=\"Read the release notes\"\n>\nFastMCP 2.13 \"Cache Me If You Can\" represents a fundamental maturation of the framework. After months of community feedback on authentication and state management, this release delivers the infrastructure FastMCP needs to handle production workloads: persistent storage, response caching, and pragmatic OAuth improvements that reflect real-world deployment challenges.\n\n\ud83d\udcbe **Pluggable storage backends** bring persistent state to FastMCP servers. Built on [py-key-value-aio](https://github.com/strawgate/py-key-value), a new library from FastMCP maintainer Bill Easton ([@strawgate](https://github.com/strawgate)), the storage layer provides encrypted disk storage by default, platform-aware token management, and a simple key-value interface for application state. We're excited to bring this elegantly designed library into the FastMCP ecosystem - it's both powerful and remarkably easy to use, including wrappers to add encryption, TTLs, caching, and more to backends ranging from Elasticsearch, Redis, DynamoDB, filesystem, in-memory, and more!\n\n\ud83d\udd10 **OAuth maturity** brings months of production learnings into the framework. The new consent screen prevents confused deputy and authorization bypass attacks discovered in earlier versions, while the OAuth proxy now issues its own tokens with automatic key derivation. RFC 7662 token introspection support enables enterprise auth flows, and path prefix mounting enables OAuth-protected servers to integrate into existing web applications. FastMCP now supports out-of-the-box authentication with [WorkOS](https://gofastmcp.com/integrations/workos) and [AuthKit](https://gofastmcp.com/integrations/authkit), [GitHub](https://gofastmcp.com/integrations/github), [Google](https://gofastmcp.com/integrations/google), [Azure](https://gofastmcp.com/integrations/azure) (Entra ID), [AWS Cognito](https://gofastmcp.com/integrations/aws-cognito), [Auth0](https://gofastmcp.com/integrations/auth0), [Descope](https://gofastmcp.com/integrations/descope), [Scalekit](https://gofastmcp.com/integrations/scalekit), [JWTs](https://gofastmcp.com/servers/auth/token-verification#jwt-token-verification), and [RFC 7662 token introspection](https://gofastmcp.com/servers/auth/token-verification#token-introspection-protocol).\n\n\u26a1 **Response Caching Middleware** dramatically improves performance for expensive operations, while **Server lifespans** provide proper initialization and cleanup hooks that run once per server instance instead of per client session.\n\n\u2728 **Developer experience improvements** include Pydantic input validation, icon support, RFC 6570 query parameters for resource templates, improved Context API methods, and async file/directory resources.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12.5\" description=\"October 17, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.12.5: Safety Pin\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.5\"\ncta=\"Read the release notes\"\n>\nPins MCP SDK version below 1.17 to ensure the `.well-known` payload appears in the expected location when using FastMCP auth providers with composite applications.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12.4\" description=\"September 26, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.12.4: OIDC What You Did There\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.4\"\ncta=\"Read the release notes\"\n>\nFastMCP 2.12.4 adds comprehensive OIDC support and expands authentication options with AWS Cognito and Descope providers. The release also includes improvements to logging middleware, URL handling for nested resources, persistent OAuth client registration storage, and various fixes to the experimental OpenAPI parser.\n\n\ud83d\udd10 **OIDC Configuration** brings native support for OpenID Connect, enabling seamless integration with enterprise identity providers.\n\n\ud83c\udfe2 **Enterprise Authentication** expands with AWS Cognito and Descope providers, broadening the authentication ecosystem.\n\n\ud83d\udee0\ufe0f **Improved Reliability** through enhanced URL handling, persistent OAuth storage, and numerous parser fixes based on community feedback.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12.3\" description=\"September 17, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.12.3: Double Time\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.3\"\ncta=\"Read the release notes\"\n>\nFastMCP 2.12.3 focuses on performance and developer experience improvements. This release includes optimized auth provider imports that reduce server startup time, enhanced OIDC authentication flows, and automatic inline snapshot creation for testing.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12.2\" description=\"September 3, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.12.2: Perchance to Stream\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.2\"\ncta=\"Read the release notes\"\n>\nHotfix for streamable-http transport validation in fastmcp.json configuration files, resolving a parsing error when CLI arguments were merged against the configuration spec.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12.1\" description=\"September 3, 2025\" tags={[\"Releases\"]}>\n<Card\ntitle=\"FastMCP 2.12.1: OAuth to Joy\"\nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.1\"\ncta=\"Read the release notes\"\n>\nFastMCP 2.12.1 strengthens OAuth proxy implementation with improved client storage reliability, PKCE forwarding, configurable token endpoint authentication methods, and expanded scope handling based on extensive community testing.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.12\" description=\"August 31, 2025\" tags={[\"Releases\"]}>\n<Card \ntitle=\"FastMCP 2.12: Auth to the Races\" \nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.12.0\" \ncta=\"Read the release notes\"  \n>\nFastMCP 2.12 represents one of our most significant releases to date. After extensive testing and iteration with the community, we're shipping major improvements to authentication, configuration, and MCP feature adoption.\n\n\ud83d\udd10 **OAuth Proxy** bridges the gap for providers that don't support Dynamic Client Registration, enabling authentication with GitHub, Google, WorkOS, and Azure through minimal configuration.\n\n\ud83d\udccb **Declarative JSON Configuration** introduces `fastmcp.json` as the single source of truth for server settings, making MCP servers as portable and shareable as container images.\n\n\ud83e\udde0 **Sampling API Fallback** tackles adoption challenges by letting servers generate completions server-side when clients don't support the feature, encouraging innovation while maintaining compatibility.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.11\" description=\"August 1, 2025\" tags={[\"Releases\"]}>\n<Card \ntitle=\"FastMCP 2.11: Auth to a Good Start\" \nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.11.0\" \ncta=\"Read the release notes\"  \n>\nFastMCP 2.11 brings enterprise-ready authentication and dramatic performance improvements.\n\n\ud83d\udd12 **Comprehensive OAuth 2.1 Support** with WorkOS AuthKit integration, Dynamic Client Registration, and support for separate resource and authorization servers.\n\n\u26a1 **Experimental OpenAPI Parser** delivers dramatic performance gains through single-pass schema processing and optimized memory usage (enable with environment variable).\n\n\ud83d\udcbe **Enhanced State Management** provides persistent state across tool calls with a simple dictionary interface, improving context handling and type annotations.\n\nThis release emphasizes speed and simplicity while setting the foundation for future enterprise features.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.10\" description=\"July 2, 2025\" tags={[\"Releases\"]}>\n<Card \ntitle=\"FastMCP 2.10: Great Spec-tations\" \nhref=\"https://github.com/jlowin/fastmcp/releases/tag/v2.10.0\" \ncta=\"Read the release notes\"  \n>\nFastMCP 2.10 achieves full compliance with the 6/18/2025 MCP specification update, introducing powerful new communication patterns.\n\n\ud83d\udcac **Elicitation Support** enables dynamic server-client communication and \"human-in-the-loop\" workflows, allowing servers to request additional information during execution.\n\n\ud83d\udcca **Output Schemas** provide structured outputs for tools, making results more predictable and easier to parse programmatically.\n\n\ud83d\udee0\ufe0f **Enhanced HTTP Routing** with OpenAPI extensions support and configurable algorithms for more flexible API integration.\n\nThis release includes a breaking change to `client.call_tool()` return signatures but significantly expands the interaction capabilities of MCP servers.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.9\" description=\"June 23, 2025\" tags={[\"Releases\", \"Blog Posts\"]}>\n<Card \ntitle=\"FastMCP 2.9: MCP-Native Middleware\" href=\"https://www.jlowin.dev/blog/fastmcp-2-9-middleware\" \nimg=\"https://jlowin.dev/_image?href=%2F_astro%2Fhero.BkVTdeBk.jpg&w=1200&h=630&f=png\" \ncta=\"Read more\"  \n>\nFastMCP 2.9 is a major release that, among other things, introduces two important features that push beyond the basic MCP protocol. \n\n\ud83e\udd1d *MCP Middleware* brings a flexible middleware system for intercepting and controlling server operations - think authentication, logging, rate limiting, and custom business logic without touching core protocol code. \n\n\u2728 *Server-side type conversion* for prompts solves a major developer pain point: while MCP requires string arguments, your functions can now work with native Python types like lists and dictionaries, with automatic conversion handling the complexity.\n\nThese features transform FastMCP from a simple protocol implementation into a powerful framework for building sophisticated MCP applications. Combined with the new `File` utility for binary data and improvements to authentication and serialization, this release makes FastMCP significantly more flexible and developer-friendly while maintaining full protocol compliance.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.8\" description=\"June 11, 2025\" tags={[\"Releases\", \"Blog Posts\"]}>\n<Card \ntitle=\"FastMCP 2.8: Transform and Roll Out\" href=\"https://www.jlowin.dev/blog/fastmcp-2-8-tool-transformation\" \nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.su3kspkP.png&w=1000&h=500&f=webp\" \ncta=\"Read more\"  \n>\nFastMCP 2.8 is here, and it's all about taking control of your tools.\n\nThis release is packed with new features for curating the perfect LLM experience:\n\n\ud83d\udee0\ufe0f Tool Transformation\n\nThe headline feature lets you wrap any tool\u2014from your own code, a third-party library, or an OpenAPI spec\u2014to create an enhanced, LLM-friendly version. You can rename arguments, rewrite descriptions, and hide parameters without touching the original code.\n\nThis feature was developed in close partnership with Bill Easton. As Bill brilliantly [put it](https://www.linkedin.com/posts/williamseaston_huge-thanks-to-william-easton-for-providing-activity-7338011349525983232-Mw6T?utm_source=share&utm_medium=member_desktop&rcm=ACoAAAAd6d0B3uL9zpCsq9eYWKi3HIvb8eN_r_Q), \"Tool transformation flips Prompt Engineering on its head: stop writing tool-friendly LLM prompts and start providing LLM-friendly tools.\"\n\n\ud83c\udff7\ufe0f Component Control\n\nNow that you're transforming tools, you need a way to hide the old ones! In FastMCP 2.8 you can programmatically enable/disable any component, and for everyone who's been asking what FastMCP's tags are for\u2014they finally have a purpose! You can now use tags to declaratively filter which components are exposed to your clients.\n\n\ud83d\ude80 Pragmatic by Default\n\nLastly, to ensure maximum compatibility with the ecosystem, we've made the pragmatic decision to default all OpenAPI routes to Tools, making your entire API immediately accessible to any tool-using agent. When the industry catches up and supports resources, we'll restore the old default -- but no reason you should do extra work before OpenAI, Anthropic, or Google!\n\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.7\" description=\"June 6, 2025\" tags={[\"Releases\"]}>\n<Card \ntitle=\"FastMCP 2.7: Pare Programming\" href=\"https://github.com/jlowin/fastmcp/releases/tag/v2.7.0\" \nimg=\"assets/updates/release-2-7.png\" \ncta=\"Read the release notes\"  \n>\nFastMCP 2.7 has been released!\n\nMost notably, it introduces the highly requested (and Pythonic) \"naked\" decorator usage:\n\n```python {3}\nmcp = FastMCP()\n\n@mcp.tool\ndef add(a: int, b: int) -> int:\n    return a + b\n```\n\nIn addition, decorators now return the objects they create, instead of the decorated function. This is an important usability enhancement.\n\nThe bulk of the update is focused on improving the FastMCP internals, including a few breaking internal changes to private APIs. A number of functions that have clung on since 1.0 are now deprecated.\n</Card>\n</Update>\n\n\n\n<Update label=\"FastMCP 2.6\" description=\"June 2, 2025\" tags={[\"Releases\", \"Blog Posts\"]}>\n<Card \ntitle=\"FastMCP 2.6: Blast Auth\" href=\"https://www.jlowin.dev/blog/fastmcp-2-6\" \nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.Bsu8afiw.png&w=1000&h=500&f=webp\" \ncta=\"Read more\"  \n>\nFastMCP 2.6 is here!\n\nThis release introduces first-class authentication for MCP servers and clients, including pragmatic Bearer token support and seamless OAuth 2.1 integration. This release aligns with how major AI platforms are adopting MCP today, making it easier than ever to securely connect your tools to real-world AI models. Dive into the update and secure your stack with minimal friction.\n</Card>\n</Update>\n\n<Update description=\"May 21, 2025\" label=\"Vibe-Testing\" tags={[\"Blog Posts\", \"Tutorials\"]}>\n<Card\ntitle=\"Stop Vibe-Testing Your MCP Server\"\nhref=\"https://www.jlowin.dev/blog/stop-vibe-testing-mcp-servers\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.BUPy9I9c.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\n\nYour tests are bad and you should feel bad.\n\nStop vibe-testing your MCP server through LLM guesswork. FastMCP 2.0 introduces in-memory testing for fast, deterministic, and fully Pythonic validation of your MCP logic\u2014no network, no subprocesses, no vibes.\n\n</Card>\n</Update>\n\n\n<Update description=\"May 8, 2025\" label=\"10,000 Stars\" tags={[\"Blog Posts\"]}>\n<Card\ntitle=\"Reflecting on FastMCP at 10k stars \ud83c\udf1f\"\nhref=\"https://www.jlowin.dev/blog/fastmcp-2-10k-stars\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.Cnvci9Q_.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\n\nIn just six weeks since its relaunch, FastMCP has surpassed 10,000 GitHub stars\u2014becoming the fastest-growing OSS project in our orbit. What started as a personal itch has become the backbone of Python-based MCP servers, powering a rapidly expanding ecosystem. While the protocol itself evolves, FastMCP continues to lead with clarity, developer experience, and opinionated tooling. Here\u2019s to what\u2019s next.\n\n</Card>\n</Update>\n\n<Update description=\"May 8, 2025\" label=\"FastMCP 2.3\" tags={[\"Blog Posts\", \"Releases\"]}>\n<Card\ntitle=\"Now Streaming: FastMCP 2.3\"\nhref=\"https://www.jlowin.dev/blog/fastmcp-2-3-streamable-http\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.M_hv6gEB.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\n\nFastMCP 2.3 introduces full support for Streamable HTTP, a modern alternative to SSE that simplifies MCP deployments over the web. It\u2019s efficient, reliable, and now the default HTTP transport. Just run your server with transport=\"http\" and connect clients via a standard URL\u2014FastMCP handles the rest. No special setup required. This release makes deploying MCP servers easier and more portable than ever.\n\n</Card>\n</Update>\n\n<Update description=\"April 23, 2025\" label=\"Proxy Servers\" tags={[\"Blog Posts\", \"Tutorials\"]}>\n<Card\ntitle=\"MCP Proxy Servers with FastMCP 2.0\"\nhref=\"https://www.jlowin.dev/blog/fastmcp-proxy\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Frobot-hero.DpmAqgui.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\n\nEven AI needs a good travel adapter \ud83d\udd0c\n\n\nFastMCP now supports proxying arbitrary MCP servers, letting you run a local FastMCP instance that transparently forwards requests to any remote or third-party server\u2014regardless of transport. This enables transport bridging (e.g., stdio \u21c4 SSE), simplified client configuration, and powerful gateway patterns. Proxies are fully composable with other FastMCP servers, letting you mount or import them just like local servers. Use `FastMCP.from_client()` to wrap any backend in a clean, Pythonic proxy.\n</Card>\n</Update>\n\n<Update label=\"FastMCP 2.0\" description=\"April 16, 2025\" tags={[\"Releases\", \"Blog Posts\"]}>\n<Card\ntitle=\"Introducing FastMCP 2.0 \ud83d\ude80\"\nhref=\"https://www.jlowin.dev/blog/fastmcp-2\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Fhero.DpbmGNrr.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\n\nThis major release reimagines FastMCP as a full ecosystem platform, with powerful new features for composition, integration, and client interaction. You can now compose local and remote servers, proxy arbitrary MCP servers (with transport translation), and generate MCP servers from OpenAPI or FastAPI apps. A new client infrastructure supports advanced workflows like LLM sampling. \n\nFastMCP 2.0 builds on the success of v1 with a cleaner, more flexible foundation\u2014try it out today!\n</Card>\n</Update>\n\n\n\n<Update label=\"Official SDK\" description=\"December 3, 2024\" tags={[\"Announcements\"]}>\n<Card\ntitle=\"FastMCP is joining the official MCP Python SDK!\"\nhref=\"https://bsky.app/profile/jlowin.dev/post/3lch4xk5cf22c\"\nicon=\"sparkles\"\ncta=\"Read the announcement\"\n>\nFastMCP 1.0 will become part of the official MCP Python SDK!\n</Card>\n</Update>\n\n\n\n<Update label=\"FastMCP 1.0\" description=\"December 1, 2024\" tags={[\"Releases\", \"Blog Posts\"]}>\n<Card\ntitle=\"Introducing FastMCP \ud83d\ude80\"\nhref=\"https://www.jlowin.dev/blog/introducing-fastmcp\"\nimg=\"https://www.jlowin.dev/_image?href=%2F_astro%2Ffastmcp.Bep7YlTw.png&w=1000&h=500&f=webp\"\ncta=\"Read more\"\n>\nBecause life's too short for boilerplate.\n\nThis is where it all started. FastMCP\u2019s launch post introduced a clean, Pythonic way to build MCP servers without the protocol overhead. Just write functions; FastMCP handles the rest. What began as a weekend project quickly became the foundation of a growing ecosystem.\n</Card>\n</Update>\n\n"}, {"filename": "examples/atproto_mcp/README.md", "content": "# ATProto MCP Server\n\nThis example demonstrates a FastMCP server that provides tools and resources for interacting with the AT Protocol (Bluesky).\n\n## Features\n\n### Resources (Read-only)\n\n- **atproto://profile/status**: Get connection status and profile information\n- **atproto://timeline**: Retrieve your timeline feed\n- **atproto://notifications**: Get recent notifications\n\n### Tools (Actions)\n\n- **post**: Create posts with rich features (text, images, quotes, replies, links, mentions)\n- **create_thread**: Post multi-part threads with automatic linking\n- **search**: Search for posts by query\n- **follow**: Follow users by handle\n- **like**: Like posts by URI\n- **repost**: Share posts by URI\n\n## Setup\n\n1. Create a `.env` file in the root directory with your Bluesky credentials:\n\n```bash\nATPROTO_HANDLE=your.handle@bsky.social\nATPROTO_PASSWORD=your-app-password\nATPROTO_PDS_URL=https://bsky.social  # optional, defaults to bsky.social\n```\n\n2. Install and run the server:\n\n```bash\n# Install dependencies\nuv pip install -e .\n\n# Run the server\nuv run atproto-mcp\n```\n\n## The Unified Post Tool\n\nThe `post` tool is a single, flexible interface for all posting needs:\n\n```python\nasync def post(\n    text: str,                          # Required: Post content\n    images: list[str] = None,           # Optional: Image URLs (max 4)\n    image_alts: list[str] = None,       # Optional: Alt text for images\n    links: list[RichTextLink] = None,   # Optional: Embedded links\n    mentions: list[RichTextMention] = None,  # Optional: User mentions\n    reply_to: str = None,               # Optional: Reply to post URI\n    reply_root: str = None,             # Optional: Thread root URI\n    quote: str = None,                  # Optional: Quote post URI\n)\n```\n\n### Usage Examples\n\n```python\nfrom fastmcp import Client\nfrom atproto_mcp.server import atproto_mcp\n\nasync def demo():\n    async with Client(atproto_mcp) as client:\n        # Simple post\n        await client.call_tool(\"post\", {\n            \"text\": \"Hello from FastMCP!\"\n        })\n        \n        # Post with image\n        await client.call_tool(\"post\", {\n            \"text\": \"Beautiful sunset! \ud83c\udf05\",\n            \"images\": [\"https://example.com/sunset.jpg\"],\n            \"image_alts\": [\"Sunset over the ocean\"]\n        })\n        \n        # Reply to a post\n        await client.call_tool(\"post\", {\n            \"text\": \"Great point!\",\n            \"reply_to\": \"at://did:plc:xxx/app.bsky.feed.post/yyy\"\n        })\n        \n        # Quote post\n        await client.call_tool(\"post\", {\n            \"text\": \"This is important:\",\n            \"quote\": \"at://did:plc:xxx/app.bsky.feed.post/yyy\"\n        })\n        \n        # Rich text with links and mentions\n        await client.call_tool(\"post\", {\n            \"text\": \"Check out FastMCP by @alternatebuild.dev\",\n            \"links\": [{\"text\": \"FastMCP\", \"url\": \"https://github.com/jlowin/fastmcp\"}],\n            \"mentions\": [{\"handle\": \"alternatebuild.dev\", \"display_text\": \"@alternatebuild.dev\"}]\n        })\n        \n        # Advanced: Quote with image\n        await client.call_tool(\"post\", {\n            \"text\": \"Adding visual context:\",\n            \"quote\": \"at://did:plc:xxx/app.bsky.feed.post/yyy\",\n            \"images\": [\"https://example.com/chart.png\"]\n        })\n        \n        # Advanced: Reply with rich text\n        await client.call_tool(\"post\", {\n            \"text\": \"I agree! See this article for more info\",\n            \"reply_to\": \"at://did:plc:xxx/app.bsky.feed.post/yyy\",\n            \"links\": [{\"text\": \"this article\", \"url\": \"https://example.com/article\"}]\n        })\n        \n        # Create a thread\n        await client.call_tool(\"create_thread\", {\n            \"posts\": [\n                {\"text\": \"Starting a thread about Python \ud83e\uddf5\"},\n                {\"text\": \"Python is great for rapid prototyping\"},\n                {\"text\": \"And the ecosystem is amazing!\", \"images\": [\"https://example.com/python.jpg\"]}\n            ]\n        })\n```\n\n## AI Assistant Use Cases\n\nThe unified API enables natural AI assistant interactions:\n\n- **\"Reply to that post with these findings\"** \u2192 Uses `reply_to` with rich text\n- **\"Share this article with commentary\"** \u2192 Uses `quote` with the article link\n- **\"Post this chart with explanation\"** \u2192 Uses `images` with descriptive text\n- **\"Start a thread about AI safety\"** \u2192 Uses `create_thread` for automatic linking\n\n## Architecture\n\nThe server is organized as:\n- `server.py` - Public API with resources and tools\n- `_atproto/` - Private implementation module\n  - `_client.py` - ATProto client management\n  - `_posts.py` - Unified posting logic\n  - `_profile.py` - Profile operations\n  - `_read.py` - Timeline, search, notifications\n  - `_social.py` - Follow, like, repost\n- `types.py` - TypedDict definitions\n- `settings.py` - Configuration management\n\n## Running the Demo\n\n```bash\n# Run demo (read-only)\nuv run python demo.py\n\n# Run demo with posting enabled\nuv run python demo.py --post\n```\n\n## Security Note\n\nStore your Bluesky credentials securely in environment variables. Never commit credentials to version control."}, {"filename": "examples/auth/authkit_dcr/README.md", "content": "# AuthKit DCR Example\n\nDemonstrates FastMCP server protection with AuthKit Dynamic Client Registration.\n\n## Setup\n\n1. Set your AuthKit domain:\n\n   ```bash\n   export FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_AUTHKIT_DOMAIN=\"https://your-app.authkit.app\"\n   ```\n\n2. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n3. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for AuthKit authentication.\n"}, {"filename": "examples/auth/aws_oauth/README.md", "content": "# AWS Cognito OAuth Example\n\nDemonstrates FastMCP server protection with AWS Cognito OAuth.\n\n## Setup\n\n1. Create an AWS Cognito User Pool and App Client:\n   - Go to [AWS Cognito Console](https://console.aws.amazon.com/cognito/)\n   - Create a new User Pool or use an existing one\n   - Create an App Client in your User Pool\n   - Configure the App Client settings:\n     - Enable \"Authorization code grant\" flow\n     - Add Callback URL: `http://localhost:8000/auth/callback`\n     - Configure OAuth scopes (at minimum: `openid`)\n   - Note your User Pool ID, App Client ID, Client Secret, and Cognito Domain Prefix\n\n2. Set environment variables:\n\n   ```bash\n   export FASTMCP_SERVER_AUTH_AWS_COGNITO_USER_POOL_ID=\"your-user-pool-id\"\n   export FASTMCP_SERVER_AUTH_AWS_COGNITO_AWS_REGION=\"your-aws-region\"\n   export FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_ID=\"your-app-client-id\"\n   export FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_SECRET=\"your-app-client-secret\"\n   ```\n\n   Or create a `.env` file:\n\n   ```env\n   FASTMCP_SERVER_AUTH_AWS_COGNITO_USER_POOL_ID=your-user-pool-id\n   FASTMCP_SERVER_AUTH_AWS_COGNITO_AWS_REGION=your-aws-region\n   FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_ID=your-app-client-id\n   FASTMCP_SERVER_AUTH_AWS_COGNITO_CLIENT_SECRET=your-app-client-secret\n   ```\n\n3. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n4. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for AWS Cognito authentication.\n"}, {"filename": "examples/auth/azure_oauth/README.md", "content": "# Azure (Microsoft Entra) OAuth Example\n\nThis example demonstrates how to use the Azure OAuth provider with FastMCP servers.\n\n## Setup\n\n### 1. Azure App Registration\n\n1. Go to [Azure Portal \u2192 App registrations](https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade)\n2. Click \"New registration\" and configure:\n   - Name: Your app name\n   - Supported account types: Choose based on your needs\n   - Redirect URI: `http://localhost:8000/auth/callback` (Web platform)\n3. After creation, go to \"Certificates & secrets\" \u2192 \"New client secret\"\n4. Note these values from the Overview page:\n   - Application (client) ID\n   - Directory (tenant) ID\n\n### 2. Environment Variables\n\nCreate a `.env` file:\n\n```bash\n# Required\nAZURE_CLIENT_ID=your-application-client-id\nAZURE_CLIENT_SECRET=your-client-secret-value\nAZURE_TENANT_ID=your-tenant-id  # From Azure Portal Overview page\n```\n\n### 3. Run the Example\n\nStart the server:\n\n```bash\nuv run python server.py\n```\n\nTest with client:\n\n```bash\nuv run python client.py\n```\n\n## Tenant Configuration\n\nThe `tenant_id` parameter is **required** and controls which accounts can authenticate:\n\n- **Your tenant ID**: Single organization (most common)\n- **`organizations`**: Any work/school account\n- **`consumers`**: Personal Microsoft accounts only\n\n"}, {"filename": "examples/auth/discord_oauth/README.md", "content": "# Discord OAuth Example\n\nDemonstrates FastMCP server protection with Discord OAuth.\n\n## Setup\n\n1. Create a Discord OAuth App:\n   - Go to https://discord.com/developers/applications\n   - Click \"New Application\" and give it a name\n   - Go to OAuth2 in the left sidebar\n   - Add a Redirect URL: `http://localhost:8000/auth/callback`\n   - Copy the Client ID and Client Secret\n\n2. Set environment variables:\n\n   ```bash\n   export FASTMCP_SERVER_AUTH_DISCORD_CLIENT_ID=\"your-client-id\"\n   export FASTMCP_SERVER_AUTH_DISCORD_CLIENT_SECRET=\"your-client-secret\"\n   ```\n\n3. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n4. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for Discord authentication.\n"}, {"filename": "examples/auth/github_oauth/README.md", "content": "# GitHub OAuth Example\n\nDemonstrates FastMCP server protection with GitHub OAuth.\n\n## Setup\n\n1. Create a GitHub OAuth App:\n   - Go to GitHub Settings > Developer settings > OAuth Apps\n   - Set Authorization callback URL to: `http://localhost:8000/auth/callback`\n   - Copy the Client ID and Client Secret\n\n2. Set environment variables:\n\n   ```bash\n   export FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=\"your-client-id\"\n   export FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=\"your-client-secret\"\n   ```\n\n3. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n4. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for GitHub authentication.\n"}, {"filename": "examples/auth/google_oauth/README.md", "content": "# Google OAuth Example\n\nDemonstrates FastMCP server protection with Google OAuth.\n\n## Setup\n\n1. Create a Google OAuth 2.0 Client:\n   - Go to [Google Cloud Console](https://console.cloud.google.com/)\n   - Create or select a project\n   - Go to APIs & Services > Credentials\n   - Create OAuth 2.0 Client ID (Web application)\n   - Add Authorized redirect URI: `http://localhost:8000/auth/callback`\n   - Copy the Client ID and Client Secret\n\n2. Set environment variables:\n\n   ```bash\n   export FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=\"your-client-id.apps.googleusercontent.com\"\n   export FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=\"your-client-secret\"\n   ```\n\n3. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n4. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for Google authentication.\n"}, {"filename": "examples/auth/mounted/README.md", "content": "# Multi-Provider OAuth Example\n\nThis example demonstrates mounting multiple OAuth-protected MCP servers in a single application, each with its own OAuth provider. It showcases RFC 8414 path-aware discovery where each server has its own authorization server metadata endpoint.\n\n## URL Structure\n\n- **GitHub MCP**: `http://localhost:8000/api/mcp/github/mcp`\n- **Google MCP**: `http://localhost:8000/api/mcp/google/mcp`\n\nDiscovery endpoints (RFC 8414 path-aware):\n- **GitHub**: `http://localhost:8000/.well-known/oauth-authorization-server/api/mcp/github`\n- **Google**: `http://localhost:8000/.well-known/oauth-authorization-server/api/mcp/google`\n\n## Setup\n\nSet environment variables for both providers:\n\n```bash\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_ID=\"your-github-client-id\"\nexport FASTMCP_SERVER_AUTH_GITHUB_CLIENT_SECRET=\"your-github-client-secret\"\nexport FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=\"your-google-client-id\"\nexport FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=\"your-google-client-secret\"\n```\n\nConfigure redirect URIs in each provider's developer console (note the `/api/mcp/{provider}` prefix since the servers are mounted):\n- GitHub: `http://localhost:8000/api/mcp/github/auth/callback/github`\n- Google: `http://localhost:8000/api/mcp/google/auth/callback/google`\n\n## Running\n\nStart the server:\n```bash\npython server.py\n```\n\nConnect with the client:\n```bash\npython client.py\n```\n"}, {"filename": "examples/auth/scalekit_oauth/README.md", "content": "# Scalekit OAuth Example\n\nDemonstrates FastMCP server protection with Scalekit OAuth.\n\n## Setup\n\n### 1. Configure MCP server in Scalekit environment\n\n**Create a Scalekit Account**:\n\n- Go to [Scalekit Dashboard](https://app.scalekit.com/)\n- Copy your Environment URL from **Developers** \u2192 **Settings**\n- Copy Resource ID (res_xxx) from **Developers** \u2192 **MCP Servers**\n\n**Register Your MCP Server**:\n\n- Go to **MCP Servers** \u2192 **Create New Server**\n- Fill in your MCP server details\n- Note the **Resource ID** (e.g., `res_123`)\n\nCreate a `.env` file:\n\n```bash\n# Required Scalekit credentials\nSCALEKIT_ENVIRONMENT_URL=<YOUR_APP_ENVIRONMENT_URL>\nSCALEKIT_RESOURCE_ID=<YOUR_APP_RESOURCE_ID> # res_926EXAMPLE5878\nBASE_URL=http://localhost:8000/\n# Optional: additional scopes tokens must include (comma-separated)\n# SCALEKIT_REQUIRED_SCOPES=read,write\n```\n\n### 2. Run the Example\n\nStart the server:\n\n```bash\n# From this directory\nuv run python server.py\n```\n\nThe server will start on `http://localhost:8000/mcp` with Scalekit OAuth authentication enabled.\n\nTest with client:\n\n```bash\nuv run python client.py\n```\n\nThe `client.py` will:\n\n1. Attempt to connect to the server\n2. Detect that OAuth authentication is required\n3. Open a browser for Scalekit authentication\n4. Complete the OAuth flow and connect to the server\n5. Demonstrate calling authenticated tools\n"}, {"filename": "examples/auth/workos_oauth/README.md", "content": "# WorkOS OAuth Example\n\nDemonstrates FastMCP server protection with WorkOS OAuth.\n\n## Setup\n\n1. Create a WorkOS application and copy your credentials:\n\n   ```bash\n   export WORKOS_CLIENT_ID=\"your-client-id\"\n   export WORKOS_CLIENT_SECRET=\"your-client-secret\"\n   export WORKOS_AUTHKIT_DOMAIN=\"https://your-app.authkit.app\"\n   ```\n\n2. Run the server:\n\n   ```bash\n   python server.py\n   ```\n\n3. In another terminal, run the client:\n\n   ```bash\n   python client.py\n   ```\n\nThe client will open your browser for WorkOS authentication.\n"}, {"filename": "examples/fastmcp_config_demo/README.md", "content": "# FastMCP Configuration Demo\n\nThis example demonstrates the recommended way to configure FastMCP servers using `fastmcp.json`.\n\n## Migration from Dependencies Parameter\n\nPreviously (deprecated as of FastMCP 2.11.4), you would specify dependencies in the Python code:\n\n```python\nmcp = FastMCP(\"Demo Server\", dependencies=[\"pyautogui\", \"Pillow\"])\n```\n\nNow, dependencies are declared in `fastmcp.json`:\n\n```json\n{\n  \"environment\": {\n    \"dependencies\": [\"pyautogui\", \"Pillow\"]\n  }\n}\n```\n\n## Running the Server\n\nWith the configuration file in place, you can run the server in several ways:\n\n```bash\n# Auto-detect fastmcp.json in current directory\ncd examples/mcp_server_config_demo\nfastmcp run\n\n# Or specify the config file explicitly\nfastmcp run examples/mcp_server_config_demo/fastmcp.json\n\n# Or use development mode with the Inspector UI\nfastmcp dev examples/mcp_server_config_demo/fastmcp.json\n```\n\n## Benefits\n\n- **Single source of truth**: All configuration in one place\n- **Environment isolation**: Dependencies are installed in an isolated UV environment\n- **No import-time issues**: Dependencies are installed before the server is imported\n- **IDE support**: JSON schema provides autocomplete and validation\n- **Shareable**: Easy to share complete server configuration with others\n\n## Configuration Structure\n\nThe `fastmcp.json` file supports three main sections:\n\n1. **entrypoint** (required): The Python file containing your server\n2. **environment** (optional): Python version and dependencies\n3. **deployment** (optional): Runtime settings like transport and logging\n\nSee the [full documentation](https://gofastmcp.com/docs/deployment/server-configuration) for more details."}, {"filename": "examples/providers/sqlite/README.md", "content": "# Dynamic Tools from SQLite\n\nThis example demonstrates serving MCP tools from a database. Tools can be added, modified, or disabled by updating the database - no server restart required.\n\n## Structure\n\n- `tools.db` - SQLite database with tool configurations (committed for convenience)\n- `setup_db.py` - Script to create/reset the database\n- `server.py` - MCP server that loads tools from the database\n\n## Usage\n\n```bash\n# Reset the database (optional - tools.db is pre-seeded)\nuv run examples/providers/sqlite/setup_db.py\n\n# Run the server\nuv run fastmcp run examples/providers/sqlite/server.py\n```\n\n## How It Works\n\nThe `SQLiteToolProvider` queries the database on every `list_tools` and `call_tool` request:\n\n```python\nclass SQLiteToolProvider(BaseToolProvider):\n    async def list_tools(self) -> list[Tool]:\n        # Query database for enabled tools\n        ...\n\n    async def get_tool(self, name: str) -> Tool | None:\n        # Efficient single-tool lookup\n        ...\n```\n\nTools are defined as `ConfigurableTool` subclasses that combine schema and execution:\n\n```python\nclass ConfigurableTool(Tool):\n    operation: str  # \"add\", \"multiply\", etc.\n\n    async def run(self, arguments: dict[str, Any]) -> ToolResult:\n        # Execute based on configured operation\n        ...\n```\n\n## Modifying Tools at Runtime\n\nWhile the server is running, you can modify tools in the database:\n\n```bash\n# Add a new tool\nsqlite3 examples/providers/sqlite/tools.db \"INSERT INTO tools VALUES ('subtract_numbers', 'Subtract two numbers', '{\\\"type\\\":\\\"object\\\",\\\"properties\\\":{\\\"a\\\":{\\\"type\\\":\\\"number\\\"},\\\"b\\\":{\\\"type\\\":\\\"number\\\"}},\\\"required\\\":[\\\"a\\\",\\\"b\\\"]}', 'subtract', 0, 1)\"\n\n# Disable a tool\nsqlite3 examples/providers/sqlite/tools.db \"UPDATE tools SET enabled = 0 WHERE name = 'divide_numbers'\"\n```\n\nThe next `list_tools` or `call_tool` request will reflect these changes.\n"}, {"filename": "examples/sampling/README.md", "content": "# Sampling Examples\n\nThese examples demonstrate FastMCP's sampling API, which allows server tools to request LLM completions from the client.\n\n## Prerequisites\n\n```bash\npip install fastmcp[anthropic]\nexport ANTHROPIC_API_KEY=your-key\n```\n\nOr run directly with `uv`:\n\n```bash\nuv run examples/sampling/text.py\n```\n\n## Examples\n\n### Simple Text Sampling (`text.py`)\n\nBasic sampling flow where a server tool requests an LLM completion:\n\n```bash\nuv run examples/sampling/text.py\n```\n\n### Structured Output (`structured_output.py`)\n\nUses `result_type` to get validated Pydantic models from the LLM:\n\n```bash\nuv run examples/sampling/structured_output.py\n```\n\n### Tool Use (`tool_use.py`)\n\nGives the LLM tools to use during sampling (calculator, time, dice):\n\n```bash\nuv run examples/sampling/tool_use.py\n```\n\n### Server Fallback (`server_fallback.py`)\n\nConfigures a fallback sampling handler on the server, enabling sampling even when clients don't support it:\n\n```bash\nuv run examples/sampling/server_fallback.py\n```\n\n## Using OpenAI Instead\n\nTo use OpenAI instead of Anthropic, change the handler:\n\n```python\nfrom fastmcp.client.sampling.handlers.openai import OpenAISamplingHandler\n\nhandler = OpenAISamplingHandler(default_model=\"gpt-4o-mini\")\n```\n\nAnd install with `pip install fastmcp[openai]`.\n"}, {"filename": "examples/smart_home/README.md", "content": "# smart home mcp server\n\n```bash\ncd examples/smart_home\nmcp install src/smart_home/hub.py:hub_mcp -f .env\n```\nwhere `.env` contains the following:\n```\nHUE_BRIDGE_IP=<your hue bridge ip>\nHUE_BRIDGE_USERNAME=<your hue bridge username>\n```\n\n```bash\nopen -a Claude\n```"}, {"filename": "examples/tasks/README.md", "content": "# FastMCP Tasks Example\n\nDemonstrates background task execution with Docket, including progress tracking, distributed backends, and CLI worker management.\n\n## Setup\n\n```bash\n# From the fastmcp root directory\nuv sync\n\n# Start Redis\ncd examples/tasks\ndocker compose up -d\n\n# Load environment (or source .envrc manually)\ndirenv allow\n\n# Run the server\nfastmcp run server.py\n```\n\nFor single-process mode without Redis, set `FASTMCP_DOCKET_URL=memory://` (note: CLI workers won't work).\n\n## Running the Client\n\n```bash\n# Background execution with progress callbacks\npython examples/tasks/client.py --duration 10\n\n# Immediate execution (blocks)\npython examples/tasks/client.py immediate --duration 5\n```\n\n## Starting Additional Workers\n\nWith Redis, you can run additional workers to process tasks in parallel:\n\n```bash\nfastmcp tasks worker server.py\n\n# Configure via environment:\nexport FASTMCP_DOCKET_CONCURRENCY=20\nfastmcp tasks worker server.py\n```\n\n**Backend options:**\n- `memory://` - Single-process only (default)\n- `redis://` - Distributed, multi-process (Redis or Valkey)\n\n## Environment Variables\n\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `FASTMCP_DOCKET_URL` | `memory://` | Docket backend URL |\n\n## Learn More\n\n- [FastMCP Tasks Documentation](https://gofastmcp.com/docs/tasks)\n- [Docket Documentation](https://github.com/PrefectHQ/docket)\n- [MCP Task Protocol (SEP-1686)](https://spec.modelcontextprotocol.io/specification/architecture/tasks/)\n"}, {"filename": "examples/testing_demo/README.md", "content": "# FastMCP Testing Demo\n\nA comprehensive example demonstrating FastMCP testing patterns with pytest-asyncio.\n\n## Overview\n\nThis example shows how to:\n- Set up pytest-asyncio configuration in `pyproject.toml`\n- Write async test fixtures for MCP clients\n- Test tools, resources, and prompts\n- Use parametrized tests for multiple scenarios\n- Leverage inline-snapshot and dirty-equals for assertions\n\n## Project Structure\n\n```\ntesting_demo/\n\u251c\u2500\u2500 pyproject.toml          # Project config with pytest-asyncio setup\n\u251c\u2500\u2500 server.py               # Simple MCP server with tools/resources/prompts\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_server.py      # Comprehensive test suite\n\u2514\u2500\u2500 README.md               # This file\n```\n\n## Key Features\n\n### pyproject.toml Configuration\n\nThe `pyproject.toml` includes the critical pytest-asyncio configuration:\n\n```toml\n[tool.pytest.ini_options]\nasyncio_mode = \"auto\"\n```\n\nThis eliminates the need for `@pytest.mark.asyncio` decorators on every async test.\n\n### Server Components\n\nThe demo server (`server.py`) includes:\n- **Tools**: `add`, `greet`, `async_multiply`\n- **Resources**: `demo://info`, `demo://greeting/{name}`\n- **Prompts**: `hello`, `explain`\n\n### Test Patterns\n\nThe test suite demonstrates:\n1. **Async fixture pattern**: Proper client fixture using `async with`\n2. **Tool testing**: Calling tools and checking results via `.data` attribute\n3. **Resource testing**: Reading static and templated resources\n4. **Prompt testing**: Getting prompts with different arguments\n5. **Parametrized tests**: Testing multiple scenarios efficiently\n6. **Schema validation**: Verifying tool schemas and structure\n7. **Pattern matching**: Using dirty-equals for flexible assertions\n\n## Running the Tests\n\n```bash\n# Install dependencies\nuv sync\n\n# Run all tests\nuv run pytest\n\n# Run with verbose output\nuv run pytest -v\n\n# Run a specific test\nuv run pytest tests/test_server.py::test_add_tool\n```\n\n## Running the Server\n\n```bash\n# Run the server\nuv run fastmcp run server.py\n\n# Inspect the server\nuv run fastmcp inspect server.py\n```\n\n## Learning More\n\nFor detailed information about testing FastMCP servers, see the [Testing Documentation](../../docs/patterns/testing.mdx).\n"}, {"filename": "src/fastmcp/contrib/README.md", "content": "# FastMCP Contrib Modules\n\nThis directory holds community-contributed modules for FastMCP. These modules extend FastMCP's functionality but are not officially maintained by the core team.\n\n**Guarantees:**\n*   Modules in `contrib` may have different testing requirements or stability guarantees compared to the core library.\n*   Changes to the core FastMCP library might break modules in `contrib` without explicit warnings in the main changelog.\n\nUse these modules at your own discretion. Contributions are welcome, but please include tests and documentation.\n\n## Usage\n\nTo use a contrib module, import it from the `fastmcp.contrib` package.\n\n```python\nfrom fastmcp.contrib import my_module\n```\n\nNote that the contrib modules may have different dependencies than the core library, which can be noted in their respective README's or even separate requirements / dependency files."}, {"filename": "src/fastmcp/contrib/bulk_tool_caller/README.md", "content": "# Bulk Tool Caller\n\nThis module provides the `BulkToolCaller` class, which extends the `MCPMixin` to offer tools for performing multiple tool calls in a single request to a FastMCP server. This can be useful for optimizing interactions with the server by reducing the overhead of individual tool calls.\n\n## Usage\n\nTo use the `BulkToolCaller`, see the example [example.py](./example.py) file. The `BulkToolCaller` can be instantiated and then registered with a FastMCP server URL. It provides methods to call multiple tools in bulk, either different tools or the same tool with different arguments.\n\n\n## Provided Tools\n\nThe `BulkToolCaller` provides the following tools:\n\n### `call_tools_bulk`\n\nCalls multiple different tools registered on the MCP server in a single request.\n\n- **Arguments:**\n    - `tool_calls` (list of `CallToolRequest`): A list of objects, where each object specifies the `tool` name and `arguments` for an individual tool call.\n    - `continue_on_error` (bool, optional): If `True`, continue executing subsequent tool calls even if a previous one resulted in an error. Defaults to `True`.\n\n- **Returns:**\n    A list of `CallToolRequestResult` objects, each containing the result (`isError`, `content`) and the original `tool` name and `arguments` for each call.\n\n### `call_tool_bulk`\n\nCalls a single tool registered on the MCP server multiple times with different arguments in a single request.\n\n- **Arguments:**\n    - `tool` (str): The name of the tool to call.\n    - `tool_arguments` (list of dict): A list of dictionaries, where each dictionary contains the arguments for an individual run of the tool.\n    - `continue_on_error` (bool, optional): If `True`, continue executing subsequent tool calls even if a previous one resulted in an error. Defaults to `True`.\n\n- **Returns:**\n    A list of `CallToolRequestResult` objects, each containing the result (`isError`, `content`) and the original `tool` name and `arguments` for each call."}, {"filename": "src/fastmcp/contrib/component_manager/README.md", "content": "# Component Manager \u2013 Contrib Module for FastMCP\n\nThe **Component Manager** provides a unified API for enabling and disabling tools, resources, and prompts at runtime in a FastMCP server. This module is useful for dynamic control over which components are active, enabling advanced features like feature toggling, admin interfaces, or automation workflows.\n\n---\n\n## \ud83d\udd27 Features\n\n- Enable/disable **tools**, **resources**, and **prompts** via HTTP endpoints.\n- Supports **local** and **mounted (server)** components.\n- Customizable **API root path**.\n- Optional **Auth scopes** for secured access.\n- Fully integrates with FastMCP with minimal configuration.\n\n---\n\n## \ud83d\udce6 Installation\n\nThis module is part of the `fastmcp.contrib` package. No separate installation is required if you're already using **FastMCP**.\n\n---\n\n## \ud83d\ude80 Usage\n\n### Basic Setup\n\n```python\nfrom fastmcp import FastMCP\nfrom fastmcp.contrib.component_manager import set_up_component_manager\n\nmcp = FastMCP(name=\"Component Manager\", instructions=\"This is a test server with component manager.\")\nset_up_component_manager(server=mcp)\n```\n\n---\n\n## \ud83d\udd17 API Endpoints\n\nAll endpoints are registered at `/` by default, or under the custom path if one is provided.\n\n### Tools\n\n```http\nPOST /tools/{tool_name}/enable\nPOST /tools/{tool_name}/disable\n```\n\n### Resources\n\n```http\nPOST /resources/{uri:path}/enable\nPOST /resources/{uri:path}/disable\n```\n\n * Supports template URIs as well\n```http\nPOST /resources/example://test/{id}/enable\nPOST /resources/example://test/{id}/disable\n```\n\n### Prompts\n\n```http\nPOST /prompts/{prompt_name}/enable\nPOST /prompts/{prompt_name}/disable\n```\n---\n\n#### \ud83e\uddea Example Response\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n  \"message\": \"Disabled tool: example_tool\"\n}\n\n```\n\n---\n\n## \u2699\ufe0f Configuration Options\n\n### Custom Root Path\n\nTo mount the API under a different path:\n\n```python\nset_up_component_manager(server=mcp, path=\"/admin\")\n```\n\n### Securing Endpoints with Auth Scopes\n\nIf your server uses authentication:\n\n```python\nmcp = FastMCP(name=\"Component Manager\", instructions=\"This is a test server with component manager.\", auth=auth)\nset_up_component_manager(server=mcp, required_scopes=[\"write\", \"read\"])\n```\n\n---\n\n## \ud83e\uddea Example: Enabling a Tool with Curl\n\n```bash\ncurl -X POST \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\\n  -H \"Content-Type: application/json\" \\\n  http://localhost:8001/tools/example_tool/enable\n```\n\n---\n\n## \ud83e\uddf1 Working with Mounted Servers\n\nYou can also combine different configurations when working with mounted servers \u2014 for example, using different scopes:\n\n```python\nmcp = FastMCP(name=\"Component Manager\", instructions=\"This is a test server with component manager.\", auth=auth)\nset_up_component_manager(server=mcp, required_scopes=[\"mcp:write\"])\n\nmounted = FastMCP(name=\"Component Manager\", instructions=\"This is a test server with component manager.\", auth=auth)\nset_up_component_manager(server=mounted, required_scopes=[\"mounted:write\"])\n\nmcp.mount(server=mounted, prefix=\"mo\")\n```\n\nThis allows you to grant different levels of access:\n\n```bash\n# Accessing the main server gives you control over both local and mounted components\ncurl -X POST \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\\n  -H \"Content-Type: application/json\" \\\n  http://localhost:8001/tools/mo_example_tool/enable\n\n# Accessing the mounted server gives you control only over its own components\ncurl -X POST \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\\n  -H \"Content-Type: application/json\" \\\n  http://localhost:8002/tools/example_tool/enable\n```\n\n---\n\n## \u2699\ufe0f How It Works\n\n- `set_up_component_manager()` registers API routes for tools, resources, and prompts.\n- The `ComponentService` class exposes async methods to enable/disable components.\n- Each endpoint returns a success message in JSON or a 404 error if the component isn't found.\n\n---\n\n## \ud83e\udde9 Extending\n\nYou can subclass `ComponentService` for custom behavior or mount its routes elsewhere as needed.\n\n---\n\n## Maintenance Notice\n\nThis module is not officially maintained by the core FastMCP team. It is an independent extension developed by [gorocode](https://github.com/gorocode).\n\nIf you encounter any issues or wish to contribute, please feel free to open an issue or submit a pull request, and kindly notify me. I'd love to stay up to date.\n\n\n## \ud83d\udcc4 License\n\nThis module follows the license of the main [FastMCP](https://github.com/jlowin/fastmcp) project."}, {"filename": "src/fastmcp/contrib/mcp_mixin/README.md", "content": "from mcp.types import ToolAnnotations\n\n# MCP Mixin\n\nThis module provides the `MCPMixin` base class and associated decorators (`@mcp_tool`, `@mcp_resource`, `@mcp_prompt`).\n\nIt allows developers to easily define classes whose methods can be registered as tools, resources, or prompts with a `FastMCP` server instance using the `register_all()`, `register_tools()`, `register_resources()`, or `register_prompts()` methods provided by the mixin.\n\nIncludes support for\nTools:\n* [enable/disable](https://gofastmcp.com/servers/tools#disabling-tools)\n* [annotations](https://gofastmcp.com/servers/tools#annotations-2)\n* [excluded arguments](https://gofastmcp.com/servers/tools#excluding-arguments)\n* [meta](https://gofastmcp.com/servers/tools#param-meta)\n\nPrompts:\n* [enable/disable](https://gofastmcp.com/servers/prompts#disabling-prompts)\n* [meta](https://gofastmcp.com/servers/prompts#param-meta)\n\nResources:\n* [enable/disable](https://gofastmcp.com/servers/resources#disabling-resources)\n* [meta](https://gofastmcp.com/servers/resources#param-meta)\n  \n## Usage\n\nInherit from `MCPMixin` and use the decorators on the methods you want to register.\n\n```python\nfrom mcp.types import ToolAnnotations\nfrom fastmcp import FastMCP\nfrom fastmcp.contrib.mcp_mixin import MCPMixin, mcp_tool, mcp_resource, mcp_prompt\n\nclass MyComponent(MCPMixin):\n    @mcp_tool(name=\"my_tool\", description=\"Does something cool.\")\n    def tool_method(self):\n        return \"Tool executed!\"\n\n    # example of disabled tool\n    @mcp_tool(name=\"my_tool\", description=\"Does something cool.\", enabled=False)\n    def disabled_tool_method(self):\n        # This function can't be called by client because it's disabled\n        return \"You'll never get here!\"\n\n    # example of excluded parameter tool\n    @mcp_tool(\n        name=\"my_tool\", description=\"Does something cool.\",\n        enabled=False, exclude_args=['delete_everything'],\n    )\n    def excluded_param_tool_method(self, delete_everything=False):\n        # MCP tool calls can't pass the \"delete_everything\" argument\n        if delete_everything:\n            return \"Nothing to delete, I bet you're not a tool :)\"\n        return \"You might be a tool if...\"\n\n    # example tool w/annotations\n    @mcp_tool(\n        name=\"my_tool\", description=\"Does something cool.\",\n        annotations=ToolAnnotations(\n            title=\"Attn LLM, use this tool first!\",\n            readOnlyHint=False,\n            destructiveHint=False,\n            idempotentHint=False,\n        )\n    )\n    def tool_method(self):\n        return \"Tool executed!\"\n\n    # example tool w/everything\n    @mcp_tool(\n        name=\"my_tool\", description=\"Does something cool.\",\n        enabled=True,\n        exclude_args=['delete_all'],\n        annotations=ToolAnnotations(\n            title=\"Attn LLM, use this tool first!\",\n            readOnlyHint=False,\n            destructiveHint=False,\n            idempotentHint=False,\n        )\n    )\n    def tool_method(self, delete_all=False):\n        if delete_all:\n            return \"99 records deleted. I bet you're not a tool :)\"\n        return \"Tool executed, but you might be a tool!\"\n\n    # example tool w/ meta\n    @mcp_tool(\n        name=\"data_tool\",\n        description=\"Fetches user data from database\",\n        meta={\"version\": \"2.0\", \"category\": \"database\", \"author\": \"dev-team\"}\n    )\n    def data_tool_method(self, user_id: int):\n        return f\"Fetching data for user {user_id}\"\n\n    @mcp_resource(uri=\"component://data\")\n    def resource_method(self):\n        return {\"data\": \"some data\"}\n\n    # Disabled resource\n    @mcp_resource(uri=\"component://data\", enabled=False)\n    def resource_method(self):\n        return {\"data\": \"some data\"}\n\n    # example resource w/meta and title\n    @mcp_resource(\n        uri=\"component://config\",\n        title=\"Data resource Title,\n        meta={\"internal\": True, \"cache_ttl\": 3600, \"priority\": \"high\"}\n    )\n    def config_resource_method(self):\n        return {\"config\": \"data\"}\n\n    # prompt\n    @mcp_prompt(name=\"A prompt\")\n    def prompt_method(self, name):\n        return f\"What's up {name}?\"\n\n    # disabled prompt\n    @mcp_prompt(name=\"A prompt\", enabled=False)\n    def prompt_method(self, name):\n        return f\"What's up {name}?\"\n\n    # example prompt w/title and meta\n    @mcp_prompt(\n        name=\"analysis_prompt\",\n        title=\"Data Analysis Prompt\",\n        description=\"Analyzes data patterns\",\n        meta={\"complexity\": \"high\", \"domain\": \"analytics\", \"requires_context\": True}\n    )\n    def analysis_prompt_method(self, dataset: str):\n        return f\"Analyze the patterns in {dataset}\"\n\nmcp_server = FastMCP()\ncomponent = MyComponent()\n\n# Register all decorated methods with a prefix\n# Useful if you will have multiple instantiated objects of the same class\n# and want to avoid name collisions.\ncomponent.register_all(mcp_server, prefix=\"my_comp\") \n\n# Register without a prefix\n# component.register_all(mcp_server) \n\n# Now 'my_comp_my_tool' tool and 'my_comp+component://data' resource are registered (if prefix used)\n# Or 'my_tool' and 'component://data' are registered (if no prefix used)\n```\n\nThe `prefix` argument in registration methods is optional. If omitted, methods are registered with their original decorated names/URIs. Individual separators (`tools_separator`, `resources_separator`, `prompts_separator`) can also be provided to `register_all` to change the separator for specific types.\n"}, {"filename": "src/fastmcp/server/providers/openapi/README.md", "content": "# OpenAPI Server Implementation (New)\n\nThis directory contains the next-generation FastMCP server implementation for OpenAPI integration, designed to replace the legacy implementation in `/server/openapi.py`.\n\n## Architecture Overview\n\nThe new implementation uses a **stateless request building approach** with `openapi-core` and `RequestDirector`, providing zero-latency startup and robust OpenAPI support optimized for serverless environments.\n\n### Core Components\n\n1. **`server.py`** - `FastMCPOpenAPI` main server class with RequestDirector integration\n2. **`components.py`** - Simplified component implementations using RequestDirector\n3. **`routing.py`** - Route mapping and component selection logic\n\n### Key Architecture Principles\n\n#### 1. Stateless Performance\n- **Zero Startup Latency**: No code generation or heavy initialization\n- **RequestDirector**: Stateless HTTP request building using openapi-core\n- **Pre-calculated Schemas**: All complex processing done during parsing\n\n#### 2. Unified Implementation\n- **Single Code Path**: All components use RequestDirector consistently\n- **No Fallbacks**: Simplified architecture without hybrid complexity\n- **Performance First**: Optimized for cold starts and serverless deployments\n\n#### 3. OpenAPI Compliance\n- **openapi-core Integration**: Leverages proven library for parameter serialization\n- **Full Feature Support**: Complete OpenAPI 3.0/3.1 support including deepObject\n- **Error Handling**: Comprehensive HTTP error mapping to MCP errors\n\n## Component Classes\n\n### RequestDirector-Based Components\n\n#### `OpenAPITool`\n- Executes operations using RequestDirector for HTTP request building\n- Automatic parameter validation and OpenAPI-compliant serialization\n- Built-in error handling and structured response processing\n- **Advantages**: Zero latency, robust, comprehensive OpenAPI support\n\n#### `OpenAPIResource` / `OpenAPIResourceTemplate`  \n- Provides resource access using RequestDirector\n- Consistent parameter handling across all resource types\n- Support for complex parameter patterns and collision resolution\n- **Advantages**: High performance, simplified architecture, reliable error handling\n\n## Server Implementation\n\n### `FastMCPOpenAPI` Class\n\nThe main server class orchestrates the stateless request building approach:\n\n```python\nclass FastMCPOpenAPI(FastMCP):\n    def __init__(self, openapi_spec: dict, client: httpx.AsyncClient, **kwargs):\n        # 1. Parse OpenAPI spec to HTTP routes with pre-calculated schemas\n        self._routes = parse_openapi_to_http_routes(openapi_spec)\n        \n        # 2. Initialize RequestDirector with openapi-core Spec\n        self._spec = Spec.from_dict(openapi_spec)\n        self._director = RequestDirector(self._spec)\n            \n        # 3. Create components using RequestDirector\n        self._create_components()\n```\n\n### Component Creation Logic\n\n```python\ndef _create_tool(self, route: HTTPRoute) -> Tool:\n    # All tools use RequestDirector for consistent, high-performance request building\n    return OpenAPITool(\n        client=self._client, \n        route=route, \n        director=self._director,\n        name=tool_name,\n        description=description,\n        parameters=flat_param_schema\n    )\n```\n\n## Data Flow\n\n### Stateless Request Building\n\n```\nOpenAPI Spec \u2192 HTTPRoute with Pre-calculated Fields \u2192 RequestDirector \u2192 HTTP Request \u2192 Structured Response\n```\n\n1. **Spec Parsing**: OpenAPI spec parsed to `HTTPRoute` models with pre-calculated schemas\n2. **RequestDirector Setup**: openapi-core Spec initialized for request building\n3. **Component Creation**: Create components with RequestDirector reference\n4. **Request Building**: RequestDirector builds HTTP request from flat parameters\n5. **Request Execution**: Execute request with httpx client\n6. **Response Processing**: Return structured MCP response\n\n## Key Features\n\n### 1. Enhanced Parameter Handling\n\n#### Parameter Collision Resolution\n- **Automatic Suffixing**: Colliding parameters get location-based suffixes\n- **Example**: `id` in path and body becomes `id__path` and `id`\n- **Transparent**: LLMs see suffixed parameters, implementation routes correctly\n\n#### DeepObject Style Support\n- **Native Support**: Generated client handles all deepObject variations\n- **Explode Handling**: Proper support for explode=true/false\n- **Complex Objects**: Nested object serialization works correctly\n\n### 2. Robust Error Handling\n\n#### HTTP Error Mapping\n- **Status Code Mapping**: HTTP errors mapped to appropriate MCP errors\n- **Structured Responses**: Error details preserved in tool results\n- **Timeout Handling**: Network timeouts handled gracefully\n\n#### Request Building Error Handling\n- **Parameter Validation**: Invalid parameters caught during request building\n- **Schema Validation**: openapi-core validates all OpenAPI constraints\n- **Graceful Degradation**: Missing optional parameters handled smoothly\n\n### 3. Performance Optimizations\n\n#### Efficient Client Reuse\n- **Connection Pooling**: HTTP connections reused across requests\n- **Client Caching**: Generated clients cached for performance\n- **Async Support**: Full async/await throughout\n\n#### Request Optimization\n- **Pre-calculated Schemas**: All complex processing done during initialization\n- **Parameter Mapping**: Collision resolution handled upfront\n- **Zero Latency**: No runtime code generation or complex schema processing\n\n## Configuration\n\n### Server Options\n\n```python\nserver = FastMCPOpenAPI(\n    openapi_spec=spec,           # Required: OpenAPI specification\n    client=httpx_client,         # Required: HTTP client instance\n    name=\"API Server\",           # Optional: Server name\n    route_map=custom_routes,     # Optional: Custom route mappings\n    enable_caching=True,         # Optional: Enable response caching\n)\n```\n\n### Route Mapping Customization\n\n```python\nfrom fastmcp.server.openapi_new.routing import RouteMap\n\ncustom_routes = RouteMap({\n    \"GET:/users\": \"tool\",        # Force specific operations to be tools\n    \"GET:/status\": \"resource\",   # Force specific operations to be resources\n})\n```\n\n## Testing Strategy\n\n### Test Structure\n\nTests are organized by functionality:\n- `test_server.py` - Server integration and RequestDirector behavior\n- `test_parameter_collisions.py` - Parameter collision handling\n- `test_deepobject_style.py` - DeepObject parameter style support\n- `test_openapi_features.py` - General OpenAPI feature compliance\n\n### Testing Philosophy\n\n1. **Real Integration**: Test with real OpenAPI specs and HTTP clients\n2. **Minimal Mocking**: Only mock external API endpoints\n3. **Behavioral Focus**: Test behavior, not implementation details\n4. **Performance Focus**: Test that initialization is fast and stateless\n\n### Example Test Pattern\n\n```python\nasync def test_stateless_request_building():\n    \"\"\"Test that server works with stateless RequestDirector approach.\"\"\"\n    \n    # Test server initialization is fast\n    start_time = time.time()\n    server = FastMCPOpenAPI(spec=valid_spec, client=client)\n    init_time = time.time() - start_time\n    assert init_time < 0.01  # Should be very fast\n    \n    # Verify RequestDirector functionality\n    assert hasattr(server, '_director')\n    assert hasattr(server, '_spec')\n```\n\n## Migration Benefits\n\n### From Legacy Implementation\n\n1. **Eliminated Startup Latency**: Zero code generation overhead (100-200ms improvement)\n2. **Better OpenAPI Compliance**: openapi-core handles all OpenAPI features correctly\n3. **Serverless Friendly**: Perfect for cold-start environments\n4. **Simplified Architecture**: Single RequestDirector approach eliminates complexity\n5. **Enhanced Reliability**: No dynamic code generation failures\n\n### Backward Compatibility\n\n- **Same Interface**: Public API unchanged from legacy implementation\n- **Performance Improvement**: Significantly faster initialization\n- **No Breaking Changes**: Existing code works without modification\n\n## Monitoring and Debugging\n\n### Logging\n\n```python\n# Enable debug logging to see implementation choices\nimport logging\nlogging.getLogger(\"fastmcp.server.openapi_new\").setLevel(logging.DEBUG)\n```\n\n### Key Log Messages\n- **RequestDirector Initialization**: Success/failure of RequestDirector setup\n- **Schema Pre-calculation**: Pre-calculated schema and parameter map status\n- **Request Building**: Parameter mapping and URL construction details\n- **Performance Metrics**: Request timing and error rates\n\n### Debugging Common Issues\n\n1. **RequestDirector Initialization Fails**\n   - Check OpenAPI spec validity with `openapi-core`\n   - Verify spec format is correct JSON/YAML\n   - Ensure all required OpenAPI fields are present\n\n2. **Parameter Issues**\n   - Enable debug logging for parameter processing\n   - Check for parameter collision warnings\n   - Verify OpenAPI spec parameter definitions\n\n3. **Performance Issues**\n   - Monitor RequestDirector request building timing\n   - Check HTTP client configuration\n   - Review response processing timing\n\n## Future Enhancements\n\n### Planned Features\n\n1. **Advanced Caching**: Intelligent response caching with TTL\n2. **Streaming Support**: Handle streaming API responses\n3. **Batch Operations**: Optimize multiple operation calls\n4. **Enhanced Monitoring**: Detailed metrics and health checks\n5. **Configuration Management**: Dynamic configuration updates\n\n### Performance Improvements\n\n1. **Enhanced Schema Caching**: More aggressive schema pre-calculation\n2. **Parallel Processing**: Concurrent operation execution\n3. **Memory Optimization**: Further reduce memory footprint\n4. **Request Optimization**: Smart request batching and deduplication\n\n## Related Documentation\n\n- `/utilities/openapi_new/README.md` - Utility implementation details\n- `/server/openapi/README.md` - Legacy implementation reference\n- `/tests/server/openapi_new/` - Comprehensive test suite\n- Project documentation on OpenAPI integration patterns"}, {"filename": "src/fastmcp/utilities/openapi/README.md", "content": "# OpenAPI Utilities\n\nThis directory contains the OpenAPI integration utilities for FastMCP.\n\n## Architecture Overview\n\nThe implementation follows a **stateless request building strategy** using `openapi-core` for high-performance, per-request HTTP request construction, eliminating startup latency while maintaining robust OpenAPI compliance.\n\n### Core Components\n\n1. **`director.py`** - `RequestDirector` for stateless HTTP request building\n2. **`parser.py`** - OpenAPI spec parsing and route extraction with pre-calculated schemas\n3. **`schemas.py`** - Schema processing with parameter mapping for collision handling\n4. **`models.py`** - Enhanced data models with pre-calculated fields for performance\n5. **`formatters.py`** - Response formatting and processing utilities\n\n### Key Architecture Principles\n\n#### 1. Stateless Request Building\n- Uses `openapi-core` library for robust OpenAPI parameter serialization\n- Builds HTTP requests on-demand with zero startup latency\n- Offloads OpenAPI compliance to a well-tested library without code generation overhead\n\n#### 2. Pre-calculated Optimization\n- **Schema Pre-calculation**: Combined schemas calculated once during parsing\n- **Parameter Mapping**: Collision resolution mapping calculated upfront\n- **Zero Runtime Overhead**: All complex processing done during initialization\n\n#### 3. Performance-First Design\n- **No Code Generation**: Eliminates 100-200ms startup latency\n- **Serverless Friendly**: Ideal for cold-start environments\n- **Minimal Dependencies**: Uses lightweight `openapi-core` instead of full client generation\n\n## Data Flow\n\n### Initialization Process\n\n```\nOpenAPI Spec \u2192 Parser \u2192 HTTPRoute with Pre-calculated Fields \u2192 RequestDirector + SchemaPath\n```\n\n1. **Input**: Raw OpenAPI specification (dict)\n2. **Parsing**: Extract operations to `HTTPRoute` models\n3. **Pre-calculation**: Generate combined schemas and parameter maps during parsing\n4. **Director Setup**: Create `RequestDirector` with `SchemaPath` for request building\n\n### Request Processing\n\n```\nMCP Tool Call \u2192 RequestDirector.build() \u2192 httpx.Request \u2192 HTTP Response \u2192 Structured Output\n```\n\n1. **Tool Invocation**: FastMCP receives tool call with parameters\n2. **Request Building**: RequestDirector builds HTTP request using parameter map\n3. **Parameter Handling**: openapi-core handles all OpenAPI serialization rules\n4. **Response Processing**: Parse response into structured format with proper error handling\n\n## Key Features\n\n### 1. High-Performance Request Building\n- Zero startup latency - no code generation required\n- Stateless request building scales infinitely\n- Uses proven `openapi-core` library for OpenAPI compliance\n- Perfect for serverless and cold-start environments\n\n### 2. Comprehensive Parameter Support\n- **Parameter Collisions**: Intelligent collision resolution with suffixing\n- **DeepObject Style**: Full support for deepObject parameters with explode=true/false\n- **Complex Schemas**: Handles nested objects, arrays, and all OpenAPI types\n- **Pre-calculated Mapping**: Parameter location mapping done upfront for performance\n\n### 3. Enhanced Error Handling\n- HTTP status code mapping to MCP errors\n- Structured error responses with detailed information\n- Graceful handling of network timeouts and connection errors\n- Proper error context preservation\n\n### 4. Advanced Schema Processing\n- **Pre-calculated Schemas**: Combined parameter and body schemas calculated once\n- **Collision-aware**: Automatically handles parameter name collisions\n- **Type Safety**: Full Pydantic model validation\n- **Performance**: Zero runtime schema processing overhead\n\n## Component Integration\n\n### Server Components (`/server/openapi/`)\n\n1. **`OpenAPITool`** - Simplified tool implementation using RequestDirector\n2. **`OpenAPIResource`** - Resource implementation with RequestDirector\n3. **`OpenAPIResourceTemplate`** - Resource template with RequestDirector support\n4. **`FastMCPOpenAPI`** - Main server class with stateless request building\n\n### RequestDirector Integration\n\nAll components use the same RequestDirector approach:\n- Consistent parameter handling across all component types\n- Uniform error handling and response processing\n- Simplified architecture without fallback complexity\n- High performance for all operation types\n\n## Usage Examples\n\n### Basic Server Setup\n\n```python\nimport httpx\nfrom fastmcp.server.openapi import FastMCPOpenAPI\n\n# OpenAPI spec (can be loaded from file/URL)\nopenapi_spec = {...}\n\n# Create HTTP client\nasync with httpx.AsyncClient() as client:\n    # Create server with stateless request building\n    server = FastMCPOpenAPI(\n        openapi_spec=openapi_spec,\n        client=client,\n        name=\"My API Server\"\n    )\n    \n    # Server automatically creates RequestDirector and pre-calculates schemas\n```\n\n### Direct RequestDirector Usage\n\n```python\nfrom fastmcp.utilities.openapi.director import RequestDirector\nfrom jsonschema_path import SchemaPath\n\n# Create RequestDirector manually\nspec = SchemaPath.from_dict(openapi_spec)\ndirector = RequestDirector(spec)\n\n# Build HTTP request\nrequest = director.build(route, flat_arguments, base_url)\n\n# Execute with httpx\nasync with httpx.AsyncClient() as client:\n    response = await client.send(request)\n```\n\n## Testing Strategy\n\nTests are located in `/tests/server/openapi/`:\n\n### Test Categories\n\n1. **Core Functionality**\n   - `test_server.py` - Server initialization and RequestDirector integration\n\n2. **OpenAPI Features**  \n   - `test_parameter_collisions.py` - Parameter name collision handling\n   - `test_deepobject_style.py` - DeepObject parameter style support\n   - `test_openapi_features.py` - General OpenAPI feature compliance\n\n### Testing Philosophy\n\n- **Real Objects**: Use real HTTPRoute models and OpenAPI specifications\n- **Minimal Mocking**: Only mock external HTTP endpoints\n- **Performance Focus**: Test that initialization is fast and stateless\n- **Behavioral Testing**: Verify OpenAPI compliance without implementation details\n\n## Future Enhancements\n\n### Planned Features\n\n1. **Response Streaming**: Handle streaming API responses\n2. **Enhanced Authentication**: More auth provider integrations\n3. **Advanced Metrics**: Detailed request/response monitoring\n4. **Schema Validation**: Enhanced input/output validation\n5. **Batch Operations**: Optimized multi-operation requests\n\n### Performance Improvements\n\n1. **Schema Caching**: More aggressive schema pre-calculation\n2. **Memory Optimization**: Further reduce memory footprint\n3. **Request Batching**: Smart batching for bulk operations\n4. **Connection Optimization**: Enhanced connection pooling strategies\n\n## Troubleshooting\n\n### Common Issues\n\n1. **RequestDirector Initialization Fails**\n   - Check OpenAPI spec validity with `jsonschema-path`\n   - Verify spec format is correct JSON/YAML\n   - Ensure all required OpenAPI fields are present\n\n2. **Parameter Mapping Issues**\n   - Check parameter collision resolution in debug logs\n   - Verify parameter names match OpenAPI spec exactly\n   - Review pre-calculated parameter map in HTTPRoute\n\n3. **Request Building Errors**\n   - Check network connectivity to target API\n   - Verify base URL configuration\n   - Review parameter validation and type mismatches\n\n### Debugging\n\n- Enable debug logging: `logger.setLevel(logging.DEBUG)`\n- Check RequestDirector initialization logs\n- Review parameter mapping in HTTPRoute models\n- Monitor request building and API response patterns\n\n## Dependencies\n\n- `openapi-core` - OpenAPI specification processing and validation\n- `httpx` - HTTP client library\n- `pydantic` - Data validation and serialization\n- `urllib.parse` - URL building and manipulation"}, {"filename": "tests/experimental/README.md", "content": "# Experimental Tests\n\nEach directory in this folder tests a discrete experimental feature. The directory structure within each experiment should approximate the \"normal\" test directory structure to facilitate moving tests into place once/if the experiment is merged into the main codebase."}, {"filename": "v3-notes/get-methods-consolidation.md", "content": "# Consolidating get_* and _list_* Methods\n\nThis document captures the design decision to consolidate component listing methods in FastMCP 3.0.\n\n## Problem\n\nThe server had parallel implementations for listing components:\n- `get_tools()` / `_list_tools()`\n- `get_resources()` / `_list_resources()`\n- `get_prompts()` / `_list_prompts()`\n- `get_resource_templates()` / `_list_resource_templates()`\n\nThese were nearly identical but with subtle differences in dedup keys, logging, and return types. The `_list_*` methods were internal and used by the MCP protocol handlers, while `get_*` methods were the public API.\n\n## Solution\n\n`get_*` is now the canonical method. The `_list_*` methods were deleted entirely.\n\n```python\nasync def get_tools(self, *, apply_middleware: bool = False) -> list[Tool]:\n    \"\"\"Canonical method for listing tools.\"\"\"\n    if apply_middleware:\n        # Apply middleware chain (for MCP protocol handlers)\n        mw_context = MiddlewareContext(...)\n        return await self._apply_middleware(\n            context=mw_context,\n            call_next=lambda context: self.get_tools(apply_middleware=False)\n        )\n\n    # Core implementation: query providers, dedupe, filter visibility\n    ...\n```\n\n## Key Changes\n\n### Return Type: dict \u2192 list\n\nThe dict return type was removed because the key was redundant\u2014components already have `.name` or `.uri` attributes.\n\n```python\n# Before\ntools = await server.get_tools()\ntool = tools[\"my_tool\"]\n\n# After\ntools = await server.get_tools()\ntool = next(t for t in tools if t.name == \"my_tool\")\n```\n\n### Middleware via Parameter\n\nThe `apply_middleware=True` parameter applies the middleware chain. This replaces the separate `_list_*_middleware()` methods.\n\nCallers:\n- MCP protocol handlers: `get_tools(apply_middleware=True)`\n- Direct access: `get_tools()` (default False)\n\n## Benefits\n\n1. **Single source of truth** - One method, not two\n2. **Consistent behavior** - Same dedup key, same visibility filtering\n3. **Clearer API** - Public method with explicit middleware opt-in\n4. **Less code** - Deleted ~200 lines of duplicate implementation\n\n## Implementation Files\n\n- `src/fastmcp/server/server.py` - Canonical `get_*` methods\n- `src/fastmcp/server/providers/fastmcp_provider.py` - Uses `apply_middleware=True`\n- `src/fastmcp/utilities/inspect.py` - Uses `apply_middleware=True`\n"}, {"filename": "v3-notes/visibility.md", "content": "# Visibility & Enable/Disable Design\n\nThis document captures the design decisions for the enable/disable system in FastMCP 3.0.\n\n## Core Principle\n\n**Components describe capabilities. Servers and providers control availability.**\n\nPreviously, each component had an `enabled` field that users could mutate directly. This caused a fundamental problem: when components pass through providers (especially TransformingProvider), you receive copies\u2014and mutating a copy doesn't affect the original.\n\n## Solution: Hierarchical Visibility\n\nBoth servers and providers maintain their own `VisibilityFilter`. If a component is disabled at any level, it's disabled up the chain.\n\n```\nProvider A (filters) \u2192 Provider B (filters) \u2192 Server (filters) \u2192 Client sees only enabled components\n```\n\n## VisibilityFilter\n\nThe `VisibilityFilter` class (`src/fastmcp/utilities/visibility.py`) provides:\n\n### Blocklist (disable)\n```python\nserver.disable(keys=[\"tool:my_tool\"])  # Hide specific component\nserver.disable(tags={\"internal\"})       # Hide all components with tag\n```\n\n### Allowlist (enable with only=True)\n```python\nserver.enable(tags={\"public\"}, only=True)  # Show ONLY components with tag\n```\n\n### Blocklist Wins\nIf a component is in both blocklist and allowlist, blocklist wins. This ensures you can always hide something regardless of other filters.\n\n### Change Detection\nThe `VisibilityFilter` only sends notifications when visibility actually changes:\n- Disabling an already-disabled component: no notification\n- Enabling an already-enabled component: no notification\n- Actual state change: notification sent\n\n## Vocabulary\n\nConsistent verbs throughout the codebase:\n- `enable()` / `disable()` - methods on servers and providers\n- `is_enabled()` - check if component is visible\n- `_disabled_keys`, `_disabled_tags` - blocklist state\n- `_enabled_keys`, `_enabled_tags` - allowlist state\n- `_default_enabled` - True unless `only=True` was used\n\n## Notifications\n\n`VisibilityFilter` handles notifications directly via `_send_notification()`. This:\n1. Gets the current request context (if any)\n2. Queues the appropriate list-changed notification\n3. No-ops gracefully outside request context\n\nThis simplifies the code\u2014no callback wiring needed between VisibilityFilter and its owners.\n\n## Migration from 2.x\n\n### Component enable/disable removed\n\n```python\n# Before (2.x) - BROKEN: mutates a copy\ntool.disable()\n\n# After (3.x)\nserver.disable(keys=[\"tool:my_tool\"])\n```\n\n### enabled field removed\n\n```python\n# Before (2.x)\n@mcp.tool(enabled=False)\ndef my_tool(): ...\n\n# After (3.x)\n@mcp.tool\ndef my_tool(): ...\n\nmcp.disable(keys=[\"tool:my_tool\"])\n```\n\n### include_tags/exclude_tags deprecated\n\n```python\n# Before (deprecated)\nmcp = FastMCP(\"server\", exclude_tags={\"internal\"})\n\n# After\nmcp = FastMCP(\"server\")\nmcp.disable(tags={\"internal\"})\n```\n\n## Component Keys\n\nComponents use prefixed keys for enable/disable:\n- Tools: `\"tool:function_name\"`\n- Prompts: `\"prompt:prompt_name\"`\n- Resources: `\"resource:resource://uri\"`\n- Templates: `\"template:resource://{param}/path\"`\n\nUse `component.key` to get the correct key format.\n\n## Implementation Files\n\n- `src/fastmcp/utilities/visibility.py` - VisibilityFilter class\n- `src/fastmcp/server/providers/base.py` - Provider.enable/disable\n- `src/fastmcp/server/server.py` - FastMCP.enable/disable\n- `src/fastmcp/utilities/components.py` - Component.enable/disable raise NotImplementedError\n"}]